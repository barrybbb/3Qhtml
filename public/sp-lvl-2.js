//>>built
require({cache:{"cb/widget/HelpDialog":function(){define(["dojo","dojo/_base/declare","dojo/_base/lang","dojo/on","dojo/aspect","dojo/dom-construct","sp/dialog/TooltipDialog","sp/dialog/DialogContent","cb/widget/ShortcutsDialog","cb/widget/BoardCheatSheetDialog","sp/I18n","dojo/i18n!../board/nls/Messages"],function(_1,_2,_3,on,_4,_5,_6,_7,_8,_9,_a,_b){var _c=_a.wrap(_b);return _2([_6],{complexOrient:{"BR":"TR"},integratedDesign:true,integratedDesignOffset:11,invisibleMilk:true,postCreate:function(){this.inherited(arguments);this.content=new _7({i18n:_b,templateString:"<div class=\"dialog-content\" data-dojo-attach-point=\"_menuContainer\"><div>",dialog:this,buildRendering:function(){this.inherited("buildRendering",arguments);var _d=_5.create("ul",{"class":"simple-app-menu title-app-menu"},this._menuContainer);var _e=_5.create("li",{"innerHTML":"<i class=\"fonticon-keyboard\"></i> "+_c("help_menu_shortcuts")},_d);this.own(on(_e,"click",_3.hitch(this,function(e){(new _8({autofocus:false})).show();this.dialog.hide();})));var _f=_5.create("li",{"innerHTML":"<i class=\"fonticon-magnifier\"></i> "+_c("help_menu_faq")},_d);this.own(on(_f,"click",_3.hitch(this,function(e){Zenbox.show();this.dialog.hide();})));var _10=_5.create("li",{"innerHTML":"<i class=\"fonticon-info\"></i> "+_c("help_menu_cheatsheet")},_d);this.own(on(_10,"click",_3.hitch(this,function(e){(new _9()).show();this.dialog.hide();})));var _11=_5.create("li",{"innerHTML":"<i class=\"fonticon-tour\"></i> "+_c("help_menu_tutorial")},_d);this.own(on(_11,"click",_3.hitch(this,function(e){_1.hash("#tutorial=start");this.dialog.hide();})));}});}});});},"wp/data/item/RectangleItem":function(){define("wp/data/item/RectangleItem",["dijit","dojo","dojox","dojo/require!wp/data/Item"],function(_12,_13,_14){_13.provide("wp.data.item.RectangleItem");_13.require("wp.data.Item");_13.declare("wp.data.item.RectangleItem",wp.data.Item,{constructor:function(map){this.type="rectangle";},draw:function(_15){if(this.del){return;}var _16=wp.common.ColorHelper.convertHexAndPercentToDojoColor(this.lc,this.fo);var _17=this.ls.toLowerCase()!="none"?this.lw:"0";var _18=this.ls.toLowerCase()!="none"?this.ls:"solid";var _19=this.ls.toLowerCase()!="none"?this.lo:"0";var _1a=wp.common.ColorHelper.convertHexAndPercentToDojoColor(this.lc,_19);var _1b={color:_1a,width:_17,style:_18,cap:"butt",join:"round"};var x=Math.min(this.a.x,this.b.x);var y=Math.min(this.a.y,this.b.y);var w=Math.abs(this.a.x-this.b.x);var h=Math.abs(this.a.y-this.b.y);if(w<1){w=1;}if(h<1){h=1;}var xZ=x;var yZ=y;var _1c=w;var _1d=h;var _1e=_15.createRect({x:xZ,y:yZ,width:_1c,height:_1d,r:0}).setStroke(_1b);if(this.fo>0){_1e.setFill(_16);}if(_1b.width<this.MIN_LINE_WIDTH){_15.createRect({x:xZ,y:yZ,width:_1c,height:_1d,r:0}).setStroke(this.TRANSPARENT_STROKE);}},json:function(){return {"type":this.type,"del":this.del,"id":this.id,"seq":this.seq,"z":this.z,"fc":this.fc,"fo":this.fo,"lc":this.lc,"lo":this.lo,"lw":this.lw,"ls":this.ls,"a":this.a,"b":this.b,"authorid":this.authorid,"origAuthorid":this.origAuthorid,"origSeq":this.origSeq,"origDte":this.origDte,"dte":this.dte};}});});},"cb/board/itemui/SimpleTxtDiv":function(){define(["dojo","dojo/DeferredList","dojo/on","dojo/when","dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/dom-class","dojo/dom-attr","dojox/lang/functional","cb/util-text","wp/common/TextHelper","wp/common/ColorHelper","./_TxtDiv","./TxtDivHelper","./TxtDivTextarea","sp/I18n","dojo/i18n!./nls/itemui"],function(_1f,_20,on,_21,_22,_23,_24,_25,_26,_27,_28,_29,_2a,_2b,_2c,_2d,_2e,_2f,_30){var _31=_2f.wrap(_30);return _24("cb.board.itemui.SimpleTxtDiv",[_2c],{multipleEntriesPossible:false,startup:function(_32,_33,_34){this.inherited("startup",arguments);if(this.widgetItemSubtype==="note"){_1f.addClass(this.domNode,"pWTD-stickynoteStyle");}},rearrange:function(_35){this.inherited("rearrange",arguments);if(_35.subtype==="note"){_1f.toggleClass(this.domNode,"pWTD-boxStyle",false);_1f.style(this.entryList,"background",_2b.convertHexAndPercentToDojoColor(_35.fc,50).toHex());}else{if(!_35.fc||_35.fc==="transparent"||!_35.fo||_35.fo==="0"||_35.fo*1===0){_1f.toggleClass(this.domNode,"pWTD-boxStyle",false);_1f.style(this.entryList,"background","");}else{if(_35.fc==="#ffffff"){_1f.toggleClass(this.domNode,"pWTD-boxStyle",false);_1f.style(this.entryList,"background",_2b.convertHexAndPercentToDojoColor(_35.fc,100).toHex());}else{_1f.toggleClass(this.domNode,"pWTD-boxStyle",true);_1f.style(this.entryList,"background",_2b.convertHexAndPercentToDojoColor(_35.fc,_35.fo).toHex());}}}_1f.style(this.domNode,"color",_35.tc?_35.tc:"#333333");_1f.toggleClass(this.domNode,"align-left",!_35.ta||_35.ta==="left");_1f.toggleClass(this.domNode,"align-center",_35.ta==="center");_1f.toggleClass(this.domNode,"align-right",_35.ta==="right");_1f.toggleClass(this.domNode,"font-arial",!_35.tf||_35.tf==="arial"||_35.tf==="normal");_1f.toggleClass(this.domNode,"font-awesome",_35.tf==="awesome");_1f.toggleClass(this.domNode,"font-handwrite",_35.tf==="handwrite");_1f.toggleClass(this.domNode,"font-Chewy",_35.tf==="Chewy");_1f.toggleClass(this.domNode,"font-Lobster",_35.tf==="Lobster");_1f.toggleClass(this.domNode,"font-OpenSans",_35.tf==="OpenSans");_1f.toggleClass(this.domNode,"font-OpenSansBold",_35.tf==="OpenSansBold");_1f.toggleClass(this.domNode,"font-OpenSansCondensed",_35.tf==="OpenSansCondensed");_1f.toggleClass(this.domNode,"font-PTMono",_35.tf==="PTMono");_1f.toggleClass(this.domNode,"font-Ultra",_35.tf==="Ultra");_1f.toggleClass(this.domNode,"font-s",!_35.ts||_35.ts==="s");_1f.toggleClass(this.domNode,"font-xs",_35.ts==="xs");_1f.toggleClass(this.domNode,"font-m",_35.ts==="m");_1f.toggleClass(this.domNode,"font-l",_35.ts==="l");_1f.toggleClass(this.domNode,"font-xl",_35.ts==="xl");_1f.toggleClass(this.domNode,"font-xxl",_35.ts==="xxl");_1f.toggleClass(this.domNode,"font-xxxl",_35.ts==="xxxl");},_getTextToSend:function(_36){return _36;},_getTextToDisplayInTextarea:function(_37){return _2a.unescape(_37);},_enrichTextEntryContent:function(_38,_39,_3a){_38.innerHTML=_29.convertTextToMarkupWithBreaksAndLinks(_39,"sid=\"__NOFLOW\"",true);},_renderEntryContentAsText:function(_3b,_3c,_3d){var _3e=_1f.create("p",{"sid":this.txtGroupId,"class":"enable-user-text-select","innerHTML":_3c},_3b);this._enrichTextEntryContent(_3e,_3c,_3d);},_renderEntryContentAsInput:function(_3f,_40){var _41=dijit.byId("pWTextareaNode");if(_41){_41.destroyRecursive();}var _42=_25.create("div",{"class":"textarea-container"},_3f);var _43=this._getTextToDisplayInTextarea(_40?_40.text:"");var _44=new _2e({id:"pWTextareaNode",txtGroupId:this.txtGroupId,value:_43,createWithAt:false,resetCallback:_1f.hitch(this,function(){this.controller.resetTextEdit();}),saveCallback:_1f.hitch(this,function(_45){this.controller.saveTextEditIfChanged(this._getTextToSend(_45));})},_1f.create("div",{},_42));}});});},"cb/board/toolbar/ChooseMoreDialog":function(){define(["dojo","dojo/_base/declare","dojo/_base/lang","dojo/on","sp/dialog/TooltipDialog","sp/dialog/DialogContent","sp/I18n","dojo/i18n!../nls/Messages"],function(_46,_47,_48,on,_49,_4a,_4b,_4c){var _4d=_4b.wrap(_4c);return _46.declare([_49],{complexOrient:{"BR":"TR"},integratedDesign:true,integratedDesignOffset:7,closeSubscriptions:null,baseClass:"extended-toolbar",createAndConnectCloseHandler:function(){this.closeSubscriptions=[_46.subscribe("/sp/pad/controller/mousedown",this,function(_4e){this.hide();}),_46.subscribe("/sp/pad/propbar/mousedown",this,function(_4f){this.hide();}),_46.subscribe("updates/cb/board/currenttool",this,function(_50){this.hide();}),_46.subscribe("/cb/board/tool/config/current",this,function(_51){this.hide();})];},hide:function(){this.inherited("hide",arguments);if(this.closeSubscriptions){for(var i=0;i<this.closeSubscriptions.length;i++){_46.unsubscribe(this.closeSubscriptions[i]);}}}});});},"cb/widget/BoardCheatSheetDialog":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/on","dojo/dom-attr","dojo/dom-construct","dojo/dom-class","dojo/query","sp/dialog/TooltipDialog","sp/dialog/DialogContent","sp/ajax/AjaxEngine","dojo/text!./BoardCheatSheetDialog.html","sp/I18n","dojo/i18n!./nls/BoardCheatSheetDialog","dojo/NodeList-dom"],function(_52,_53,on,_54,_55,_56,_57,_58,_59,_5a,_5b,_5c,_5d){var _5e=_5c.wrap(_5d);return _52([_58],{baseClass:"cheat-sheet-dialog",fadeBeforeHide:true,i18n:_5d,postCreate:function(){this.inherited(arguments);new _59({templateString:_5b,dialog:this,postMixInProperties:function(){this.inherited("postMixInProperties",arguments);this.markAsChecked=(sp.info.user.info.showTutorial===false)?true:false;},postCreate:function(){this.inherited("postCreate",arguments);if(!sp.info.user.isIdentified){_55.destroy(this._dontShowAgainContainer);}else{_54.set(this._dontShowAgainBox,"checked",this.markAsChecked);}this._setupPointerClickHandling();},_handleDontShowAgainChange:function(){var _5f=!_54.get(this._dontShowAgainBox,"checked");_5a.changeUserSettingShowTutorial({userId:sp.info.user.id,state:_5f}).then(function(_60){if(_60.success){sp.info.user.info.showTutorial=_60.showTutorial;}});},_handleCloseButtonClick:function(){this.dialog.hide();},_setupPointerClickHandling:function(){var _61=_57(".pointer",this.domNode);on(this,"click",_53.hitch(this,function(){_61.removeClass("active");}));_61.on("click",function(_62){window.setTimeout(_53.hitch(this,function(){_56.toggle(this,"active");}),100);});}});}});});},"cb/board/FooterContentPane":function(){define(["dojo","dojo/_base/declare","dojo/_base/lang","dojo/on","dojo/aspect","dojo/dom-class","dojo/dom-construct","dojo/html","dijit/_Widget","dijit/layout/ContentPane","dijit/layout/BorderContainer","cb/util","cb/board/participants/ParticipantListDisplay","cb/page/pad/ParticipantTracker","cb/board/conference/ChatContainer","cb/board/conference/ConferenceContainer","cb/board/OuterFooterToggler","sp/I18n","dojo/i18n!./nls/Messages"],function(_63,_64,_65,on,_66,_67,_68,_69,_6a,_6b,_6c,_6d,_6e,_6f,_70,_71,_72,_73,_74){var _75=_73.wrap(_74);return _64([_6c],{postCreate:function(){this.inherited(arguments);this._innerLeftPane=new _6b({"region":"left"});this.addChild(this._innerLeftPane);this._innerCenterPane=new _6b({"region":"center"});this.addChild(this._innerCenterPane);this._innerRightPane=new _6b({"region":"right"});this.addChild(this._innerRightPane);this._footerToggler=_68.create("div",{"innerHTML":"<span class=\"fonticon-triangle-left\"></span><span class=\"fonticon-triangle-left\"></span>","title":_75("close_footer"),"class":"footer-toggler open"},this._innerLeftPane.domNode);this.own(_66.after(_6f,"onUserAdded",_6d.debounce(function(){if(_6f.getUsers().length>1){_63.publish("/cb/board/panes/footer/open");}},150)));this.own(on(this._footerToggler,"click",function(e){_63.publish("/cb/board/panes/footer/close");}));this.own(_63.subscribe("/cb/board/panes/footer/open",_65.hitch(this,function(){this._toggleFooter(true);})));this.own(_63.subscribe("/cb/board/panes/footer/close",_65.hitch(this,function(){this._toggleFooter(false);})));this.own(_63.subscribe("/cb/board/panes/footer/layout",_65.hitch(this,function(){this.getParent().resize();})));this._chatContainer=new _70({},_68.create("div",null,this._innerLeftPane.domNode));this._participantsDisplay=new _6e({withShareButton:true},_68.create("div",null,this._innerCenterPane.domNode));this._conferenceContainer=new _71({},_68.create("div",null,this._innerRightPane.domNode));_68.create("div",{"class":"minimap-footer-spacer"},this._innerRightPane.domNode);new _72({controller:this.controller},_63.create("div",{"class":"outer-footer-toggler-container"},_63.byId("borderContainer"),"after"));this._toggleFooter(true);},_toggleFooter:function(_76){_63.toggleClass(this.domNode,"footer-pane-visible",!!_76);_63.toggleClass(_63.body(),"footer-visible",!!_76);this.getParent().resize();window.setTimeout(function(){_63.publish("/window/resize");},0);}});});},"wp/data/ItemMap":function(){define("wp/data/ItemMap",["dijit","dojo","dojox","dojo/require!wp/data/SequenceHelper,dojox/lang/functional,dojox/lang/functional"],function(_77,_78,_79){_78.provide("wp.data.ItemMap");_78.require("wp.data.SequenceHelper");_78.require("dojox.lang.functional");_78.declare("wp.data.ItemMap",null,{constructor:function(){this._lastModifiedAt=new Date();this._map={};this._itemData={};this._zList=[];this._zListPositions={};this._cache={};this._bbox=null;this._itemBBoxesOrNullForDeletedBoxes={};this._groups={};this._chronoMap={};this._connsSource={};this._txtEntries={};this.txtEntryIdsCompareBound=_78.hitch(this,this.txtEntryIdsCompare);},addOrUpdateItem:function(_7a){if(!_7a.id){throw new Error("addOrUpdateItem: Id missing!");}if(_7a.z!==0&&!_7a.z){throw new Error("addOrUpdateItem: Z-Index missing!");}var id=_7a.id;var z=1*_7a.z;var seq=_7a.seq?_7a.seq:null;var _7b=_7a.dte?_78.date.stamp.fromISOString(_7a.dte):new Date();if(_7b>this._lastModifiedAt){this._lastModifiedAt=_7b;}var _7c=_7a.json();if(!this._insertToMap(id,_7c,seq)){this._chronoMap[id]={origAuthorid:_7a.authorid,createdAt:_7b};return false;}var _7d=this._insertToCache(id,_7a);if(_7d){this._chronoMap[id]={origAuthorid:_7a.authorid,createdAt:_7b};}this._insertToGroups(id,_7a);this._insertToTxtEntries(id,_7a);this._insertToBBox(id,_7a,_7d);if(_7a.conn){if(_7a.conn.length&&_7a.conn.length>0){this._connsSource[_7a.id]=_7a.conn[0].id;}}this._insertToZList(id,z,seq,_7a.del);return true;},getSourceConnectionsByMasterId:function(_7e){return _79.lang.functional.keys(_79.lang.functional.filterIn(this._connsSource,function(_7f,key){return _7f===_7e;}));},getLastModifiedAt:function(){return this._lastModifiedAt;},contains:function(id){if(!id){throw new Error("contains: Id missing when calling contains!");}return !!this._itemData[id];},getItemById:function(id){if(!id){throw new Error("getItemById: Id missing!");}if(!this._cache[id]){throw new Error("getItemById: Item with id '"+id+"' doesn't exist!");}return this._cache[id];},getItemDataCopyById:function(id,_80){if(!id){throw new Error("getItemDataCopyById: Id missing! - debugMsg: "+_80);}if(!this._itemData[id]){throw new Error("getItemDataCopyById: Item with id '"+id+"' doesn't exist!");}return _78.clone(this._itemData[id]);},getItemType:function(id){if(!id){throw new Error("contains: Id missing when calling containsType!");}var _81=this._cache[id];return _81?_81.type:null;},getItemSubType:function(id){if(!id){throw new Error("contains: Id missing when calling containsType!");}var _82=this._cache[id];return _82?_82.subtype:null;},getIds:function(){var ids=[],_83=this._zList,_84=this._cache;for(var i=_83.length;i--;){var id=_83[i].id;if(!_84[id].del){ids.unshift(id);}}return ids;},getIdsByBBox:function(_85,_86){var ids=[],_87=this._zList,_88=this._cache;for(var i=_87.length;i--;){var id=_87[i].id;var _89=_88[id];if(!_89.del&&_89.type!="txtE"){var _8a=_86.getBBox(id);if(_8a&&_85.containsBox(_8a)){ids.unshift(id);}}}return ids;},getIdsByTouchedBBox:function(_8b,_8c){var ids=[],_8d=this._zList,_8e=this._cache;for(var i=_8d.length;i--;){var id=_8d[i].id;var _8f=_8e[id];if(!_8f.del&&_8f.type!="txtE"){var _90=_8c.getBBox(id);if(_90&&_8b.collides(_90)){ids.unshift(id);}}}return ids;},getItemAlignByBBoxAndSearchBox:function(_91,_92,_93){var ret={horizontal:{align:null,diff:10000},vertical:{align:null,diff:10000}};var _94=_91.getCenter();var _95=this._zList,_96=this._cache;for(var i=_95.length;i--;){var id=_95[i].id;if(!_93.isIdSelected(id)){var _97=_96[id];if(!_97.del&&_97.type!="txtE"){var _98=_93.getBBox(id);if(_98&&_92.collides(_98)){var _99=_98.getCenter();if(!ret.horizontal.align||Math.abs(ret.horizontal.diff)>0){var _9a=_98.p1.x-_91.p1.x;var _9b=_99.x-_94.x;var _9c=_98.p2.x-_91.p2.x;if(Math.abs(_9a)<Math.abs(ret.horizontal.diff)){ret.horizontal.align="left";ret.horizontal.diff=_9a;}if(Math.abs(_9b)<Math.abs(ret.horizontal.diff)){ret.horizontal.align="center";ret.horizontal.diff=_9b;}if(Math.abs(_9c)<Math.abs(ret.horizontal.diff)){ret.horizontal.align="right";ret.horizontal.diff=_9c;}}if(!ret.vertical.align||Math.abs(ret.vertical.diff)>0){var _9d=_98.p1.y-_91.p1.y;var _9b=_99.y-_94.y;var _9e=_98.p2.y-_91.p2.y;if(Math.abs(_9d)<Math.abs(ret.vertical.diff)){ret.vertical.align="top";ret.vertical.diff=_9d;}if(Math.abs(_9b)<Math.abs(ret.vertical.diff)){ret.vertical.align="center";ret.vertical.diff=_9b;}if(Math.abs(_9e)<Math.abs(ret.vertical.diff)){ret.vertical.align="bottom";ret.vertical.diff=_9e;}}}}}}return ret;},getIdsAbovePos:function(_9f){var ids=[];var i=_9f;var _a0=this._zList;var _a1=_a0.length;var _a2=this._cache;while(i<_a1){var id=_a0[i].id;if(!_a2[id].del){ids.push(id);}i++;}return ids;},getIdsInZorderWithSuccessor:function(_a3){var _a4=this;var _a5=_79.functional.map(_79.lang.functional.keys(_a3),function(id){var z=_a4._zListIndexOf(id);var _a6=_a4._zListIndexOf(z+1);return {id:id,z:z,nextId:_a6};});_a5.sort(function(a,b){return a.z-b.z;});return _a5;},size:function(){return this._zList.length;},getNextMaxZ:function(){var n=this._zList.length===0?1:(1*this._zList[this._zList.length-1].z+1);return this._isNumber(n)?n:1;},getNextMinZ:function(){var n=this._zList.length===0?-1:(1*this._zList[0].z-1);return this._isNumber(n)?n:-1;},_isNumber:function(n){return (Object.prototype.toString.call(n)=="[object Number]")&&isFinite(n)&&!isNaN(n);},getBBox:function(){return this._bbox;},getGroupId:function(id){var ret=null;for(var _a7 in this._groups){if(this._groups.hasOwnProperty(_a7)){var ids=this._groups[_a7];if(ids){for(var i=ids.length;i--;){if(ids[i]===id){return _a7;}}}}}return null;},getTextEntryIds:function(_a8){var _a9=this._txtEntries[_a8];if(_a9){return _a9.getEntries();}else{return [];}},getInvisibleTextGroupIds:function(){var _aa=_79.lang.functional.keys(this._txtEntries);return _78.filter(_aa,function(_ab){return !this.contains(_ab)||this.getItemById(_ab).del;},this);},_insertToMap:function(id,_ac,_ad){if(!id){throw new Error("_insertToMap: id is null");}if(!_ac){throw new Error("_insertToMap: newItemData is null");}if(this._itemData[id]){var _ae=_78.clone(this._itemData[id]);if(_ae.seq&&_ad&&wp.data.SequenceHelper.isGreaterThan(_ae.seq,_ad)){return false;}}this._itemData[id]=_ac;return true;},_insertToCache:function(id,_af){var _b0=!this._cache[id];this._cache[id]=_af;return _b0;},_insertToZList:function(id,_b1,seq,del){var _b2=this._zList;if(!id){throw new Error("_insertToZList: id is "+id);}if(_b1!==0&&!_b1){throw new Error("_insertToZList: zIndex is "+_b1);}var _b3={id:id,z:1*_b1,seq:(seq?seq:null),del:del};var _b4=this._zListIndexOf(id);if(_b4>-1){var _b5=_b2[_b4];if(_b5.z===_b3.z&&wp.data.SequenceHelper.isEqual(_b5.seq,_b3.seq)&&_b5.del===_b3.del){return;}_b2.splice(_b4,1);this._zListPositions[id]=null;for(var k=_b4;k<_b2.length;k++){var _b6=_b2[k];if(_b6&&_b6.id){this._zListPositions[_b6.id]=k;}}}if(_b3.del){return null;}var _b7=-1;for(var i=_b2.length;i--;){var obj=_b2[i];if(obj.z<_b3.z){_b7=i+1;break;}else{if(obj.z>_b3.z){}else{if(!obj.seq&&_b3.seq){}else{if(obj.seq&&!_b3.seq){_b7=i+1;break;}else{if(wp.data.SequenceHelper.isGreaterThan(obj.seq,_b3.seq)){}else{_b7=i+1;break;}}}}}}if(1*_b7<0){_b2.unshift(_b3);_b7=0;}else{if(1*_b7>=_b2.length){_b2.push(_b3);_b7=_b2.length-1;}else{_b2.splice(_b7,0,_b3);}}for(var k=_b7;k<_b2.length;k++){var _b6=_b2[k];if(_b6&&_b6.id){this._zListPositions[_b6.id]=k;}}return _b7;},_zListIndexOf:function(id){if(!id){return -1;}var ret=this._zListPositions[id];return ret||((ret===0)?0:-1);},_getIdAtZListIndex:function(idx){return this._zList[idx]||null;},_insertToBBox:function(id,_b8){var _b9=_b8.getBBox();if(_b9){var _ba=this._itemBBoxesOrNullForDeletedBoxes[id];if((_ba&&_b9.equals(_ba)&&!_b8.del)||(!_ba&&_b8.del)){return;}if(!this._bbox){if(!_b8.del){this._bbox=_b9.getACopy();}}else{if(!_ba&&!_b8.del){this._bbox.expandByBBox(_b9);}else{this._refreshBBox();}}if(_b8.del){delete this._itemBBoxesOrNullForDeletedBoxes[id];}else{this._itemBBoxesOrNullForDeletedBoxes[id]=_b9.getACopy();}}},_refreshBBox:function(){this._bbox=null;for(var id in this._cache){if(this._cache.hasOwnProperty(id)){var _bb=this._cache[id];if(_bb&&!_bb.del&&_bb.getBBox()){if(!this._bbox){this._bbox=_bb.getBBox().getACopy();}else{this._bbox.expandByBBox(_bb.getBBox());}}}}},_insertToGroups:function(id,_bc){if(_bc.type=="group"){if(_bc.del){delete this._groups[id];}else{var _bd=[],_be,_bf=_bc.ids;for(var i=_bf.length;i--;){_be=_bf[i];if(_be===id){continue;}_bd.unshift(_bf[i]);}this._groups[id]=_bd;}}},_insertToTxtEntries:function(id,_c0){if(_c0.type!=="txtE"){return;}var _c1=this._txtEntries[_c0.txtGId];if(!_c1){_c1=this._txtEntries[_c0.txtGId]=new wp.TxtEntries(this.txtEntryIdsCompareBound);}_c1.push(_c0.id);},_getOrigDte:function(_c2){if(!_c2){return null;}if(_c2.origDte){var _c3=_78.date.stamp.fromISOString(_c2.origDte);if(_c3){return _c3;}}if(_c2.id){var _c4=this._chronoMap[_c2.id];if(_c4&&_c4.createdAt){return _c4.createdAt;}}return null;},txtEntryIdsCompare:function(_c5,_c6){return this.txtEntriesCompare(this.getItemById(_c5),this.getItemById(_c6));},txtEntryIdsCompareBound:function(){throw "this method has to be replaced in the constructor";},txtEntriesCompare:function(_c7,_c8){return sp.global.simpleComparator(this._getOrigDte(_c7),this._getOrigDte(_c8));}});(function(){_78.provide("wp.TxtEntries");_78.require("dojox.lang.functional");wp.TxtEntries=function(_c9){this.entryIds={};this.sortedIds=[];this.push=function(id){this.entryIds[id]=true;this.sortedIds=null;};this.getEntries=function(){if(!this.sortedIds){this.sortedIds=_79.lang.functional.keys(this.entryIds);this.sortedIds.sort(_c9);}return this.sortedIds;};};})();});},"cb/page/pad/ToolChangedFlashMessage":function(){define(["dojo/_base/declare","dojo/query","dojo/dom-style","dojo/dom","dojo/dom-construct","dojo/dom-class","dojo/_base/fx","dojo/fx","dijit/_Widget","sp/I18n","dojo/i18n!./nls/ToolChangedFlashMessage"],function(_ca,_cb,_cc,dom,_cd,_ce,fx,_cf,_d0,_d1,_d2){var _d3=_ca([_d0],{shortcutId:null,buildRendering:function(){this.domNode=_cd.create("div",{"class":"tool-changed-flash"});var _d4=dom.byId("pad-main");_cd.place(this.domNode,_d4,"first");},showMessage:function(_d5){this.domNode.innerHTML="<div class=\"floater\"></div><div class=\"message\">"+_d1.wrap(_d2)("message_"+_d5)+"</div>";this._makeVisible();},_makeVisible:function(){var _d6=fx.animateProperty({node:this.domNode,duration:200,properties:{opacity:0.8},beforeBegin:function(_d7){_cc.set(_d7,"zIndex","1");_cc.set(_d7,"opacity","0");}});var _d8=fx.animateProperty({node:this.domNode,duration:300,delay:200,properties:{opacity:0},beforeBegin:function(_d9){_cc.set(_d9,"opacity","0.8");},onBegin:dojo.hitch(this,function(){_ce.add(this.domNode,"scale");}),onEnd:function(_da){_cc.set(_da,"zIndex","0");_ce.remove(_da,"scale");}});_cf.chain([_d6,_d8]).play();}});var _db=null;var _dc=function(){if(!_db){_db=new _d3();}return _db;};return {showMessage:function(_dd){_dc().showMessage(_dd);}};});},"cb/board/conference/ConferenceContainer":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/dom-construct","dojo/dom-class","dojo/aspect","dojo/promise/all","dojo/when","dijit/_Widget","cb/widget/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","sp/Tooltip","cb/page/pad/FollowAndPresentationManager","cb/videochat/VideoChatManager","cb/videochat/VideoChatTooltip","cb/Capabilities","cb/util","sp/I18n","dojo/text!./ConferenceContainer.html","dojo/i18n!../nls/Messages"],function(_de,_df,_e0,_e1,_e2,_e3,_e4,_e5,_e6,_e7,_e8,_e9,_ea,_eb,_ec,_ed,_ee,_ef,_f0,_f1){var _f2=_ef.wrap(_f1);return _de([_e6,_e7,_e8],{templateString:_f0,i18n:_f1,postMixInProperties:function(){this.inherited("postMixInProperties",arguments);this.videoCheckedAttr=_eb.isPublishing()?"checked":"";},buildRendering:function(){this.inherited("buildRendering",arguments);},postCreate:function(){this.inherited("postCreate",arguments);var _f3=this;dojo.connect(_ea,"onAnyModerationStarted",this,"_updateLiveLocationAndModerationButton");dojo.connect(_ea,"onAnyModerationStopped",this,"_updateLiveLocationAndModerationButton");dojo.connect(_ea,"onOwnLiveLocationsTurnedOn",this,"_updateLiveLocationAndModerationButton");dojo.connect(_ea,"onOwnLiveLocationsTurnedOff",this,"_updateLiveLocationAndModerationButton");new _e9({connectId:this._livelocationsSwitch.domNode,position:["above-centered"],label:"<span class=\"tooltip-hint-content\">"+_f2("live_locations_description")+"</span>",showDelay:200});_e4({capability:_ed.checkVideoChat(),available:_eb.isAvailable(),allowed:_e5(_eb.get("additionalusersallowed"))}).then(dojo.hitch(this,function(_f4){var _f5=_f4.capability;var _f6=_f4.available;var _f7=_f4.allowed;var _f8;if(_f5==="premium"){_f8=(sp.info.document.document.ownerId&&sp.info.document.document.ownerId==sp.info.user.info.id)?_f2("disallow_premium_owner"):_f2("disallow_premium_participant");}else{if(_f5==="disabled"){_f8=null;}else{if(!_f6){_f8=_f2("unavailable_flash");}else{if(!_f7){_f8=null;}else{_f8=_f2("video_description");}}}}if(_f8){new _e9({connectId:this._videoSwitch.domNode,position:["above-centered"],label:"<span class=\"tooltip-hint-content\">"+_f8+"</span>",showDelay:200});}this._updateVideoSwitchState();}));_ed.checkModerator().then(dojo.hitch(this,function(_f9){var _fa;if(_f9=="enabled"){this._moderatorSwitch.set("disabled",false);_fa=_f2("moderator_description");}else{if(_f9=="student"){_fa=_f2("disallow_student");}else{_fa=(sp.info.document.document.ownerId&&sp.info.document.document.ownerId==sp.info.user.info.id)?_f2("disallow_premium_owner"):_f2("disallow_premium_participant");}}new _e9({connectId:this._moderatorSwitch.domNode,position:["above-centered"],label:"<span class=\"tooltip-hint-content\">"+_fa+"</span>",showDelay:200});}));_e3.after(_eb,"onPublisherDestroyed",dojo.hitch(this,function(){this._videoSwitch.set("value",false);this._updateVideoSwitchState();}));_e3.after(_eb,"onPublisherCreated",dojo.hitch(this,function(){this._videoSwitch.set("value",true);this._updateVideoSwitchState();}));_e3.after(_eb,"onStreamCreated",dojo.hitch(this,function(){this._updateVideoSwitchState();}));_e3.after(_eb,"onStreamDestroyed",dojo.hitch(this,function(){this._updateVideoSwitchState();}));_ec.setupTooltip(_eb,[this._videoSwitch.domNode]);},_updateVideoSwitchState:function(){_e4({featureEnabled:_ed.checkFeature("videochat").then(function(_fb){return _fb==="enabled";}),available:_e5(_eb.isAvailable()),allowed:_e5(_eb.get("additionalusersallowed")),publishing:_e5(_eb.isPublishing())}).then(_e0.hitch(this,function(_fc){var _fd=_fc.publishing||(_fc.available&&_fc.allowed);this._videoSwitch.set("disabled",!_fd);this._videoSwitch.set("hidden",!_fc.featureEnabled);})).otherwise(function(e){});},_updateLiveLocationAndModerationButton:function(){var _fe=_ea.isModeratorModeOn();if(this._moderatorSwitch.get("checked")!==_fe){this._moderatorSwitch.set("checked",_fe);}var _ff=_ea.isLiveLocationsOn();if(this._livelocationsSwitch.get("checked")!==_ff){this._livelocationsSwitch.set("checked",_ff);}},_handleChangeLiveLocations:function(v){_ea[(v?"turnLiveLocationsOn":"turnLiveLocationsOff")]();},_handleChangeVideo:function(v){_eb[v?"publish":"unpublish"]();},_handleChangeModerator:function(v){_ea[(v?"turnModerationOn":"turnModerationOff")]();}});});},"cb/board/itemui/_TxtDiv":function(){define(["dojo","dojo/DeferredList","dojo/on","dojo/when","dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/dom-class","dojo/dom-attr","dojox/lang/functional","cb/util","cb/util-mentions","cb/util-hashtags","cb/util-text","cb/api/Api","./TxtDivHelper","./TxtDivTextarea","./TxtDivTextareaWithDropDown","./DropDownSelectHiddenComboBox","./HashtagComboBoxMenu","./HashtagSelectStoreFactory","sp/I18n","dojo/i18n!./nls/itemui"],function(dojo,_100,on,when,lang,_101,_102,_103,_104,_105,_106,_107,_108,_109,_10a,Api,_10b,_10c,_10d,_10e,_10f,_110,_111,i18n){var I18N=_111.wrap(i18n);return _102("cb.board.itemui._TxtDiv",[dijit._Widget,cb.widget._Templated],{templateString:"<div class=\"pWTD cur_move cur_text_move\"><ul dojoAttachPoint=\"entryList\"></ul></div>",widgetsInTemplate:false,controller:null,txtGroupId:null,txtEItems:null,widgetItemType:null,widgetItemSubtype:null,_editable:true,multipleEntriesPossible:true,constructor:function(){this.txtEItems=[];this.txtEItemsPerId={};},_renderEntryContentAsText:function(_112,_113){},_renderEntryContentAsInput:function(_114,_115){},_renderCollapsedStateUi:function(){},startup:function(_116,type,_117){this.inherited("startup",arguments);this.controller=_116;this.widgetItemType=type;this.widgetItemSubtype=_117;this.own(this.controller.status.getAndWatch("editing",dojo.hitch(this,function(attr,old,_118){this._editable=!_118.readonly;dojo.toggleClass(this.domNode,"pWTD-editable",this._editable);})));this.own(dojo.connect(this.domNode,"dblclick",this,function(_119){this._onDblClick();}));if(this.widgetItemSubtype==="note"){dojo.addClass(this.domNode,"pWTD-stickynoteStyle");}},_isEntryEditable:function(_11a){return true;},_onDblClick:function(){if(!this._editable||this.controller.currentTool==="TOOL_ZOOM"||this.controller.currentTextGroupIdInEdit===this.txtGroupId){return;}if(this.txtEItems.length>0&&!this.multipleEntriesPossible){dojo.publish("requests/cb/board/edittextentry",this.txtEItems[0].id);}else{dojo.publish("requests/cb/board/edittextgroup",this.txtGroupId);}},applyId:function(id){if(this.txtGroupId!==id){this.txtGroupId=id;this.domNode.setAttribute("sid",id);this.entryList.setAttribute("sid",id);}},showWidget:function(){dojo.removeClass(this.domNode,"hideBlock");},hideWidget:function(){dojo.addClass(this.domNode,"hideBlock");},markAsSelected:function(){dojo.addClass(this.domNode,"pWTDSelected");},markAsUnselected:function(){dojo.removeClass(this.domNode,"pWTDSelected");},getEntryItem:function(id){return this.txtEItemsPerId[id];},render:function(item,_11b){if(_11b){this.txtEItems=_11b;this.txtEItemsPerId={};_106.forEach(this.txtEItems,function(_11c){this.txtEItemsPerId[_11c.id]=_11c;},this);}this.renderTextEntries();this.rearrange(item);},rearrange:function(item){var x=Math.min(item.a.x,item.b.x)/100;var y=Math.min(item.a.y,item.b.y)/100;var w=Math.abs(item.a.x-item.b.x)/100;var _11d={left:x+"em",top:y+"em",width:w+"em",zIndex:item.z};dojo.style(this.domNode,_11d);},renderTextEntries:function(){var _11e=this.controller.currentTextGroupIdInEdit===this.txtGroupId;var _11f=this.controller.currentTextEntryIdInEdit;var _120=this.controller.currentTextEntryToCreateWithAt;_10b.markAllEntriesForLaterDeletion(this.entryList);var _121=null;var _122=null;if(!_11e&&this.txtEItems.length===0){_122=_121=this._renderEntryAsText();}else{for(var i=0;i<this.txtEItems.length;i++){var _123=this.txtEItems[i];var _124=dojo.query("[eid="+_123.id+"]",this.entryList);var _125=_124.length>0?_124[0]:null;if(_11f===_123.id){_125=this._renderEntryAsInput(_123,_125,_120);}else{_125=this._renderEntryAsText(_123,_125);}_10b.moveEntryNode(this.entryList,_125,_121);_121=_125;if(i===0){_122=_125;}}}if(_11e&&!_11f){var _126=dojo.query("[eid=__UNSAVED]",this.entryList);var _127=this._renderEntryAsInput(null,(_126.length>0?_126[0]:null),_120);_10b.moveEntryNode(this.entryList,_127,_121);}_10b.deleteAllEntriesStillMarked(this.entryList);if(this.txtEItems.length>2){this._renderCollapsedStateUi(_122,this.txtEItems.length-2);}_104.toggle(this.domNode,"comment-collapsible",this.txtEItems.length>2);_104.toggle(this.domNode,"pWTDEdit",_11e);_104.toggle(this.domNode,"pWTDEditWithNewAnswer",_11e&&!_11f);},_renderEntryAsText:function(_128,_129){var tmp=_10b.prepareEntryNode(this.entryList,_129,_128,this.txtGroupId,false);var _12a=tmp.entryNode;if(tmp.contentChanged){if(!_128){_104.add(_12a,"emptyEntry");dojo.create("p",{"sid":this.txtGroupId,"innerHTML":"&nbsp;"},_12a);}else{var _12b=_128.isTextEscaped?_128.text:cb.common.escapeHtml(_128.text);this._renderEntryContentAsText(_12a,_12b,_128);}if(this._isEntryEditable(_128?_128.getFixedAuthorId():undefined)){this._renderEditLink(_12a,_128?_128.id:undefined);}}return _12a;},_renderEntryAsInput:function(_12c,_12d,_12e){var tmp=_10b.prepareEntryNode(this.entryList,_12d,_12c,this.txtGroupId,true);var _12f=tmp.entryNode;if(tmp.contentChanged){this._renderEntryContentAsInput(_12f,_12c,_12e);}return _12f;},getDivHeight:function(){return dojo.coords(this.domNode).h;},_renderEditLink:function(_130,_131){_10b.createActionLink(_130,"comment-edit-link link",I18N("edit_item_link_label"),null,function(){if(_131){dojo.publish("requests/cb/board/edittextentry",_131);}else{dojo.publish("requests/cb/board/edittextgroup",this.txtGroupId);}},this);}});});},"cb/mousetrap":function(){define(["cb/ext/mousetrap"],function(_132){return _132;});},"cb/board/toolbar/SecondaryToolbar":function(){define(["dojo","dojo/_base/declare","dojo/_base/lang","dojo/on","dojo/aspect","dojo/dom-class","dojo/dom-construct","dojo/html","dijit/_Widget","dijit/_Container","dijit/layout/ContentPane","dijit/layout/BorderContainer","cb/util","cb/WheelSupport","./ChooseZoomDialog","./ChooseCreateToolDialog","./AttributeContainer","./ImportContainer","sp/I18n","dojo/i18n!../nls/Messages"],function(dojo,_133,lang,on,_134,_135,_136,_137,_138,_139,_13a,_13b,_13c,_13d,_13e,_13f,_140,_141,_142,i18n){var _143=_142.wrap(i18n);return _133([_138,_139],{controller:null,container:null,_currentLineMenuTool:null,_currentShapeMenuTool:null,_currentTextMenuTool:null,_undoPossible:false,_redoPossible:false,constructor:function(args){dojo.mixin(this,args);},buildRendering:function(){this.inherited(arguments);this._undoButton=this.createIconButton("tool_label_undo","fonticon-undo","basic-tool-toggle disabled",lang.hitch(this,function(e){this.controller.undo();}));this._redoButton=this.createIconButton("tool_label_redo","fonticon-redo","basic-tool-toggle disabled",lang.hitch(this,function(e){this.controller.redo();}));this.createSeparator("basic-tool-toggle");this._zoomButton=this.createIconButton("tool_label_zoom","fonticon-magnifier-plus","basic-tool-toggle",lang.hitch(this,function(e){dojo.publish("requests/cb/board/currenttoolchange","TOOL_ZOOM");}));this._zoomMenuButton=this.createEmptyButton("basic-tool-toggle zoom-menu",lang.hitch(this,function(e){this._zoomMenuButtonClicked();}));this.createSeparator("basic-tool-toggle");this._handButton=this.createIconButton("tool_label_hand","fonticon-hand","basic-tool-toggle app-button--bigger-icon",lang.hitch(this,function(e){dojo.publish("requests/cb/board/currenttoolchange","TOOL_HAND");}));this._selectButton=this.createIconButton("tool_label_select","fonticon-select","edit-tool-toggle app-button--bigger-icon contracted",lang.hitch(this,function(e){dojo.publish("requests/cb/board/currenttoolchange","TOOL_SELECT");}));this._eraserButton=this.createIconButton("tool_label_eraser","fonticon-eraser","edit-tool-toggle app-button--bigger-icon",lang.hitch(this,function(e){dojo.publish("requests/cb/board/currenttoolchange","TOOL_ERASER");}));this.createSeparator("edit-tool-toggle");this._scribbleButton=this.createLabelButton("tool_label_scribble","fonticon-scribble","discuss-tool-toggle",lang.hitch(this,function(e){dojo.publish("requests/cb/board/currenttoolchange","TOOL_SCRIBBLE");}));this._highlightButton=this.createLabelButton("tool_label_highlight","fonticon-highlighter","discuss-tool-toggle",lang.hitch(this,function(e){dojo.publish("requests/cb/board/currenttoolchange","TOOL_HIGHLIGHT");}));this.createSeparator("discuss-tool-toggle");this._commentButton=this.createLabelButton("tool_label_comment","fonticon-comment","discuss-tool-toggle no-shrink",lang.hitch(this,function(e){dojo.publish("requests/cb/board/currenttoolchange","TOOL_TEXT_COMMENT");}));this.createSeparator("discuss-tool-toggle");this._lineMenuButton=this.createEmptyButton("create-tool-toggle",lang.hitch(this,function(e){this._lineMenuButtonClicked();}));this._shapeMenuButton=this.createEmptyButton("create-tool-toggle",lang.hitch(this,function(e){this._shapeMenuButtonClicked();}));this._textMenuButton=this.createEmptyButton("create-tool-toggle",lang.hitch(this,function(e){this._textMenuButtonClicked();}));this.createSeparator("create-tool-toggle");this._updateLineMenuButton("TOOL_SHAPE_FREELINE","fonticon-freeLine",_143("tool_default_line"));this._updateShapeMenuButton("TOOL_SHAPE_RECTANGLE","fonticon-rectangle",_143("tool_default_shape"));this._updateTextMenuButton("TOOL_TEXT_BLOCK","fonticon-text",_143("tool_default_text"));this._attributeContainer=new _140({controller:this.controller,container:this.container},_136.create("span",{"class":"hideBlock"},this.domNode));this._importContainer=new _141({controller:this.controller,container:this.container},_136.create("span",{"class":"hideBlock"},this.domNode));this._createHeaderToggleButton();this.subscribe("updates/cb/board/currenttool",function(_144){dojo.query(".app-button",this.domNode).removeClass("active");switch(_144){case "TOOL_HAND":dojo.addClass(this._handButton,"active");break;case "TOOL_ZOOM":dojo.addClass(this._zoomButton,"active");break;case "TOOL_SELECT":dojo.addClass(this._selectButton,"active");break;case "TOOL_ERASER":dojo.addClass(this._eraserButton,"active");break;case "TOOL_SCRIBBLE":dojo.addClass(this._scribbleButton,"active");break;case "TOOL_HIGHLIGHT":dojo.addClass(this._highlightButton,"active");break;case "TOOL_TEXT_COMMENT":dojo.addClass(this._commentButton,"active");break;case "TOOL_SHAPE_LINE":dojo.addClass(this._lineMenuButton,"active");this._updateLineMenuButton(_144,"fonticon-line",_143("tool_label_line"));break;case "TOOL_SHAPE_ARROW":dojo.addClass(this._lineMenuButton,"active");this._updateLineMenuButton(_144,"fonticon-arrow",_143("tool_label_arrow"));break;case "TOOL_SHAPE_FREELINE":dojo.addClass(this._lineMenuButton,"active");this._updateLineMenuButton(_144,"fonticon-freeLine",_143("tool_label_freehand"));break;case "TOOL_SHAPE_RECTANGLE":dojo.addClass(this._shapeMenuButton,"active");this._updateShapeMenuButton(_144,"fonticon-rectangle",_143("tool_label_rectangle"));break;case "TOOL_SHAPE_ELLIPSE":dojo.addClass(this._shapeMenuButton,"active");this._updateShapeMenuButton(_144,"fonticon-ellipse",_143("tool_label_ellipse"));break;case "TOOL_TEXT_NOTE":dojo.addClass(this._textMenuButton,"active");this._updateTextMenuButton(_144,"fonticon-postit",_143("tool_label_postit"));break;case "TOOL_TEXT_BLOCK":dojo.addClass(this._textMenuButton,"active");this._updateTextMenuButton(_144,"fonticon-text",_143("tool_label_textbox"));break;case "TOOL_TEXT_HEADLINE":dojo.addClass(this._textMenuButton,"active");this._updateTextMenuButton(_144,"fonticon-headline",_143("tool_label_headline"));break;default:undefined;}});this.subscribe("updates/cb/board/currentmode",function(_145){this._importContainer.removeImportModeUI();dojo.addClass(this.domNode,"hideBlock");dojo.query(".edit-tool-toggle",this.domNode).toggleClass("hideBlock",true);dojo.query(".discuss-tool-toggle",this.domNode).toggleClass("hideBlock",true);dojo.query(".create-tool-toggle",this.domNode).toggleClass("hideBlock",true);dojo.query(".attribute-container",this.domNode).toggleClass("hideBlock",true);dojo.query(".import-container",this.domNode).toggleClass("hideBlock",true);switch(_145){case "BROWSE":dojo.removeClass(this.domNode,"hideBlock");dojo.query(".basic-tool-toggle",this.domNode).toggleClass("hideBlock",false);break;case "DISCUSS":dojo.removeClass(this.domNode,"hideBlock");dojo.query(".basic-tool-toggle",this.domNode).toggleClass("hideBlock",false);dojo.query(".edit-tool-toggle",this.domNode).toggleClass("hideBlock",false);dojo.query(".discuss-tool-toggle",this.domNode).toggleClass("hideBlock",false);dojo.query(".attribute-container",this.domNode).toggleClass("hideBlock",false);break;case "CREATE":dojo.removeClass(this.domNode,"hideBlock");dojo.query(".basic-tool-toggle",this.domNode).toggleClass("hideBlock",false);dojo.query(".edit-tool-toggle",this.domNode).toggleClass("hideBlock",false);dojo.query(".create-tool-toggle",this.domNode).toggleClass("hideBlock",false);dojo.query(".attribute-container",this.domNode).toggleClass("hideBlock",false);break;case "IMPORT":dojo.removeClass(this.domNode,"hideBlock");dojo.query(".basic-tool-toggle",this.domNode).toggleClass("hideBlock",true);dojo.query(".import-container",this.domNode).toggleClass("hideBlock",false);break;default:undefined;}this._publishResize();});this._updateZoomMenuButtonText(1);this._zoomMenuButton.title=_143("tool_label_zoom_menu");dojo.subscribe("/surface/update/zoom",lang.hitch(this,function(_146){this._updateZoomMenuButtonText(_146);}));_13d.connectWidget(this,this._zoomMenuButton,lang.hitch(this.controller,"simpleMouseWheelZoom"));dojo.subscribe("/container/history/undo",lang.hitch(this,function(_147){if(this._undoPossible!=_147){this._undoPossible=_147;dojo.toggleClass(this._undoButton,"disabled",!this._undoPossible);}}));dojo.subscribe("/container/history/redo",lang.hitch(this,function(_148){if(this._redoPossible!=_148){this._redoPossible=_148;dojo.toggleClass(this._redoButton,"disabled",!this._redoPossible);}}));},postCreate:function(){this.inherited(arguments);this.connect(this.domNode,"onmousedown",function(e){dojo.publish("/sp/pad/propbar/mousedown",[e]);});},_publishResize:function(){this.getParent().resize();this.getParent().getParent().resize();window.setTimeout(function(){dojo.publish("/window/resize");},0);},_zoomMenuButtonClicked:function(){(new _13e()).show(this._zoomMenuButton);},_updateZoomMenuButtonText:function(_149){var _14a=Math.round(_149*100)+"%";this._zoomMenuButton.innerHTML=this._createDropDownButtonLabelMarkup(null,_14a);},_lineMenuButtonClicked:function(){dojo.publish("requests/cb/board/currenttoolchange",this._currentLineMenuTool);(new _13f({"mode":"LINE"})).show(this._lineMenuButton);},_updateLineMenuButton:function(tool,_14b,_14c){this._currentLineMenuTool=tool;this._lineMenuButton.title=_14c;this._lineMenuButton.innerHTML=this._createDropDownButtonLabelMarkup(_14b,_14c);},_shapeMenuButtonClicked:function(){dojo.publish("requests/cb/board/currenttoolchange",this._currentShapeMenuTool);(new _13f({"mode":"SHAPE"})).show(this._shapeMenuButton);},_updateShapeMenuButton:function(tool,_14d,_14e){this._currentShapeMenuTool=tool;this._shapeMenuButton.title=_14e;this._shapeMenuButton.innerHTML=this._createDropDownButtonLabelMarkup(_14d,_14e);},_textMenuButtonClicked:function(){dojo.publish("requests/cb/board/currenttoolchange",this._currentTextMenuTool);(new _13f({"mode":"TEXT"})).show(this._textMenuButton);},_updateTextMenuButton:function(tool,_14f,_150){this._currentTextMenuTool=tool;this._textMenuButton.title=_150;this._textMenuButton.innerHTML=this._createDropDownButtonLabelMarkup(_14f,_150);},createSeparator:function(_151){return _136.create("span",{"class":"hideBlock app-button-separator "+(_151?_151:"")},this.domNode);},createEmptyButton:function(_152,_153){var _154=this._createAppButton(null,null,_152);this.own(on(_154,"click",_153));return _154;},createIconButton:function(_155,_156,_157,_158){var _159=_143(_155);var _15a="<i class=\""+_156+"\"></i>";var _15b="icon-only "+(_157?_157:"");var _15c=this._createAppButton(_159,_15a,_15b);this.own(on(_15c,"click",_158));return _15c;},createLabelButton:function(_15d,_15e,_15f,_160){var _161=_143(_15d);var _162=this._createAppButtonLabelMarkup(_15e,_161);var _163=(_15f?_15f:"");var _164=this._createAppButton(_161,_162,_163);this.own(on(_164,"click",_160));return _164;},_createAppButtonLabelMarkup:function(_165,_166){return "<i class=\""+_165+"\"></i> <span class=\"tool-label\">"+_166+"</span>";},_createDropDownButtonLabelMarkup:function(_167,_168){return (_167?"<i class=\""+_167+"\"></i> ":"")+"<span class=\"tool-label\">"+_168+"</span><span class=\"triangle\">&#9660</span>";},_createAppButton:function(_169,_16a,_16b){return _136.create("span",{"title":(_169?_169:""),"innerHTML":(_16a?_16a:""),"class":"hideBlock app-button "+(_16b?_16b:"")},this.domNode);},_createHeaderToggleButton:function(){var _16c=_136.create("span",{"innerHTML":"<i class=\"fonticon-doublearrow-up\"></i><i class=\"fonticon-doublearrow-down\"></i>","class":"app-button icon-only header-toggle header-toggle-open"},this.domNode);this.own(on(_16c,"click",function(){var _16d=dojo.hasClass(_16c,"header-toggle-open");var _16e=dojo.byId("boardHeader");var _16f=dijit.byId("borderContainer");var _170=_16d?"0":"58";dojo.animateProperty({node:_16e,properties:{height:_170},duration:150,rate:30,onAnimate:function(){_16f.resize();},onEnd:function(){dojo.toggleClass(_16c,"header-toggle-open",!_16d);dojo.toggleClass(_16c,"header-toggle-closed",_16d);_16f.resize();dojo.publish("/window/resize");}}).play();}));}});});},"wp/handler/ControllerConfigAddOn":function(){define("wp/handler/ControllerConfigAddOn",["dijit","dojo","dojox"],function(_171,dojo,_172){dojo.provide("wp.handler.ControllerConfigAddOn");dojo.declare("wp.handler.ControllerConfigAddOn",null,{toolCursorModes:{"TOOL_NONE":"cur_select","TOOL_HAND":"cur_hand","TOOL_ZOOM":"cur_zoom_in","TOOL_SELECT":"cur_select show_text_edit_ui","TOOL_ERASER":"cur_erase","TOOL_SCRIBBLE":"cur_draw","TOOL_HIGHLIGHT":"cur_draw","TOOL_TEXT_COMMENT":"cur_draw show_text_edit_ui","TOOL_TEXT_NOTE":"cur_draw show_text_edit_ui","TOOL_TEXT_BLOCK":"cur_draw show_text_edit_ui","TOOL_TEXT_HEADLINE":"cur_draw show_text_edit_ui","TOOL_SHAPE_RECTANGLE":"cur_draw","TOOL_SHAPE_ELLIPSE":"cur_draw","TOOL_SHAPE_LINE":"cur_draw","TOOL_SHAPE_ARROW":"cur_draw","TOOL_SHAPE_FREELINE":"cur_draw"},toolConfigBuffer:{"TOOL_SCRIBBLE":{"UI_LINE_COLOR":"#de1221","UI_LINE_WIDTH":"w3","UI_LINE_STYLE":"solid","onClickNOP":false,"onDrawEndDoSelect":false,"singleMode":"DISCUSS","_getPreviewProps":function(){var _173={};_173.type="freeLine";_173.lc=this["UI_LINE_COLOR"];_173.ls=this["UI_LINE_STYLE"];_173.la="none";_173.lw=this["UI_LINE_WIDTH"].substring(1,3);_173.fixAlignment=false;return _173;},"_getFinalPropsArray":function(){return [this._getPreviewProps()];}},"TOOL_HIGHLIGHT":{"UI_LINE_COLOR":"#f5ff1a","onClickNOP":true,"onDrawEndDoSelect":false,"singleMode":"DISCUSS","_getPreviewProps":function(){var _174={};_174.type="line";_174.lc=this["UI_LINE_COLOR"];_174.ls="solid";_174.la="none";_174.lw="21";_174.lo="50";_174.lj="miter";_174.fixAlignment=true;return _174;},"_getFinalPropsArray":function(){return [this._getPreviewProps()];}},"TOOL_TEXT_COMMENT":{"UI_LINE_COLOR":"#de1221","onClickNOP":false,"onDrawEndDoSelect":true,"singleMode":"DISCUSS","_getPreviewProps":function(){var _175={};_175.type="line";_175.lc=this["UI_LINE_COLOR"];_175.lw="3";_175.ls="dash";_175.la="source";_175.fixAlignment=false;return _175;},"_getFinalPropsArray":function(){var _176={};_176.type="txtG";_176.subtype="comment";_176.lc=this["UI_LINE_COLOR"];_176.fc=this["UI_LINE_COLOR"];_176.defaultWidth="260";return [this._getPreviewProps(),_176];}},"TOOL_TEXT_NOTE":{"UI_FILL_COLOR":"#f5ff1a","UI_TEXT_COLOR":"#333333","UI_FONT_TYPE":"OpenSans","UI_FONT_SIZE":"m","UI_TEXT_ALIGN":"left","onClickNOP":false,"onDrawEndDoSelect":true,"singleMode":"CREATE","_getPreviewProps":function(){var _177={};_177.type="rectangle";_177.lc=this["UI_FILL_COLOR"]=="#ffffff"?"#eeeeee":this["UI_FILL_COLOR"];_177.fo="100";_177.lo="0";_177.fixedHeight="166";_177.minWidth="150";return _177;},"_getFinalPropsArray":function(){var _178={};_178.type="txtG";_178.subtype="note";_178.fc=this["UI_FILL_COLOR"];_178.tc=this["UI_TEXT_COLOR"];_178.tf=this["UI_FONT_TYPE"];_178.ts=this["UI_FONT_SIZE"];_178.ta=this["UI_TEXT_ALIGN"];_178.fixedHeight="166";_178.minWidth="150";return [_178];}},"TOOL_TEXT_BLOCK":{"UI_FILL_COLOR_WT":"#dddddd","UI_TEXT_COLOR":"#333333","UI_FONT_TYPE":"OpenSans","UI_FONT_SIZE":"m","UI_TEXT_ALIGN":"center","onClickNOP":false,"onDrawEndDoSelect":true,"singleMode":"CREATE","_getPreviewProps":function(){var _179={};_179.type="rectangle";_179.lc=this["UI_FILL_COLOR_WT"]=="#ffffff"||this["UI_FILL_COLOR_WT"]=="transparent"?"#eeeeee":this["UI_FILL_COLOR_WT"];_179.fo="100";_179.lo="0";_179.fixedHeight="33";_179.minWidth="75 ";return _179;},"_getFinalPropsArray":function(){var _17a={};_17a.type="txtG";_17a.subtype="textbox";_17a.fc=this["UI_FILL_COLOR_WT"];_17a.tc=this["UI_TEXT_COLOR"];_17a.tf=this["UI_FONT_TYPE"];_17a.ts=this["UI_FONT_SIZE"];_17a.ta=this["UI_TEXT_ALIGN"];_17a.fixedHeight="33";_17a.minWidth="75";return [_17a];}},"TOOL_TEXT_HEADLINE":{"UI_FILL_COLOR_WT":"transparent","UI_TEXT_COLOR":"#333333","UI_FONT_TYPE":"OpenSansBold","UI_FONT_SIZE":"xl","UI_TEXT_ALIGN":"left","onClickNOP":false,"onDrawEndDoSelect":true,"singleMode":"CREATE","_getPreviewProps":function(){var _17b={};_17b.type="rectangle";_17b.lc=this["UI_FILL_COLOR_WT"]=="#ffffff"||this["UI_FILL_COLOR_WT"]=="transparent"?"#eeeeee":this["UI_FILL_COLOR_WT"];_17b.fo="100";_17b.lo="0";_17b.fixedHeight="66";_17b.minWidth="300";return _17b;},"_getFinalPropsArray":function(){var _17c={};_17c.type="txtG";_17c.subtype="headline";_17c.outline=true;_17c.fc=this["UI_FILL_COLOR_WT"];_17c.tc=this["UI_TEXT_COLOR"];_17c.tf=this["UI_FONT_TYPE"];_17c.ts=this["UI_FONT_SIZE"];_17c.ta=this["UI_TEXT_ALIGN"];_17c.fixedHeight="66";_17c.minWidth="300";return [_17c];}},"TOOL_SHAPE_RECTANGLE":{"UI_SHAPE_COLOR":"#8bc9ea","UI_LINE_WIDTH":"w3","UI_FILL_STYLE":"medium","onClickNOP":true,"onDrawEndDoSelect":true,"singleMode":"CREATE","_getPreviewProps":function(){var _17d={};_17d.type="rectangle";_17d.lc=this["UI_SHAPE_COLOR"];_17d.fo=this["UI_FILL_STYLE"]=="full"?"100":(this["UI_FILL_STYLE"]=="none"?"0":"50");_17d.lw=this["UI_LINE_WIDTH"].substring(1,3);_17d.lo=this["UI_FILL_STYLE"]=="none"?"100":"0";return _17d;},"_getFinalPropsArray":function(){return [this._getPreviewProps()];}},"TOOL_SHAPE_ELLIPSE":{"UI_SHAPE_COLOR":"#8bc9ea","UI_LINE_WIDTH":"w3","UI_FILL_STYLE":"medium","onClickNOP":true,"onDrawEndDoSelect":true,"singleMode":"CREATE","_getPreviewProps":function(){var _17e={};_17e.type="ellipse";_17e.lc=this["UI_SHAPE_COLOR"];_17e.fo=this["UI_FILL_STYLE"]=="full"?"100":(this["UI_FILL_STYLE"]=="none"?"0":"50");_17e.lw=this["UI_LINE_WIDTH"].substring(1,3);_17e.lo=this["UI_FILL_STYLE"]=="none"?"100":"0";return _17e;},"_getFinalPropsArray":function(){return [this._getPreviewProps()];}},"TOOL_SHAPE_LINE":{"UI_LINE_COLOR":"#000000","UI_LINE_WIDTH":"w3","UI_LINE_STYLE":"solid","onClickNOP":true,"onDrawEndDoSelect":true,"singleMode":"CREATE","_getPreviewProps":function(){var _17f={};_17f.type="line";_17f.lc=this["UI_LINE_COLOR"];_17f.ls=this["UI_LINE_STYLE"];_17f.la="none";_17f.lw=this["UI_LINE_WIDTH"].substring(1,3);_17f.fixAlignment=true;return _17f;},"_getFinalPropsArray":function(){return [this._getPreviewProps()];}},"TOOL_SHAPE_ARROW":{"UI_LINE_COLOR":"#000000","UI_LINE_WIDTH":"w3","UI_LINE_STYLE":"solid","onClickNOP":true,"onDrawEndDoSelect":true,"singleMode":"CREATE","_getPreviewProps":function(){var _180={};_180.type="line";_180.lc=this["UI_LINE_COLOR"];_180.ls=this["UI_LINE_STYLE"];_180.la="target";_180.lw=this["UI_LINE_WIDTH"].substring(1,3);_180.fixAlignment=true;return _180;},"_getFinalPropsArray":function(){return [this._getPreviewProps()];}},"TOOL_SHAPE_FREELINE":{"UI_LINE_COLOR":"#000000","UI_LINE_WIDTH":"w3","UI_LINE_STYLE":"solid","onClickNOP":false,"onDrawEndDoSelect":false,"singleMode":"CREATE","_getPreviewProps":function(){var _181={};_181.type="freeLine";_181.lc=this["UI_LINE_COLOR"];_181.ls=this["UI_LINE_STYLE"];_181.la="none";_181.lw=this["UI_LINE_WIDTH"].substring(1,3);_181.fixAlignment=false;return _181;},"_getFinalPropsArray":function(){return [this._getPreviewProps()];}}},getCorrectEditToolForSubType:function(_182){switch(_182){case "comment":return "TOOL_TEXT_COMMENT";case "note":return "TOOL_TEXT_NOTE";case "headline":return "TOOL_TEXT_HEADLINE";case "textbox":return "TOOL_TEXT_BLOCK";default:return;}},isModeAllowedForTool:function(mode,tool){if(this.toolConfigBuffer[tool]&&this.toolConfigBuffer[tool].singleMode){return mode===this.toolConfigBuffer[tool].singleMode;}else{if(mode==="IMPORT"&&tool!=="TOOL_HAND"){return false;}else{if(mode==="BROWSE"&&tool!=="TOOL_HAND"&&tool!=="TOOL_ZOOM"){return false;}else{return true;}}}},getRecommendedModeForTool:function(tool){if(this.toolConfigBuffer[tool]&&this.toolConfigBuffer[tool].singleMode){return this.toolConfigBuffer[tool].singleMode;}else{if(tool==="TOOL_SELECT"||tool==="TOOL_ERASER"){return "DISCUSS";}else{return "BROWSE";}}},uiAttributeKeys:["UI_FILL_COLOR","UI_FILL_COLOR_WT","UI_LINE_COLOR","UI_SHAPE_COLOR","UI_TEXT_COLOR","UI_FILL_STYLE","UI_LINE_WIDTH","UI_LINE_STYLE","UI_LINE_ARROW","UI_FONT_TYPE","UI_FONT_SIZE","UI_TEXT_ALIGN"],attributeValueConfig:{"UI_FILL_COLOR":{"uiMode":"COLOR-SELECTOR"},"UI_FILL_COLOR_WT":{"uiMode":"COLOR-SELECTOR-WITH-TRANSPARENCY"},"UI_LINE_COLOR":{"uiMode":"COLOR-SELECTOR"},"UI_SHAPE_COLOR":{"uiMode":"COLOR-SELECTOR"},"UI_TEXT_COLOR":{"uiMode":"COLOR-SELECTOR-WITH-TEXT-COLORS"},"UI_FILL_STYLE":{"uiMode":"ICON-ONLY","allValues":["full","medium","none"]},"UI_LINE_WIDTH":{"uiMode":"SELECTED-LABEL-AS-BORDER","allValues":["w1","w2","w3","w5","w9","w13","w21"]},"UI_LINE_STYLE":{"uiMode":"SELECTED-LABEL-AS-BORDER","allValues":["solid","dash","dot"]},"UI_LINE_ARROW":{"uiMode":"ICON-ONLY","allValues":["none","source","target","both"]},"UI_FONT_TYPE":{"uiMode":"SELECTED-LABEL","allValues":["normal","Chewy","awesome","handwrite","Lobster","OpenSans","OpenSansBold","OpenSansCondensed","PTMono","Ultra"]},"UI_FONT_SIZE":{"uiMode":"SELECTED-LABEL","allValues":["xs","s","m","l","xl","xxl","xxxl"]},"UI_TEXT_ALIGN":{"uiMode":"ICON-ONLY","allValues":["left","center","right"]}},_updateSelectedItemProps:function(_183,_184){var _185=[];if(_183==="UI_LINE_COLOR"&&(_184[0]==="#")){_185.push({key:"lc",value:_184});}if(_183==="UI_FILL_COLOR"&&(_184[0]==="#")){_185.push({key:"fc",value:_184});}if(_183==="UI_SHAPE_COLOR"&&(_184[0]==="#")){_185.push({key:"lc",value:_184});}if(_183==="UI_FILL_COLOR_WT"&&(_184[0]==="#"||_184==="transparent")){_185.push({key:"fc",value:_184});}if(_183==="UI_TEXT_COLOR"&&(_184[0]==="#")){_185.push({key:"tc",value:_184});}if(_183==="UI_LINE_WIDTH"&&this.isValidUiValueForKey("UI_LINE_WIDTH",_184)){_185.push({key:"lw",value:(_184.substring?_184.substring(1,3):"3")});}if(_183==="UI_LINE_STYLE"&&this.isValidUiValueForKey("UI_LINE_STYLE",_184)){_185.push({key:"ls",value:_184});}if(_183==="UI_FILL_STYLE"&&this.isValidUiValueForKey("UI_FILL_STYLE",_184)){_185.push({key:"fo",value:(_184=="full"?"100":(_184=="none"?"0":"50"))});_185.push({key:"lo",value:(_184=="full"?"100":(_184=="none"?"100":"0"))});}if(_183==="UI_LINE_ARROW"&&this.isValidUiValueForKey("UI_LINE_ARROW",_184)){_185.push({key:"la",value:_184});}if(_183==="UI_FONT_TYPE"&&this.isValidUiValueForKey("UI_FONT_TYPE",_184)){_185.push({key:"tf",value:_184});}if(_183==="UI_FONT_SIZE"&&this.isValidUiValueForKey("UI_FONT_SIZE",_184)){_185.push({key:"ts",value:_184});}if(_183==="UI_TEXT_ALIGN"&&this.isValidUiValueForKey("UI_TEXT_ALIGN",_184)){_185.push({key:"ta",value:_184});}if(_185.length>0){this.batchChangeProperties(_185);}},getSelectionConfig:function(){var _186={};if(this._pad.container.isSthSelected()){var _187=this._pad.container.getCommonProperty({"txtG":"subtype"});if(_187==="note"||_187==="textbox"||_187==="headline"){var _188=this._pad.container.getCommonProperty({"txtG":"tf"});if(_188){_186["UI_FONT_TYPE"]=_188;}var _189=this._pad.container.getCommonProperty({"txtG":"ts"});if(_189){_186["UI_FONT_SIZE"]=_189;}var _18a=this._pad.container.getCommonProperty({"txtG":"ta"});if(_18a){_186["UI_TEXT_ALIGN"]=_18a;}var _18b=this._pad.container.getCommonProperty({"txtG":"tc"});if(_18b){_186["UI_TEXT_COLOR"]=_18b;}if(_187=="textbox"||_187=="headline"){var _18c=this._pad.container.getCommonProperty({"txtG":"fc"});if(_18c){_186["UI_FILL_COLOR_WT"]=_18c;}}else{if(_187=="note"){var _18d=this._pad.container.getCommonProperty({"txtG":"fc"});if(_18d){_186["UI_FILL_COLOR"]=_18d;}}}}else{var _18e=this._pad.container.getCommonProperty({"txtG":"lc","line":"lc","freeLine":"lc"});if(_18e){_186["UI_LINE_COLOR"]=_18e;}var _18f=this._pad.container.getCommonProperty({"rectangle":"lc","ellipse":"lc"});if(_18f){_186["UI_SHAPE_COLOR"]=_18f;}}var _190=this._pad.container.getCommonProperty({"line":"lw","freeLine":"lw","ellipse":"lw","rectangle":"lw"});if(_190){var _191="w"+_190;if(this.isValidUiValueForKey("UI_LINE_WIDTH",_191)){_186["UI_LINE_WIDTH"]=_191;}}var _192=this._pad.container.getCommonProperty({"line":"ls","freeLine":"ls"});if(_192){if(this._pad.container.getCommonProperty({"line":"lo","freeLine":"lo"})==="100"){_186["UI_LINE_STYLE"]=_192;}}var _193=this._pad.container.getCommonProperty({"ellipse":"fo","rectangle":"fo"});if(_193){_186["UI_FILL_STYLE"]=_193=="100"?"full":(_193=="0"?"none":"medium");}var _194=this._pad.container.getCommonProperty({"line":"la"});if(_194){if(this._pad.container.getCommonProperty({"line":"lo"})==="100"){_186["UI_LINE_ARROW"]=_194;}}}return _186;},baseColorsBlackWhite:["#000000","#555555","#999999","#bbbbbb","#cccccc","#dddddd","#eeeeee","#ffffff"],baseColorsBlackWhiteForText:["#000000","#333333","#555555","#777777","#999999","#bbbbbb","#dddddd","#ffffff"],baseColors:["#de1221","#ff872a","#f5ff1a","#00ca1d","#8bc9ea","#107fc9","#8810dd","#ff00ff"],baseColorsUltraLight:["#f7c3c7","#ffe1c9","#fdffc5","#bff2c7","#e2f1fa","#c3dff1","#e1c3f7","#ffbfff"],baseColorsLight:["#ea6b75","#ffb47a","#f9ff70","#60de72","#b7ddf2","#6aafdd","#b56aea","#ff60ff"],baseColorsDark:["#8a0b15","#9f541a","#999f10","#007e12","#577d92","#0a4f7d","#550a8a","#9f009f"],getOrderedUiAttributeKeys:function(){return this.uiAttributeKeys;},getAttributeUiMode:function(_195){if(!this.attributeValueConfig[_195]){console.warn("No attribute UI mode found for key:",_195);return;}return this.attributeValueConfig[_195].uiMode;},getAllAttributeValues:function(_196){if(!this.attributeValueConfig[_196]){console.warn("No attribute values found for key:",_196);return;}return this.attributeValueConfig[_196].allValues;},isValidUiValueForKey:function(_197,_198){return dojo.indexOf(this.getAllAttributeValues(_197),_198)>-1;},getAllBaseColors:function(){return this.baseColors;},getAllBWColors:function(){return this.baseColorsBlackWhite;},getAllBWColorsForText:function(){return this.baseColorsBlackWhiteForText;},toolDefaultProperties:{"fc":"#ffffff","fo":"100","lc":"#000000","lo":"100","lw":"4","ls":"solid","la":"none","lj":"round","tc":"#333333","ts":"s","ta":"left","tf":"normal"},getToolCursorMode:function(tool){if(!tool){tool=this.currentTool;}return this.toolCursorModes[tool];},_updateToolConfig:function(tool,key,_199,_19a){if(this.toolConfigBuffer[tool]&&this.toolConfigBuffer[tool][key]){this.toolConfigBuffer[tool][key]=_199;}else{console.warn("No tool '"+tool+"' found with key '"+key+"', setting value '"+_199+"' failed.");}if(!_19a){this._mergeSharedToolConfigs(tool,key,_199);}},_mergeSharedToolConfigs:function(tool,key,_19b){if(key==="UI_SHAPE_COLOR"||key==="UI_LINE_WIDTH"||key==="UI_FILL_STYLE"){if(tool==="TOOL_SHAPE_RECTANGLE"){this._updateToolConfig("TOOL_SHAPE_ELLIPSE",key,_19b,true);}if(tool==="TOOL_SHAPE_ELLIPSE"){this._updateToolConfig("TOOL_SHAPE_RECTANGLE",key,_19b,true);}}if(key==="UI_LINE_COLOR"||key==="UI_LINE_WIDTH"||key==="UI_LINE_STYLE"){if(tool==="TOOL_SHAPE_FREELINE"){this._updateToolConfig("TOOL_SHAPE_LINE",key,_19b,true);this._updateToolConfig("TOOL_SHAPE_ARROW",key,_19b,true);}if(tool==="TOOL_SHAPE_LINE"){this._updateToolConfig("TOOL_SHAPE_ARROW",key,_19b,true);this._updateToolConfig("TOOL_SHAPE_FREELINE",key,_19b,true);}if(tool==="TOOL_SHAPE_ARROW"){this._updateToolConfig("TOOL_SHAPE_FREELINE",key,_19b,true);this._updateToolConfig("TOOL_SHAPE_LINE",key,_19b,true);}}},getPreviewPropsByTool:function(tool){if(this.toolConfigBuffer[tool]){var _19c=this.toolConfigBuffer[tool]._getPreviewProps();var prop=this.getDefaultProperties();for(var key in _19c){if(_19c.hasOwnProperty(key)){prop[key]=_19c[key];}}return prop;}else{console.warn("No tool '"+tool+"' found, getting item properties failed.");}},getFinalPropArrayByTool:function(tool){if(this.toolConfigBuffer[tool]){var _19d=this.toolConfigBuffer[tool]._getFinalPropsArray();var arr=[];for(var i=0;i<_19d.length;i++){var _19e=_19d[i];var prop=this.getDefaultProperties();for(var key in _19e){if(_19e.hasOwnProperty(key)){prop[key]=_19e[key];}}arr.push(prop);}return arr;}else{console.warn("No tool '"+tool+"' found, getting item properties failed.");}},getDefaultProperties:function(tool){var _19f={};for(var key in this.toolDefaultProperties){if(this.toolDefaultProperties.hasOwnProperty(key)){_19f[key]=this.toolDefaultProperties[key];}}return _19f;},getDefaultProperty:function(key){if(this.toolDefaultProperties[key]){return this.toolDefaultProperties[key];}},autoFormRecOn:false});});},"cb/board/toolbar/ChooseCreateToolDialog":function(){define(["dojo","dojo/_base/declare","dojo/_base/lang","dojo/on","dojo/aspect","dojo/dom-class","dojo/dom-construct","dojo/html","dojo/keys","sp/dialog/TooltipDialog","sp/dialog/DialogContent","sp/I18n","dojo/i18n!../nls/Messages"],function(dojo,_1a0,lang,on,_1a1,_1a2,_1a3,_1a4,keys,_1a5,_1a6,_1a7,i18n){var _1a8=_1a7.wrap(i18n);return dojo.declare([_1a5],{complexOrient:{"BL":"TL"},integratedDesign:true,integratedDesignOffset:11,closeSubscriptions:null,mode:"LINE",postCreate:function(){this.inherited(arguments);this.content=new _1a6({i18n:i18n,templateString:"<div class=\"dialog-content\"><ul class=\"simple-app-menu tool-app-menu\" dojoAttachPoint=\"_menuNode\"></ul><div>",dialog:this,buildRendering:function(){this.inherited("buildRendering",arguments);if(this.dialog.mode=="TEXT"){this._textBlockButton=_1a3.create("li",{"innerHTML":"<i class=\"fonticon-text\"></i> "+_1a8("tool_label_textbox")},this._menuNode);this._noteButton=_1a3.create("li",{"innerHTML":"<i class=\"fonticon-postit\"></i> "+_1a8("tool_label_postit")},this._menuNode);this._textHeadlineButton=_1a3.create("li",{"innerHTML":"<i class=\"fonticon-headline\"></i> "+_1a8("tool_label_headline")},this._menuNode);this.own(on(this._textBlockButton,"click",function(e){dojo.publish("requests/cb/board/currenttoolchange","TOOL_TEXT_BLOCK");}));this.own(on(this._noteButton,"click",function(e){dojo.publish("requests/cb/board/currenttoolchange","TOOL_TEXT_NOTE");}));this.own(on(this._textHeadlineButton,"click",function(e){dojo.publish("requests/cb/board/currenttoolchange","TOOL_TEXT_HEADLINE");}));}else{if(this.dialog.mode=="SHAPE"){this._rectangleButton=_1a3.create("li",{"innerHTML":"<i class=\"fonticon-rectangle\"></i> "+_1a8("tool_label_rectangle")},this._menuNode);this._ellipseButton=_1a3.create("li",{"innerHTML":"<i class=\"fonticon-ellipse\"></i> "+_1a8("tool_label_ellipse")},this._menuNode);this.own(on(this._rectangleButton,"click",function(e){dojo.publish("requests/cb/board/currenttoolchange","TOOL_SHAPE_RECTANGLE");}));this.own(on(this._ellipseButton,"click",function(e){dojo.publish("requests/cb/board/currenttoolchange","TOOL_SHAPE_ELLIPSE");}));}else{this._lineButton=_1a3.create("li",{"innerHTML":"<i class=\"fonticon-line\"></i> "+_1a8("tool_label_line")},this._menuNode);this._arrowButton=_1a3.create("li",{"innerHTML":"<i class=\"fonticon-arrow\"></i> "+_1a8("tool_label_arrow")},this._menuNode);this._freeLineButton=_1a3.create("li",{"innerHTML":"<i class=\"fonticon-freeLine\"></i> "+_1a8("tool_label_freehand")},this._menuNode);this.own(on(this._lineButton,"click",function(e){dojo.publish("requests/cb/board/currenttoolchange","TOOL_SHAPE_LINE");}));this.own(on(this._arrowButton,"click",function(e){dojo.publish("requests/cb/board/currenttoolchange","TOOL_SHAPE_ARROW");}));this.own(on(this._freeLineButton,"click",function(e){dojo.publish("requests/cb/board/currenttoolchange","TOOL_SHAPE_FREELINE");}));}}}});},createAndConnectCloseHandler:function(){this.closeSubscriptions=[dojo.subscribe("/sp/pad/controller/mousedown",this,function(args){this.hide();}),dojo.subscribe("/sp/pad/propbar/mousedown",this,function(args){this.hide();}),dojo.subscribe("updates/cb/board/currenttool",this,function(args){this.hide();})];},hide:function(){this.inherited("hide",arguments);if(this.closeSubscriptions){for(var i=0;i<this.closeSubscriptions.length;i++){dojo.unsubscribe(this.closeSubscriptions[i]);}}}});});},"dojo/dnd/Selector":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/kernel","../_base/lang","../dom","../dom-construct","../mouse","../_base/NodeList","../on","../touch","./common","./Container"],function(_1a9,_1aa,_1ab,_1ac,lang,dom,_1ad,_1ae,_1af,on,_1b0,dnd,_1b1){var _1b2=_1aa("dojo.dnd.Selector",_1b1,{constructor:function(node,_1b3){if(!_1b3){_1b3={};}this.singular=_1b3.singular;this.autoSync=_1b3.autoSync;this.selection={};this.anchor=null;this.simpleSelection=false;this.events.push(on(this.node,_1b0.press,lang.hitch(this,"onMouseDown")),on(this.node,_1b0.release,lang.hitch(this,"onMouseUp")));},singular:false,getSelectedNodes:function(){var t=new _1af();var e=dnd._empty;for(var i in this.selection){if(i in e){continue;}t.push(dom.byId(i));}return t;},selectNone:function(){return this._removeSelection()._removeAnchor();},selectAll:function(){this.forInItems(function(data,id){this._addItemClass(dom.byId(id),"Selected");this.selection[id]=1;},this);return this._removeAnchor();},deleteSelectedNodes:function(){var e=dnd._empty;for(var i in this.selection){if(i in e){continue;}var n=dom.byId(i);this.delItem(i);_1ad.destroy(n);}this.anchor=null;this.selection={};return this;},forInSelectedItems:function(f,o){o=o||_1ac.global;var s=this.selection,e=dnd._empty;for(var i in s){if(i in e){continue;}f.call(o,this.getItem(i),i,this);}},sync:function(){_1b2.superclass.sync.call(this);if(this.anchor){if(!this.getItem(this.anchor.id)){this.anchor=null;}}var t=[],e=dnd._empty;for(var i in this.selection){if(i in e){continue;}if(!this.getItem(i)){t.push(i);}}_1a9.forEach(t,function(i){delete this.selection[i];},this);return this;},insertNodes:function(_1b4,data,_1b5,_1b6){var _1b7=this._normalizedCreator;this._normalizedCreator=function(item,hint){var t=_1b7.call(this,item,hint);if(_1b4){if(!this.anchor){this.anchor=t.node;this._removeItemClass(t.node,"Selected");this._addItemClass(this.anchor,"Anchor");}else{if(this.anchor!=t.node){this._removeItemClass(t.node,"Anchor");this._addItemClass(t.node,"Selected");}}this.selection[t.node.id]=1;}else{this._removeItemClass(t.node,"Selected");this._removeItemClass(t.node,"Anchor");}return t;};_1b2.superclass.insertNodes.call(this,data,_1b5,_1b6);this._normalizedCreator=_1b7;return this;},destroy:function(){_1b2.superclass.destroy.call(this);this.selection=this.anchor=null;},onMouseDown:function(e){if(this.autoSync){this.sync();}if(!this.current){return;}if(!this.singular&&!dnd.getCopyKeyState(e)&&!e.shiftKey&&(this.current.id in this.selection)){this.simpleSelection=true;if(_1ae.isLeft(e)){_1ab.stop(e);}return;}if(!this.singular&&e.shiftKey){if(!dnd.getCopyKeyState(e)){this._removeSelection();}var c=this.getAllNodes();if(c.length){if(!this.anchor){this.anchor=c[0];this._addItemClass(this.anchor,"Anchor");}this.selection[this.anchor.id]=1;if(this.anchor!=this.current){var i=0,node;for(;i<c.length;++i){node=c[i];if(node==this.anchor||node==this.current){break;}}for(++i;i<c.length;++i){node=c[i];if(node==this.anchor||node==this.current){break;}this._addItemClass(node,"Selected");this.selection[node.id]=1;}this._addItemClass(this.current,"Selected");this.selection[this.current.id]=1;}}}else{if(this.singular){if(this.anchor==this.current){if(dnd.getCopyKeyState(e)){this.selectNone();}}else{this.selectNone();this.anchor=this.current;this._addItemClass(this.anchor,"Anchor");this.selection[this.current.id]=1;}}else{if(dnd.getCopyKeyState(e)){if(this.anchor==this.current){delete this.selection[this.anchor.id];this._removeAnchor();}else{if(this.current.id in this.selection){this._removeItemClass(this.current,"Selected");delete this.selection[this.current.id];}else{if(this.anchor){this._removeItemClass(this.anchor,"Anchor");this._addItemClass(this.anchor,"Selected");}this.anchor=this.current;this._addItemClass(this.current,"Anchor");this.selection[this.current.id]=1;}}}else{if(!(this.current.id in this.selection)){this.selectNone();this.anchor=this.current;this._addItemClass(this.current,"Anchor");this.selection[this.current.id]=1;}}}}_1ab.stop(e);},onMouseUp:function(){if(!this.simpleSelection){return;}this.simpleSelection=false;this.selectNone();if(this.current){this.anchor=this.current;this._addItemClass(this.anchor,"Anchor");this.selection[this.current.id]=1;}},onMouseMove:function(){this.simpleSelection=false;},onOverEvent:function(){this.onmousemoveEvent=on(this.node,_1b0.move,lang.hitch(this,"onMouseMove"));},onOutEvent:function(){if(this.onmousemoveEvent){this.onmousemoveEvent.remove();delete this.onmousemoveEvent;}},_removeSelection:function(){var e=dnd._empty;for(var i in this.selection){if(i in e){continue;}var node=dom.byId(i);if(node){this._removeItemClass(node,"Selected");}}this.selection={};return this;},_removeAnchor:function(){if(this.anchor){this._removeItemClass(this.anchor,"Anchor");this.anchor=null;}return this;}});return _1b2;});},"cb/page/pad/AndroidOrientationFix":function(){define(["dojo/ready","dojo/has","dojo/query","dojo/on","dijit"],function(_1b8,has,$,on,_1b9){_1b8(90,function(){if(has("android")){var _1ba=$("head > meta[name=viewport]");_1ba.attr("content","width=device-width, user-scalable=0, maximum-scale=1, initial-scale=1, minimum-scale=1");var _1bb;function _1bc(){if(Math.abs(window.orientation)!==90){if(true!==_1bb){window.setTimeout(function(){_1ba.attr("content","width=device-width, user-scalable=0, maximum-scale=1, initial-scale=1, minimum-scale=1");},50);}_1bb=true;}else{if(false!==_1bb){window.setTimeout(function(){_1ba.attr("content","width=device-width, user-scalable=0, maximum-scale=1, initial-scale=1, minimum-scale=1");var bc=_1b9.byId("borderContainer");if(bc){bc.toggleSidebar(true);}},50);}_1bb=false;}};_1bc();on(window,"orientationchange",_1bc);}});return {};});},"sp/EditSessionMessageCreator":function(){define(["dijit","dojo","dojox","dojo/i18n!sp/nls/EditSessionMessageCreator","dojo/require!sp/err,dojo/date/stamp,dojo/date/locale,sp/I18n,cb/page/pad/UserColorTracker"],function(_1bd,dojo,_1be){dojo.provide("sp.EditSessionMessageCreator");dojo.require("sp.err");dojo.require("dojo.date.stamp");dojo.require("dojo.date.locale");dojo.require("sp.I18n");dojo.require("cb.page.pad.UserColorTracker");dojo.requireLocalization("sp","EditSessionMessageCreator");dojo.declare("sp.EditSessionMessageCreator",[],{_errHandler:null,_currentTimeout:null,BUFFER_TIME:2*1000,constructor:function(args){this._buffer={};this._errHandler=args.errHandler;this.subscription=dojo.subscribe("/sp/ajax/incoming/editsession",this,this._onEditSessionMessage);},_onEditSessionMessage:function(msg){if(!msg||msg.type!=="editsession"){return;}if(msg.action!=="left"&&msg.action!=="joined"){return;}if(this._currentTimeout){window.clearTimeout(this._currentTimeout);this._currentTimeout=null;}var _1bf=this._buffer[msg.user.id];if(_1bf&&_1bf.action==="joined"&&msg.action==="left"){delete this._buffer[msg.user.id];}else{this._buffer[msg.user.id]=msg;}this._currentTimeout=window.setTimeout(dojo.hitch(this,this._showBufferContents),this.BUFFER_TIMEOUT);},_showBufferContents:function(){var _1c0=this._buffer;this._buffer={};var _1c1=this._errHandler;for(var _1c2 in _1c0){if(!_1c0.hasOwnProperty(_1c2)){continue;}var msg=_1c0[_1c2];var _1c3=dojo.date.stamp.fromISOString(msg.time)||new Date();var _1c4,_1c5,_1c6,_1c7;var _1c8;if(msg.action==="joined"){if(msg.user.id==sp.info.user.id){var _1c9=sp.info.user.isNamedGuest?"permanent_editsession":"editsession";var _1ca=sp.info.user.isNamedGuest?"as_guest":"as_user";var _1cb=sp.info.padConfig.startNewAndEmpty?"on_new_board":"on_existing_board";_1c5=sp.I18n.get("sp","EditSessionMessageCreator")("joined_message_me_"+_1ca+"_"+_1cb);_1c4=_1c5;_1c7=sp.I18n.get("sp","EditSessionMessageCreator")("joined_title_me_"+_1ca+"_"+_1cb,[msg.user.displayname]);_1c6="<div class=\"msg-color-swatch\" style=\"background-color:"+cb.page.pad.UserColorTracker.get(msg.user.id)+"\"></div>"+_1c7;_1c8=this._errHandler.getNewMessageObject(_1c9,_1c4,_1c6,msg.user.id);}else{_1c5=sp.I18n.get("sp","EditSessionMessageCreator")("joined_message");_1c4=_1c5;_1c7=sp.I18n.get("sp","EditSessionMessageCreator")("joined_title",[msg.user.displayname]);_1c6="<div class=\"msg-color-swatch\" style=\"background-color:"+cb.page.pad.UserColorTracker.get(msg.user.id)+"\"></div>"+_1c7;_1c8=this._errHandler.getNewMessageObject("editsession",_1c4,_1c6,msg.user.id);}}else{if(msg.action==="left"){_1c5=sp.I18n.get("sp","EditSessionMessageCreator")("left_message");_1c4=_1c5;_1c7=sp.I18n.get("sp","EditSessionMessageCreator")("left_title",[msg.user.displayname]);_1c6="<div class=\"msg-color-swatch\" style=\"background-color:"+cb.page.pad.UserColorTracker.get(msg.user.id)+"\"></div>"+_1c7;_1c8=this._errHandler.getNewMessageObject("editsession",_1c4,_1c6,msg.user.id);}}if(_1c8){_1c8.msgText=_1c5;_1c8.titleText=_1c7;_1c8.timestamp=_1c3.getTime();this._errHandler.handle(_1c8);}}}});});},"plupload/plupload-html4":function(){define("plupload/plupload-html4",["dijit","dojo","dojox","dojo/require!plupload/plupload"],function(_1cc,dojo,_1cd){dojo.provide("plupload.plupload-html4");dojo.require("plupload.plupload");(function(_1ce){(function(_1cf,_1d0,_1d1,_1d2){function _1d3(id){return _1d0.getElementById(id);};_1d1.runtimes.Html4=_1d1.addRuntime("html4",{getFeatures:function(){return {multipart:true,triggerDialog:(_1d1.ua.gecko&&_1cf.FormData||_1d1.ua.webkit)};},init:function(_1d4,_1d5){_1d4.bind("Init",function(up){var _1d6=_1d0.body,_1d7,url="javascript",_1d8,_1d9,_1da,_1db=[],IE=/MSIE/.test(navigator.userAgent),_1dc=[],_1dd=up.settings.filters,i,ext,type,y;no_type_restriction:for(i=0;i<_1dd.length;i++){ext=_1dd[i].extensions.split(/,/);for(y=0;y<ext.length;y++){if(ext[y]==="*"){_1dc=[];break no_type_restriction;}type=_1d1.mimeTypes[ext[y]];if(type&&_1d1.inArray(type,_1dc)===-1){_1dc.push(type);}}}_1dc=_1dc.join(",");function _1de(){var form,_1d9,_1df,_1e0;_1da=_1d1.guid();_1db.push(_1da);form=_1d0.createElement("form");form.setAttribute("id","form_"+_1da);form.setAttribute("method","post");form.setAttribute("enctype","multipart/form-data");form.setAttribute("encoding","multipart/form-data");form.setAttribute("target",up.id+"_iframe");_1d9=_1d0.createElement("input");_1d9.setAttribute("id","input_"+_1da);_1d9.setAttribute("type","file");_1d9.setAttribute("accept",_1dc);_1d9.setAttribute("size",1);_1e0=_1d3(up.settings.browse_button);if(up.features.triggerDialog&&_1e0){_1d1.addEvent(_1d3(up.settings.browse_button),"click",function(e){if(!_1d9.disabled){_1d9.click();}e.preventDefault();},up.id);}_1d1.addEvent(_1d9,"change",function(e){var _1e1=e.target,name,_1e2=[],_1e3;if(_1e1.value){_1d3("form_"+_1da).style.top=-1048575+"px";name=_1e1.value.replace(/\\/g,"/");name=name.substring(name.length,name.lastIndexOf("/")+1);_1e2.push(new _1d1.File(_1da,name));if(!up.features.triggerDialog){_1d1.removeAllEvents(form,up.id);}else{_1d1.removeEvent(_1e0,"click",up.id);}_1d1.removeEvent(_1d9,"change",up.id);_1de();if(_1e2.length){_1d4.trigger("FilesAdded",_1e2);}}},up.id);form.appendChild(_1d9);_1d6.appendChild(form);up.refresh();};function _1e4(){var temp=_1d0.createElement("div");temp.innerHTML="<iframe id=\""+up.id+"_iframe\" name=\""+up.id+"_iframe\" src=\""+url+":&quot;&quot;\" style=\"display:none\"></iframe>";_1d7=temp.firstChild;_1d6.appendChild(_1d7);_1d1.addEvent(_1d7,"load",function(e){var n=e.target,el,_1e5;if(!_1d8){return;}try{el=n.contentWindow.document||n.contentDocument||_1cf.frames[n.id].document;}catch(ex){up.trigger("Error",{code:_1d1.SECURITY_ERROR,message:_1d1.translate("Security error."),file:_1d8});return;}_1e5=el.documentElement.innerText||el.documentElement.textContent;if(_1e5){_1d8.status=_1d1.DONE;_1d8.loaded=1025;_1d8.percent=100;up.trigger("UploadProgress",_1d8);up.trigger("FileUploaded",_1d8,{response:_1e5});}},up.id);};if(up.settings.container){_1d6=_1d3(up.settings.container);if(_1d1.getStyle(_1d6,"position")==="static"){_1d6.style.position="relative";}}up.bind("UploadFile",function(up,file){var form,_1d9;if(file.status==_1d1.DONE||file.status==_1d1.FAILED||up.state==_1d1.STOPPED){return;}form=_1d3("form_"+file.id);_1d9=_1d3("input_"+file.id);_1d9.setAttribute("name",up.settings.file_data_name);form.setAttribute("action",up.settings.url);_1d1.each(_1d1.extend({name:file.target_name||file.name},up.settings.multipart_params,up.settings.args),function(_1e6,name){var _1e7=_1d0.createElement("input");_1d1.extend(_1e7,{type:"hidden",name:name,value:_1e6});form.insertBefore(_1e7,form.firstChild);});_1d8=file;_1d3("form_"+_1da).style.top=-1048575+"px";form.submit();});up.bind("FileUploaded",function(up){up.refresh();});up.bind("StateChanged",function(up){if(up.state==_1d1.STARTED){_1e4();}else{if(up.state==_1d1.STOPPED){_1cf.setTimeout(function(){_1d1.removeEvent(_1d7,"load",up.id);if(_1d7.parentNode){_1d7.parentNode.removeChild(_1d7);}},0);}}_1d1.each(up.files,function(file,i){if(file.status===_1d1.DONE||file.status===_1d1.FAILED){var form=_1d3("form_"+file.id);if(form){form.parentNode.removeChild(form);}}});});up.bind("Refresh",function(up){var _1e8,_1e9,_1ea,_1eb,_1ec,_1ed,_1ee,_1ef,_1f0;_1e8=_1d3(up.settings.browse_button);if(_1e8){_1ec=_1d1.getPos(_1e8,_1d3(up.settings.container));_1ed=_1d1.getSize(_1e8);_1ee=_1d3("form_"+_1da);_1ef=_1d3("input_"+_1da);if(up.features.triggerDialog){if(_1d1.getStyle(_1e8,"position")==="static"){_1d1.extend(_1e8.style,{position:"relative"});}_1f0=parseInt(_1e8.style.zIndex,10);if(isNaN(_1f0)){_1f0=0;}_1d1.extend(_1e8.style,{zIndex:_1f0});_1d1.extend(_1ee.style,{zIndex:_1f0-1});}_1ea=up.settings.browse_button_hover;_1eb=up.settings.browse_button_active;_1e9=up.features.triggerDialog?_1e8:_1ee;if(_1ea){_1d1.addEvent(_1e9,"mouseover",function(){_1d1.addClass(_1e8,_1ea);},up.id);_1d1.addEvent(_1e9,"mouseout",function(){_1d1.removeClass(_1e8,_1ea);},up.id);}if(_1eb){_1d1.addEvent(_1e9,"mousedown",function(){_1d1.addClass(_1e8,_1eb);},up.id);_1d1.addEvent(_1d0.body,"mouseup",function(){_1d1.removeClass(_1e8,_1eb);},up.id);}}});_1d4.bind("FilesRemoved",function(up,_1f1){var i,n;for(i=0;i<_1f1.length;i++){n=_1d3("form_"+_1f1[i].id);if(n){n.parentNode.removeChild(n);}}});_1d4.bind("DisableBrowse",function(up,_1f2){var _1f3=_1d0.getElementById("input_"+_1da);if(_1f3){_1f3.disabled=_1f2;}});_1d4.bind("Destroy",function(up){var name,_1f4,form,_1f5={inputContainer:"form_"+_1da,inputFile:"input_"+_1da,browseButton:up.settings.browse_button};for(name in _1f5){_1f4=_1d3(_1f5[name]);if(_1f4){_1d1.removeAllEvents(_1f4,up.id);}}_1d1.removeAllEvents(_1d0.body,up.id);_1d1.each(_1db,function(id,i){form=_1d3("form_"+id);if(form){form.parentNode.removeChild(form);}});});_1de();});_1d5({success:true});}});})(window,document,_1ce);})(plupload.plupload);});},"plupload/plupload-html5":function(){define("plupload/plupload-html5",["dijit","dojo","dojox","dojo/require!plupload/plupload"],function(_1f6,dojo,_1f7){dojo.provide("plupload.plupload-html5");dojo.require("plupload.plupload");(function(_1f8){(function(_1f9,_1fa,_1fb,_1fc){var _1fd={},_1fe;function _1ff(img){var iw=img.naturalWidth,ih=img.naturalHeight;if(iw*ih>1024*1024){var _200=_1fa.createElement("canvas");_200.width=_200.height=1;var ctx=_200.getContext("2d");ctx.drawImage(img,-iw+1,0);return ctx.getImageData(0,0,1,1).data[3]===0;}else{return false;}};function _201(img,iw,ih){var _202=_1fa.createElement("canvas");_202.width=1;_202.height=ih;var ctx=_202.getContext("2d");ctx.drawImage(img,0,0);var data=ctx.getImageData(0,0,1,ih).data;var sy=0;var ey=ih;var py=ih;while(py>sy){var _203=data[(py-1)*4+3];if(_203===0){ey=py;}else{sy=py;}py=(ey+sy)>>1;}var _204=(py/ih);return (_204===0)?1:_204;};function _205(img,_206,_207){var iw=img.naturalWidth,ih=img.naturalHeight;var _208=_207.width,_209=_207.height;var ctx=_206.getContext("2d");ctx.save();var _20a=_1ff(img);if(_20a){iw/=2;ih/=2;}var d=1024;var _20b=_1fa.createElement("canvas");_20b.width=_20b.height=d;var _20c=_20b.getContext("2d");var _20d=_201(img,iw,ih);var sy=0;while(sy<ih){var sh=sy+d>ih?ih-sy:d;var sx=0;while(sx<iw){var sw=sx+d>iw?iw-sx:d;_20c.clearRect(0,0,d,d);_20c.drawImage(img,-sx,-sy);var dx=(sx*_208/iw)<<0;var dw=Math.ceil(sw*_208/iw);var dy=(sy*_209/ih/_20d)<<0;var dh=Math.ceil(sh*_209/ih/_20d);ctx.drawImage(_20b,0,0,sw,sh,dx,dy,dw,dh);sx+=d;}sy+=d;}ctx.restore();_20b=_20c=null;};function _20e(file,_20f){var _210;if("FileReader" in _1f9){_210=new FileReader();_210.readAsDataURL(file);_210.onload=function(){_20f(_210.result);};}else{return _20f(file.getAsDataURL());}};function _211(file,_212){var _213;if("FileReader" in _1f9){_213=new FileReader();_213.readAsBinaryString(file);_213.onload=function(){_212(_213.result);};}else{return _212(file.getAsBinary());}};function _214(file,_215,mime,_216){var _217,_218,img,_219,up=this;_20e(_1fd[file.id],function(data){_217=_1fa.createElement("canvas");_217.style.display="none";_1fa.body.appendChild(_217);img=new Image();img.onerror=img.onabort=function(){_216({success:false});};img.onload=function(){var _21a,_21b,_21c,_21d,_21e;if(!_215["width"]){_215["width"]=img.width;}if(!_215["height"]){_215["height"]=img.height;}_219=Math.min(_215.width/img.width,_215.height/img.height);if(_219<1){_21a=Math.round(img.width*_219);_21b=Math.round(img.height*_219);}else{if(_215["quality"]&&mime==="image/jpeg"){_21a=img.width;_21b=img.height;}else{_216({success:false});return;}}_217.width=_21a;_217.height=_21b;_205(img,_217,{width:_21a,height:_21b});if(mime==="image/jpeg"){_21d=new _21f(atob(data.substring(data.indexOf("base64,")+7)));if(_21d["headers"]&&_21d["headers"].length){_21e=new _220();if(_21e.init(_21d.get("exif")[0])){_21e.setExif("PixelXDimension",_21a);_21e.setExif("PixelYDimension",_21b);_21d.set("exif",_21e.getBinary());if(up.hasEventListener("ExifData")){up.trigger("ExifData",file,_21e.EXIF());}if(up.hasEventListener("GpsData")){up.trigger("GpsData",file,_21e.GPS());}}}}if(_215["quality"]&&mime==="image/jpeg"){try{data=_217.toDataURL(mime,_215["quality"]/100);}catch(ex){data=_217.toDataURL(mime);}}else{data=_217.toDataURL(mime);}data=data.substring(data.indexOf("base64,")+7);data=atob(data);if(_21d&&_21d["headers"]&&_21d["headers"].length){data=_21d.restore(data);_21d.purge();}_217.parentNode.removeChild(_217);_216({success:true,data:data});};img.src=data;});};_1fb.runtimes.Html5=_1fb.addRuntime("html5",{getFeatures:function(){var xhr,_221,_222,_223,_224,_225;_221=_222=_224=_225=false;if(_1f9.XMLHttpRequest){xhr=new XMLHttpRequest();_222=!!xhr.upload;_221=!!(xhr.sendAsBinary||xhr.upload);}if(_221){_223=!!(xhr.sendAsBinary||(_1f9.Uint8Array&&_1f9.ArrayBuffer));_224=!!(File&&(File.prototype.getAsDataURL||_1f9.FileReader)&&_223);_225=!!(File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice));}_1fe=_1fb.ua.safari&&_1fb.ua.windows;return {html5:_221,dragdrop:(function(){var div=_1fa.createElement("div");return ("draggable" in div)||("ondragstart" in div&&"ondrop" in div);}()),jpgresize:_224,pngresize:_224,multipart:_224||!!_1f9.FileReader||!!_1f9.FormData,canSendBinary:_223,cantSendBlobInFormData:!!(_1fb.ua.gecko&&_1f9.FormData&&_1f9.FileReader&&!FileReader.prototype.readAsArrayBuffer)||_1fb.ua.android,progress:_222,chunks:_225,multi_selection:!(_1fb.ua.safari&&_1fb.ua.windows),triggerDialog:true};},init:function(_226,_227){var _228,xhr;function _229(_22a){var file,i,_22b=[],id,_22c={};for(i=0;i<_22a.length;i++){file=_22a[i];if(_22c[file.name]&&_1fb.ua.safari&&_1fb.ua.windows){continue;}_22c[file.name]=true;id=_1fb.guid();_1fd[id]=file;_22b.push(new _1fb.File(id,file.fileName||file.name,file.fileSize||file.size));}if(_22b.length){_226.trigger("FilesAdded",_22b);}};_228=this.getFeatures();if(!_228.html5){_227({success:false});return;}_226.bind("Init",function(up){var _22d,_22e,_22f=[],i,y,_230=up.settings.filters,ext,type,_231=_1fa.body,_232;_22d=_1fa.createElement("div");_22d.id=up.id+"_html5_container";_1fb.extend(_22d.style,{position:"absolute",background:_226.settings.shim_bgcolor||"transparent",width:"100px",height:"100px",overflow:"hidden",zIndex:99999,opacity:_226.settings.shim_bgcolor?"":0});_22d.className="plupload html5";if(_226.settings.container){_231=_1fa.getElementById(_226.settings.container);if(_1fb.getStyle(_231,"position")==="static"){_231.style.position="relative";}}_231.appendChild(_22d);no_type_restriction:for(i=0;i<_230.length;i++){ext=_230[i].extensions.split(/,/);for(y=0;y<ext.length;y++){if(ext[y]==="*"){_22f=[];break no_type_restriction;}type=_1fb.mimeTypes[ext[y]];if(type&&_1fb.inArray(type,_22f)===-1){_22f.push(type);}}}_22d.innerHTML="<input id=\""+_226.id+"_html5\" "+" style=\"font-size:999px\""+" type=\"file\" accept=\""+_22f.join(",")+"\" "+(_226.settings.multi_selection&&_226.features.multi_selection?"multiple=\"multiple\"":"")+" />";_22d.scrollTop=100;_232=_1fa.getElementById(_226.id+"_html5");if(up.features.triggerDialog){_1fb.extend(_232.style,{position:"absolute",width:"100%",height:"100%"});}else{_1fb.extend(_232.style,{cssFloat:"right",styleFloat:"right"});}_232.onchange=function(){_229(this.files);this.value="";};_22e=_1fa.getElementById(up.settings.browse_button);if(_22e){var _233=up.settings.browse_button_hover,_234=up.settings.browse_button_active,_235=up.features.triggerDialog?_22e:_22d;if(_233){_1fb.addEvent(_235,"mouseover",function(){_1fb.addClass(_22e,_233);},up.id);_1fb.addEvent(_235,"mouseout",function(){_1fb.removeClass(_22e,_233);},up.id);}if(_234){_1fb.addEvent(_235,"mousedown",function(){_1fb.addClass(_22e,_234);},up.id);_1fb.addEvent(_1fa.body,"mouseup",function(){_1fb.removeClass(_22e,_234);},up.id);}if(up.features.triggerDialog){_1fb.addEvent(_22e,"click",function(e){var _236=_1fa.getElementById(up.id+"_html5");if(_236&&!_236.disabled){_236.click();}e.preventDefault();},up.id);}}});_226.bind("PostInit",function(){_226.cbUploadFile=function(file){_229([file]);};});_226.bind("PostInit",function(){var _237=_1fa.getElementById(_226.settings.drop_element);if(_237){if(_1fe){_1fb.addEvent(_237,"dragenter",function(e){var _238,_239,_23a;_238=_1fa.getElementById(_226.id+"_drop");if(!_238){_238=_1fa.createElement("input");_238.setAttribute("type","file");_238.setAttribute("id",_226.id+"_drop");_238.setAttribute("multiple","multiple");_1fb.addEvent(_238,"change",function(){_229(this.files);_1fb.removeEvent(_238,"change",_226.id);_238.parentNode.removeChild(_238);},_226.id);_1fb.addEvent(_238,"dragover",function(e){e.stopPropagation();},_226.id);_237.appendChild(_238);}_239=_1fb.getPos(_237,_1fa.getElementById(_226.settings.container));_23a=_1fb.getSize(_237);if(_1fb.getStyle(_237,"position")==="static"){_1fb.extend(_237.style,{position:"relative"});}_1fb.extend(_238.style,{position:"absolute",display:"block",top:0,left:0,width:_23a.w+"px",height:_23a.h+"px",opacity:0});},_226.id);return;}_1fb.addEvent(_237,"dragover",function(e){e.preventDefault();},_226.id);_1fb.addEvent(_237,"drop",function(e){var _23b=e.dataTransfer;e.preventDefault();if(_23b&&_23b.files&&_23b.files.length>0){_229(_23b.files);}else{_226.trigger("OtherDrop",e);}e.preventDefault();},_226.id);}});_226.bind("Refresh",function(up){var _23c,_23d,_23e,_23f,_240;_23c=_1fa.getElementById(_226.settings.browse_button);if(_23c){_23d=_1fb.getPos(_23c,_1fa.getElementById(up.settings.container));_23e=_1fb.getSize(_23c);_23f=_1fa.getElementById(_226.id+"_html5_container");_1fb.extend(_23f.style,{top:_23d.y+"px",left:_23d.x+"px",width:_23e.w+"px",height:_23e.h+"px"});if(_226.features.triggerDialog){if(_1fb.getStyle(_23c,"position")==="static"){_1fb.extend(_23c.style,{position:"relative"});}_240=parseInt(_1fb.getStyle(_23c,"zIndex"),10);if(isNaN(_240)){_240=0;}_1fb.extend(_23c.style,{zIndex:_240});_1fb.extend(_23f.style,{zIndex:_240-1});}}});_226.bind("DisableBrowse",function(up,_241){var _242=_1fa.getElementById(up.id+"_html5");if(_242){_242.disabled=_241;}});_226.bind("CancelUpload",function(){if(xhr&&xhr.abort){xhr.abort();}});_226.bind("UploadFile",function(up,file){var _243=up.settings,_244,_245;function _246(blob,_247,end){var _248;if(File.prototype.slice){try{blob.slice();return blob.slice(_247,end);}catch(e){return blob.slice(_247,end-_247);}}else{if(_248=File.prototype.webkitSlice||File.prototype.mozSlice){return _248.call(blob,_247,end);}else{return null;}}};function _249(blob){var _24a=0,_24b=0;function _24c(){var _24d,br,_24e,args,_24f,_250,_251,url=up.settings.url;function _252(bin){if(xhr.sendAsBinary){xhr.sendAsBinary(bin);}else{if(up.features.canSendBinary){var ui8a=new Uint8Array(bin.length);for(var i=0;i<bin.length;i++){ui8a[i]=(bin.charCodeAt(i)&255);}xhr.send(ui8a.buffer);}}};function _253(bin){var _254=0,_255="----pluploadboundary"+_1fb.guid(),_256,_257="--",crlf="\r\n",_258="";xhr=new XMLHttpRequest;if(xhr.upload){xhr.upload.onprogress=function(e){file.loaded=Math.min(file.size,_24b+e.loaded-_254);up.trigger("UploadProgress",file);};}xhr.onreadystatechange=function(){var _259,_25a;if(xhr.readyState==4&&up.state!==_1fb.STOPPED){try{_259=xhr.status;}catch(ex){_259=0;}if(_259>=400){up.trigger("Error",{code:_1fb.HTTP_ERROR,message:_1fb.translate("HTTP Error."),file:file,status:_259});}else{if(_24e){_25a={chunk:_24a,chunks:_24e,response:xhr.responseText,status:_259};up.trigger("ChunkUploaded",file,_25a);_24b+=_250;if(_25a.cancelled){file.status=_1fb.FAILED;return;}file.loaded=Math.min(file.size,(_24a+1)*_24f);}else{file.loaded=file.size;}up.trigger("UploadProgress",file);bin=_24d=_256=_258=null;if(!_24e||++_24a>=_24e){file.status=_1fb.DONE;up.trigger("FileUploaded",file,{response:xhr.responseText,status:_259});}else{_24c();}}}};if(up.settings.multipart&&_228.multipart){args.name=file.target_name||file.name;xhr.open("post",url,true);_1fb.each(up.settings.headers,function(_25b,name){xhr.setRequestHeader(name,_25b);});if(typeof (bin)!=="string"&&!!_1f9.FormData){_256=new FormData();_1fb.each(_1fb.extend(args,up.settings.multipart_params),function(_25c,name){_256.append(name,_25c);});_256.append(up.settings.file_data_name,bin);xhr.send(_256);return;}if(typeof (bin)==="string"){xhr.setRequestHeader("Content-Type","multipart/form-data; boundary="+_255);_1fb.each(_1fb.extend(args,up.settings.multipart_params),function(_25d,name){_258+=_257+_255+crlf+"Content-Disposition: form-data; name=\""+name+"\""+crlf+crlf;_258+=unescape(encodeURIComponent(_25d))+crlf;});_251=_1fb.mimeTypes[file.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream";_258+=_257+_255+crlf+"Content-Disposition: form-data; name=\""+up.settings.file_data_name+"\"; filename=\""+unescape(encodeURIComponent(file.name))+"\""+crlf+"Content-Type: "+_251+crlf+crlf+bin+crlf+_257+_255+_257+crlf;_254=_258.length-bin.length;bin=_258;_252(bin);return;}}url=_1fb.buildUrl(up.settings.url,_1fb.extend(args,up.settings.multipart_params));xhr.open("post",url,true);xhr.setRequestHeader("Content-Type","application/octet-stream");_1fb.each(up.settings.headers,function(_25e,name){xhr.setRequestHeader(name,_25e);});if(typeof (bin)==="string"){_252(bin);}else{xhr.send(bin);}};if(file.status==_1fb.DONE||file.status==_1fb.FAILED||up.state==_1fb.STOPPED){return;}args=_1fb.extend({name:file.target_name||file.name},up.settings.args);if(_243.chunk_size&&file.size>_243.chunk_size&&(_228.chunks||typeof (blob)=="string")){_24f=_243.chunk_size;_24e=Math.ceil(file.size/_24f);_250=Math.min(_24f,file.size-(_24a*_24f));if(typeof (blob)=="string"){_24d=blob.substring(_24a*_24f,_24a*_24f+_250);}else{_24d=_246(blob,_24a*_24f,_24a*_24f+_250);}args.chunk=_24a;args.chunks=_24e;}else{_250=file.size;_24d=blob;}if(up.settings.multipart&&_228.multipart&&typeof (_24d)!=="string"&&_1f9.FileReader&&_228.cantSendBlobInFormData&&_228.chunks&&up.settings.chunk_size){(function(){var fr=new FileReader();fr.onload=function(){_253(fr.result);fr=null;};fr.readAsBinaryString(_24d);}());}else{_253(_24d);}};_24c();};_244=_1fd[file.id];if(_228.jpgresize&&up.settings.resize&&/\.(png|jpg|jpeg)$/i.test(file.name)){_214.call(up,file,up.settings.resize,/\.png$/i.test(file.name)?"image/png":"image/jpeg",function(res){if(res.success){file.size=res.data.length;_249(res.data);}else{if(_228.chunks){_249(_244);}else{_211(_244,_249);}}});}else{if(!_228.chunks&&_228.jpgresize){_211(_244,_249);}else{_249(_244);}}});_226.bind("Destroy",function(up){var name,_25f,_260=_1fa.body,_261={inputContainer:up.id+"_html5_container",inputFile:up.id+"_html5",browseButton:up.settings.browse_button,dropElm:up.settings.drop_element};for(name in _261){_25f=_1fa.getElementById(_261[name]);if(_25f){_1fb.removeAllEvents(_25f,up.id);}}_1fb.removeAllEvents(_1fa.body,up.id);if(up.settings.container){_260=_1fa.getElementById(up.settings.container);}_260.removeChild(_1fa.getElementById(_261.inputContainer));});_227({success:true});}});function _262(){var II=false,bin;function read(idx,size){var mv=II?0:-8*(size-1),sum=0,i;for(i=0;i<size;i++){sum|=(bin.charCodeAt(idx+i)<<Math.abs(mv+i*8));}return sum;};function _263(_264,idx,_265){var _265=arguments.length===3?_265:bin.length-idx-1;bin=bin.substr(0,idx)+_264+bin.substr(_265+idx);};function _266(idx,num,size){var str="",mv=II?0:-8*(size-1),i;for(i=0;i<size;i++){str+=String.fromCharCode((num>>Math.abs(mv+i*8))&255);}_263(str,idx,size);};return {II:function(_267){if(_267===_1fc){return II;}else{II=_267;}},init:function(_268){II=false;bin=_268;},SEGMENT:function(idx,_269,_26a){switch(arguments.length){case 1:return bin.substr(idx,bin.length-idx-1);case 2:return bin.substr(idx,_269);case 3:_263(_26a,idx,_269);break;default:return bin;}},BYTE:function(idx){return read(idx,1);},SHORT:function(idx){return read(idx,2);},LONG:function(idx,num){if(num===_1fc){return read(idx,4);}else{_266(idx,num,4);}},SLONG:function(idx){var num=read(idx,4);return (num>2147483647?num-4294967296:num);},STRING:function(idx,size){var str="";for(size+=idx;idx<size;idx++){str+=String.fromCharCode(read(idx,1));}return str;}};};function _21f(data){var _26b={65505:{app:"EXIF",name:"APP1",signature:"Exif\x00"},65506:{app:"ICC",name:"APP2",signature:"ICC_PROFILE\x00"},65517:{app:"IPTC",name:"APP13",signature:"Photoshop 3.0\x00"}},_26c=[],read,idx,_26d=_1fc,_26e=0,_26f;read=new _262();read.init(data);if(read.SHORT(0)!==65496){return;}idx=2;_26f=Math.min(1048576,data.length);while(idx<=_26f){_26d=read.SHORT(idx);if(_26d>=65488&&_26d<=65495){idx+=2;continue;}if(_26d===65498||_26d===65497){break;}_26e=read.SHORT(idx+2)+2;if(_26b[_26d]&&read.STRING(idx+4,_26b[_26d].signature.length)===_26b[_26d].signature){_26c.push({hex:_26d,app:_26b[_26d].app.toUpperCase(),name:_26b[_26d].name.toUpperCase(),start:idx,length:_26e,segment:read.SEGMENT(idx,_26e)});}idx+=_26e;}read.init(null);return {headers:_26c,restore:function(data){read.init(data);var _270=new _21f(data);if(!_270["headers"]){return false;}for(var i=_270["headers"].length;i>0;i--){var hdr=_270["headers"][i-1];read.SEGMENT(hdr.start,hdr.length,"");}_270.purge();idx=read.SHORT(2)==65504?4+read.SHORT(4):2;for(var i=0,max=_26c.length;i<max;i++){read.SEGMENT(idx,0,_26c[i].segment);idx+=_26c[i].length;}return read.SEGMENT();},get:function(app){var _271=[];for(var i=0,max=_26c.length;i<max;i++){if(_26c[i].app===app.toUpperCase()){_271.push(_26c[i].segment);}}return _271;},set:function(app,_272){var _273=[];if(typeof (_272)==="string"){_273.push(_272);}else{_273=_272;}for(var i=ii=0,max=_26c.length;i<max;i++){if(_26c[i].app===app.toUpperCase()){_26c[i].segment=_273[ii];_26c[i].length=_273[ii].length;ii++;}if(ii>=_273.length){break;}}},purge:function(){_26c=[];read.init(null);}};};function _220(){var data,tags,_274={},_275;data=new _262();tags={tiff:{274:"Orientation",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}};_275={"ColorSpace":{1:"sRGB",0:"Uncalibrated"},"MeteringMode":{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},"LightSource":{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},"Flash":{0:"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},"ExposureMode":{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},"WhiteBalance":{0:"Auto white balance",1:"Manual white balance"},"SceneCaptureType":{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},"Contrast":{0:"Normal",1:"Soft",2:"Hard"},"Saturation":{0:"Normal",1:"Low saturation",2:"High saturation"},"Sharpness":{0:"Normal",1:"Soft",2:"Hard"},"GPSLatitudeRef":{N:"North latitude",S:"South latitude"},"GPSLongitudeRef":{E:"East longitude",W:"West longitude"}};function _276(_277,_278){var _279=data.SHORT(_277),i,ii,tag,type,_27a,_27b,_27c,_27d,_27e=[],hash={};for(i=0;i<_279;i++){_27c=_27b=_277+12*i+2;tag=_278[data.SHORT(_27c)];if(tag===_1fc){continue;}type=data.SHORT(_27c+=2);_27a=data.LONG(_27c+=2);_27c+=4;_27e=[];switch(type){case 1:case 7:if(_27a>4){_27c=data.LONG(_27c)+_274.tiffHeader;}for(ii=0;ii<_27a;ii++){_27e[ii]=data.BYTE(_27c+ii);}break;case 2:if(_27a>4){_27c=data.LONG(_27c)+_274.tiffHeader;}hash[tag]=data.STRING(_27c,_27a-1);continue;case 3:if(_27a>2){_27c=data.LONG(_27c)+_274.tiffHeader;}for(ii=0;ii<_27a;ii++){_27e[ii]=data.SHORT(_27c+ii*2);}break;case 4:if(_27a>1){_27c=data.LONG(_27c)+_274.tiffHeader;}for(ii=0;ii<_27a;ii++){_27e[ii]=data.LONG(_27c+ii*4);}break;case 5:_27c=data.LONG(_27c)+_274.tiffHeader;for(ii=0;ii<_27a;ii++){_27e[ii]=data.LONG(_27c+ii*4)/data.LONG(_27c+ii*4+4);}break;case 9:_27c=data.LONG(_27c)+_274.tiffHeader;for(ii=0;ii<_27a;ii++){_27e[ii]=data.SLONG(_27c+ii*4);}break;case 10:_27c=data.LONG(_27c)+_274.tiffHeader;for(ii=0;ii<_27a;ii++){_27e[ii]=data.SLONG(_27c+ii*4)/data.SLONG(_27c+ii*4+4);}break;default:continue;}_27d=(_27a==1?_27e[0]:_27e);if(_275.hasOwnProperty(tag)&&typeof _27d!="object"){hash[tag]=_275[tag][_27d];}else{hash[tag]=_27d;}}return hash;};function _27f(){var Tiff=_1fc,idx=_274.tiffHeader;data.II(data.SHORT(idx)==18761);if(data.SHORT(idx+=2)!==42){return false;}_274["IFD0"]=_274.tiffHeader+data.LONG(idx+=2);Tiff=_276(_274["IFD0"],tags.tiff);_274["exifIFD"]=("ExifIFDPointer" in Tiff?_274.tiffHeader+Tiff.ExifIFDPointer:_1fc);_274["gpsIFD"]=("GPSInfoIFDPointer" in Tiff?_274.tiffHeader+Tiff.GPSInfoIFDPointer:_1fc);return true;};function _280(ifd,tag,_281){var _282,_283,_284,_285=0;if(typeof (tag)==="string"){var _286=tags[ifd.toLowerCase()];for(hex in _286){if(_286[hex]===tag){tag=hex;break;}}}_282=_274[ifd.toLowerCase()+"IFD"];_283=data.SHORT(_282);for(i=0;i<_283;i++){_284=_282+12*i+2;if(data.SHORT(_284)==tag){_285=_284+8;break;}}if(!_285){return false;}data.LONG(_285,_281);return true;};return {init:function(_287){_274={tiffHeader:10};if(_287===_1fc||!_287.length){return false;}data.init(_287);if(data.SHORT(0)===65505&&data.STRING(4,5).toUpperCase()==="EXIF\x00"){return _27f();}return false;},EXIF:function(){var Exif;Exif=_276(_274.exifIFD,tags.exif);if(Exif.ExifVersion&&_1fb.typeOf(Exif.ExifVersion)==="array"){for(var i=0,_288="";i<Exif.ExifVersion.length;i++){_288+=String.fromCharCode(Exif.ExifVersion[i]);}Exif.ExifVersion=_288;}return Exif;},GPS:function(){var GPS;GPS=_276(_274.gpsIFD,tags.gps);if(GPS.GPSVersionID){GPS.GPSVersionID=GPS.GPSVersionID.join(".");}return GPS;},setExif:function(tag,_289){if(tag!=="PixelXDimension"&&tag!=="PixelYDimension"){return false;}return _280("exif",tag,_289);},getBinary:function(){return data.SEGMENT();}};};})(window,document,_1f8);})(plupload.plupload);});},"cb/page/pad/sidebar/_SidebarSizer":function(){define(["dojo","dojo/dom-geometry","dojo/dom-style","dojo/window"],function(dojo,_28a,_28b,_28c){return dojo.declare(null,{delay:200,maxBottomMargin:180,constructor:function(_28d){dojo.mixin(this,_28d);if(!this.node||!this.sidebar||!this.list){throw "node, sidebar or list is missing for Sizer";}this._recalculateBound=dojo.hitch(this,"_recalculate");dojo.connect(this.list,"onShow",this,function(){this.setVisibility(true);this.recalculate();});dojo.connect(this.list,"onHide",this,function(){this.setVisibility(false);});dojo.subscribe("/window/resize",this,"recalculate");},recalculate:function(){if(this._timeout){window.clearTimeout(this._timeout);}this._timeout=window.setTimeout(this._recalculateBound,this.delay);},setVisibility:function(_28e){this._visible=_28e;},_recalculate:function(){if(!this._visible){return;}var _28f=_28a.position(this.sidebar.domNode);var _290=_28f.y+_28f.h-dojo.coords(this.node).h;var _291=dojo.window.getBox().h-_290-this.maxBottomMargin;_28b.set(this.node,"maxHeight",_291+"px");}});});},"cb/ext/mousetrap":function(){(function(_292,_293,_294){var _295={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},_296={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},_297={"~":"`","!":"1","@":"2","#":"3","$":"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0","_":"-","+":"=",":":";","\"":"'","<":",",">":".","?":"/","|":"\\"},_298={"option":"alt","command":"meta","return":"enter","escape":"esc","mod":/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},_299,_29a={},_29b={},_29c={},_29d,_29e=false,_29f=false,_2a0=false;for(var i=1;i<20;++i){_295[111+i]="f"+i;}for(i=0;i<=9;++i){_295[i+96]=i;}function _2a1(_2a2,type,_2a3){if(_2a2.addEventListener){_2a2.addEventListener(type,_2a3,false);return;}_2a2.attachEvent("on"+type,_2a3);};function _2a4(e){if(e.type=="keypress"){var _2a5=String.fromCharCode(e.which);if(!e.shiftKey){_2a5=_2a5.toLowerCase();}return _2a5;}if(_295[e.which]){return _295[e.which];}if(_296[e.which]){return _296[e.which];}return String.fromCharCode(e.which).toLowerCase();};function _2a6(_2a7,_2a8){return _2a7.sort().join(",")===_2a8.sort().join(",");};function _2a9(_2aa){_2aa=_2aa||{};var _2ab=false,key;for(key in _29c){if(_2aa[key]){_2ab=true;continue;}_29c[key]=0;}if(!_2ab){_2a0=false;}};function _2ac(_2ad,_2ae,e,_2af,_2b0,_2b1){var i,_2b2,_2b3=[],_2b4=e.type;if(!_29a[_2ad]){return [];}if(_2b4=="keyup"&&_2b5(_2ad)){_2ae=[_2ad];}for(i=0;i<_29a[_2ad].length;++i){_2b2=_29a[_2ad][i];if(!_2af&&_2b2.seq&&_29c[_2b2.seq]!=_2b2.level){continue;}if(_2b4!=_2b2.action){continue;}if((_2b4=="keypress"&&!e.metaKey&&!e.ctrlKey)||_2a6(_2ae,_2b2.modifiers)){var _2b6=!_2af&&_2b2.combo==_2b0;var _2b7=_2af&&_2b2.seq==_2af&&_2b2.level==_2b1;if(_2b6||_2b7){_29a[_2ad].splice(i,1);}_2b3.push(_2b2);}}return _2b3;};function _2b8(e){var _2b9=[];if(e.shiftKey){_2b9.push("shift");}if(e.altKey){_2b9.push("alt");}if(e.ctrlKey){_2b9.push("ctrl");}if(e.metaKey){_2b9.push("meta");}return _2b9;};function _2ba(e){if(e.preventDefault){e.preventDefault();return;}e.returnValue=false;};function _2bb(e){if(e.stopPropagation){e.stopPropagation();return;}e.cancelBubble=true;};function _2bc(_2bd,e,_2be,_2bf){if(_2c0.stopCallback(e,e.target||e.srcElement,_2be,_2bf)){return;}if(_2bd(e,_2be)===false){_2ba(e);_2bb(e);}};function _2c1(_2c2,_2c3,e){var _2c4=_2ac(_2c2,_2c3,e),i,_2c5={},_2c6=0,_2c7=false;for(i=0;i<_2c4.length;++i){if(_2c4[i].seq){_2c6=Math.max(_2c6,_2c4[i].level);}}for(i=0;i<_2c4.length;++i){if(_2c4[i].seq){if(_2c4[i].level!=_2c6){continue;}_2c7=true;_2c5[_2c4[i].seq]=1;_2bc(_2c4[i].callback,e,_2c4[i].combo,_2c4[i].seq);continue;}if(!_2c7){_2bc(_2c4[i].callback,e,_2c4[i].combo);}}var _2c8=e.type=="keypress"&&_29f;if(e.type==_2a0&&!_2b5(_2c2)&&!_2c8){_2a9(_2c5);}_29f=_2c7&&e.type=="keydown";};function _2c9(e){if(typeof e.which!=="number"){e.which=e.keyCode;}var _2ca=_2a4(e);if(!_2ca){return;}if(e.type=="keyup"&&_29e===_2ca){_29e=false;return;}_2c0.handleKey(_2ca,_2b8(e),e);};function _2b5(key){return key=="shift"||key=="ctrl"||key=="alt"||key=="meta";};function _2cb(){clearTimeout(_29d);_29d=setTimeout(_2a9,1000);};function _2cc(){if(!_299){_299={};for(var key in _295){if(key>95&&key<112){continue;}if(_295.hasOwnProperty(key)){_299[_295[key]]=key;}}}return _299;};function _2cd(key,_2ce,_2cf){if(!_2cf){_2cf=_2cc()[key]?"keydown":"keypress";}if(_2cf=="keypress"&&_2ce.length){_2cf="keydown";}return _2cf;};function _2d0(_2d1,keys,_2d2,_2d3){_29c[_2d1]=0;function _2d4(_2d5){return function(){_2a0=_2d5;++_29c[_2d1];_2cb();};};function _2d6(e){_2bc(_2d2,e,_2d1);if(_2d3!=="keyup"){_29e=_2a4(e);}setTimeout(_2a9,10);};for(var i=0;i<keys.length;++i){var _2d7=i+1===keys.length;var _2d8=_2d7?_2d6:_2d4(_2d3||_2d9(keys[i+1]).action);_2da(keys[i],_2d8,_2d3,_2d1,i);}};function _2db(_2dc){if(_2dc==="+"){return ["+"];}return _2dc.split("+");};function _2d9(_2dd,_2de){var keys,key,i,_2df=[];keys=_2db(_2dd);for(i=0;i<keys.length;++i){key=keys[i];if(_298[key]){key=_298[key];}if(_2de&&_2de!="keypress"&&_297[key]){key=_297[key];_2df.push("shift");}if(_2b5(key)){_2df.push(key);}}_2de=_2cd(key,_2df,_2de);return {key:key,modifiers:_2df,action:_2de};};function _2da(_2e0,_2e1,_2e2,_2e3,_2e4){_29b[_2e0+":"+_2e2]=_2e1;_2e0=_2e0.replace(/\s+/g," ");var _2e5=_2e0.split(" "),info;if(_2e5.length>1){_2d0(_2e0,_2e5,_2e1,_2e2);return;}info=_2d9(_2e0,_2e2);_29a[info.key]=_29a[info.key]||[];_2ac(info.key,info.modifiers,{type:info.action},_2e3,_2e0,_2e4);_29a[info.key][_2e3?"unshift":"push"]({callback:_2e1,modifiers:info.modifiers,action:info.action,seq:_2e3,level:_2e4,combo:_2e0});};function _2e6(_2e7,_2e8,_2e9){for(var i=0;i<_2e7.length;++i){_2da(_2e7[i],_2e8,_2e9);}};_2a1(_293,"keypress",_2c9);_2a1(_293,"keydown",_2c9);_2a1(_293,"keyup",_2c9);var _2c0={bind:function(keys,_2ea,_2eb){keys=keys instanceof Array?keys:[keys];_2e6(keys,_2ea,_2eb);return this;},unbind:function(keys,_2ec){return _2c0.bind(keys,function(){},_2ec);},trigger:function(keys,_2ed){if(_29b[keys+":"+_2ed]){_29b[keys+":"+_2ed]({},keys);}return this;},reset:function(){_29a={};_29b={};return this;},stopCallback:function(e,_2ee){if((" "+_2ee.className+" ").indexOf(" mousetrap ")>-1){return false;}return _2ee.tagName=="INPUT"||_2ee.tagName=="SELECT"||_2ee.tagName=="TEXTAREA"||_2ee.isContentEditable;},handleKey:_2c1};_292.Mousetrap=_2c0;if(typeof define==="function"&&define.amd){define(_2c0);}})(window,document);},"cb/board/tutorial/TutorialStepPane":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/query","dojo/dom-construct","dojo/dom-class","dojo/on","dojo/_base/array","dojo/dom-attr","dijit/place","dijit/_WidgetBase","cb/widget/_TemplatedMixin","cb/util","sp/I18n","dojo/i18n!./nls/TutorialMessages"],function(_2ef,lang,_2f0,_2f1,_2f2,on,arr,_2f3,_2f4,_2f5,_2f6,_2f7,_2f8,i18n){var _2f9=_2f8.wrap(i18n);return _2ef([_2f5,_2f6],{templateString:"<div class=\"dijitPopup\"><div class=\"dijitTooltipContainer\" data-dojo-attach-point=\"_containerNode\"><div class=\"dialog-title\" data-dojo-attach-point=\"_titleNode\"></div><div data-dojo-attach-point=\"_contentNode\"></div></div></div>",baseClass:"tutorial-pane",i18n:i18n,contextNode:null,constructor:function(){this.inherited(arguments);this.subscribe("/window/resize",dojo.hitch(this,function(){this.show(this.contextNode);}));this.stepAchievements=[];this.stepAchievementInterval=null;this.stepAchievementIntervalLength=1000;},onDestroy:function(){if(this.stepAchievementInterval){window.clearInterval(this.stepAchievementInterval);}},postCreate:function(){this.inherited(arguments);if(this.tutTitle){this._titleNode.innerHTML=this.tutTitle;}var _2fa=true;if(this.tutStepOnload){_2fa=this.tutStepOnload();}if(_2fa&&this.tutSpecial){dojo.addClass(this._containerNode,"with-special "+this.tutSpecial.bgClass);_2f1.create("div",{"class":"tutorial-special","innerHTML":this.tutSpecial.markup},this._contentNode);}if(_2fa&&this.tutStepBgClass){dojo.addClass(this._containerNode,this.tutStepBgClass);}if(_2fa&&this.tutActions&&this.tutActions.length>0){var _2fb=_2f1.create("ul",{"class":"tutorial-actions"},this._contentNode);for(var i=0;i<this.tutActions.length;i++){var _2fc=this.tutActions[i];var _2fd=null;var _2fe=null;if(_2fc.markup){_2fd="<div class=\"inner\">"+_2fc.markup+"</div>";if(_2fc.extraMarkup){_2fd=_2fd+_2fc.extraMarkup;}else{var _2ff="<i class=\"fonticon-task-round-done default-icon\"></i>";var _300="icon-container";if(_2fc.iconClass){_2ff+="<i class=\""+_2fc.iconClass+"\"></i>";_300+=" with-special-icon";}_2fd="<div class=\""+_300+"\">"+_2ff+"</div>"+_2fd;}_2fe=_2f1.create("li",{"class":"tutorial-action "+(_2fc.extraMarkup?"no-icon":""),"innerHTML":_2fd},_2fb);}this.stepAchievements.push({actionNode:_2fe,checkerFunction:_2fc.getCheckerFunction(),completed:false});}}var _301=null;if(!_2fa){_301=_2f1.create("div",{"class":"tutorial-tip","innerHTML":_2f9("error_on_load_tip")},this._contentNode);}else{if(this.tutTip){_301=_2f1.create("div",{"class":"tutorial-tip","innerHTML":this.tutTip.markup},this._contentNode);if(this.tutTip.bgClass){_2f2.add(_301,this.tutTip.bgClass);}if(this.tutTip.onClickFunction){dojo.query("span.link",_301).connect("onclick",this.tutTip.onClickFunction);}}}if(this.tutButtons&&this.tutButtons.length>0){var _302=_2f1.create("div",{"class":"tutorial-buttons"},this._contentNode);for(var i=0;i<this.tutButtons.length;i++){var _303=this.tutButtons[i];var _304=_2f1.create("span",{"class":_303.cssClass,"innerHTML":_303.label},_302);on(_304,"click",_303.onClickFunction);}}if(this.stepAchievements.length>0){this.startAchievementChecker();}sp.global.analytics.trackEvent("Tutorial",_2fa?"show_step":"show_error",this.tutStepId);},show:function(node){this.contextNode=node;if(this.contextNode){_2f4.around(this.domNode,this.contextNode,[{aroundCorner:"TR",corner:"TR"}]);}else{_2f4.around(this.domNode,dojo.body(),[{aroundCorner:"MM",corner:"MM"}]);}},startAchievementChecker:function(){this.stepAchievementInterval=window.setInterval(dojo.hitch(this,function(){var _305=this._checkAchievements();if(_305){window.clearInterval(this.stepAchievementInterval);if(this.tutActionsNextStep){var _306=this.tutStepId;var _307=this.tutActionsNextStep;setTimeout(function(){dojo.hash("#tutorial="+_307);sp.global.analytics.trackEvent("Tutorial","actions_completed",_306);},1500);}}else{}}),this.stepAchievementIntervalLength);},_checkAchievements:function(){var _308=0;for(var i=0;i<this.stepAchievements.length;i++){var sta=this.stepAchievements[i];if(!sta.completed){var _309=sta.checkerFunction();if(_309){sta.completed=true;if(sta.actionNode){_2f2.add(sta.actionNode,"completed");}}else{_308++;}}}return _308===0;}});});},"cb/page/pad/SequenceOrderingHelper":function(){define(["dojo","wp/data/SequenceHelper"],function(dojo,_30a){return dojo.declare(null,{keyExtractor:function(){return "constant";},constructor:function(_30b){this.keyExtractor=_30b;this._lastMessages={};},isLatestMessage:function(msg){if(!msg.seq){return true;}var key=this._extractKey(msg);if(!key){return true;}var _30c=this._lastMessages[key];if(_30c){if(_30a.isGreaterThan(_30c.seq,msg.seq)){return false;}}_30c[key]=msg;return true;},_extractKey:function(msg){try{var key=this.keyExtractor(msg);if(!key){throw "could not extract key";}return key;}catch(e){console.warn("error extracting key for msg",msg,"using keyExtractor",this.keyExtractor,this,e);return null;}}});});},"wp/widget/ScreenshotDialogContent":function(){define("wp/widget/ScreenshotDialogContent",["dijit","dojo","dojox","dojo/i18n!wp/widget/nls/ScreenshotDialog","dojo/require!sp/dialog/DialogContent,sp/JavaDeployer,sp/err,sp/I18n,sp/I18nWidget,dijit/_Contained"],function(_30d,dojo,_30e){dojo.provide("wp.widget.ScreenshotDialogContent");dojo.require("sp.dialog.DialogContent");dojo.require("sp.JavaDeployer");dojo.require("sp.err");dojo.require("sp.I18n");dojo.require("sp.I18nWidget");dojo.require("dijit._Contained");dojo.requireLocalization("wp.widget","ScreenshotDialog");var _30f=40;dojo.declare("wp.widget.ScreenshotDialogContent",[sp.dialog.DialogContent,sp.I18nWidget,_30d._Contained],{templateString:"<div class=\"dialog-content\">\r\n    <div dojoAttachPoint=\"_messagesContainer\"></div>\r\n    <div class=\"hideBlock import-snap\" dojoAttachPoint=\"_createSnapshotContent\">\r\n        <p class=\"applet-loading appletContainerTextLoading\">${!i18n.screenshotapplet_loading}</p>\r\n        <div class=\"appletContainerTextReady\" style=\"display:none;\">${!i18n.screenshotapplet_ready}</div>\r\n        <div dojoAttachPoint=\"_createSnapshotAppletContainer\">\r\n            <div class=\"installJava errContainer\" style=\"display:none;\">\r\n                <div class=\"message error\">\r\n                    <p class=\"no-space\">${!i18n.nojava_message}</p>\r\n                    <p>\r\n                        <a class=\"installJavaLink button\" href=\"http://java.com/\" style=\"text-decoration:underline;\" title=\"Klicken Sie hier um Java jetzt zu installieren\">\r\n                            <span>\r\n                                ${!i18n.installjava_button} <i class=\"unicode\">&#9658;</i>\r\n                            </span>\r\n                        </a>\r\n                    </p>\r\n                    <p class=\"small\">${!i18n.installjava_nexthint}</p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <p class=\"appletContainerTextProgress applet-loading hideBlock\">${!i18n.screenshotapplet_progress}</p>\r\n        <div class=\"appletContainerTextReady snap-explain hideBlock\">\r\n            <p><strong>${!i18n.screenshotapplet_explain_1}</strong><br/>${!i18n.screenshotapplet_explain_2}</p>\r\n        </div>\r\n        <div class=\"clearer\"></div>\r\n    </div>\r\n    <p class=\"center cancel-container\"><span class=\"link\"  dojoAttachEvent=\"onclick:_cancelClick\">${!i18n.cancel_operation}</span></p>\r\n</div>",dialog:null,documentId:null,documentTitle:null,skipWidgetBundle:true,_importStartedDeferreds:null,_fileIdToUploadIdMap:null,postMixInProperties:function(){this.inherited(arguments);var _310=dojo.mixin({},this.i18n,sp.I18n.bundle("wp.widget","ScreenshotDialog"),true);this.i18n=_310;this._importStartedDeferreds={};this._fileIdToUploadIdMap={};},postCreate:function(){this.inherited("postCreate",arguments);this.err=new sp.err({container:this._messagesContainer});},startup:function(){this.inherited("startup",arguments);this.subscribe("/sp/ajax/incoming/importstarted",function(msg){var def=this._getWaitForImportDeferred(msg.uploadId);if(def.fired===-1){def.callback(msg);}});this.connect(this.dialog,"onHide","_destroyApplet");this._createSnapshot();},_destroyApplet:function(){if(this._createSnapshotApplet){try{if(this._createSnapshotApplet.disposeAllWindows){this._createSnapshotApplet.disposeAllWindows();}}catch(e){}try{this._createSnapshotApplet.stop();}catch(e){}dojo.destroy(this._createSnapshotApplet);dojo.query(".appletContainerTextLoading, .appletContainerTextReady",this.domNode).addClass("hideBlock");this._createSnapshotApplet=null;}},_createSnapshot:function(){sp.global.analytics.trackEvent("board insert","screenshot applet","loading");dojo.removeClass(this._createSnapshotContent,"hideBlock");window.setTimeout(dojo.hitch(this,this.insertApplet),50);},insertApplet:function(){dojo.query(".appletContainerTextLoading",this.domNode).removeClass("hideBlock");dojo.query(".appletContainerTextReady, .appletContainerTextProgress",this.domNode).addClass("hideBlock");var _311=new sp.JavaDeployer(sp.info.user.locale,this._createSnapshotAppletContainer);this.connect(_311,"onAppletStarted",function(_312){dojo.query(".appletContainerTextLoading",this.domNode).addClass("hideBlock");dojo.query(".appletContainerTextReady",this.domNode).removeClass("hideBlock");});this.connect(_311,"onAppletError",function(){var _313,_314;_313=sp.I18n.get("wp.widget","ScreenshotDialog")("upload_applet_error_title");_314=sp.I18n.get("wp.widget","ScreenshotDialog")("upload_applet_error_text");this.err.showMessage("fatal",_314,_313);this.unblockWindow();this._destroyApplet();});this.connect(_311,"onUploadStart",function(){dojo.query(".appletContainerTextReady",this.domNode).addClass("hideBlock");dojo.query(".appletContainerTextProgress",this.domNode).removeClass("hideBlock");});this.connect(_311,"onSuccessfullUpload",function(){dojo.query(".appletContainerTextProgress",this.domNode).addClass("hideBlock");this.onImportSuccessfull();});this.connect(_311,"onAppletShutdown","onAppletShutdown");var _315={name:"ConceptPaste",codebase:"/_/webstart/"+sp.info.app.version,code:"com.parklifetools.conceptpaste.applet.ConceptPasteApplet.class",archive:"conceptpaste-applet.jar",width:1,height:1,mayscript:"true",scriptable:"true"};var _316={"jsessionid":sp.info.user.jsessionid,"serverurl.prefix.https":sp.info.app.serverUrlsForUser.https,"serverhost":sp.info.app.serverhostForUser,"codebase_lookup":"false","noddraw.check":"true","swing.aatext":"true","progressbar":"true","addto":this.documentId,"importPositionX":this.getImportPosition().x,"importPositionY":this.getImportPosition().y,"importZIndex":this.getImportZIndex(),"locale":sp.info.user.locale};var _317="1.5.0";_311.runApplet(_315,_316,_317);this._createSnapshotApplet=this._createSnapshotAppletContainer.lastChild;},_getWaitForImportDeferred:function(_318){if(!this._importStartedDeferreds.hasOwnProperty(_318)){this._importStartedDeferreds[_318]=new dojo.Deferred();}return this._importStartedDeferreds[_318];},getImportPosition:function(){if(sp.global.pad){var _319=sp.global.pad.surface.getPositionForNewImports();return new wp.Point(Math.round(_319.x),Math.round(_319.y));}else{return new wp.Point(0,0);}},getImportZIndex:function(){return sp.global.pad?sp.global.pad.container._itemMap.getNextMaxZ():0;},onImportFailed:function(){this.unblockWindow();},onImportSuccessfull:function(){setTimeout(function(){sp.global.spinInTaskbar();},2000);this.unblockWindow();},onAppletShutdown:function(){},unblockWindow:function(){if(this._windowBlocker){dojo.destroy(this._windowBlocker);this._windowBlocker=null;}}});});},"dojox/html/metrics":function(){define("dojox/html/metrics",["dojo/_base/kernel","dojo/_base/lang","dojo/_base/sniff","dojo/ready","dojo/_base/unload","dojo/_base/window","dojo/dom-geometry"],function(_31a,lang,has,_31b,_31c,_31d,_31e){var dhm=lang.getObject("dojox.html.metrics",true);var _31f=lang.getObject("dojox");dhm.getFontMeasurements=function(){var _320={"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,"small":0,"medium":0,"large":0,"x-large":0,"xx-large":0};if(has("ie")){_31d.doc.documentElement.style.fontSize="100%";}var div=_31d.doc.createElement("div");var ds=div.style;ds.position="absolute";ds.left="-100px";ds.top="0";ds.width="30px";ds.height="1000em";ds.borderWidth="0";ds.margin="0";ds.padding="0";ds.outline="0";ds.lineHeight="1";ds.overflow="hidden";_31d.body().appendChild(div);for(var p in _320){ds.fontSize=p;_320[p]=Math.round(div.offsetHeight*12/16)*16/12/1000;}_31d.body().removeChild(div);div=null;return _320;};var _321=null;dhm.getCachedFontMeasurements=function(_322){if(_322||!_321){_321=dhm.getFontMeasurements();}return _321;};var _323=null,_324={};dhm.getTextBox=function(text,_325,_326){var m,s;if(!_323){m=_323=_31d.doc.createElement("div");var c=_31d.doc.createElement("div");c.appendChild(m);s=c.style;s.overflow="scroll";s.position="absolute";s.left="0px";s.top="-10000px";s.width="1px";s.height="1px";s.visibility="hidden";s.borderWidth="0";s.margin="0";s.padding="0";s.outline="0";_31d.body().appendChild(c);}else{m=_323;}m.className="";s=m.style;s.borderWidth="0";s.margin="0";s.padding="0";s.outline="0";if(arguments.length>1&&_325){for(var i in _325){if(i in _324){continue;}s[i]=_325[i];}}if(arguments.length>2&&_326){m.className=_326;}m.innerHTML=text;var box=_31e.position(m);box.w=m.parentNode.scrollWidth;return box;};var _327={w:16,h:16};dhm.getScrollbar=function(){return {w:_327.w,h:_327.h};};dhm._fontResizeNode=null;dhm.initOnFontResize=function(_328){var f=dhm._fontResizeNode=_31d.doc.createElement("iframe");var fs=f.style;fs.position="absolute";fs.width="5em";fs.height="10em";fs.top="-10000px";fs.display="none";if(has("ie")){f.onreadystatechange=function(){if(f.contentWindow.document.readyState=="complete"){f.onresize=f.contentWindow.parent[_31f._scopeName].html.metrics._fontresize;}};}else{f.onload=function(){f.contentWindow.onresize=f.contentWindow.parent[_31f._scopeName].html.metrics._fontresize;};}f.setAttribute("src","javascript:'<html><head><script>if(\"loadFirebugConsole\" in window){window.loadFirebugConsole();}</script></head><body></body></html>'");_31d.body().appendChild(f);dhm.initOnFontResize=function(){};};dhm.onFontResize=function(){};dhm._fontresize=function(){dhm.onFontResize();};_31c.addOnUnload(function(){var f=dhm._fontResizeNode;if(f){if(has("ie")&&f.onresize){f.onresize=null;}else{if(f.contentWindow&&f.contentWindow.onresize){f.contentWindow.onresize=null;}}dhm._fontResizeNode=null;}});_31b(function(){try{var n=_31d.doc.createElement("div");n.style.cssText="top:0;left:0;width:100px;height:100px;overflow:scroll;position:absolute;visibility:hidden;";_31d.body().appendChild(n);_327.w=n.offsetWidth-n.clientWidth;_327.h=n.offsetHeight-n.clientHeight;_31d.body().removeChild(n);delete n;}catch(e){}if("fontSizeWatch" in _31a.config&&!!_31a.config.fontSizeWatch){dhm.initOnFontResize();}});return dhm;});},"wp/data/item/TxtGItem":function(){define("wp/data/item/TxtGItem",["dijit","dojo","dojox","dojo/require!wp/data/Item"],function(_329,dojo,_32a){dojo.provide("wp.data.item.TxtGItem");dojo.require("wp.data.Item");dojo.declare("wp.data.item.TxtGItem",wp.data.Item,{subtype:null,constructor:function(map){this.type="txtG";this.isWidget=true;if(!this.subtype){if(this.v==="3"){this.subtype="textbox";}else{this.subtype="comment";}}this.minWidth=200;if(this.subtype==="textbox"){this.minWidth=75;}else{if(this.subtype==="note"){this.minWidth=150;}else{if(this.subtype==="headline"){this.minWidth=300;}}}},drawWidget:function(_32b,_32c){_32b.applyId(this.id);_32b.render(this,_32c);},json:function(){return {"type":this.type,"subtype":this.subtype,"del":this.del,"id":this.id,"seq":this.seq,"z":this.z,"v":this.v,"a":this.a,"b":this.b,"lc":this.lc,"fc":this.fc,"fo":this.fo,"lw":this.lw,"ts":this.ts,"ta":this.ta,"tf":this.tf,"tc":this.tc,"authorid":this.authorid,"origAuthorid":this.origAuthorid,"origSeq":this.origSeq,"origDte":this.origDte,"dte":this.dte,"taskStatus":this.taskStatus,"collapse":this.collapse,"outline":this.outline,"orderingKey":this.orderingKey};}});});},"cb/page/pad/FollowAndPresentationManager":function(){define(["dojo","dojox/timing","cb/util","wp/UniqueArray","./ParticipantTracker"],function(dojo,_32d,_32e,_32f,_330){var _331=dojo.declare(null,{_iAmTheModerator:false,_iHaveLiveLocationsOn:false,_userIdsWithLiveLocationsOn:null,_currentModeratorId:null,_viewportSendingTimer:null,_oldTrackingData:null,msgProcessingPaused:true,msgBufferUnsorted:[],constructor:function(){this._iAmTheModerator=false;this._iHaveLiveLocationsOn=false;this._userIdsWithLiveLocationsOn=new _32f();this._currentModeratorId=null;this._oldTrackingData=null;this.documentId=sp.info.document.document.id;this._viewportSendingTimer=new _32d.Timer(300);dojo.connect(this._viewportSendingTimer,"onStop",this,"onViewportSendingStopped");dojo.connect(this._viewportSendingTimer,"onTick",this,"onViewportSendingRequired");dojo.subscribe("/sp/ajax/connectivityStatus",this,function(_332){if(_332==="FULLY-INITIATED"){setTimeout(dojo.hitch(this,function(){this.msgProcessingPaused=false;if(this.msgBufferUnsorted.length>0){var _333=this.msgBufferUnsorted.sort(function(a,b){return (new Date(a.dte)-new Date(b.dte));});var _334=null;var _335={};for(var i=0;i<_333.length;i++){var msg=_333[i];if(msg.type==="moderation"){_334=msg;}else{if(msg.type==="livelocations"){_335[msg.userid]=msg;}else{if(msg.type==="viewport"){}}}}if(_334){this._handleMessage(_334);}dojo.forEach(dojox.lang.functional.keys(_335),function(id){this._handleMessage(_335[id]);},this);}}),500);}});dojo.subscribe("/sp/ajax/incoming/livelocations",this,this._bufferOrHandleMessage);dojo.subscribe("/sp/ajax/incoming/moderation",this,this._bufferOrHandleMessage);dojo.subscribe("/sp/ajax/incoming/viewport",this,this._bufferOrHandleMessage);dojo.connect(_330,"onUserRemoved",this,function(_336){this._removeUserFromListWithLiveLocationsOnAndStopSendingIfNeeded(_336);});},onAnyModerationStarted:function(){sp.global.analytics.trackEvent("board conference","moderation start",_330.getUsers().length);},onAnyModerationStopped:function(_337){sp.global.analytics.trackEvent("board conference","moderation stop",_330.getUsers().length);},onOwnLiveLocationsTurnedOn:function(){sp.global.analytics.trackEvent("board conference","live locations on",_330.getUsers().length);},onOwnLiveLocationsTurnedOff:function(){sp.global.analytics.trackEvent("board conference","live locations off",_330.getUsers().length);},onViewportSendingRequired:function(_338){},onViewportSendingStopped:function(){},turnLiveLocationsOn:function(){if(!this._iHaveLiveLocationsOn){sp.ajax.getInstance().publishItem({type:"livelocations",command:"start",userid:sp.info.user.id},this.documentId);this._iHaveLiveLocationsOn=true;this.onOwnLiveLocationsTurnedOn();}},turnLiveLocationsOff:function(){if(this._iHaveLiveLocationsOn){sp.ajax.getInstance().publishItem({type:"livelocations",command:"stop",userid:sp.info.user.id},this.documentId);this._iHaveLiveLocationsOn=false;this.onOwnLiveLocationsTurnedOff();}},turnModerationOn:function(_339){if(!this._iAmTheModerator){this._removeModeratorAndStopFollowingIfNeeded();if(!_339){sp.ajax.getInstance().publishItem({type:"moderation",command:"start",userid:sp.info.user.id},this.documentId);}this._iAmTheModerator=true;this._currentModeratorId=sp.info.user.id;this.onAnyModerationStarted();this._startViewportSending();}},turnModerationOff:function(_33a){if(this._iAmTheModerator){var _33b=this._currentModeratorId;if(!_33a){sp.ajax.getInstance().publishItem({type:"moderation",command:"stop",userid:sp.info.user.id},this.documentId);}this._iAmTheModerator=false;this._currentModeratorId=null;if(_33b){this.onAnyModerationStopped(_33b);}if(this._userIdsWithLiveLocationsOn.getLength()===0){this._stopViewportSending();}}},isLiveLocationsOn:function(){return this._iHaveLiveLocationsOn;},isModeratorModeOn:function(){return this._iAmTheModerator;},isSendingViewports:function(){return this._viewportSendingTimer.isRunning;},getCurrentModeratorId:function(){return this._currentModeratorId;},_bufferOrHandleMessage:function(msg){if(this.msgProcessingPaused){this.msgBufferUnsorted.push(msg);}else{_32e.wrapDefer(this._handleMessage(msg));}},_handleMessage:function(msg){switch(msg.type){case "viewport":dojo.publish("requests/cb/board/followviewport",[msg]);break;case "livelocations":this._handleLiveLocationsMessage(msg);break;case "moderation":this._handleModerationMessage(msg);break;}},_handleLiveLocationsMessage:function(msg){if(msg.authorid===sp.info.user.id){return;}if(msg.userid===sp.info.user.id){return msg.command==="start"?this.turnLiveLocationsOn(true):this.turnLiveLocationsOff(true);}if(msg.command==="start"){this._addUserToListWithLiveLocationsOnAndStartSendingIfNeeded(msg.userid);}else{if(msg.command==="stop"){this._removeUserFromListWithLiveLocationsOnAndStopSendingIfNeeded(msg.userid);}}},_handleModerationMessage:function(msg){if(msg.authorid===sp.info.user.id){return;}if(msg.userid===sp.info.user.id){return msg.command==="start"?this.turnModerationOn(true):this.turnModerationOff(true);}if(msg.command==="start"){this._setNewModeratorAndStartFollowingIfNeeded(msg.userid);}else{if(msg.command==="stop"){this._removeModeratorAndStopFollowingIfNeeded(msg.userid);}}},_addUserToListWithLiveLocationsOnAndStartSendingIfNeeded:function(_33c){if(sp.info.user.id===_33c){return;}if(_330.isUserPresent(_33c)){this._userIdsWithLiveLocationsOn.push(_33c);this._startViewportSending();}},_removeUserFromListWithLiveLocationsOnAndStopSendingIfNeeded:function(_33d){if(sp.info.user.id===_33d){return;}if(_33d===this._currentModeratorId){this._userIdsWithLiveLocationsOn.del(_33d);if(this._userIdsWithLiveLocationsOn.getLength()===0&&!this._iAmTheModerator){this._stopViewportSending();}}},_setNewModeratorAndStartFollowingIfNeeded:function(_33e){if(sp.info.user.id===_33e){return;}if(_330.isUserPresent(_33e)){if(this._iAmTheModerator){this.turnModerationOff(true);}this._currentModeratorId=_33e;this.onAnyModerationStarted();}},_removeModeratorAndStopFollowingIfNeeded:function(){var _33f=this._currentModeratorId;this._currentModeratorId=null;if(_33f){this.onAnyModerationStopped(_33f);}},_startViewportSending:function(){if(!this._viewportSendingTimer.isRunning){this._viewportSendingTimer.start();}this.onViewportSendingRequired(true);},_stopViewportSending:function(){this._viewportSendingTimer.stop();}});return new _331();});},"cb/videochat/VideoChatManager":function(){define(["dojo","dojo/ready","dojo/aspect","dojo/when","dojo/_base/lang","dojo/Deferred","dojo/DeferredList","dojo/Stateful","sp/ajax/AjaxEngine","cb/Capabilities","dojox/lang/functional"],function(dojo,_340,_341,when,lang,_342,_343,_344,_345,_346,_347){var _348=6;var _349=dojo.declare([_344],{currentListeners:null,cancreatestreamMode:"activate",_numberOfConnectedClients:0,_publishingStartTime:null,CONNECT_TIMEOUT:60000,_available:false,constructor:function(){this._sessionConnectErrorHandler=dojo.hitch(this,this._sessionConnectErrorHandler);this.currentListeners={};this._enabledDeferred=_346.checkVideoChat();this._setupDeferred=new _342();this._initDeferred=new _342();this._sessionConnectedDef=new _342();this._publishingDef=new _343([this._setupDeferred,this._initDeferred,this._sessionConnectedDef],false,true,true);this._publishingDef.then(function(){},dojo.hitch(this,function(e){console.warn("videochatsetup failed",e);this._available=false;}));_341.before(this,"onStreamCreated",dojo.hitch(this,function(_34a){this.currentListeners[_34a]=true;}),true);_341.before(this,"onStreamDestroyed",dojo.hitch(this,function(_34b){delete this.currentListeners[_34b];}),true);var _34c=dojo.hitch(this,"_updateCancreatestreamMode");_341.after(this,"onStreamCreated",_34c,true);_341.after(this,"onStreamDestroyed",_34c,true);_341.after(this,"onPublisherCreated",_34c,true);_341.after(this,"onPublisherDestroyed",_34c,true);},setup:function(args){if(this.session){return;}this._enabledDeferred.then(dojo.hitch(this,function(_34d){if(_34d!=="disabled"){this._available=TB.checkSystemRequirements()!==0;if(!this._available){this._setupDeferred.reject({msg:"system requirements not met",log:false});}else{_345.getTokboxToken({documentId:args.documentId}).then(dojo.hitch(this,function(_34e){if(_34e.tokboxdata.success){dojo.mixin(this,args);this.apiKey=_34e.tokboxdata.apiKey;this.sessionId=_34e.tokboxdata.sessionId;this.token=_34e.tokboxdata.token;this._setupDeferred.resolve(_34e.tokboxdata);sp.global.analytics.trackEvent("board conference","video chat available","",null,true);}else{this._setupDeferred.reject({tokboxresult:_34e.tokboxdata,log:false});}}),dojo.hitch(this,function(_34f){this._setupDeferred.reject("tokboxtoken not available");}));}}else{this._setupDeferred.reject({msg:"videochat not available",log:false});}}));},publisherAddedHandler:function(){},streamAddedHandler:function(){},_sessionConnectErrorHandler:function(msg){if(!this._sessionConnectedDef.isResolved()){this._sessionConnectedDef.reject({msg:"could not connect",log:false});}},init:function(args){if(this.session){return;}this._setupDeferred.then(dojo.hitch(this,function(){_340(dojo.hitch(this,function(){window.setTimeout(dojo.hitch(this,function(){TB.setLogLevel(TB.DEBUG);TB.addEventListener("exception",this._sessionConnectErrorHandler);this.session=TB.initSession(this.sessionId);this.session.addEventListener("sessionConnected",dojo.hitch(this,"_sessionConnectedEventHandler"));this.session.addEventListener("connectionCreated",dojo.hitch(this,"_connectionCreatedEventHandler"));this.session.addEventListener("connectionDestroyed",dojo.hitch(this,"_connectionDestroyedEventHandler"));this.session.addEventListener("streamCreated",dojo.hitch(this,"_streamCreatedEventHandler"));this.session.addEventListener("streamDestroyed",dojo.hitch(this,"_streamDestroyedEventHandler"));this._sessionConnectTimeout=window.setTimeout(dojo.hitch(this,function(){if(!this._sessionConnectedDef.isResolved()){this._sessionConnectedDef.reject({msg:"connect timed out ",log:false});}}),this.CONNECT_TIMEOUT);this.session.connect(this.apiKey,this.token);this._initDeferred.resolve(true);}),100);}));}));},publish:function(){if(this.publisher){return true;}return this._publishingDef.then(dojo.hitch(this,"_createPublisherRepresentation"));},unpublish:function(){if(!this.publisher){return true;}return this._publishingDef.then(dojo.hitch(this,"_destroyPublisherRepresentation"));},isPublishing:function(){return !!this.publisher;},togglePublish:function(){this._publishingDef.then(dojo.hitch(this,function(){if(this.isPublishing()){return this.unpublish();}else{return this.publish();}}));},onStreamCreated:function(_350){},onStreamDestroyed:function(_351){},onPublisherCreated:function(){this._publishingStartTime=new Date().getTime();sp.global.analytics.trackEvent("board conference","video chat sending start",this._numberOfConnectedClients);},onPublisherDestroyed:function(){sp.global.analytics.trackEvent("board conference","video chat sending stop",this._numberOfConnectedClients);if(this._publishingStartTime){var _352=new Date().getTime()-this._publishingStartTime;sp.global.analytics.trackTiming("board conference","video chat sent",null,_352);}this._publishingStartTime=null;},_sessionConnectedEventHandler:function(_353){TB.removeEventListener("exception",this._sessionConnectErrorHandler);window.clearTimeout(this._sessionConnectTimeout);this._available=true;this._sessionConnectedDef.resolve(true);this._createStreamRepresentation(_353.streams);this._numberOfConnectedClients=_353.connections?_353.connections.length:0;},_connectionCreatedEventHandler:function(_354){this._numberOfConnectedClients++;},_connectionDestroyedEventHandler:function(_355){this._numberOfConnectedClients--;},_streamCreatedEventHandler:function(_356){this._createStreamRepresentation(_356.streams);},_streamDestroyedEventHandler:function(_357){dojo.forEach(_357.streams,function(_358){if(_358.connection.connectionId==this.session.connection.connectionId){return;}this.onStreamDestroyed(_358.streamId);},this);},_createPublisherRepresentation:function(){var res=this.publisherAddedHandler({userid:sp.info.user.id,name:sp.info.user.info.displayname});var _359=res.widget;this.publisher=this.session.publish(res.domId,{height:res.height,width:res.width,name:sp.info.user.info.displayname,backgroundImageURI:"https://conceptboard.com/__/userphoto/"+sp.info.user.info.id+".png",wmode:"window"});this.publisher.addEventListener("resize",function(_35a){_359.resize({w:_35a.widthTo,h:_35a.heightTo});});this.onPublisherCreated();},_createStreamRepresentation:function(_35b){dojo.forEach(_35b,function(_35c){if(_35c.connection.connectionId==this.session.connection.connectionId){return;}var _35d=dojo.toJson(_35c.connection.data);var res=this.streamAddedHandler({id:_35c.streamId,name:_35c.name,userid:_35d.userid});this.session.subscribe(_35c,res.domId,{height:res.height,width:res.width,backgroundImageURI:"https://conceptboard.com/__/userphoto/"+_35d.userid+".png",wmode:"window"});this.onStreamCreated(_35c.streamId);},this);},_destroyPublisherRepresentation:function(){this.session.unpublish(this.publisher);this.publisher=null;this.onPublisherDestroyed();},isAvailable:function(){return when(this._publishingDef).always(lang.hitch(this,function(){return this._available;}));},_currentListenersCountGetter:function(){return _347.keys(this.currentListeners).length;},_numberofstreamsGetter:function(){return this.get("currentListenersCount")+(this.isPublishing()?1:0);},_numberofmaxstreamsGetter:function(){return _348;},_additionalusersallowedGetter:function(){return this.get("numberofstreams")<_348;},_updateCancreatestreamMode:function(){if(this.isPublishing()){this.set("cancreatestreamMode","deactivate");}else{if(this.get("additionalusersallowed")){this.set("cancreatestreamMode","activate");}else{this.set("cancreatestreamMode","activationlimited");}}}});var _35e=new _349();_340(function(){_35e.setup({documentId:sp.info.document.document.id});});return _35e;});},"cb/board/conference/ChatInput":function(){define(["dojo","dojo/on","dojo/dom-class","dojo/keys","dijit/form/SimpleTextarea"],function(dojo,on,_35f,keys,_360){return dojo.declare([_360],{baseClass:"chat-input",buildRendering:function(){this.inherited(arguments);_35f.add(this.focusNode,"full-width");on(this.focusNode,"paste",function(evt){evt.stopPropagation();});},_onInput:function(e){this.inherited(arguments);if(e.keyCode==keys.ESCAPE&&!(e.ctrlKey||e.altKey||e.metaKey)){this.reset();}if(e.keyCode==keys.ENTER&&!(e.ctrlKey||e.altKey||e.metaKey)){this._setValueAttr(this.get("value"),true);}},_setBlurValue:function(){}});});},"cb/board/conference/ChatContainer":function(){define(["dojo","dojo/_base/declare","dojo/_base/lang","dojo/aspect","dojo/on","dojo/dom-class","dojo/dom-construct","dojo/html","dojo/query","dijit/_Widget","cb/board/conference/Chat","cb/util","sp/I18n","dojo/i18n!../nls/Messages"],function(dojo,_361,lang,_362,on,_363,_364,_365,_366,_367,Chat,_368,_369,i18n){var _36a=_369.wrap(i18n);return _361([_367],{baseClass:"chat-container",open:false,toggledManuallyOnce:false,postCreate:function(){this.inherited(arguments);this._chatToggler=_364.create("div",{"innerHTML":"<i class=\"fonticon-chat\"></i>"+_36a("chat_label")+" ","class":"chat-toggler"},this.domNode);this._msgNumber=_364.create("span",{},this._chatToggler);this._unreadMsgHintContainer=_364.create("span",{"title":_36a("chat_new_messages"),"class":"unread-msg-hint hideBlock"},this._chatToggler);_364.create("span",{"innerHTML":"&mdash;","class":"toggle"},this._chatToggler);this.own(on(this._chatToggler,"click",lang.hitch(this,function(e){this.set("open",!this.get("open"));this.toggledManuallyOnce=true;this._updateUnreadMsgHint();})));this._chat=new Chat({documentId:sp.info.document.id},dojo.create("div",null,this.domNode));this.own(_362.after(this._chat,"onAddOrUpdatedMessage",_368.debounce(lang.hitch(this,function(_36b){if(_36b.msg.type==="chat"){var _36c=!_36b.msg.del&&(!sp.info.padConfig.lastVisited||new Date(_36b.timestamp)>sp.info.padConfig.lastVisited);if(_36c&&!this.toggledManuallyOnce){this.set("open",true);dojo.publish("/cb/board/panes/footer/open");}this._updateMsgNumber();this._updateUnreadMsgHint(_36c);}}),150),true));},_setOpenAttr:function(open){var _36d=this.get("open");open=!!open;this._set("open",open);_363.toggle(this.domNode,"open",open);if(open&&!_36d){this._chat.scrollToLatest();}},_updateMsgNumber:function(){var _36e=this._chat.getNumberOfUndeletedMessages();this._msgNumber.innerHTML=_36e>0?("("+_369.esc(_36e)+")"):"";},_updateUnreadMsgHint:function(_36f){_366(this._unreadMsgHintContainer).children().orphan();if(!this.open&&_36f){_364.create("div",{"class":"animated-dot"},this._unreadMsgHintContainer);_363.remove(this._unreadMsgHintContainer,"hideBlock");}else{_363.add(this._unreadMsgHintContainer,"hideBlock");}}});});},"wp/data/item/TemporaryItem":function(){define("wp/data/item/TemporaryItem",["dijit","dojo","dojox","dojo/require!wp/data/Item"],function(_370,dojo,_371){dojo.provide("wp.data.item.TemporaryItem");dojo.require("wp.data.Item");dojo.declare("wp.data.item.TemporaryItem",wp.data.Item,{subtype:null,constructor:function(map){this.type="temporary";this.isWidget=true;}});});},"dojo/dnd/Manager":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/lang","../_base/window","../dom-class","../Evented","../has","../keys","../on","../topic","../touch","./common","./autoscroll","./Avatar"],function(_372,_373,_374,lang,win,_375,_376,has,keys,on,_377,_378,dnd,_379,_37a){var _37b=_373("dojo.dnd.Manager",[_376],{constructor:function(){this.avatar=null;this.source=null;this.nodes=[];this.copy=true;this.target=null;this.canDropFlag=false;this.events=[];},OFFSET_X:has("touch")?0:16,OFFSET_Y:has("touch")?-64:16,overSource:function(_37c){if(this.avatar){this.target=(_37c&&_37c.targetState!="Disabled")?_37c:null;this.canDropFlag=Boolean(this.target);this.avatar.update();}_377.publish("/dnd/source/over",_37c);},outSource:function(_37d){if(this.avatar){if(this.target==_37d){this.target=null;this.canDropFlag=false;this.avatar.update();_377.publish("/dnd/source/over",null);}}else{_377.publish("/dnd/source/over",null);}},startDrag:function(_37e,_37f,copy){_379.autoScrollStart(win.doc);this.source=_37e;this.nodes=_37f;this.copy=Boolean(copy);this.avatar=this.makeAvatar();win.body().appendChild(this.avatar.node);_377.publish("/dnd/start",_37e,_37f,this.copy);this.events=[on(win.doc,_378.move,lang.hitch(this,"onMouseMove")),on(win.doc,_378.release,lang.hitch(this,"onMouseUp")),on(win.doc,"keydown",lang.hitch(this,"onKeyDown")),on(win.doc,"keyup",lang.hitch(this,"onKeyUp")),on(win.doc,"dragstart",_374.stop),on(win.body(),"selectstart",_374.stop)];var c="dojoDnd"+(copy?"Copy":"Move");_375.add(win.body(),c);},canDrop:function(flag){var _380=Boolean(this.target&&flag);if(this.canDropFlag!=_380){this.canDropFlag=_380;this.avatar.update();}},stopDrag:function(){_375.remove(win.body(),["dojoDndCopy","dojoDndMove"]);_372.forEach(this.events,function(_381){_381.remove();});this.events=[];this.avatar.destroy();this.avatar=null;this.source=this.target=null;this.nodes=[];},makeAvatar:function(){return new _37a(this);},updateAvatar:function(){this.avatar.update();},onMouseMove:function(e){var a=this.avatar;if(a){_379.autoScrollNodes(e);var s=a.node.style;s.left=(e.pageX+this.OFFSET_X)+"px";s.top=(e.pageY+this.OFFSET_Y)+"px";var copy=Boolean(this.source.copyState(dnd.getCopyKeyState(e)));if(this.copy!=copy){this._setCopyStatus(copy);}}if(has("touch")){e.preventDefault();}},onMouseUp:function(e){if(this.avatar){if(this.target&&this.canDropFlag){var copy=Boolean(this.source.copyState(dnd.getCopyKeyState(e)));_377.publish("/dnd/drop/before",this.source,this.nodes,copy,this.target,e);_377.publish("/dnd/drop",this.source,this.nodes,copy,this.target,e);}else{_377.publish("/dnd/cancel");}this.stopDrag();}},onKeyDown:function(e){if(this.avatar){switch(e.keyCode){case keys.CTRL:var copy=Boolean(this.source.copyState(true));if(this.copy!=copy){this._setCopyStatus(copy);}break;case keys.ESCAPE:_377.publish("/dnd/cancel");this.stopDrag();break;}}},onKeyUp:function(e){if(this.avatar&&e.keyCode==keys.CTRL){var copy=Boolean(this.source.copyState(false));if(this.copy!=copy){this._setCopyStatus(copy);}}},_setCopyStatus:function(copy){this.copy=copy;this.source._markDndStatus(this.copy);this.updateAvatar();_375.replace(win.body(),"dojoDnd"+(this.copy?"Copy":"Move"),"dojoDnd"+(this.copy?"Move":"Copy"));}});dnd._manager=null;_37b.manager=dnd.manager=function(){if(!dnd._manager){dnd._manager=new _37b();}return dnd._manager;};return _37b;});},"dijit/form/Textarea":function(){define(["dojo/_base/declare","dojo/dom-style","./_ExpandingTextAreaMixin","./SimpleTextarea"],function(_382,_383,_384,_385){return _382("dijit.form.Textarea",[_385,_384],{baseClass:"dijitTextBox dijitTextArea dijitExpandingTextArea",cols:"",buildRendering:function(){this.inherited(arguments);_383.set(this.textbox,{overflowY:"hidden",overflowX:"auto",boxSizing:"border-box",MsBoxSizing:"border-box",WebkitBoxSizing:"border-box",MozBoxSizing:"border-box"});}});});},"dojox/html/ext-dojo/style":function(){define("dojox/html/ext-dojo/style",["dojo/_base/kernel","dojo/dom-style","dojo/_base/lang","dojo/_base/html","dojo/_base/sniff","dojo/_base/window","dojo/dom","dojo/dom-construct","dojo/dom-style","dojo/dom-attr"],function(_386,_387,lang,Html,has,win,DOM,_388,_389,_38a){_386.experimental("dojox.html.ext-dojo.style");var st=lang.getObject("dojox.html.ext-dojo.style",true);var _38b=lang.getObject("dojox.html");lang.mixin(_38b["ext-dojo"].style,{supportsTransform:true,_toPx:function(_38c){var ds=Html.style,_38d=this._conversion;if(typeof _38c==="number"){return _38c+"px";}else{if(_38c.toLowerCase().indexOf("px")!=-1){return _38c;}}!_38d.parentNode&&_388.place(_38d,win.body());ds(_38d,"margin",_38c);return ds(_38d,"margin");},init:function(){var _38e=win.doc.documentElement.style,_38f=_38b["ext-dojo"].style,sget=_389.get,sset=_389.set;_389.get=function(node,name){var tr=(name=="transform"),to=(name=="transformOrigin");if(tr){return _38f.getTransform(node);}else{if(to){return _38f.getTransformOrigin(node);}else{return arguments.length==2?sget(node,name):sget(node);}}};_389.set=function(node,name,_390){var tr=(name=="transform"),to=(name=="transformOrigin"),n=DOM.byId(node);if(tr){return _38f.setTransform(n,_390,true);}else{if(to){return _38f.setTransformOrigin(n,_390);}else{return arguments.length==3?sset(n,name,_390):sset(n,name);}}};for(var i=0,_391=["WebkitT","MozT","OT","msT","t"];i<_391.length;i++){if(typeof _38e[_391[i]+"ransform"]!=="undefined"){this.tPropertyName=_391[i]+"ransform";}if(typeof _38e[_391[i]+"ransformOrigin"]!=="undefined"){this.toPropertyName=_391[i]+"ransformOrigin";}}if(this.tPropertyName){this.setTransform=function(node,_392){return _389.set(node,this.tPropertyName,_392);};this.getTransform=function(node){return _389.get(node,this.tPropertyName);};}else{if(has("ie")){this.setTransform=this._setTransformFilter;this.getTransform=this._getTransformFilter;}}if(this.toPropertyName){this.setTransformOrigin=function(node,_393){return sset(node,this.toPropertyName,_393);};this.getTransformOrigin=function(node){return sget(node,this.toPropertyName);};}else{if(has("ie")){this.setTransformOrigin=this._setTransformOriginFilter;this.getTransformOrigin=this._getTransformOriginFilter;}else{this.supportsTransform=false;}}this._conversion=_388.create("div",{style:{position:"absolute",top:"-100px",left:"-100px",fontSize:0,width:"0",backgroundPosition:"50% 50%"}});},_notSupported:function(){console.warn("Sorry, this browser doesn't support transform and transform-origin");},_setTransformOriginFilter:function(node,_394){var to=lang.trim(_394).replace(" top"," 0").replace("left ","0 ").replace(" center","50%").replace("center ","50% ").replace(" bottom"," 100%").replace("right ","100% ").replace(/\s+/," "),_395=to.split(" "),n=DOM.byId(node),t=this.getTransform(n),_396=true;for(var i=0;i<_395.length;i++){_396=_396&&/^0|(\d+(%|px|pt|in|pc|mm|cm))$/.test(_395[i]);if(_395[i].indexOf("%")==-1){_395[i]=this._toPx(_395[i]);}}if(!_396||!_395.length||_395.length>2){return _394;}Html.attr(n,"dojo-transform-origin",_395.join(" "));t&&this.setTransform(node,t);return _394;},_getTransformOriginFilter:function(node){return Html.attr(node,"dojo-transform-origin")||"50% 50%";},_setTransformFilter:function(node,_397){var t=_397.replace(/\s/g,""),n=DOM.byId(node),_398=t.split(")"),_399=1,_39a=1,mstr="DXImageTransform.Microsoft.Matrix",_39b=_38a.has,attr=Html.attr,PI=Math.PI,cos=Math.cos,sin=Math.sin,tan=Math.tan,max=Math.max,min=Math.min,abs=Math.abs,_39c=PI/180,_39d=PI/200,ct="",_39e="",_39f=[],x0=0,y0=0,dx=0,dy=0,xc=0,yc=0,a=0,m11=1,m12=0,m21=0,m22=1,tx=0,ty=0,_3a0=[m11,m12,m21,m22,tx,ty],_3a1=false,ds=Html.style,_3a2=ds(n,"position")=="absolute"?"absolute":"relative",w=ds(n,"width")+ds(n,"paddingLeft")+ds(n,"paddingRight"),h=ds(n,"height")+ds(n,"paddingTop")+ds(n,"paddingBottom"),toPx=this._toPx;!_39b(n,"dojo-transform-origin")&&this.setTransformOrigin(n,"50% 50%");for(var i=0,l=_398.length;i<l;i++){_39f=_398[i].match(/matrix|rotate|scaleX|scaleY|scale|skewX|skewY|skew|translateX|translateY|translate/);_39e=_39f?_39f[0]:"";switch(_39e){case "matrix":ct=_398[i].replace(/matrix\(|\)/g,"");var _3a3=ct.split(",");m11=_3a0[0]*_3a3[0]+_3a0[1]*_3a3[2];m12=_3a0[0]*_3a3[1]+_3a0[1]*_3a3[3];m21=_3a0[2]*_3a3[0]+_3a0[3]*_3a3[2];m22=_3a0[2]*_3a3[1]+_3a0[3]*_3a3[3];tx=_3a0[4]+_3a3[4];ty=_3a0[5]+_3a3[5];break;case "rotate":ct=_398[i].replace(/rotate\(|\)/g,"");_399=ct.indexOf("deg")!=-1?_39c:ct.indexOf("grad")!=-1?_39d:1;a=parseFloat(ct)*_399;var s=sin(a),c=cos(a);m11=_3a0[0]*c+_3a0[1]*s;m12=-_3a0[0]*s+_3a0[1]*c;m21=_3a0[2]*c+_3a0[3]*s;m22=-_3a0[2]*s+_3a0[3]*c;break;case "skewX":ct=_398[i].replace(/skewX\(|\)/g,"");_399=ct.indexOf("deg")!=-1?_39c:ct.indexOf("grad")!=-1?_39d:1;var ta=tan(parseFloat(ct)*_399);m11=_3a0[0];m12=_3a0[0]*ta+_3a0[1];m21=_3a0[2];m22=_3a0[2]*ta+_3a0[3];break;case "skewY":ct=_398[i].replace(/skewY\(|\)/g,"");_399=ct.indexOf("deg")!=-1?_39c:ct.indexOf("grad")!=-1?_39d:1;ta=tan(parseFloat(ct)*_399);m11=_3a0[0]+_3a0[1]*ta;m12=_3a0[1];m21=_3a0[2]+_3a0[3]*ta;m22=_3a0[3];break;case "skew":ct=_398[i].replace(/skew\(|\)/g,"");var _3a4=ct.split(",");_3a4[1]=_3a4[1]||"0";_399=_3a4[0].indexOf("deg")!=-1?_39c:_3a4[0].indexOf("grad")!=-1?_39d:1;_39a=_3a4[1].indexOf("deg")!=-1?_39c:_3a4[1].indexOf("grad")!=-1?_39d:1;var a0=tan(parseFloat(_3a4[0])*_399),a1=tan(parseFloat(_3a4[1])*_39a);m11=_3a0[0]+_3a0[1]*a1;m12=_3a0[0]*a0+_3a0[1];m21=_3a0[2]+_3a0[3]*a1;m22=_3a0[2]*a0+_3a0[3];break;case "scaleX":ct=parseFloat(_398[i].replace(/scaleX\(|\)/g,""))||1;m11=_3a0[0]*ct;m12=_3a0[1];m21=_3a0[2]*ct;m22=_3a0[3];break;case "scaleY":ct=parseFloat(_398[i].replace(/scaleY\(|\)/g,""))||1;m11=_3a0[0];m12=_3a0[1]*ct;m21=_3a0[2];m22=_3a0[3]*ct;break;case "scale":ct=_398[i].replace(/scale\(|\)/g,"");var _3a5=ct.split(",");_3a5[1]=_3a5[1]||_3a5[0];m11=_3a0[0]*_3a5[0];m12=_3a0[1]*_3a5[1];m21=_3a0[2]*_3a5[0];m22=_3a0[3]*_3a5[1];break;case "translateX":ct=parseInt(_398[i].replace(/translateX\(|\)/g,""))||1;m11=_3a0[0];m12=_3a0[1];m21=_3a0[2];m22=_3a0[3];tx=toPx(ct);tx&&attr(n,"dojo-transform-matrix-tx",tx);break;case "translateY":ct=parseInt(_398[i].replace(/translateY\(|\)/g,""))||1;m11=_3a0[0];m12=_3a0[1];m21=_3a0[2];m22=_3a0[3];ty=toPx(ct);ty&&attr(n,"dojo-transform-matrix-ty",ty);break;case "translate":ct=_398[i].replace(/translate\(|\)/g,"");m11=_3a0[0];m12=_3a0[1];m21=_3a0[2];m22=_3a0[3];var _3a6=ct.split(",");_3a6[0]=parseInt(toPx(_3a6[0]))||0;_3a6[1]=parseInt(toPx(_3a6[1]))||0;tx=_3a6[0];ty=_3a6[1];tx&&attr(n,"dojo-transform-matrix-tx",tx);ty&&attr(n,"dojo-transform-matrix-ty",ty);break;}_3a0=[m11,m12,m21,m22,tx,ty];}var Bx=min(w*m11+h*m12,min(min(w*m11,h*m12),0)),By=min(w*m21+h*m22,min(min(w*m21,h*m22),0));dx=-Bx;dy=-By;if(has("ie")<8){n.style.zoom="1";if(_3a2!="absolute"){var _3a7=ds(node.parentNode,"width"),tw=abs(w*m11),th=abs(h*m12),wMax=max(tw+th,max(max(th,tw),0));dx-=(wMax-w)/2-(_3a7>wMax?0:(wMax-_3a7)/2);}}else{if(has("ie")==8){ds(n,"zIndex")=="auto"&&(n.style.zIndex="0");}}try{_3a1=!!n.filters.item(mstr);}catch(e){_3a1=false;}if(_3a1){n.filters.item(mstr).M11=m11;n.filters.item(mstr).M12=m12;n.filters.item(mstr).M21=m21;n.filters.item(mstr).M22=m22;n.filters.item(mstr).filterType="bilinear";n.filters.item(mstr).Dx=0;n.filters.item(mstr).Dy=0;n.filters.item(mstr).sizingMethod="auto expand";}else{n.style.filter+=" progid:"+mstr+"(M11="+m11+",M12="+m12+",M21="+m21+",M22="+m22+",FilterType='bilinear',Dx=0,Dy=0,sizingMethod='auto expand')";}tx=parseInt(attr(n,"dojo-transform-matrix-tx")||"0");ty=parseInt(attr(n,"dojo-transform-matrix-ty")||"0");var _3a8=attr(n,"dojo-transform-origin").split(" ");for(i=0;i<2;i++){_3a8[i]=_3a8[i]||"50%";}xc=(_3a8[0].toString().indexOf("%")!=-1)?w*parseInt(_3a8[0])*0.01:_3a8[0];yc=(_3a8[1].toString().indexOf("%")!=-1)?h*parseInt(_3a8[1])*0.01:_3a8[1];if(_39b(n,"dojo-startX")){x0=parseInt(attr(n,"dojo-startX"));}else{x0=parseInt(ds(n,"left"));attr(n,"dojo-startX",_3a2=="absolute"?x0:"0");}if(_39b(n,"dojo-startY")){y0=parseInt(attr(n,"dojo-startY"));}else{y0=parseInt(ds(n,"top"));attr(n,"dojo-startY",_3a2=="absolute"?y0:"0");}ds(n,{position:_3a2,left:x0-parseInt(dx)+parseInt(xc)-((parseInt(xc)-tx)*m11+(parseInt(yc)-ty)*m12)+"px",top:y0-parseInt(dy)+parseInt(yc)-((parseInt(xc)-tx)*m21+(parseInt(yc)-ty)*m22)+"px"});return _397;},_getTransformFilter:function(node){try{var n=DOM.byId(node),item=n.filters.item(0);return "matrix("+item.M11+", "+item.M12+", "+item.M21+", "+item.M22+", "+(Html.attr(node,"dojo-transform-tx")||"0")+", "+(Html.attr(node,"dojo-transform-ty")||"0")+")";}catch(e){return "matrix(1, 0, 0, 1, 0, 0)";}},setTransform:function(){this._notSupported();},setTransformOrigin:function(){this._notSupported();}});_38b["ext-dojo"].style.init();return Html.style;});},"dojox/gfx/_base":function(){define("dojox/gfx/_base",["dojo/_base/kernel","dojo/_base/lang","dojo/_base/Color","dojo/_base/sniff","dojo/_base/window","dojo/_base/array","dojo/dom","dojo/dom-construct","dojo/dom-geometry"],function(_3a9,lang,_3aa,has,win,arr,dom,_3ab,_3ac){var g=lang.getObject("dojox.gfx",true),b=g._base={};g._hasClass=function(node,_3ad){var cls=node.getAttribute("className");return cls&&(" "+cls+" ").indexOf(" "+_3ad+" ")>=0;};g._addClass=function(node,_3ae){var cls=node.getAttribute("className")||"";if(!cls||(" "+cls+" ").indexOf(" "+_3ae+" ")<0){node.setAttribute("className",cls+(cls?" ":"")+_3ae);}};g._removeClass=function(node,_3af){var cls=node.getAttribute("className");if(cls){node.setAttribute("className",cls.replace(new RegExp("(^|\\s+)"+_3af+"(\\s+|$)"),"$1$2"));}};b._getFontMeasurements=function(){var _3b0={"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,"small":0,"medium":0,"large":0,"x-large":0,"xx-large":0};var p;if(has("ie")){win.doc.documentElement.style.fontSize="100%";}var div=_3ab.create("div",{style:{position:"absolute",left:"0",top:"-100px",width:"30px",height:"1000em",borderWidth:"0",margin:"0",padding:"0",outline:"none",lineHeight:"1",overflow:"hidden"}},win.body());for(p in _3b0){div.style.fontSize=p;_3b0[p]=Math.round(div.offsetHeight*12/16)*16/12/1000;}win.body().removeChild(div);return _3b0;};var _3b1=null;b._getCachedFontMeasurements=function(_3b2){if(_3b2||!_3b1){_3b1=b._getFontMeasurements();}return _3b1;};var _3b3=null,_3b4={};b._getTextBox=function(text,_3b5,_3b6){var m,s,al=arguments.length;var i;if(!_3b3){_3b3=_3ab.create("div",{style:{position:"absolute",top:"-10000px",left:"0"}},win.body());}m=_3b3;m.className="";s=m.style;s.borderWidth="0";s.margin="0";s.padding="0";s.outline="0";if(al>1&&_3b5){for(i in _3b5){if(i in _3b4){continue;}s[i]=_3b5[i];}}if(al>2&&_3b6){m.className=_3b6;}m.innerHTML=text;if(m["getBoundingClientRect"]){var bcr=m.getBoundingClientRect();return {l:bcr.left,t:bcr.top,w:bcr.width||(bcr.right-bcr.left),h:bcr.height||(bcr.bottom-bcr.top)};}else{return _3ac.getMarginBox(m);}};var _3b7=0;b._getUniqueId=function(){var id;do{id=_3a9._scopeName+"xUnique"+(++_3b7);}while(dom.byId(id));return id;};lang.mixin(g,{defaultPath:{type:"path",path:""},defaultPolyline:{type:"polyline",points:[]},defaultRect:{type:"rect",x:0,y:0,width:100,height:100,r:0},defaultEllipse:{type:"ellipse",cx:0,cy:0,rx:200,ry:100},defaultCircle:{type:"circle",cx:0,cy:0,r:100},defaultLine:{type:"line",x1:0,y1:0,x2:100,y2:100},defaultImage:{type:"image",x:0,y:0,width:0,height:0,src:""},defaultText:{type:"text",x:0,y:0,text:"",align:"start",decoration:"none",rotated:false,kerning:true},defaultTextPath:{type:"textpath",text:"",align:"start",decoration:"none",rotated:false,kerning:true},defaultStroke:{type:"stroke",color:"black",style:"solid",width:1,cap:"butt",join:4},defaultLinearGradient:{type:"linear",x1:0,y1:0,x2:100,y2:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultRadialGradient:{type:"radial",cx:0,cy:0,r:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultPattern:{type:"pattern",x:0,y:0,width:0,height:0,src:""},defaultFont:{type:"font",style:"normal",variant:"normal",weight:"normal",size:"10pt",family:"serif"},getDefault:(function(){var _3b8={};return function(type){var t=_3b8[type];if(t){return new t();}t=_3b8[type]=new Function();t.prototype=g["default"+type];return new t();};})(),normalizeColor:function(_3b9){return (_3b9 instanceof _3aa)?_3b9:new _3aa(_3b9);},normalizeParameters:function(_3ba,_3bb){var x;if(_3bb){var _3bc={};for(x in _3ba){if(x in _3bb&&!(x in _3bc)){_3ba[x]=_3bb[x];}}}return _3ba;},makeParameters:function(_3bd,_3be){var i=null;if(!_3be){return lang.delegate(_3bd);}var _3bf={};for(i in _3bd){if(!(i in _3bf)){_3bf[i]=lang.clone((i in _3be)?_3be[i]:_3bd[i]);}}return _3bf;},formatNumber:function(x,_3c0){var val=x.toString();if(val.indexOf("e")>=0){val=x.toFixed(4);}else{var _3c1=val.indexOf(".");if(_3c1>=0&&val.length-_3c1>5){val=x.toFixed(4);}}if(x<0){return val;}return _3c0?" "+val:val;},makeFontString:function(font){return font.style+" "+font.variant+" "+font.weight+" "+font.size+" "+font.family;},splitFontString:function(str){var font=g.getDefault("Font");var t=str.split(/\s+/);do{if(t.length<5){break;}font.style=t[0];font.variant=t[1];font.weight=t[2];var i=t[3].indexOf("/");font.size=i<0?t[3]:t[3].substring(0,i);var j=4;if(i<0){if(t[4]=="/"){j=6;}else{if(t[4].charAt(0)=="/"){j=5;}}}if(j<t.length){font.family=t.slice(j).join(" ");}}while(false);return font;},cm_in_pt:72/2.54,mm_in_pt:7.2/2.54,px_in_pt:function(){return g._base._getCachedFontMeasurements()["12pt"]/12;},pt2px:function(len){return len*g.px_in_pt();},px2pt:function(len){return len/g.px_in_pt();},normalizedLength:function(len){if(len.length===0){return 0;}if(len.length>2){var _3c2=g.px_in_pt();var val=parseFloat(len);switch(len.slice(-2)){case "px":return val;case "pt":return val*_3c2;case "in":return val*72*_3c2;case "pc":return val*12*_3c2;case "mm":return val*g.mm_in_pt*_3c2;case "cm":return val*g.cm_in_pt*_3c2;}}return parseFloat(len);},pathVmlRegExp:/([A-Za-z]+)|(\d+(\.\d+)?)|(\.\d+)|(-\d+(\.\d+)?)|(-\.\d+)/g,pathSvgRegExp:/([A-Za-z])|(\d+(\.\d+)?)|(\.\d+)|(-\d+(\.\d+)?)|(-\.\d+)/g,equalSources:function(a,b){return a&&b&&a===b;},switchTo:function(_3c3){var ns=typeof _3c3=="string"?g[_3c3]:_3c3;if(ns){arr.forEach(["Group","Rect","Ellipse","Circle","Line","Polyline","Image","Text","Path","TextPath","Surface","createSurface","fixTarget"],function(name){g[name]=ns[name];});}}});return g;});},"org/cometd":function(){this.org=this.org||{};org.cometd={};org.cometd.JSON={};org.cometd.JSON.toJSON=org.cometd.JSON.fromJSON=function(_3c4){throw "Abstract";};org.cometd.Utils={};org.cometd.Utils.isString=function(_3c5){if(_3c5===undefined||_3c5===null){return false;}return typeof _3c5==="string"||_3c5 instanceof String;};org.cometd.Utils.isArray=function(_3c6){if(_3c6===undefined||_3c6===null){return false;}return _3c6 instanceof Array;};org.cometd.Utils.inArray=function(_3c7,_3c8){for(var i=0;i<_3c8.length;++i){if(_3c7===_3c8[i]){return i;}}return -1;};org.cometd.Utils.setTimeout=function(_3c9,_3ca,_3cb){return window.setTimeout(function(){try{_3ca();}catch(x){_3c9._debug("Exception invoking timed function",_3ca,x);}},_3cb);};org.cometd.Utils.clearTimeout=function(_3cc){window.clearTimeout(_3cc);};org.cometd.TransportRegistry=function(){var _3cd=[];var _3ce={};this.getTransportTypes=function(){return _3cd.slice(0);};this.findTransportTypes=function(_3cf,_3d0,url){var _3d1=[];for(var i=0;i<_3cd.length;++i){var type=_3cd[i];if(_3ce[type].accept(_3cf,_3d0,url)===true){_3d1.push(type);}}return _3d1;};this.negotiateTransport=function(_3d2,_3d3,_3d4,url){for(var i=0;i<_3cd.length;++i){var type=_3cd[i];for(var j=0;j<_3d2.length;++j){if(type===_3d2[j]){var _3d5=_3ce[type];if(_3d5.accept(_3d3,_3d4,url)===true){return _3d5;}}}}return null;};this.add=function(type,_3d6,_3d7){var _3d8=false;for(var i=0;i<_3cd.length;++i){if(_3cd[i]===type){_3d8=true;break;}}if(!_3d8){if(typeof _3d7!=="number"){_3cd.push(type);}else{_3cd.splice(_3d7,0,type);}_3ce[type]=_3d6;}return !_3d8;};this.find=function(type){for(var i=0;i<_3cd.length;++i){if(_3cd[i]===type){return _3ce[type];}}return null;};this.remove=function(type){for(var i=0;i<_3cd.length;++i){if(_3cd[i]===type){_3cd.splice(i,1);var _3d9=_3ce[type];delete _3ce[type];return _3d9;}}return null;};this.clear=function(){_3cd=[];_3ce={};};this.reset=function(){for(var i=0;i<_3cd.length;++i){_3ce[_3cd[i]].reset();}};};org.cometd.Transport=function(){var _3da;var _3db;this.registered=function(type,_3dc){_3da=type;_3db=_3dc;};this.unregistered=function(){_3da=null;_3db=null;};this._debug=function(){_3db._debug.apply(_3db,arguments);};this._mixin=function(){return _3db._mixin.apply(_3db,arguments);};this.getConfiguration=function(){return _3db.getConfiguration();};this.getAdvice=function(){return _3db.getAdvice();};this.setTimeout=function(_3dd,_3de){return org.cometd.Utils.setTimeout(_3db,_3dd,_3de);};this.clearTimeout=function(_3df){org.cometd.Utils.clearTimeout(_3df);};this.convertToMessages=function(_3e0){if(org.cometd.Utils.isString(_3e0)){try{return org.cometd.JSON.fromJSON(_3e0);}catch(x){this._debug("Could not convert to JSON the following string","\""+_3e0+"\"");throw x;}}if(org.cometd.Utils.isArray(_3e0)){return _3e0;}if(_3e0===undefined||_3e0===null){return [];}if(_3e0 instanceof Object){return [_3e0];}throw "Conversion Error "+_3e0+", typeof "+(typeof _3e0);};this.accept=function(_3e1,_3e2,url){throw "Abstract";};this.getType=function(){return _3da;};this.send=function(_3e3,_3e4){throw "Abstract";};this.reset=function(){this._debug("Transport",_3da,"reset");};this.abort=function(){this._debug("Transport",_3da,"aborted");};this.toString=function(){return this.getType();};};org.cometd.Transport.derive=function(_3e5){function F(){};F.prototype=_3e5;return new F();};org.cometd.RequestTransport=function(){var _3e6=new org.cometd.Transport();var _3e7=org.cometd.Transport.derive(_3e6);var _3e8=0;var _3e9=null;var _3ea=[];var _3eb=[];function _3ec(_3ed){while(_3eb.length>0){var _3ee=_3eb[0];var _3ef=_3ee[0];var _3f0=_3ee[1];if(_3ef.url===_3ed.url&&_3ef.sync===_3ed.sync){_3eb.shift();_3ed.messages=_3ed.messages.concat(_3ef.messages);this._debug("Coalesced",_3ef.messages.length,"messages from request",_3f0.id);continue;}break;}};function _3f1(_3f2,_3f3){this.transportSend(_3f2,_3f3);_3f3.expired=false;if(!_3f2.sync){var _3f4=this.getConfiguration().maxNetworkDelay;var _3f5=_3f4;if(_3f3.metaConnect===true){_3f5+=this.getAdvice().timeout;}this._debug("Transport",this.getType(),"waiting at most",_3f5,"ms for the response, maxNetworkDelay",_3f4);var self=this;_3f3.timeout=this.setTimeout(function(){_3f3.expired=true;var _3f6="Request "+_3f3.id+" of transport "+self.getType()+" exceeded "+_3f5+" ms max network delay";var _3f7={reason:_3f6};var xhr=_3f3.xhr;_3f7.httpCode=self.xhrStatus(xhr);self.abortXHR(xhr);self._debug(_3f6);self.complete(_3f3,false,_3f3.metaConnect);_3f2.onFailure(xhr,_3f2.messages,_3f7);},_3f5);}};function _3f8(_3f9){var _3fa=++_3e8;var _3fb={id:_3fa,metaConnect:false};if(_3ea.length<this.getConfiguration().maxConnections-1){_3ea.push(_3fb);_3f1.call(this,_3f9,_3fb);}else{this._debug("Transport",this.getType(),"queueing request",_3fa,"envelope",_3f9);_3eb.push([_3f9,_3fb]);}};function _3fc(_3fd){var _3fe=_3fd.id;this._debug("Transport",this.getType(),"metaConnect complete, request",_3fe);if(_3e9!==null&&_3e9.id!==_3fe){throw "Longpoll request mismatch, completing request "+_3fe;}_3e9=null;};function _3ff(_400,_401){var _402=org.cometd.Utils.inArray(_400,_3ea);if(_402>=0){_3ea.splice(_402,1);}if(_3eb.length>0){var _403=_3eb.shift();var _404=_403[0];var _405=_403[1];this._debug("Transport dequeued request",_405.id);if(_401){if(this.getConfiguration().autoBatch){_3ec.call(this,_404);}_3f8.call(this,_404);this._debug("Transport completed request",_400.id,_404);}else{var self=this;this.setTimeout(function(){self.complete(_405,false,_405.metaConnect);var _406={reason:"Previous request failed"};var xhr=_405.xhr;_406.httpCode=self.xhrStatus(xhr);_404.onFailure(xhr,_404.messages,_406);},0);}}};_3e7.complete=function(_407,_408,_409){if(_409){_3fc.call(this,_407);}else{_3ff.call(this,_407,_408);}};_3e7.transportSend=function(_40a,_40b){throw "Abstract";};_3e7.transportSuccess=function(_40c,_40d,_40e){if(!_40d.expired){this.clearTimeout(_40d.timeout);this.complete(_40d,true,_40d.metaConnect);if(_40e&&_40e.length>0){_40c.onSuccess(_40e);}else{_40c.onFailure(_40d.xhr,_40c.messages,{httpCode:204});}}};_3e7.transportFailure=function(_40f,_410,_411){if(!_410.expired){this.clearTimeout(_410.timeout);this.complete(_410,false,_410.metaConnect);_40f.onFailure(_410.xhr,_40f.messages,_411);}};function _412(_413){if(_3e9!==null){throw "Concurrent metaConnect requests not allowed, request id="+_3e9.id+" not yet completed";}var _414=++_3e8;this._debug("Transport",this.getType(),"metaConnect send, request",_414,"envelope",_413);var _415={id:_414,metaConnect:true};_3f1.call(this,_413,_415);_3e9=_415;};_3e7.send=function(_416,_417){if(_417){_412.call(this,_416);}else{_3f8.call(this,_416);}};_3e7.abort=function(){_3e6.abort();for(var i=0;i<_3ea.length;++i){var _418=_3ea[i];this._debug("Aborting request",_418);this.abortXHR(_418.xhr);}if(_3e9){this._debug("Aborting metaConnect request",_3e9);this.abortXHR(_3e9.xhr);}this.reset();};_3e7.reset=function(){_3e6.reset();_3e9=null;_3ea=[];_3eb=[];};_3e7.abortXHR=function(xhr){if(xhr){try{xhr.abort();}catch(x){this._debug(x);}}};_3e7.xhrStatus=function(xhr){if(xhr){try{return xhr.status;}catch(x){this._debug(x);}}return -1;};return _3e7;};org.cometd.LongPollingTransport=function(){var _419=new org.cometd.RequestTransport();var _41a=org.cometd.Transport.derive(_419);var _41b=true;_41a.accept=function(_41c,_41d,url){return _41b||!_41d;};_41a.xhrSend=function(_41e){throw "Abstract";};_41a.transportSend=function(_41f,_420){this._debug("Transport",this.getType(),"sending request",_420.id,"envelope",_41f);var self=this;try{var _421=true;_420.xhr=this.xhrSend({transport:this,url:_41f.url,sync:_41f.sync,headers:this.getConfiguration().requestHeaders,body:org.cometd.JSON.toJSON(_41f.messages),onSuccess:function(_422){self._debug("Transport",self.getType(),"received response",_422);var _423=false;try{var _424=self.convertToMessages(_422);if(_424.length===0){_41b=false;self.transportFailure(_41f,_420,{httpCode:204});}else{_423=true;self.transportSuccess(_41f,_420,_424);}}catch(x){self._debug(x);if(!_423){_41b=false;var _425={exception:x};_425.httpCode=self.xhrStatus(_420.xhr);self.transportFailure(_41f,_420,_425);}}},onError:function(_426,_427){_41b=false;var _428={reason:_426,exception:_427};_428.httpCode=self.xhrStatus(_420.xhr);if(_421){self.setTimeout(function(){self.transportFailure(_41f,_420,_428);},0);}else{self.transportFailure(_41f,_420,_428);}}});_421=false;}catch(x){_41b=false;this.setTimeout(function(){self.transportFailure(_41f,_420,{exception:x});},0);}};_41a.reset=function(){_419.reset();_41b=true;};return _41a;};org.cometd.CallbackPollingTransport=function(){var _429=new org.cometd.RequestTransport();var _42a=org.cometd.Transport.derive(_429);var _42b=2000;_42a.accept=function(_42c,_42d,url){return true;};_42a.jsonpSend=function(_42e){throw "Abstract";};_42a.transportSend=function(_42f,_430){var self=this;var _431=0;var _432=_42f.messages.length;var _433=[];while(_432>0){var json=org.cometd.JSON.toJSON(_42f.messages.slice(_431,_431+_432));var _434=_42f.url.length+encodeURI(json).length;if(_434>_42b){if(_432===1){this.setTimeout(function(){self.transportFailure(_42f,_430,{reason:"Bayeux message too big, max is "+_42b});},0);return;}--_432;continue;}_433.push(_432);_431+=_432;_432=_42f.messages.length-_431;}var _435=_42f;if(_433.length>1){var _436=0;var end=_433[0];this._debug("Transport",this.getType(),"split",_42f.messages.length,"messages into",_433.join(" + "));_435=this._mixin(false,{},_42f);_435.messages=_42f.messages.slice(_436,end);_435.onSuccess=_42f.onSuccess;_435.onFailure=_42f.onFailure;for(var i=1;i<_433.length;++i){var _437=this._mixin(false,{},_42f);_436=end;end+=_433[i];_437.messages=_42f.messages.slice(_436,end);_437.onSuccess=_42f.onSuccess;_437.onFailure=_42f.onFailure;this.send(_437,_430.metaConnect);}}this._debug("Transport",this.getType(),"sending request",_430.id,"envelope",_435);try{var _438=true;this.jsonpSend({transport:this,url:_435.url,sync:_435.sync,headers:this.getConfiguration().requestHeaders,body:org.cometd.JSON.toJSON(_435.messages),onSuccess:function(_439){var _43a=false;try{var _43b=self.convertToMessages(_439);if(_43b.length===0){self.transportFailure(_435,_430,{httpCode:204});}else{_43a=true;self.transportSuccess(_435,_430,_43b);}}catch(x){self._debug(x);if(!_43a){self.transportFailure(_435,_430,{exception:x});}}},onError:function(_43c,_43d){var _43e={reason:_43c,exception:_43d};if(_438){self.setTimeout(function(){self.transportFailure(_435,_430,_43e);},0);}else{self.transportFailure(_435,_430,_43e);}}});_438=false;}catch(xx){this.setTimeout(function(){self.transportFailure(_435,_430,{exception:xx});},0);}};return _42a;};org.cometd.WebSocketTransport=function(){var _43f=new org.cometd.Transport();var _440=org.cometd.Transport.derive(_43f);var _441;var _442=true;var _443=false;var _444=true;var _445={};var _446={};var _447=false;var _448=null;var _449=false;var _44a=null;_440.reset=function(){_43f.reset();_442=true;_443=false;_444=true;_445={};_446={};_447=false;_448=null;_449=false;_44a=null;};function _44b(){if(_447){return;}_447=true;var url=_441.getURL().replace(/^http/,"ws");this._debug("Transport",this.getType(),"connecting to URL",url);try{var _44c=_441.getConfiguration().protocol;var _44d=_44c?new org.cometd.WebSocket(url,_44c):new org.cometd.WebSocket(url);}catch(x){_442=false;this._debug("Exception while creating WebSocket object",x);throw x;}_444=_441.getConfiguration().stickyReconnect!==false;var self=this;var _44e=null;var _44f=_441.getConfiguration().connectTimeout;if(_44f>0){_44e=this.setTimeout(function(){_44e=null;self._debug("Transport",self.getType(),"timed out while connecting to URL",url,":",_44f,"ms");var _450={code:1000,reason:"Connect Timeout"};self.webSocketClose(_44d,_450.code,_450.reason);self.onClose(_44d,_450);},_44f);}var _451=function(){self._debug("WebSocket opened",_44d);_447=false;if(_44e){self.clearTimeout(_44e);_44e=null;}if(_448){_441._warn("Closing Extra WebSocket Connections",_44d,_448);self.webSocketClose(_44d,1000,"Extra Connection");}else{self.onOpen(_44d);}};var _452=function(_453){_453=_453||{code:1000};self._debug("WebSocket closing",_44d,_453);_447=false;if(_44e){self.clearTimeout(_44e);_44e=null;}if(_448!==null&&_44d!==_448){self._debug("Closed Extra WebSocket Connection",_44d);}else{self.onClose(_44d,_453);}};var _454=function(_455){self._debug("WebSocket message",_455,_44d);if(_44d!==_448){_441._warn("Extra WebSocket Connections",_44d,_448);}self.onMessage(_44d,_455);};_44d.onopen=_451;_44d.onclose=_452;_44d.onerror=function(){_452({code:1002,reason:"Error"});};_44d.onmessage=_454;this._debug("Transport",this.getType(),"configured callbacks on",_44d);};function _456(_457,_458,_459){var json=org.cometd.JSON.toJSON(_458.messages);_457.send(json);this._debug("Transport",this.getType(),"sent",_458,"metaConnect =",_459);var _45a=this.getConfiguration().maxNetworkDelay;var _45b=_45a;if(_459){_45b+=this.getAdvice().timeout;_449=true;}var self=this;var _45c=[];for(var i=0;i<_458.messages.length;++i){(function(){var _45d=_458.messages[i];if(_45d.id){_45c.push(_45d.id);_446[_45d.id]=this.setTimeout(function(){self._debug("Transport",self.getType(),"timing out message",_45d.id,"after",_45b,"on",_457);var _45e={code:1000,reason:"Message Timeout"};self.webSocketClose(_457,_45e.code,_45e.reason);self.onClose(_457,_45e);},_45b);}})();}this._debug("Transport",this.getType(),"waiting at most",_45b,"ms for messages",_45c,"maxNetworkDelay",_45a,", timeouts:",_446);};function _45f(_460,_461,_462){try{if(_460===null){_44b.call(this);}else{_456.call(this,_460,_461,_462);}}catch(x){this.setTimeout(function(){_461.onFailure(_460,_461.messages,{exception:x});},0);}};_440.onOpen=function(_463){this._debug("Transport",this.getType(),"opened",_463);_448=_463;_443=true;this._debug("Sending pending messages",_445);for(var key in _445){var _464=_445[key];var _465=_464[0];var _466=_464[1];_44a=_465.onSuccess;_456.call(this,_463,_465,_466);}};_440.onMessage=function(_467,_468){this._debug("Transport",this.getType(),"received websocket message",_468,_467);var _469=false;var _46a=this.convertToMessages(_468.data);var _46b=[];for(var i=0;i<_46a.length;++i){var _46c=_46a[i];if(/^\/meta\//.test(_46c.channel)||_46c.successful!==undefined){if(_46c.id){_46b.push(_46c.id);var _46d=_446[_46c.id];if(_46d){this.clearTimeout(_46d);delete _446[_46c.id];this._debug("Transport",this.getType(),"removed timeout for message",_46c.id,", timeouts",_446);}}}if("/meta/connect"===_46c.channel){_449=false;}if("/meta/disconnect"===_46c.channel&&!_449){_469=true;}}var _46e=false;for(var j=0;j<_46b.length;++j){var id=_46b[j];for(var key in _445){var ids=key.split(",");var _46f=org.cometd.Utils.inArray(id,ids);if(_46f>=0){_46e=true;ids.splice(_46f,1);var _470=_445[key][0];var _471=_445[key][1];delete _445[key];if(ids.length>0){_445[ids.join(",")]=[_470,_471];}break;}}}if(_46e){this._debug("Transport",this.getType(),"removed envelope, envelopes",_445);}_44a.call(this,_46a);if(_469){this.webSocketClose(_467,1000,"Disconnect");}};_440.onClose=function(_472,_473){this._debug("Transport",this.getType(),"closed",_472,_473);_442=_444&&_443;for(var id in _446){this.clearTimeout(_446[id]);}_446={};for(var key in _445){var _474=_445[key][0];var _475=_445[key][1];if(_475){_449=false;}_474.onFailure(_472,_474.messages,{websocketCode:_473.code,reason:_473.reason});}_445={};_448=null;};_440.registered=function(type,_476){_43f.registered(type,_476);_441=_476;};_440.accept=function(_477,_478,url){return _442&&!!org.cometd.WebSocket&&_441.websocketEnabled!==false;};_440.send=function(_479,_47a){this._debug("Transport",this.getType(),"sending",_479,"metaConnect =",_47a);var _47b=[];for(var i=0;i<_479.messages.length;++i){var _47c=_479.messages[i];if(_47c.id){_47b.push(_47c.id);}}_445[_47b.join(",")]=[_479,_47a];this._debug("Transport",this.getType(),"stored envelope, envelopes",_445);_45f.call(this,_448,_479,_47a);};_440.webSocketClose=function(_47d,code,_47e){try{_47d.close(code,_47e);}catch(x){this._debug(x);}};_440.abort=function(){_43f.abort();if(_448){var _47f={code:1001,reason:"Abort"};this.webSocketClose(_448,_47f.code,_47f.reason);this.onClose(_448,_47f);}this.reset();};return _440;};org.cometd.Cometd=function(name){var _480=this;var _481=name||"default";var _482=false;var _483=new org.cometd.TransportRegistry();var _484;var _485="disconnected";var _486=0;var _487=null;var _488=0;var _489=[];var _48a=false;var _48b={};var _48c=0;var _48d=null;var _48e=[];var _48f={};var _490;var _491;var _492={};var _493=false;var _494=false;var _495={protocol:null,stickyReconnect:true,connectTimeout:0,maxConnections:2,backoffIncrement:1000,maxBackoff:60000,logLevel:"info",reverseIncomingExtensions:true,maxNetworkDelay:10000,requestHeaders:{},appendMessageTypeToURL:true,autoBatch:false,advice:{timeout:60000,interval:0,reconnect:"retry"}};function _496(_497,name){try{return _497[name];}catch(x){return undefined;}};this._mixin=function(deep,_498,_499){var _49a=_498||{};for(var i=2;i<arguments.length;++i){var _49b=arguments[i];if(_49b===undefined||_49b===null){continue;}for(var _49c in _49b){var prop=_496(_49b,_49c);var targ=_496(_49a,_49c);if(prop===_498){continue;}if(prop===undefined){continue;}if(deep&&typeof prop==="object"&&prop!==null){if(prop instanceof Array){_49a[_49c]=this._mixin(deep,targ instanceof Array?targ:[],prop);}else{var _49d=typeof targ==="object"&&!(targ instanceof Array)?targ:{};_49a[_49c]=this._mixin(deep,_49d,prop);}}else{_49a[_49c]=prop;}}}return _49a;};function _49e(_49f){return org.cometd.Utils.isString(_49f);};function _4a0(_4a1){if(_4a1===undefined||_4a1===null){return false;}return typeof _4a1==="function";};function _4a2(_4a3,args){if(window.console){var _4a4=window.console[_4a3];if(_4a0(_4a4)){_4a4.apply(window.console,args);}}};this._warn=function(){_4a2("warn",arguments);};this._info=function(){if(_495.logLevel!=="warn"){_4a2("info",arguments);}};this._debug=function(){if(_495.logLevel==="debug"){_4a2("debug",arguments);}};this._isCrossDomain=function(_4a5){return _4a5&&_4a5!==window.location.host;};function _4a6(_4a7){_480._debug("Configuring cometd object with",_4a7);if(_49e(_4a7)){_4a7={url:_4a7};}if(!_4a7){_4a7={};}_495=_480._mixin(false,_495,_4a7);var url=_480.getURL();if(!url){throw "Missing required configuration parameter 'url' specifying the Bayeux server URL";}var _4a8=/(^https?:\/\/)?(((\[[^\]]+\])|([^:\/\?#]+))(:(\d+))?)?([^\?#]*)(.*)?/.exec(url);var _4a9=_4a8[2];var uri=_4a8[8];var _4aa=_4a8[9];_482=_480._isCrossDomain(_4a9);if(_495.appendMessageTypeToURL){if(_4aa!==undefined&&_4aa.length>0){_480._info("Appending message type to URI "+uri+_4aa+" is not supported, disabling 'appendMessageTypeToURL' configuration");_495.appendMessageTypeToURL=false;}else{var _4ab=uri.split("/");var _4ac=_4ab.length-1;if(uri.match(/\/$/)){_4ac-=1;}if(_4ab[_4ac].indexOf(".")>=0){_480._info("Appending message type to URI "+uri+" is not supported, disabling 'appendMessageTypeToURL' configuration");_495.appendMessageTypeToURL=false;}}}};function _4ad(_4ae){if(_4ae){var _4af=_48b[_4ae.channel];if(_4af&&_4af[_4ae.id]){delete _4af[_4ae.id];_480._debug("Removed",_4ae.listener?"listener":"subscription",_4ae);}}};function _4b0(_4b1){if(_4b1&&!_4b1.listener){_4ad(_4b1);}};function _4b2(){for(var _4b3 in _48b){var _4b4=_48b[_4b3];if(_4b4){for(var i=0;i<_4b4.length;++i){_4b0(_4b4[i]);}}}};function _4b5(_4b6){if(_485!==_4b6){_480._debug("Status",_485,"->",_4b6);_485=_4b6;}};function _4b7(){return _485==="disconnecting"||_485==="disconnected";};function _4b8(){return ++_486;};function _4b9(_4ba,_4bb,name,_4bc,_4bd){try{return _4bb.call(_4ba,_4bc);}catch(x){_480._debug("Exception during execution of extension",name,x);var _4be=_480.onExtensionException;if(_4a0(_4be)){_480._debug("Invoking extension exception callback",name,x);try{_4be.call(_480,x,name,_4bd,_4bc);}catch(xx){_480._info("Exception during execution of exception callback in extension",name,xx);}}return _4bc;}};function _4bf(_4c0){for(var i=0;i<_48e.length;++i){if(_4c0===undefined||_4c0===null){break;}var _4c1=_495.reverseIncomingExtensions?_48e.length-1-i:i;var _4c2=_48e[_4c1];var _4c3=_4c2.extension.incoming;if(_4a0(_4c3)){var _4c4=_4b9(_4c2.extension,_4c3,_4c2.name,_4c0,false);_4c0=_4c4===undefined?_4c0:_4c4;}}return _4c0;};function _4c5(_4c6){for(var i=0;i<_48e.length;++i){if(_4c6===undefined||_4c6===null){break;}var _4c7=_48e[i];var _4c8=_4c7.extension.outgoing;if(_4a0(_4c8)){var _4c9=_4b9(_4c7.extension,_4c8,_4c7.name,_4c6,true);_4c6=_4c9===undefined?_4c6:_4c9;}}return _4c6;};function _4ca(_4cb,_4cc){var _4cd=_48b[_4cb];if(_4cd&&_4cd.length>0){for(var i=0;i<_4cd.length;++i){var _4ce=_4cd[i];if(_4ce){try{_4ce.callback.call(_4ce.scope,_4cc);}catch(x){_480._debug("Exception during notification",_4ce,_4cc,x);var _4cf=_480.onListenerException;if(_4a0(_4cf)){_480._debug("Invoking listener exception callback",_4ce,x);try{_4cf.call(_480,x,_4ce,_4ce.listener,_4cc);}catch(xx){_480._info("Exception during execution of listener callback",_4ce,xx);}}}}}}};function _4d0(_4d1,_4d2){_4ca(_4d1,_4d2);var _4d3=_4d1.split("/");var last=_4d3.length-1;for(var i=last;i>0;--i){var _4d4=_4d3.slice(0,i).join("/")+"/*";if(i===last){_4ca(_4d4,_4d2);}_4d4+="*";_4ca(_4d4,_4d2);}};function _4d5(){if(_48d!==null){org.cometd.Utils.clearTimeout(_48d);}_48d=null;};function _4d6(_4d7){_4d5();var _4d8=_48f.interval+_48c;_480._debug("Function scheduled in",_4d8,"ms, interval =",_48f.interval,"backoff =",_48c,_4d7);_48d=org.cometd.Utils.setTimeout(_480,_4d7,_4d8);};var _4d9;var _4da;function _4db(sync,_4dc,_4dd,_4de){for(var i=0;i<_4dc.length;++i){var _4df=_4dc[i];var _4e0=""+_4b8();_4df.id=_4e0;if(_487){_4df.clientId=_487;}var _4e1=undefined;if(_4a0(_4df._callback)){_4e1=_4df._callback;delete _4df._callback;}_4df=_4c5(_4df);if(_4df!==undefined&&_4df!==null){_4df.id=_4e0;_4dc[i]=_4df;if(_4e1){_492[_4e0]=_4e1;}}else{_4dc.splice(i--,1);}}if(_4dc.length===0){return;}var url=_480.getURL();if(_495.appendMessageTypeToURL){if(!url.match(/\/$/)){url=url+"/";}if(_4de){url=url+_4de;}}var _4e2={url:url,sync:sync,messages:_4dc,onSuccess:function(_4e3){try{_4d9.call(_480,_4e3);}catch(x){_480._debug("Exception during handling of messages",x);}},onFailure:function(_4e4,_4e5,_4e6){try{_4e6.connectionType=_480.getTransport().getType();_4da.call(_480,_4e4,_4e5,_4e6);}catch(x){_480._debug("Exception during handling of failure",x);}}};_480._debug("Send",_4e2);_484.send(_4e2,_4dd);};function _4e7(_4e8){if(_488>0||_48a===true){_489.push(_4e8);}else{_4db(false,[_4e8],false);}};this.send=_4e7;function _4e9(){_48c=0;};function _4ea(){if(_48c<_495.maxBackoff){_48c+=_495.backoffIncrement;}};function _4eb(){++_488;};function _4ec(){var _4ed=_489;_489=[];if(_4ed.length>0){_4db(false,_4ed,false);}};function _4ee(){--_488;if(_488<0){throw "Calls to startBatch() and endBatch() are not paired";}if(_488===0&&!_4b7()&&!_48a){_4ec();}};function _4ef(){if(!_4b7()){var _4f0={channel:"/meta/connect",connectionType:_484.getType()};if(!_494){_4f0.advice={timeout:0};}_4b5("connecting");_480._debug("Connect sent",_4f0);_4db(false,[_4f0],true,"connect");_4b5("connected");}};function _4f1(){_4b5("connecting");_4d6(function(){_4ef();});};function _4f2(_4f3){if(_4f3){_48f=_480._mixin(false,{},_495.advice,_4f3);_480._debug("New advice",_48f);}};function _4f4(_4f5){_4d5();if(_4f5){_484.abort();}_487=null;_4b5("disconnected");_488=0;_4e9();_484=null;if(_489.length>0){_4da.call(_480,undefined,_489,{reason:"Disconnected"});_489=[];}};function _4f6(_4f7,_4f8,_4f9){var _4fa=_480.onTransportFailure;if(_4a0(_4fa)){_480._debug("Invoking transport failure callback",_4f7,_4f8,_4f9);try{_4fa.call(_480,_4f7,_4f8,_4f9);}catch(x){_480._info("Exception during execution of transport failure callback",x);}}};function _4fb(_4fc,_4fd){if(_4a0(_4fc)){_4fd=_4fc;_4fc=undefined;}_487=null;_4b2();if(_4b7()){_483.reset();_4f2(_495.advice);}else{_4f2(_480._mixin(false,_48f,{reconnect:"retry"}));}_488=0;_48a=true;_490=_4fc;_491=_4fd;var _4fe="1.0";var url=_480.getURL();var _4ff=_483.findTransportTypes(_4fe,_482,url);var _500={version:_4fe,minimumVersion:_4fe,channel:"/meta/handshake",supportedConnectionTypes:_4ff,_callback:_4fd,advice:{timeout:_48f.timeout,interval:_48f.interval}};var _501=_480._mixin(false,{},_490,_500);if(!_484){_484=_483.negotiateTransport(_4ff,_4fe,_482,url);if(!_484){var _502="Could not find initial transport among: "+_483.getTransportTypes();_480._warn(_502);throw _502;}}_480._debug("Initial transport is",_484.getType());_4b5("handshaking");_480._debug("Handshake sent",_501);_4db(false,[_501],false,"handshake");};function _503(){_4b5("handshaking");_48a=true;_4d6(function(){_4fb(_490,_491);});};function _504(_505){var _506=_492[_505.id];if(_4a0(_506)){delete _492[_505.id];_506.call(_480,_505);}};function _507(_508){_504(_508);_4d0("/meta/handshake",_508);_4d0("/meta/unsuccessful",_508);var _509=!_4b7()&&_48f.reconnect!=="none";if(_509){_4ea();_503();}else{_4f4(false);}};function _50a(_50b){if(_50b.successful){_487=_50b.clientId;var url=_480.getURL();var _50c=_483.negotiateTransport(_50b.supportedConnectionTypes,_50b.version,_482,url);if(_50c===null){var _50d="Could not negotiate transport with server; client=["+_483.findTransportTypes(_50b.version,_482,url)+"], server=["+_50b.supportedConnectionTypes+"]";var _50e=_480.getTransport();_4f6(_50e.getType(),null,{reason:_50d,connectionType:_50e.getType(),transport:_50e});_480._warn(_50d);_4f4(true);return;}else{if(_484!==_50c){_480._debug("Transport",_484.getType(),"->",_50c.getType());_484=_50c;}}_48a=false;_4ec();_50b.reestablish=_493;_493=true;_504(_50b);_4d0("/meta/handshake",_50b);var _50f=_4b7()?"none":_48f.reconnect;switch(_50f){case "retry":_4e9();_4f1();break;case "none":_4f4(false);break;default:throw "Unrecognized advice action "+_50f;}}else{_507(_50b);}};function _510(_511){var _512="1.0";var url=_480.getURL();var _513=_480.getTransport();var _514=_483.findTransportTypes(_512,_482,url);var _515=_483.negotiateTransport(_514,_512,_482,url);if(!_515){_4f6(_513.getType(),null,_511.failure);_480._warn("Could not negotiate transport; client=["+_514+"]");_4f4(true);_507(_511);}else{_480._debug("Transport",_513.getType(),"->",_515.getType());_4f6(_513.getType(),_515.getType(),_511.failure);_507(_511);_484=_515;}};function _516(_517){_4d0("/meta/connect",_517);_4d0("/meta/unsuccessful",_517);var _518=_4b7()?"none":_48f.reconnect;switch(_518){case "retry":_4f1();_4ea();break;case "handshake":_483.reset();_4e9();_503();break;case "none":_4f4(false);break;default:throw "Unrecognized advice action"+_518;}};function _519(_51a){_494=_51a.successful;if(_494){_4d0("/meta/connect",_51a);var _51b=_4b7()?"none":_48f.reconnect;switch(_51b){case "retry":_4e9();_4f1();break;case "none":_4f4(false);break;default:throw "Unrecognized advice action "+_51b;}}else{_516(_51a);}};function _51c(_51d){_494=false;_516(_51d);};function _51e(_51f){_4f4(true);_504(_51f);_4d0("/meta/disconnect",_51f);_4d0("/meta/unsuccessful",_51f);};function _520(_521){if(_521.successful){_4f4(false);_504(_521);_4d0("/meta/disconnect",_521);}else{_51e(_521);}};function _522(_523){_51e(_523);};function _524(_525){var _526=_48b[_525.subscription];if(_526){for(var i=_526.length-1;i>=0;--i){var _527=_526[i];if(_527&&!_527.listener){delete _526[i];_480._debug("Removed failed subscription",_527);break;}}}_504(_525);_4d0("/meta/subscribe",_525);_4d0("/meta/unsuccessful",_525);};function _528(_529){if(_529.successful){_504(_529);_4d0("/meta/subscribe",_529);}else{_524(_529);}};function _52a(_52b){_524(_52b);};function _52c(_52d){_504(_52d);_4d0("/meta/unsubscribe",_52d);_4d0("/meta/unsuccessful",_52d);};function _52e(_52f){if(_52f.successful){_504(_52f);_4d0("/meta/unsubscribe",_52f);}else{_52c(_52f);}};function _530(_531){_52c(_531);};function _532(_533){_504(_533);_4d0("/meta/publish",_533);_4d0("/meta/unsuccessful",_533);};function _534(_535){if(_535.successful===undefined){if(_535.data!==undefined){_4d0(_535.channel,_535);}else{_480._warn("Unknown Bayeux Message",_535);}}else{if(_535.successful){_504(_535);_4d0("/meta/publish",_535);}else{_532(_535);}}};function _536(_537){_532(_537);};function _538(_539){_539=_4bf(_539);if(_539===undefined||_539===null){return;}_4f2(_539.advice);var _53a=_539.channel;switch(_53a){case "/meta/handshake":_50a(_539);break;case "/meta/connect":_519(_539);break;case "/meta/disconnect":_520(_539);break;case "/meta/subscribe":_528(_539);break;case "/meta/unsubscribe":_52e(_539);break;default:_534(_539);break;}};this.receive=_538;_4d9=function(_53b){_480._debug("Received",_53b);for(var i=0;i<_53b.length;++i){var _53c=_53b[i];_538(_53c);}};_4da=function(_53d,_53e,_53f){_480._debug("handleFailure",_53d,_53e,_53f);_53f.transport=_53d;for(var i=0;i<_53e.length;++i){var _540=_53e[i];var _541={id:_540.id,successful:false,channel:_540.channel,failure:_53f};_53f.message=_540;switch(_540.channel){case "/meta/handshake":_510(_541);break;case "/meta/connect":_51c(_541);break;case "/meta/disconnect":_522(_541);break;case "/meta/subscribe":_541.subscription=_540.subscription;_52a(_541);break;case "/meta/unsubscribe":_541.subscription=_540.subscription;_530(_541);break;default:_536(_541);break;}}};function _542(_543){var _544=_48b[_543];if(_544){for(var i=0;i<_544.length;++i){if(_544[i]){return true;}}}return false;};function _545(_546,_547){var _548={scope:_546,method:_547};if(_4a0(_546)){_548.scope=undefined;_548.method=_546;}else{if(_49e(_547)){if(!_546){throw "Invalid scope "+_546;}_548.method=_546[_547];if(!_4a0(_548.method)){throw "Invalid callback "+_547+" for scope "+_546;}}else{if(!_4a0(_547)){throw "Invalid callback "+_547;}}}return _548;};function _549(_54a,_54b,_54c,_54d){var _54e=_545(_54b,_54c);_480._debug("Adding",_54d?"listener":"subscription","on",_54a,"with scope",_54e.scope,"and callback",_54e.method);var _54f={channel:_54a,scope:_54e.scope,callback:_54e.method,listener:_54d};var _550=_48b[_54a];if(!_550){_550=[];_48b[_54a]=_550;}_54f.id=_550.push(_54f)-1;_480._debug("Added",_54d?"listener":"subscription",_54f);_54f[0]=_54a;_54f[1]=_54f.id;return _54f;};this.registerTransport=function(type,_551,_552){var _553=_483.add(type,_551,_552);if(_553){this._debug("Registered transport",type);if(_4a0(_551.registered)){_551.registered(type,this);}}return _553;};this.getTransportTypes=function(){return _483.getTransportTypes();};this.unregisterTransport=function(type){var _554=_483.remove(type);if(_554!==null){this._debug("Unregistered transport",type);if(_4a0(_554.unregistered)){_554.unregistered();}}return _554;};this.unregisterTransports=function(){_483.clear();};this.findTransport=function(name){return _483.find(name);};this.configure=function(_555){_4a6.call(this,_555);};this.init=function(_556,_557){this.configure(_556);this.handshake(_557);};this.handshake=function(_558,_559){_4b5("disconnected");_493=false;_4fb(_558,_559);};this.disconnect=function(sync,_55a,_55b){if(_4b7()){return;}if(typeof sync!=="boolean"){_55b=_55a;_55a=sync;sync=false;}if(_4a0(_55a)){_55b=_55a;_55a=undefined;}var _55c={channel:"/meta/disconnect",_callback:_55b};var _55d=this._mixin(false,{},_55a,_55c);_4b5("disconnecting");_4db(sync===true,[_55d],false,"disconnect");};this.startBatch=function(){_4eb();};this.endBatch=function(){_4ee();};this.batch=function(_55e,_55f){var _560=_545(_55e,_55f);this.startBatch();try{_560.method.call(_560.scope);this.endBatch();}catch(x){this._info("Exception during execution of batch",x);this.endBatch();throw x;}};this.addListener=function(_561,_562,_563){if(arguments.length<2){throw "Illegal arguments number: required 2, got "+arguments.length;}if(!_49e(_561)){throw "Illegal argument type: channel must be a string";}return _549(_561,_562,_563,true);};this.removeListener=function(_564){if(!_564||!_564.channel||!("id" in _564)){throw "Invalid argument: expected subscription, not "+_564;}_4ad(_564);};this.clearListeners=function(){_48b={};};this.subscribe=function(_565,_566,_567,_568,_569){if(arguments.length<2){throw "Illegal arguments number: required 2, got "+arguments.length;}if(!_49e(_565)){throw "Illegal argument type: channel must be a string";}if(_4b7()){throw "Illegal state: already disconnected";}if(_4a0(_566)){_569=_568;_568=_567;_567=_566;_566=undefined;}if(_4a0(_568)){_569=_568;_568=undefined;}var send=!_542(_565);var _56a=_549(_565,_566,_567,false);if(send){var _56b={channel:"/meta/subscribe",subscription:_565,_callback:_569};var _56c=this._mixin(false,{},_568,_56b);_4e7(_56c);}return _56a;};this.unsubscribe=function(_56d,_56e,_56f){if(arguments.length<1){throw "Illegal arguments number: required 1, got "+arguments.length;}if(_4b7()){throw "Illegal state: already disconnected";}if(_4a0(_56e)){_56f=_56e;_56e=undefined;}this.removeListener(_56d);var _570=_56d.channel;if(!_542(_570)){var _571={channel:"/meta/unsubscribe",subscription:_570,_callback:_56f};var _572=this._mixin(false,{},_56e,_571);_4e7(_572);}};this.resubscribe=function(_573,_574){_4b0(_573);if(_573){return this.subscribe(_573.channel,_573.scope,_573.callback,_574);}return undefined;};this.clearSubscriptions=function(){_4b2();};this.publish=function(_575,_576,_577,_578){if(arguments.length<1){throw "Illegal arguments number: required 1, got "+arguments.length;}if(!_49e(_575)){throw "Illegal argument type: channel must be a string";}if(/^\/meta\//.test(_575)){throw "Illegal argument: cannot publish to meta channels";}if(_4b7()){throw "Illegal state: already disconnected";}if(_4a0(_576)){_578=_576;_576=_577={};}else{if(_4a0(_577)){_578=_577;_577={};}}var _579={channel:_575,data:_576,_callback:_578};var _57a=this._mixin(false,{},_577,_579);_4e7(_57a);};this.getStatus=function(){return _485;};this.isDisconnected=_4b7;this.setBackoffIncrement=function(_57b){_495.backoffIncrement=_57b;};this.getBackoffIncrement=function(){return _495.backoffIncrement;};this.getBackoffPeriod=function(){return _48c;};this.setLogLevel=function(_57c){_495.logLevel=_57c;};this.registerExtension=function(name,_57d){if(arguments.length<2){throw "Illegal arguments number: required 2, got "+arguments.length;}if(!_49e(name)){throw "Illegal argument type: extension name must be a string";}var _57e=false;for(var i=0;i<_48e.length;++i){var _57f=_48e[i];if(_57f.name===name){_57e=true;break;}}if(!_57e){_48e.push({name:name,extension:_57d});this._debug("Registered extension",name);if(_4a0(_57d.registered)){_57d.registered(name,this);}return true;}else{this._info("Could not register extension with name",name,"since another extension with the same name already exists");return false;}};this.unregisterExtension=function(name){if(!_49e(name)){throw "Illegal argument type: extension name must be a string";}var _580=false;for(var i=0;i<_48e.length;++i){var _581=_48e[i];if(_581.name===name){_48e.splice(i,1);_580=true;this._debug("Unregistered extension",name);var ext=_581.extension;if(_4a0(ext.unregistered)){ext.unregistered();}break;}}return _580;};this.getExtension=function(name){for(var i=0;i<_48e.length;++i){var _582=_48e[i];if(_582.name===name){return _582.extension;}}return null;};this.getName=function(){return _481;};this.getClientId=function(){return _487;};this.getURL=function(){if(_484&&typeof _495.urls==="object"){var url=_495.urls[_484.getType()];if(url){return url;}}return _495.url;};this.getTransport=function(){return _484;};this.getConfiguration=function(){return this._mixin(true,{},_495);};this.getAdvice=function(){return this._mixin(true,{},_48f);};org.cometd.WebSocket=window.WebSocket;if(!org.cometd.WebSocket){org.cometd.WebSocket=window.MozWebSocket;}};if(typeof define==="function"&&define.amd){define("org/cometd",function(){return org.cometd;});}},"cb/board/timeline/CommentActivityDialog":function(){define(["dojo","dojo/when","dojo/query","dojo/on","dojo/_base/array","dojo/_base/lang","dojo/dom-construct","dojo/date/stamp","dojo/date/locale","dojox/lang/functional","sp/dialog/TooltipDialog","sp/dialog/DialogContentWithoutTemplate","dojo/_base/Deferred","dojo/DeferredList","sp/infos/InfoManager","cb/widget/UserIconListEntry","cb/ext/timeago/Timeago","cb/common/UserListUtils","wp/data/SequenceHelper","sp/I18n","cb/util","cb/util-mentions","cb/util-text","dojo/i18n!../nls/Messages","dojo/NodeList-traverse","dojo/NodeList-dom"],function(dojo,when,_583,on,arr,lang,_584,_585,_586,_587,_588,_589,_58a,_58b,_58c,_58d,_58e,_58f,_590,_591,_592,_593,_594,i18n){var _595=_591.wrap(i18n);return dojo.declare([_588],{txtGIdsSorted:null,baseClass:"comment-activity-dialog",complexOrient:{"TR":"TL","BR":"BL"},invisibleMilk:true,featureRegistrationSelfsignup:false,postCreate:function(){this.inherited(arguments);this.content=new _589({i18n:i18n,dialog:this,featureRegistrationSelfsignup:this.featureRegistrationSelfsignup,postCreate:function(){this.inherited("postCreate",arguments);var _596=dojo.create("div",{"class":"dialog-title"},this.domNode);var _597=this.dialog.mode=="TASKS"?this.dialog.myOpenTasksTxtGIdsSorted:this.dialog.commentsTxtGIdsSorted;if(_597&&_597.length>0){this.renderTextGroups(_597);if(this.dialog.mode=="TASKS"){_596.innerHTML=_595("my_open_tasks_title",[_597.length]);}else{_596.innerHTML=_595("all_comments_title",[_597.length]);}}else{var _598="";if(this.dialog.mode=="TASKS"){if(this.featureRegistrationSelfsignup&&(!sp||!sp.info||!sp.info.company||!sp.info.company.id)){if(sp.info.user&&!sp.info.user.isNamedGuest&&!sp.info.user.isAnonymous){_598=_595("my_open_tasks_title_empty_basic");}else{_598=_595("my_open_tasks_title_empty_guest");}}else{_598=_595("my_open_tasks_title_empty");}}else{_598=_595("all_comments_title_empty");}_596.innerHTML=_598;}},renderTextGroups:function(_599){if(this.textGroupsContainer){_584.orphan(this.textGroupsContainer);}if(_599&&_599.length>0){this.textGroupsContainer=dojo.create("ul",{"class":"text-groups-container scroll-container pretty-scrollbars"},this.domNode);for(var i=0;i<_599.length;i++){var _59a=_599[i];var _59b=sp.global.pad.container.getItem(_59a);var _59c=sp.global.pad.container.getTextEntryItems(_59a);if(_59c&&_59c.length>0){this.renderTextGroupForId(_59a,_59b,_59c,this.textGroupsContainer);}}}},renderTextGroupForId:function(_59d,_59e,_59f,_5a0){var n=_59f.length;var _5a1=dojo.create("li",{"class":"text-group"},_5a0);if(_59e.taskStatus&&(_59e.taskStatus=="open"||_59e.taskStatus=="onhold"||_59e.taskStatus=="closed")){if(this.isOpenForMe(_59d)){dojo.addClass(_5a1,"taskstatus-open-for-me");}else{if(_59e.taskStatus=="closed"){dojo.addClass(_5a1,"taskstatus-closed");}else{dojo.addClass(_5a1,"taskstatus-open");}}var _5a2=null;if(_59e.taskStatus==="closed"){_5a2="fonticon-task-round-done";}else{if(_59e.taskStatus==="open"&&this.isOpenForMe(_59d)){_5a2="fonticon-task-open-for-me";}else{if(_59e.taskStatus==="open"){_5a2="fonticon-task-open";}}}var _5a3=dojo.create("div",{"class":"opentasks-count","innerHTML":"<i class=\"icon "+_5a2+"\"></i>"},_5a1);}var _5a4=dojo.create("ul",{"class":"text-entries-container"},_5a1);this.renderTextEntry(_59f[0],_5a4);if(n>1){this.renderTextEntry(_59f[n-1],_5a4,n);}this.own(on(_5a1,"click",dojo.hitch(this,function(_5a5){this.handleClick(_5a5,_59d);})));},renderTextEntry:function(_5a6,_5a7,n){var _5a8=dojo.create("li",{"class":"clearfix"},_5a7);if(n>2){dojo.create("div",{"class":"clearfix more-entries-hint","innerHTML":(n-2)+" "+_595("more_comments")},_5a8);}var _5a9=_584.create("ul",{"class":"user-image-container"},_5a8);_584.place(new _58d({userid:_5a6.authorid}).domNode,_5a9);var _5aa=dojo.create("p",{"innerHTML":_5a6.text},_5a8);when(this._enrichTextEntryContent(_5aa,_5a6.text)).then(dojo.hitch(this,function(){if(_5a6.authorid){sp.infos.getInstance().getById({type:sp.infos.TYPE.user,id:_5a6.authorid}).addCallback(function(_5ab){dojo.create("span",{"class":"displayname","innerHTML":_591.esc(_5ab.user.displayname)+": "},_5aa,"first");});}dojo.create("span",{"class":"modified-at","innerHTML":_58e.formatDate(new Date(this.dialog.latestTimestampsPerTxtG[_5a6.txtGId]))},_5a8,"last");}));},handleClick:function(_5ac,_5ad){if(_5ad){sp.global.analytics.trackEvent(this.dialog.mode.toLowerCase()+"Dialog","navigateToItem");dojo.hash("#item="+_5ad,true);_5ac.preventDefault();_5ac.stopPropagation();}},isOpenForMe:function(_5ae){if(this.dialog.myOpenTasksTxtGIdsSorted){return arr.indexOf(this.dialog.myOpenTasksTxtGIdsSorted,_5ae)>-1;}},_enrichTextEntryContent:function(_5af,_5b0){if(_5af){return when(_594.convertTextToFullyEnrichedMarkup(_5b0)).then(function(text){_5af.innerHTML=text;});}}});},createAndConnectCloseHandler:function(){arr.forEach(["/sp/pad/controller/mousedown","/window/resize"],function(_5b1){this.subscribe(_5b1,_592.wrapDefer(function(){this.hide();if(this.onCancel){this.onCancel();}}));},this);}});});},"wp/data/item/GroupItem":function(){define("wp/data/item/GroupItem",["dijit","dojo","dojox","dojo/require!wp/data/Item"],function(_5b2,dojo,_5b3){dojo.provide("wp.data.item.GroupItem");dojo.require("wp.data.Item");dojo.declare("wp.data.item.GroupItem",wp.data.Item,{constructor:function(map){this.type="group";},draw:function(_5b4){},json:function(){return {"type":this.type,"del":this.del,"id":this.id,"seq":this.seq,"ids":this.ids,"authorid":this.authorid,"origAuthorid":this.origAuthorid,"origSeq":this.origSeq,"origDte":this.origDte,"dte":this.dte};}});});},"wp/handler/workflow/FreeLineWorkflow":function(){define("wp/handler/workflow/FreeLineWorkflow",["dijit","dojo","dojox"],function(_5b5,dojo,_5b6){dojo.provide("wp.handler.workflow.FreeLineWorkflow");dojo.declare("wp.handler.workflow.FreeLineWorkflow",null,{constructor:function(pad){this.type="FREELINE";this._pad=pad;},localReset:function(){this.previewId=null;this.pointArray=null;},terminateWorkflow:function(){return this.pointArray&&this.pointArray.points&&this.pointArray.points.length>0;},startWorkflow:function(iCS){this.localReset();this.previewId=this._pad.generateItemId();this.pointArray=new wp.PointArray();},processWorkflow:function(iCS,_5b7){var _5b8={x:iCS.positionX,y:iCS.positionY};var _5b9={x:_5b7.positionX,y:_5b7.positionY};this.pointArray.add(_5b9);var _5ba=this._pad.controller.getPreviewPropsByTool(iCS.currentTool);var _5bb=_5b7.shiftKey;var _5bc=_5bb?"line":_5ba.type;var item=null;if(_5bc=="freeLine"){item=this._pad.factory.getNewItem(_5bc,_5ba,"0");item.id=this.previewId;item.a=_5b8;item.pa=this.pointArray;item.lw=item.lw*1+2;}else{item=this._pad.factory.getNewItem(_5bc,_5ba);item.id=this.previewId;item.a=_5b8;item.b=this.pointArray.points[this.pointArray.points.length-1];if(_5ba.fixAlignment){var _5bd=wp.common.MathsHelper.fixSingleAlignment([item.a,item.b]);if(_5bd){item.a=_5bd[0];item.b=_5bd[1];}}}this._pad.controller.previewNewItems([item]);},endWorkflow:function(iCS,_5be){var _5bf={x:iCS.positionX,y:iCS.positionY};var _5c0={x:_5be.positionX,y:_5be.positionY};this.pointArray.add(_5c0);var _5c1=this._pad.controller.getFinalPropArrayByTool(iCS.currentTool);if(_5c1.length!=1){throw new Error("Invalid prop array length while ending free line workflow!");}var _5c2=_5c1[0];var _5c3=_5be.shiftKey;var _5c4=_5c3?"line":_5c2.type;var item=null;if(_5c4=="freeLine"){item=this._pad.factory.getNewItem(_5c4,_5c2,"5");item.id=this.previewId;item.a=_5bf;item.pa=this.pointArray;var _5c5=item.pa.points.length;var _5c6=[];_5c6.push(item.a);_5c6=_5c6.concat(item.pa.points);var _5c7=sp.isTouchOnly?0.5:2;var size=Math.max(item.getBBox().getWidth(),item.getBBox().getHeight());var m=0.01;var _5c8=m*size+_5c7;var _5c9=wp.common.MathsHelper.simplifyPath(_5c6,_5c8);_5c9.shift();item.pa.points=_5c9;var _5ca=item.pa.points.length;}else{item=this._pad.factory.getNewItem(_5c4,_5c2);item.id=this.previewId;item.a=_5bf;item.b=this.pointArray.points[this.pointArray.points.length-1];if(_5c2.fixAlignment){var _5cb=wp.common.MathsHelper.fixSingleAlignment([item.a,item.b]);if(_5cb){item.a=_5cb[0];item.b=_5cb[1];}}}this._pad.controller.saveNewItems([item]);this.localReset();this.terminateWorkflow();}});});},"cb/ext/es6-fromcodepoint-shim":function(){define(function(){return String.fromCodePoint||function fromCodePoint(){var _5cc=[],_5cd,_5ce,_5cf,i;for(i=0;i<arguments.length;++i){_5cd=arguments[i];_5ce=_5cd-65536;_5cf=_5cd>65535?[55296+(_5ce>>10),56320+(_5ce&1023)]:[_5cd];_5cc.push(String.fromCharCode.apply(null,_5cf));}return _5cc.join("");};});},"wp/data/item/ImageItem":function(){define("wp/data/item/ImageItem",["dijit","dojo","dojox","dojo/require!wp/data/Item,wp/data/item/BaseImageItem"],function(_5d0,dojo,_5d1){dojo.provide("wp.data.item.ImageItem");dojo.require("wp.data.Item");dojo.require("wp.data.item.BaseImageItem");dojo.declare("wp.data.item.ImageItem",[wp.data.item.BaseImageItem],{constructor:function(map,_5d2){this.type="image";},getImageUrl:function(){return this.imgPrefix+this.src+".snap.png";}});});},"wp/data/item/EllipseItem":function(){define("wp/data/item/EllipseItem",["dijit","dojo","dojox","dojo/require!wp/data/Item"],function(_5d3,dojo,_5d4){dojo.provide("wp.data.item.EllipseItem");dojo.require("wp.data.Item");dojo.declare("wp.data.item.EllipseItem",wp.data.Item,{constructor:function(map){this.type="ellipse";},draw:function(_5d5){if(this.del){return;}var fill=wp.common.ColorHelper.convertHexAndPercentToDojoColor(this.lc,this.fo);var _5d6=this.ls.toLowerCase()!="none"?this.lw:"0";var _5d7=this.ls.toLowerCase()!="none"?this.ls:"solid";var _5d8=this.ls.toLowerCase()!="none"?this.lo:"0";var _5d9=wp.common.ColorHelper.convertHexAndPercentToDojoColor(this.lc,_5d8);var _5da={color:_5d9,width:_5d6,style:_5d7,cap:"butt",join:"round"};var rx=Math.abs(Math.round((this.a.x-this.b.x)/2));var ry=Math.abs(Math.round((this.a.y-this.b.y)/2));var cx=Math.min(this.a.x,this.b.x)+rx;var cy=Math.min(this.a.y,this.b.y)+ry;if(rx<1){rx=1;}if(ry<1){ry=1;}var cxZ=cx;var cyZ=cy;var rxZ=rx;var ryZ=ry;var _5db=_5d5.createEllipse({cx:cxZ,cy:cyZ,rx:rxZ,ry:ryZ}).setStroke(_5da);if(this.fo>0){_5db.setFill(fill);}if(_5da.width<this.MIN_LINE_WIDTH){_5d5.createEllipse({cx:cxZ,cy:cyZ,rx:rxZ,ry:ryZ}).setStroke(this.TRANSPARENT_STROKE);}},json:function(){return {"type":this.type,"authorid":this.authorid,"origAuthorid":this.origAuthorid,"origSeq":this.origSeq,"origDte":this.origDte,"del":this.del,"id":this.id,"seq":this.seq,"z":this.z,"fc":this.fc,"fo":this.fo,"lc":this.lc,"lo":this.lo,"lw":this.lw,"ls":this.ls,"a":this.a,"b":this.b};}});});},"url:cb/page/pad/SaveStateDisplay.html":"<div class=\"hd-save-container\">\n    <span class=\"hideBlock\" data-dojo-attach-point=\"saveLinkNode\">\n        ${!i18n.save}\n    </span>\n</div>","wp/surface/DrawerSelectionAddOn":function(){define("wp/surface/DrawerSelectionAddOn",["dijit","dojo","dojox"],function(_5dc,dojo,_5dd){dojo.provide("wp.surface.DrawerSelectionAddOn");(function(){dojo.declare("wp.surface.DrawerSelectionAddOn",null,{drawItemSelection:function(item,bbox,_5de){var _5df=this._surface.registerSelection(item.id);var _5e0=this._surface.getZoomFactor();if(item.type==="line"&&!_5de){this._drawSelectionLineStyle(_5df,item.a,item.b,_5e0);}else{this._drawSelectionStandardStyle(_5df,bbox,_5e0,_5de,item.type,item.subtype);}},drawWrappingSelection:function(bbox){var _5e1=this._surface.registerSelection("WRAPPER_ID");var _5e2=this._surface.getZoomFactor();this._drawSelectionStandardStyle(_5e1,bbox,_5e2);},drawAttachedSourceSelection:function(id,_5e3){var _5e4=this._surface.registerSelection(id);var _5e5=_5e3.x/100;var _5e6=_5e3.y/100;this._createSelectionResizeDot(_5e4,"__9_attach",_5e5,_5e6);},_drawSelectionStandardStyle:function(_5e7,bbox,_5e8,_5e9,_5ea,_5eb){var x1=bbox.p1.x/100;var x2=(bbox.p1.x+bbox.p2.x)/200;var x3=bbox.p2.x/100;var y1=bbox.p1.y/100;var y2=(bbox.p1.y+bbox.p2.y)/200;var y3=bbox.p2.y/100;if(!_5e9){this._createMoveCross(_5e7,"__0",x1,y1,_5ea==="txtG"?"textbox-only-selected":"");}if(_5ea==="txtG"){if(_5e9){this._createSelectionFrame(_5e7,"__0",x1,y1,x3-x1,y3-y1);}else{this._createSelectionResizeDot(_5e7,"__6",x1,y2);this._createSelectionResizeDot(_5e7,"__2",x3,y2);}}else{this._createSelectionFrame(_5e7,"__0",x1,y1,x3-x1,y3-y1);if(!_5e9){var _5ec=8;var _5ed=bbox.getWidth()*_5e8;var _5ee=bbox.getHeight()*_5e8;if(_5ea==="image"||_5ed<32||_5ee<32){_5ec=4;}if(_5ed<16||_5ee<16){_5ec=1;}if(_5ea==="image"&&_5ed>32&&_5ee>32){this._createSelectionCroppingDash(_5e7,"__8_crop",x2,y1,"top");this._createSelectionCroppingDash(_5e7,"__4_crop",x2,y3,"bottom");this._createSelectionCroppingDash(_5e7,"__6_crop",x1,y2,"left");this._createSelectionCroppingDash(_5e7,"__2_crop",x3,y2,"right");}if(_5ec>4){this._createSelectionResizeDot(_5e7,"__8",x2,y1);this._createSelectionResizeDot(_5e7,"__4",x2,y3);this._createSelectionResizeDot(_5e7,"__6",x1,y2);this._createSelectionResizeDot(_5e7,"__2",x3,y2);}if(_5ec>1){this._createSelectionResizeDot(_5e7,"__5",x1,y3);this._createSelectionResizeDot(_5e7,"__1",x3,y1);this._createSelectionResizeDot(_5e7,"__7",x1,y1);}this._createSelectionResizeDot(_5e7,"__3",x3,y3);}}},_drawSelectionLineStyle:function(_5ef,_5f0,_5f1,_5f2){var a={x:_5f0.x/100,y:_5f0.y/100};var b={x:_5f1.x/100,y:_5f1.y/100};var _5f3=Math.sqrt(Math.pow((b.x-a.x),2)+Math.pow((b.y-a.y),2))*_5f2;if(_5f3>0.3){var _5f4={x:a.x+((b.x-a.x)/2),y:a.y+((b.y-a.y)/2)};this._createMoveCross(_5ef,"__0",_5f4.x,_5f4.y,"centered-line-offset");}if(a.x>=b.x&&a.y<b.y){this._createSelectionResizeDot(_5ef,"__1",a.x,a.y);this._createSelectionResizeDot(_5ef,"__5",b.x,b.y);}else{if(a.x>=b.x&&a.y>=b.y){this._createSelectionResizeDot(_5ef,"__3",a.x,a.y);this._createSelectionResizeDot(_5ef,"__7",b.x,b.y);}else{if(a.x<b.x&&a.y>=b.y){this._createSelectionResizeDot(_5ef,"__5",a.x,a.y);this._createSelectionResizeDot(_5ef,"__1",b.x,b.y);}else{this._createSelectionResizeDot(_5ef,"__7",a.x,a.y);this._createSelectionResizeDot(_5ef,"__3",b.x,b.y);}}}},_createSelectionFrame:function(_5f5,_5f6,_5f7,_5f8,_5f9,_5fa){var _5fb=dojo.create("div",{"style":{position:"absolute",left:_5f7+"em",top:_5f8+"em"}},_5f5);var _5fc=dojo.create("div",{"style":{position:"absolute",left:_5f7+"em",top:(1*_5f8+1*_5fa)+"em"}},_5f5);var _5fd=dojo.create("div",{"style":{position:"absolute",left:_5f7+"em",top:_5f8+"em"}},_5f5);var _5fe=dojo.create("div",{"style":{position:"absolute",left:(1*_5f7+1*_5f9)+"em",top:_5f8+"em"}},_5f5);dojo.create("div",{"class":"selection-border top cur_sel__0","sid":_5f6,"style":{width:_5f9+"em"}},_5fb);dojo.create("div",{"class":"selection-border bottom cur_sel__0","sid":_5f6,"style":{width:_5f9+"em"}},_5fc);dojo.create("div",{"class":"selection-border left cur_sel__0","sid":_5f6,"style":{height:_5fa+"em"}},_5fd);dojo.create("div",{"class":"selection-border right cur_sel__0","sid":_5f6,"style":{height:_5fa+"em"}},_5fe);dojo.create("div",{"class":"selection-border-overlay top cur_sel__0","sid":_5f6,"style":{width:_5f9+"em"}},_5fb);dojo.create("div",{"class":"selection-border-overlay bottom cur_sel__0","sid":_5f6,"style":{width:_5f9+"em"}},_5fc);dojo.create("div",{"class":"selection-border-overlay left cur_sel__0","sid":_5f6,"style":{height:_5fa+"em"}},_5fd);dojo.create("div",{"class":"selection-border-overlay right cur_sel__0","sid":_5f6,"style":{height:_5fa+"em"}},_5fe);},_createSelectionResizeDot:function(_5ff,_600,_601,_602){var _603=dojo.create("div",{"style":{position:"absolute",left:_601+"em",top:_602+"em"}},_5ff);dojo.create("div",{"class":"selection-dot cur_sel"+_600,"sid":_600},_603);dojo.create("div",{"class":"selection-dot-overlay cur_sel"+_600,"sid":_600},_603);},_createSelectionCroppingDash:function(_604,_605,_606,_607,_608){var _609=dojo.create("div",{"style":{position:"absolute",left:_606+"em",top:_607+"em"}},_604);dojo.create("div",{"class":_608+" cropping-dash cur_sel"+_605,"sid":_605},_609);dojo.create("div",{"class":_608+" cropping-dash-overlay cur_sel"+_605,"sid":_605},_609);},_createMoveCross:function(_60a,_60b,_60c,_60d,_60e){var _60f=dojo.create("div",{"style":{position:"absolute",left:_60c+"em",top:_60d+"em"}},_60a);var _610=dojo.create("div",{"class":"move-cross "+_60e},_60f);dojo.create("div",{"class":"cross-underlay-right cur_sel"+_60b,"sid":_60b},_610);dojo.create("div",{"class":"cross-underlay-left cur_sel"+_60b,"sid":_60b},_610);dojo.create("div",{"class":"arrowhead top cur_sel"+_60b,"sid":_60b},_610);dojo.create("div",{"class":"arrowhead bottom cur_sel"+_60b,"sid":_60b},_610);dojo.create("div",{"class":"arrowhead left cur_sel"+_60b,"sid":_60b},_610);dojo.create("div",{"class":"arrowhead right cur_sel"+_60b,"sid":_60b},_610);dojo.create("div",{"class":"arrowline-h cur_sel"+_60b,"sid":_60b},_610);dojo.create("div",{"class":"arrowline-v cur_sel"+_60b,"sid":_60b},_610);dojo.create("div",{"class":"cross-overlay cur_sel"+_60b,"sid":_60b},_610);}});})();});},"cb/board/itemui/HashtagComboBoxMenu":function(){define(["dojo/_base/declare","dojo/_base/lang","dijit/registry","sp/I18n","dijit/form/_ComboBoxMenu"],function(_611,lang,_612,_613,_614){return _611([_614],{baseClass:"dijitComboBoxMenu hashtag-select-dropdown pretty-scrollbars",_createOption:function(item){var _615=this._createMenuItem();var _616;switch(item.providerId){case "trello":_616="<img src=\"/_/images/Trello-Icon_24.png\"/>";break;default:_616="";}if(item.type==="loading"){_615.innerHTML=_616+"<strong>Loading</strong>";}else{if(item.type==="social_provider_unavailable"){_615.innerHTML=_616+"<strong>your account is not connected</strong>";}else{switch(item.providerId){case "trello":_615.innerHTML=_616+"<span class=\"light\">Create new card in</span><br/><strong>"+_613.esc(item.displayname)+"</strong>";break;default:_615.innerHTML=_616+_613.esc(item.displayname);}}}return _615;}});});},"wp/data/Item":function(){define("wp/data/Item",["dijit","dojo","dojox","dojo/require!wp/common/TextHelper,wp/common/TransformHelper,wp/common/MathsHelper,wp/common/ColorHelper,dojox/gfx"],function(_617,dojo,_618){dojo.provide("wp.data.Item");dojo.require("wp.common.TextHelper");dojo.require("wp.common.TransformHelper");dojo.require("wp.common.MathsHelper");dojo.require("wp.common.ColorHelper");dojo.require("dojox.gfx");dojo.declare("wp.data.Item",null,{constructor:function(map){this.type="item";this.subtype=map.subtype||null;this.id=map.id||null;this.seq=map.seq||null;this.isWidget=null;this.authorid=map.authorid||null;this.origAuthorid=map.origAuthorid||null;this.origSeq=map.origSeq||null;this.origDte=map.origDte||null;this.del=map.del||null;this.z=this._validateNumber(map.z);this.v=map.v||null;this.fc=map.fc||"#ffffff";this.fo=map.fo||"0";this.lc=map.lc||"#ffffff";this.lo=map.lo||"100";this.lw=map.lw||"0";this.ls=map.ls||"solid";this.la=map.la||"none";this.lj=map.lj||"miter";this.src=map.src||null;this.rotate=map.rotate||null;this.dims=map.dims?{x:map.dims.x,y:map.dims.y}:null;this.a=map.a?{x:map.a.x,y:map.a.y}:null;this.pa=map.pa?new wp.PointArray(map.pa):null;this.b=map.b?{x:map.b.x,y:map.b.y}:null;this.ids=map.ids||null;this.taskStatus=map.taskStatus||null;this.title=map.title||null;this.ts=map.ts||null;this.ta=map.ta||"left";this.tf=map.tf||null;this.clip=map.clip?{x1:map.clip.x1,y1:map.clip.y1,x2:map.clip.x2,y2:map.clip.y2}:null;this.text=map.text||null;this.isTextEscaped=map.isTextEscaped||false;this.tc=map.tc||"#333333";this.txtGId=map.txtGId||null;this.dte=map.dte||null;this.collapse=map.collapse||null;this.conn=map.conn||[];this._bbox=null;this._ibbox=null;this._uncribbox=null;this.minWidth=null;this.IS_CONSTRUCTED=1;this.MIN_LINE_WIDTH=sp.isTouchOnly?28:14;this.TRANSPARENT_STROKE={color:[255,255,255,0.0001],width:this.MIN_LINE_WIDTH,style:"solid"};this.previewTransformMode=null;this.outline=map.outline||null;this.orderingKey=map.orderingKey||null;this.origSize=map.origSize||null;},_validateNumber:function(_619){return (_619===0||_619)?_619+"":null;},draw:function(_61a,_61b){},json:function(){},getSeqAsString:function(){return this.seq!==null?this.seq.hi+"-"+this.seq.low:null;},resetBBox:function(){this._bbox=null;this._ibbox=null;this._uncribbox=null;},getBBox:function(){if(!this._bbox){this._updateBBox();}return this._bbox;},getInnerBBox:function(){if(!this._ibbox){this._updateBBox();}return this._ibbox;},getUnclippedUnrotatedBBox:function(){if(!this._uncribbox){this._updateBBox();}return this._uncribbox;},makesSense:function(){return this.getInnerBBox().getWidth()>1||this.getInnerBBox().getHeight()>1;},_updateBBox:function(){if(this.a){this._bbox=new wp.BBox({x:this.a.x,y:this.a.y},{x:this.a.x,y:this.a.y});if(this.b){this._bbox.expand(this.b);}if(this.pa&&this.pa.points){var _61c=this.pa.points.length;for(var i=0;i<_61c;i++){this._bbox.expand(this.pa.points[i]);}}this._uncribbox=new wp.BBox({x:this._bbox.p1.x,y:this._bbox.p1.y},{x:this._bbox.p2.x,y:this._bbox.p2.y});if(this.clip){var clip=this.clip;if(clip.x1>=0&&clip.x1<clip.x2&&clip.x2<=1&&clip.y1>=0&&clip.y1<clip.y2&&clip.y2<=1){var _61d=this._bbox.p1.x;var _61e=this._bbox.p1.y;var _61f=this._bbox.getWidth();var _620=this._bbox.getHeight();this._bbox.p1.x=_61d+clip.x1*_61f;this._bbox.p2.x=_61d+clip.x2*_61f;this._bbox.p1.y=_61e+clip.y1*_620;this._bbox.p2.y=_61e+clip.y2*_620;}}if(this.rotate){var _621=this.getFixedRotateDegree();if(_621!==0){this._bbox.rotate(_621,this._uncribbox.getCenter());}}this._ibbox=new wp.BBox({x:this._bbox.p1.x,y:this._bbox.p1.y},{x:this._bbox.p2.x,y:this._bbox.p2.y});if(this.lw&&(this.lw>1)){var _622=Math.floor(this.lw/2);this._bbox.p1.x-=_622;this._bbox.p1.y-=_622;this._bbox.p2.x+=_622;this._bbox.p2.y+=_622;}}else{this._bbox=null;this._ibbox=null;}},getIds:function(){if(!this.ids){return null;}else{var ret=[],curr;for(var i=0;i<this.ids.length;i++){curr=this.ids[i];if(curr===this.id){continue;}ret.push();}return ret;}},getFixedAuthorId:function(){return this.origAuthorid?this.origAuthorid:this.authorid;},getFixedRotateDegree:function(){if(this.rotate){var _623=1*this.rotate;if(_623>=45&&_623<135){_623=90;}else{if(_623>=135&&_623<225){_623=180;}else{if(_623>=225&&_623<315){_623=270;}else{_623=0;}}}return _623;}return 0;}});});},"dijit/form/SimpleTextarea":function(){define(["dojo/_base/declare","dojo/dom-class","dojo/sniff","./TextBox"],function(_624,_625,has,_626){return _624("dijit.form.SimpleTextarea",_626,{baseClass:"dijitTextBox dijitTextArea",rows:"3",cols:"20",templateString:"<textarea ${!nameAttrSetting} data-dojo-attach-point='focusNode,containerNode,textbox' autocomplete='off'></textarea>",postMixInProperties:function(){if(!this.value&&this.srcNodeRef){this.value=this.srcNodeRef.value;}this.inherited(arguments);},buildRendering:function(){this.inherited(arguments);if(has("ie")&&this.cols){_625.add(this.textbox,"dijitTextAreaCols");}},filter:function(_627){if(_627){_627=_627.replace(/\r/g,"");}return this.inherited(arguments);},_onInput:function(e){if(this.maxLength){var _628=parseInt(this.maxLength);var _629=this.textbox.value.replace(/\r/g,"");var _62a=_629.length-_628;if(_62a>0){var _62b=this.textbox;if(_62b.selectionStart){var pos=_62b.selectionStart;var cr=0;if(has("opera")){cr=(this.textbox.value.substring(0,pos).match(/\r/g)||[]).length;}this.textbox.value=_629.substring(0,pos-_62a-cr)+_629.substring(pos-cr);_62b.setSelectionRange(pos-_62a,pos-_62a);}else{if(this.ownerDocument.selection){_62b.focus();var _62c=this.ownerDocument.selection.createRange();_62c.moveStart("character",-_62a);_62c.text="";_62c.select();}}}}this.inherited(arguments);}});});},"sp/dialog/ConnectivityDialog":function(){define(["dijit","dojo","dojox","dojo/i18n!sp/dialog/nls/ConnectivityDialog","dojo/require!sp/dialog/TooltipDialog,sp/I18n"],function(_62d,dojo,_62e){dojo.provide("sp.dialog.ConnectivityDialog");dojo.require("sp.dialog.TooltipDialog");dojo.require("sp.I18n");dojo.requireLocalization("sp.dialog","ConnectivityDialog");(function(){dojo.cache("sp.dialog","ConnectivityDialog.html","<div class=\"dialog-content\">\n    <p dojoAttachPoint=\"_spinner\"               style=\"margin:20px 0; height:60px; background:url('/_/images/ajax-loader-medium.gif') no-repeat scroll center center #ffffff;\"></p>\n    <p dojoAttachPoint=\"_connectivityMessage\"   style=\"margin:-20px 0 20px; padding:0 30px; text-align: center;\"></p>\n    <p class=\"center hideBlock\" dojoAttachPoint=\"_reloadLink\">\n        <span class=\"link\" data-dojo-attach-event=\"click:_reloadLinkClick\">${!i18n.reload_link}</span>\n    </p>\n</div>");dojo.declare("sp.dialog.ConnectivityDialog",[sp.dialog.TooltipDialog],{title:null,documentTitle:null,baseClass:"body-content connectivity-warning-dialog",destroyOnHide:false,constructor:function(){this.title=sp.I18n.get("sp.dialog","ConnectivityDialog")("title");},postCreate:function(){this.inherited("postCreate",arguments);this.content=new sp.dialog.DialogContent({templateString:dojo.cache("sp.dialog","ConnectivityDialog.html","<div class=\"dialog-content\">\n    <p dojoAttachPoint=\"_spinner\"               style=\"margin:20px 0; height:60px; background:url('/_/images/ajax-loader-medium.gif') no-repeat scroll center center #ffffff;\"></p>\n    <p dojoAttachPoint=\"_connectivityMessage\"   style=\"margin:-20px 0 20px; padding:0 30px; text-align: center;\"></p>\n    <p class=\"center hideBlock\" dojoAttachPoint=\"_reloadLink\">\n        <span class=\"link\" data-dojo-attach-event=\"click:_reloadLinkClick\">${!i18n.reload_link}</span>\n    </p>\n</div>"),dialog:this,i18n:sp.I18n.bundle("sp.dialog","ConnectivityDialog"),closeLinkText:null,_reloadLinkClick:function(){this.dialog._reloadLinkClick();}});},_onSubmit:function(_62f){},onCancel:function(_630){},_reloadLinkClick:function(){this.removeMessages();this.disableReloadLink();window.location.reload();},createAndConnectCloseHandler:function(){this.inherited(arguments);dojo.disconnect(this.closeHandler);},enableReloadLink:function(){dojo.removeClass(this.content._reloadLink,"hideBlock");},disableReloadLink:function(){dojo.addClass(this.content._reloadLink,"hideBlock");},removeMessages:function(){dojo.html.set(this.content._connectivityMessage,"");},addMessage:function(msg){if(msg==="SURFACE-LOADED"||msg==="BAYEUX-FULLY-INITIATED"||msg==="CONTAINER-FULLY-INITIATED"||msg==="DRAWER-FULLY-INITIATED"){return;}dojo.html.set(this.content._connectivityMessage,this.content._connectivityMessage.innerHTML+"<br/>"+msg);},disableSpinner:function(){dojo.addClass(this.content._spinner,"hideBlock");},enableSpinner:function(){dojo.removeClass(this.content._spinner,"hideBlock");}});})();});},"dojo/dnd/AutoSource":function(){define(["../_base/declare","./Source"],function(_631,_632){return _631("dojo.dnd.AutoSource",_632,{constructor:function(){this.autoSync=true;}});});},"wp/data/item/LineItem":function(){define("wp/data/item/LineItem",["dijit","dojo","dojox","dojo/require!wp/data/Item"],function(_633,dojo,_634){dojo.provide("wp.data.item.LineItem");dojo.require("wp.data.Item");dojo.declare("wp.data.item.LineItem",wp.data.Item,{constructor:function(map){this.type="line";},draw:function(_635){if(this.del){return;}var MH=wp.common.MathsHelper;var _636=this.ls.toLowerCase()!="none"?this.lw:"0";var _637=this.ls.toLowerCase()!="none"?this.ls:"solid";var _638=this.ls.toLowerCase()!="none"?this.lo:"0";var _639=wp.common.ColorHelper.convertHexAndPercentToDojoColor(this.lc,_638);var _63a={color:_639,width:_636,style:_637,cap:"butt",join:this.lj};var _63b={color:_639,width:_636,style:"solid",cap:"butt",join:this.lj};var _63c=Math.round(this.lw*3)+1;var _63d=this.a;var _63e=this.b;var _63f=Math.round(1*_636)%2===0?0:0.5;_63d={x:Math.round(_63d.x)+_63f,y:Math.round(_63d.y)+_63f};_63e={x:Math.round(_63e.x)+_63f,y:Math.round(_63e.y)+_63f};if(this.la==="target"||this.la==="both"){this._drawArrowHead(_63d,_63e,_63c,_635,_63b,_639);}if(this.la==="source"||this.la==="both"){this._drawArrowHead(_63e,_63d,_63c,_635,_63b,_639);}this._drawStraightLineWithTransparentUnderlay({x1:_63d.x,y1:_63d.y,x2:_63e.x,y2:_63e.y},_63a,_635);},_drawArrowHead:function(_640,_641,_642,_643,_644,_645){var _646=wp.common.MathsHelper.calculateArrowHead(_640,_641,_642);if(_646){_643.createPath().moveTo(_641.x,_641.y).lineTo(_640.x+_646.points[0].x,_640.y+_646.points[0].y).lineTo(_640.x+_646.points[1].x,_640.y+_646.points[1].y).closePath().setStroke(_644).setFill(_645);}},_drawStraightLineWithTransparentUnderlay:function(_647,_648,_649){if(_648.width<this.MIN_LINE_WIDTH){_649.createLine(_647).setStroke(this.TRANSPARENT_STROKE);}_649.createLine(_647).setStroke(_648);},_drawArcLineWithTransparentUnderlay:function(_64a,_64b,_64c){var xh=(_64a.x1+_64a.x2)/2;var yh=(_64a.y1+_64a.y2)/2;if(_64b.width<this.MIN_LINE_WIDTH){_64c.createPath().moveTo(_64a.x1,_64a.y1).smoothCurveTo(xh,yh,_64a.x2,_64a.y2).setStroke(this.TRANSPARENT_STROKE);}_64c.createPath().moveTo(_64a.x1,_64a.y1).smoothCurveTo(xh,yh,_64a.x2,_64a.y2).setStroke(_64b);},json:function(){return {"type":this.type,"del":this.del,"id":this.id,"seq":this.seq,"z":this.z,"lc":this.lc,"lo":this.lo,"lw":this.lw,"ls":this.ls,"la":this.la,"lj":this.lj,"a":this.a,"b":this.b,"authorid":this.authorid,"origAuthorid":this.origAuthorid,"origSeq":this.origSeq,"origDte":this.origDte,"dte":this.dte,"conn":this.conn};}});});},"dojox/gfx/shape":function(){define("dojox/gfx/shape",["./_base","dojo/_base/lang","dojo/_base/declare","dojo/_base/kernel","dojo/_base/sniff","dojo/_base/connect","dojo/_base/array","dojo/dom-construct","dojo/_base/Color","./matrix"],function(g,lang,_64d,_64e,has,_64f,arr,_650,_651,_652){var _653=g.shape={};var _654={};var _655={};_653.register=function(s){var t=s.declaredClass.split(".").pop();var i=t in _654?++_654[t]:((_654[t]=0));var uid=t+i;_655[uid]=s;return uid;};_653.byId=function(id){return _655[id];};_653.dispose=function(s,_656){if(_656&&s.children){for(var i=0;i<s.children.length;++i){_653.dispose(s.children[i],true);}}delete _655[s.getUID()];};_653.Shape=_64d("dojox.gfx.shape.Shape",null,{constructor:function(){this.rawNode=null;this.shape=null;this.matrix=null;this.fillStyle=null;this.strokeStyle=null;this.bbox=null;this.parent=null;this.parentMatrix=null;var uid=_653.register(this);this.getUID=function(){return uid;};},destroy:function(){_653.dispose(this);},getNode:function(){return this.rawNode;},getShape:function(){return this.shape;},getTransform:function(){return this.matrix;},getFill:function(){return this.fillStyle;},getStroke:function(){return this.strokeStyle;},getParent:function(){return this.parent;},getBoundingBox:function(){return this.bbox;},getTransformedBoundingBox:function(){var b=this.getBoundingBox();if(!b){return null;}var m=this._getRealMatrix(),gm=_652;return [gm.multiplyPoint(m,b.x,b.y),gm.multiplyPoint(m,b.x+b.width,b.y),gm.multiplyPoint(m,b.x+b.width,b.y+b.height),gm.multiplyPoint(m,b.x,b.y+b.height)];},getEventSource:function(){return this.rawNode;},setClip:function(clip){this.clip=clip;},getClip:function(){return this.clip;},setShape:function(_657){this.shape=g.makeParameters(this.shape,_657);this.bbox=null;return this;},setFill:function(fill){if(!fill){this.fillStyle=null;return this;}var f=null;if(typeof (fill)=="object"&&"type" in fill){switch(fill.type){case "linear":f=g.makeParameters(g.defaultLinearGradient,fill);break;case "radial":f=g.makeParameters(g.defaultRadialGradient,fill);break;case "pattern":f=g.makeParameters(g.defaultPattern,fill);break;}}else{f=g.normalizeColor(fill);}this.fillStyle=f;return this;},setStroke:function(_658){if(!_658){this.strokeStyle=null;return this;}if(typeof _658=="string"||lang.isArray(_658)||_658 instanceof _651){_658={color:_658};}var s=this.strokeStyle=g.makeParameters(g.defaultStroke,_658);s.color=g.normalizeColor(s.color);return this;},setTransform:function(_659){this.matrix=_652.clone(_659?_652.normalize(_659):_652.identity);return this._applyTransform();},_applyTransform:function(){return this;},moveToFront:function(){var p=this.getParent();if(p){p._moveChildToFront(this);this._moveToFront();}return this;},moveToBack:function(){var p=this.getParent();if(p){p._moveChildToBack(this);this._moveToBack();}return this;},_moveToFront:function(){},_moveToBack:function(){},applyRightTransform:function(_65a){return _65a?this.setTransform([this.matrix,_65a]):this;},applyLeftTransform:function(_65b){return _65b?this.setTransform([_65b,this.matrix]):this;},applyTransform:function(_65c){return _65c?this.setTransform([this.matrix,_65c]):this;},removeShape:function(_65d){if(this.parent){this.parent.remove(this,_65d);}return this;},_setParent:function(_65e,_65f){this.parent=_65e;return this._updateParentMatrix(_65f);},_updateParentMatrix:function(_660){this.parentMatrix=_660?_652.clone(_660):null;return this._applyTransform();},_getRealMatrix:function(){var m=this.matrix;var p=this.parent;while(p){if(p.matrix){m=_652.multiply(p.matrix,m);}p=p.parent;}return m;}});_653._eventsProcessing={connect:function(name,_661,_662){return _64f.connect(this.getEventSource(),name,_653.fixCallback(this,g.fixTarget,_661,_662));},disconnect:function(_663){_64f.disconnect(_663);}};_653.fixCallback=function(_664,_665,_666,_667){if(!_667){_667=_666;_666=null;}if(lang.isString(_667)){_666=_666||_64e.global;if(!_666[_667]){throw (["dojox.gfx.shape.fixCallback: scope[\"",_667,"\"] is null (scope=\"",_666,"\")"].join(""));}return function(e){return _665(e,_664)?_666[_667].apply(_666,arguments||[]):undefined;};}return !_666?function(e){return _665(e,_664)?_667.apply(_666,arguments):undefined;}:function(e){return _665(e,_664)?_667.apply(_666,arguments||[]):undefined;};};lang.extend(_653.Shape,_653._eventsProcessing);_653.Container={_init:function(){this.children=[];},openBatch:function(){},closeBatch:function(){},add:function(_668){var _669=_668.getParent();if(_669){_669.remove(_668,true);}this.children.push(_668);return _668._setParent(this,this._getRealMatrix());},remove:function(_66a,_66b){for(var i=0;i<this.children.length;++i){if(this.children[i]==_66a){if(_66b){}else{_66a.parent=null;_66a.parentMatrix=null;}this.children.splice(i,1);break;}}return this;},clear:function(_66c){var _66d;for(var i=0;i<this.children.length;++i){_66d=this.children[i];_66d.parent=null;_66d.parentMatrix=null;if(_66c){_66d.destroy();}}this.children=[];return this;},getBoundingBox:function(){if(this.children){var _66e=null;arr.forEach(this.children,function(_66f){var bb=_66f.getBoundingBox();if(bb){var ct=_66f.getTransform();if(ct){bb=_652.multiplyRectangle(ct,bb);}if(_66e){_66e.x=Math.min(_66e.x,bb.x);_66e.y=Math.min(_66e.y,bb.y);_66e.endX=Math.max(_66e.endX,bb.x+bb.width);_66e.endY=Math.max(_66e.endY,bb.y+bb.height);}else{_66e={x:bb.x,y:bb.y,endX:bb.x+bb.width,endY:bb.y+bb.height};}}});if(_66e){_66e.width=_66e.endX-_66e.x;_66e.height=_66e.endY-_66e.y;}return _66e;}return null;},_moveChildToFront:function(_670){for(var i=0;i<this.children.length;++i){if(this.children[i]==_670){this.children.splice(i,1);this.children.push(_670);break;}}return this;},_moveChildToBack:function(_671){for(var i=0;i<this.children.length;++i){if(this.children[i]==_671){this.children.splice(i,1);this.children.unshift(_671);break;}}return this;}};_653.Surface=_64d("dojox.gfx.shape.Surface",null,{constructor:function(){this.rawNode=null;this._parent=null;this._nodes=[];this._events=[];},destroy:function(){arr.forEach(this._nodes,_650.destroy);this._nodes=[];arr.forEach(this._events,_64f.disconnect);this._events=[];this.rawNode=null;if(has("ie")){while(this._parent.lastChild){_650.destroy(this._parent.lastChild);}}else{this._parent.innerHTML="";}this._parent=null;},getEventSource:function(){return this.rawNode;},_getRealMatrix:function(){return null;},isLoaded:true,onLoad:function(_672){},whenLoaded:function(_673,_674){var f=lang.hitch(_673,_674);if(this.isLoaded){f(this);}else{var h=_64f.connect(this,"onLoad",function(_675){_64f.disconnect(h);f(_675);});}}});lang.extend(_653.Surface,_653._eventsProcessing);_653.Rect=_64d("dojox.gfx.shape.Rect",_653.Shape,{constructor:function(_676){this.shape=g.getDefault("Rect");this.rawNode=_676;},getBoundingBox:function(){return this.shape;}});_653.Ellipse=_64d("dojox.gfx.shape.Ellipse",_653.Shape,{constructor:function(_677){this.shape=g.getDefault("Ellipse");this.rawNode=_677;},getBoundingBox:function(){if(!this.bbox){var _678=this.shape;this.bbox={x:_678.cx-_678.rx,y:_678.cy-_678.ry,width:2*_678.rx,height:2*_678.ry};}return this.bbox;}});_653.Circle=_64d("dojox.gfx.shape.Circle",_653.Shape,{constructor:function(_679){this.shape=g.getDefault("Circle");this.rawNode=_679;},getBoundingBox:function(){if(!this.bbox){var _67a=this.shape;this.bbox={x:_67a.cx-_67a.r,y:_67a.cy-_67a.r,width:2*_67a.r,height:2*_67a.r};}return this.bbox;}});_653.Line=_64d("dojox.gfx.shape.Line",_653.Shape,{constructor:function(_67b){this.shape=g.getDefault("Line");this.rawNode=_67b;},getBoundingBox:function(){if(!this.bbox){var _67c=this.shape;this.bbox={x:Math.min(_67c.x1,_67c.x2),y:Math.min(_67c.y1,_67c.y2),width:Math.abs(_67c.x2-_67c.x1),height:Math.abs(_67c.y2-_67c.y1)};}return this.bbox;}});_653.Polyline=_64d("dojox.gfx.shape.Polyline",_653.Shape,{constructor:function(_67d){this.shape=g.getDefault("Polyline");this.rawNode=_67d;},setShape:function(_67e,_67f){if(_67e&&_67e instanceof Array){this.inherited(arguments,[{points:_67e}]);if(_67f&&this.shape.points.length){this.shape.points.push(this.shape.points[0]);}}else{this.inherited(arguments,[_67e]);}return this;},_normalizePoints:function(){var p=this.shape.points,l=p&&p.length;if(l&&typeof p[0]=="number"){var _680=[];for(var i=0;i<l;i+=2){_680.push({x:p[i],y:p[i+1]});}this.shape.points=_680;}},getBoundingBox:function(){if(!this.bbox&&this.shape.points.length){var p=this.shape.points;var l=p.length;var t=p[0];var bbox={l:t.x,t:t.y,r:t.x,b:t.y};for(var i=1;i<l;++i){t=p[i];if(bbox.l>t.x){bbox.l=t.x;}if(bbox.r<t.x){bbox.r=t.x;}if(bbox.t>t.y){bbox.t=t.y;}if(bbox.b<t.y){bbox.b=t.y;}}this.bbox={x:bbox.l,y:bbox.t,width:bbox.r-bbox.l,height:bbox.b-bbox.t};}return this.bbox;}});_653.Image=_64d("dojox.gfx.shape.Image",_653.Shape,{constructor:function(_681){this.shape=g.getDefault("Image");this.rawNode=_681;},getBoundingBox:function(){return this.shape;},setStroke:function(){return this;},setFill:function(){return this;}});_653.Text=_64d(_653.Shape,{constructor:function(_682){this.fontStyle=null;this.shape=g.getDefault("Text");this.rawNode=_682;},getFont:function(){return this.fontStyle;},setFont:function(_683){this.fontStyle=typeof _683=="string"?g.splitFontString(_683):g.makeParameters(g.defaultFont,_683);this._setFont();return this;}});_653.Creator={createShape:function(_684){switch(_684.type){case g.defaultPath.type:return this.createPath(_684);case g.defaultRect.type:return this.createRect(_684);case g.defaultCircle.type:return this.createCircle(_684);case g.defaultEllipse.type:return this.createEllipse(_684);case g.defaultLine.type:return this.createLine(_684);case g.defaultPolyline.type:return this.createPolyline(_684);case g.defaultImage.type:return this.createImage(_684);case g.defaultText.type:return this.createText(_684);case g.defaultTextPath.type:return this.createTextPath(_684);}return null;},createGroup:function(){return this.createObject(g.Group);},createRect:function(rect){return this.createObject(g.Rect,rect);},createEllipse:function(_685){return this.createObject(g.Ellipse,_685);},createCircle:function(_686){return this.createObject(g.Circle,_686);},createLine:function(line){return this.createObject(g.Line,line);},createPolyline:function(_687){return this.createObject(g.Polyline,_687);},createImage:function(_688){return this.createObject(g.Image,_688);},createText:function(text){return this.createObject(g.Text,text);},createPath:function(path){return this.createObject(g.Path,path);},createTextPath:function(text){return this.createObject(g.TextPath,{}).setText(text);},createObject:function(_689,_68a){return null;}};return _653;});},"url:cb/widget/ShortcutsDialog.html":"<div class=\"dialog-content\">\r\n    <div class=\"dialog-title\">\r\n        <span class=\"title\">${!i18n.title}</span>\r\n        <div data-dojo-attach-event=\"click:_handleCloseButtonClick\" class=\"dialog-close-button\" title=\"close\"><i class=\"fonticon-cross\"></i></div>\r\n    </div>\r\n    <div class=\"shortcuts\">\r\n        <div class=\"actions clearfix\">\r\n            <h3>${!i18n.headline_actions}</h3>\r\n            <div class=\"group\">\r\n                <dl class=\"shortcut\"><dt><kbd>space</kbd></dt><dd>${!i18n.panning}</dd></dl>\r\n                <dl class=\"shortcut\"><dt><kbd>+</kbd><span> / </span><kbd>-</kbd></dt><dd>${!i18n.zoom_in_out}</dd></dl>\r\n                <dl class=\"shortcut\"><dt><kbd>1</kbd></dt><dd>${!i18n.zoom_100}</dd></dl>\r\n                <dl class=\"shortcut\"><dt><kbd>0</kbd></dt><dd>${!i18n.zoom_fit}</dd></dl>\r\n                <!-- <dl class=\"shortcut\"><dt><kbd>TAB</kbd></dt><dd>${!i18n.toggle_pc}</dd></dl>  -->\r\n            </div>\r\n            <div class=\"group\">\r\n                <dl class=\"shortcut\"><dt><kbd>${cmdOrCtrl}</kbd><span> + </span><kbd>z</kbd></dt><dd>${!i18n.undo}</dd></dl>\r\n                <dl class=\"shortcut\"><dt><kbd>${cmdOrCtrl}</kbd><span> + </span><kbd>y</kbd></dt><dd>${!i18n.redo}</dd></dl>\r\n                <dl class=\"shortcut\"><dt><kbd>${cmdOrCtrl}</kbd><span> + </span><kbd>o</kbd></dt><dd>${!i18n.toggle_outline}</dd></dl>\r\n                <dl class=\"shortcut\"><dt><kbd>esc</kbd></dt><dd>${!i18n.abort}</dd></dl>\r\n            </div>\r\n            <div class=\"group\">\r\n                <dl class=\"shortcut\"><dt><kbd>&uarr;</kbd><span>, </span><kbd>&rarr;</kbd><span>, </span><kbd>j</kbd></dt><dd>${!i18n.next_item}</dd></dl>\r\n                <dl class=\"shortcut\"><dt><kbd>&darr;</kbd><span>, </span><kbd>&larr;</kbd><span>, </span><kbd>k</kbd></dt><dd>${!i18n.prev_item}</dd></dl>\r\n                <!-- <dl class=\"shortcut\"><dt><kbd>?</kbd></dt><dd>${!i18n.open_shortcuts}</dd></dl>  -->\r\n            </div>\r\n        </div>\r\n        <div class=\"tools clearfix\">\r\n            <h3>${!i18n.headline_tools}</h3>\r\n            <div class=\"group\">\r\n                <dl class=\"shortcut\"><dt><kbd>m</kbd></dt><dd><i class=\"fonticon-hand fonticon-large\"></i> ${!i18n.move}</dd></dl>\r\n                <dl class=\"shortcut\"><dt><kbd>s</kbd></dt><dd><i class=\"fonticon-select fonticon-large\"></i> ${!i18n.select}</dd></dl>\r\n                <dl class=\"shortcut\"><dt><kbd>e</kbd></dt><dd> ${!i18n.eraser}</dd></dl>\r\n                <dl class=\"shortcut\"><dt><kbd>z</kbd></dt><dd>${!i18n.zoom}</dd></dl>\r\n                <dl class=\"shortcut\"><dt><kbd>p</kbd></dt><dd>${!i18n.pen}</dd></dl>\r\n            </div>\r\n            <div class=\"group\">\r\n                <dl class=\"shortcut\"><dt><kbd>x</kbd></dt><dd>${!i18n.highlighter}</dd></dl>\r\n                <dl class=\"shortcut\"><dt><kbd>u</kbd></dt><dd>${!i18n.rectangle}</dd></dl>\r\n                <dl class=\"shortcut\"><dt><kbd>o</kbd></dt><dd>${!i18n.ellipse}</dd></dl>\r\n                <dl class=\"shortcut\"><dt><kbd>l</kbd></dt><dd>${!i18n.line}</dd></dl>\r\n            </div>\r\n            <div class=\"group\">\r\n                <!-- <dl class=\"shortcut\"><dt><kbd>a</kbd></dt><dd>${!i18n.arrow}</dd></dl>  -->\r\n                <dl class=\"shortcut\"><dt><kbd>c</kbd></dt><dd>${!i18n.comment}</dd></dl>\r\n                <dl class=\"shortcut\"><dt><kbd>h</kbd></dt><dd>${!i18n.headline}</dd></dl>\r\n                <dl class=\"shortcut\"><dt><kbd>t</kbd></dt><dd>${!i18n.textblock}</dd></dl>\r\n                <dl class=\"shortcut\"><dt><kbd>n</kbd></dt><dd>${!i18n.stickynote}</dd></dl>\r\n            </div>\r\n        </div>\r\n        <div class=\"item-actions clearfix\">\r\n            <h3>${!i18n.headline_itemactions}</h3>\r\n            <p class=\"desc\">${!i18n.desc_itemactions}</p>\r\n            <div class=\"group\">\r\n                <dl class=\"shortcut\"><dt><kbd>${cmdOrCtrl}</kbd><span> + </span><kbd>x</kbd></dt><dd>${!i18n.item_cut}</dd></dl>\r\n                <dl class=\"shortcut\"><dt><kbd>${cmdOrCtrl}</kbd><span> + </span><kbd>c</kbd></dt><dd>${!i18n.item_copy}</dd></dl>\r\n                <dl class=\"shortcut\"><dt><kbd>${cmdOrCtrl}</kbd><span> + </span><kbd>v</kbd></dt><dd>${!i18n.item_paste}</dd></dl>\r\n            </div>\r\n            <div class=\"group\">\r\n                <dl class=\"shortcut\"><dt><kbd>${cmdOrCtrl}</kbd><span> + </span><kbd>g</kbd></dt><dd>${!i18n.item_group}</dd></dl>\r\n                <dl class=\"shortcut\"><dt><kbd>${cmdOrCtrl}</kbd><span> + </span><kbd>&#8679;</kbd><span> + </span><kbd>g</kbd></dt><dd>${!i18n.item_ungroup}</dd></dl>\r\n                <dl class=\"shortcut\"><dt><kbd>${cmdOrCtrl}</kbd><span> + </span><kbd>&#8679;</kbd><span> + </span><kbd>o</kbd></dt><dd>${!i18n.item_toggle_outline}</dd></dl>\r\n            </div>\r\n            <div class=\"group\">\r\n                <dl class=\"shortcut\"><dt><kbd>del</kbd><span>, </span><kbd>backspace</kbd></dt><dd>${!i18n.item_del}</dd></dl>\r\n                <dl class=\"shortcut\"><dt><kbd>&uarr;</kbd><span>, </span><kbd>&rarr;</kbd><span>, </span><kbd>&darr;</kbd><span>, </span><kbd>&larr;</kbd></dt><dd>${!i18n.item_move}</dd></dl>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class=\"support-notice\">\r\n        ${!i18n.support_forum_text}\r\n    </div>\r\n</div>\r\n","dojox/cometd":function(){define("dojox/cometd",["org/cometd","dojo/json","dojox","dojo/_base/xhr","dojo/io/script","dojo/topic"],function(_68b,JSON,_68c,_68d,_68e,_68f){_68b.JSON.toJSON=JSON.stringify;_68b.JSON.fromJSON=JSON.parse;_68c.Cometd=function(name){var _690=new _68b.Cometd(name);function _691(){var _692=new _68b.LongPollingTransport();var that=_68b.Transport.derive(_692);that.xhrSend=function(_693){var _694=_68d.post({url:_693.url,sync:_693.sync===true,contentType:"application/json;charset=UTF-8",headers:_693.headers,postData:_693.body,withCredentials:true,handleAs:"json",load:_693.onSuccess,error:function(_695){_693.onError(_695.message,_694?_694.ioArgs.error:_695);}});return _694.ioArgs.xhr;};return that;};function _696(){var _697=new _68b.CallbackPollingTransport();var that=_68b.Transport.derive(_697);that.jsonpSend=function(_698){var _699=_68e.get({url:_698.url,sync:_698.sync===true,callbackParamName:"jsonp",content:{message:_698.body},load:_698.onSuccess,error:function(_69a){_698.onError(_69a.message,_699?_699.ioArgs.error:_69a);}});return undefined;};return that;};if(_68b.WebSocket){_690.registerTransport("websocket",new _68b.WebSocketTransport());}_690.registerTransport("long-polling",new _691());_690.registerTransport("callback-polling",new _696());return _690;};var _69b=new _68c.Cometd();_68c.cometd=_69b;_69b._init=_69b.init;_69b._unsubscribe=_69b.unsubscribe;_69b.unsubscribe=function(_69c,_69d,_69e){if(typeof _69c==="string"){throw "Deprecated function unsubscribe(string). Use unsubscribe(object) passing as argument the return value of subscribe()";}_69b._unsubscribe.apply(_69b,arguments);};_69b._metaHandshakeEvent=function(_69f){_69f.action="handshake";_68f.publish("/cometd/meta",_69f);};_69b._metaConnectEvent=function(_6a0){_6a0.action="connect";_68f.publish("/cometd/meta",_6a0);};_69b.addListener("/meta/handshake",_69b,_69b._metaHandshakeEvent);_69b.addListener("/meta/connect",_69b,_69b._metaConnectEvent);return _69b;});},"wp/widget/ScreenshotDialog":function(){define("wp/widget/ScreenshotDialog",["dijit","dojo","dojox","dojo/i18n!wp/widget/nls/ScreenshotDialog","dojo/require!sp/dialog/Dialog,wp/widget/ScreenshotDialogContent,wp/SimpleObjects,sp/I18n"],function(_6a1,dojo,_6a2){dojo.provide("wp.widget.ScreenshotDialog");dojo.require("sp.dialog.Dialog");dojo.require("wp.widget.ScreenshotDialogContent");dojo.require("wp.SimpleObjects");dojo.require("sp.I18n");dojo.requireLocalization("wp.widget","ScreenshotDialog");dojo.declare("wp.widget.ScreenshotDialog",[sp.dialog.Dialog],{documentId:null,baseClass:"screenshot-dialog",postCreate:function(){this.inherited("postCreate",arguments);sp.infos.getInstance().getById({type:"document",id:this.documentId}).addCallback(dojo.hitch(this,function(_6a3){this.content=new wp.widget.ScreenshotDialogContent({dialog:this,documentId:_6a3.document.id,documentTitle:_6a3.document.title});this.connect(this.content,"onAppletShutdown","hide");this.connect(this.content,"onImportSuccessfull","hide");}));}});});},"cb/widget/_OnDijitClickToDblClickMixin":function(){define(["dojo","./_OnDijitDblClickMixin"],function(dojo,_6a4){return dojo.declare([_6a4],{connect:function(obj,_6a5,_6a6){return this.inherited(arguments,[obj,_6a5=="ondijitclick"?"ondijitdblclick":_6a5,_6a6]);}});});},"dijit/InlineEditBox":function(){define(["require","dojo/_base/array","dojo/_base/declare","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/dom-style","dojo/_base/event","dojo/i18n","dojo/_base/kernel","dojo/keys","dojo/_base/lang","dojo/sniff","dojo/when","./focus","./_Widget","./_TemplatedMixin","./_WidgetsInTemplateMixin","./_Container","./form/Button","./form/_TextBoxMixin","./form/TextBox","dojo/text!./templates/InlineEditBox.html","dojo/i18n!./nls/common"],function(_6a7,_6a8,_6a9,_6aa,_6ab,_6ac,_6ad,_6ae,i18n,_6af,keys,lang,has,when,fm,_6b0,_6b1,_6b2,_6b3,_6b4,_6b5,_6b6,_6b7){var _6b8=_6a9("dijit._InlineEditor",[_6b0,_6b1,_6b2],{templateString:_6b7,postMixInProperties:function(){this.inherited(arguments);this.messages=i18n.getLocalization("dijit","common",this.lang);_6a8.forEach(["buttonSave","buttonCancel"],function(prop){if(!this[prop]){this[prop]=this.messages[prop];}},this);},buildRendering:function(){this.inherited(arguments);var Cls=typeof this.editor=="string"?(lang.getObject(this.editor)||_6a7(this.editor)):this.editor;var _6b9=this.sourceStyle,_6ba="line-height:"+_6b9.lineHeight+";",_6bb=_6ad.getComputedStyle(this.domNode);_6a8.forEach(["Weight","Family","Size","Style"],function(prop){var _6bc=_6b9["font"+prop],_6bd=_6bb["font"+prop];if(_6bd!=_6bc){_6ba+="font-"+prop+":"+_6b9["font"+prop]+";";}},this);_6a8.forEach(["marginTop","marginBottom","marginLeft","marginRight","position","left","top","right","bottom","float","clear","display"],function(prop){this.domNode.style[prop]=_6b9[prop];},this);var _6be=this.inlineEditBox.width;if(_6be=="100%"){_6ba+="width:100%;";this.domNode.style.display="block";}else{_6ba+="width:"+(_6be+(Number(_6be)==_6be?"px":""))+";";}var _6bf=lang.delegate(this.inlineEditBox.editorParams,{style:_6ba,dir:this.dir,lang:this.lang,textDir:this.textDir});_6bf["displayedValue" in Cls.prototype?"displayedValue":"value"]=this.value;this.editWidget=new Cls(_6bf,this.editorPlaceholder);if(this.inlineEditBox.autoSave){_6ac.destroy(this.buttonContainer);}},postCreate:function(){this.inherited(arguments);var ew=this.editWidget;if(this.inlineEditBox.autoSave){this.connect(ew,"onChange","_onChange");this.connect(ew,"onKeyPress","_onKeyPress");}else{if("intermediateChanges" in ew){ew.set("intermediateChanges",true);this.connect(ew,"onChange","_onIntermediateChange");this.saveButton.set("disabled",true);}}},startup:function(){this.editWidget.startup();this.inherited(arguments);},_onIntermediateChange:function(){this.saveButton.set("disabled",(this.getValue()==this._resetValue)||!this.enableSave());},destroy:function(){this.editWidget.destroy(true);this.inherited(arguments);},getValue:function(){var ew=this.editWidget;return String(ew.get("displayedValue" in ew?"displayedValue":"value"));},_onKeyPress:function(e){if(this.inlineEditBox.autoSave&&this.inlineEditBox.editing){if(e.altKey||e.ctrlKey){return;}if(e.charOrCode==keys.ESCAPE){_6ae.stop(e);this.cancel(true);}else{if(e.charOrCode==keys.ENTER&&e.target.tagName=="INPUT"){_6ae.stop(e);this._onChange();}}}},_onBlur:function(){this.inherited(arguments);if(this.inlineEditBox.autoSave&&this.inlineEditBox.editing){if(this.getValue()==this._resetValue){this.cancel(false);}else{if(this.enableSave()){this.save(false);}}}},_onChange:function(){if(this.inlineEditBox.autoSave&&this.inlineEditBox.editing&&this.enableSave()){fm.focus(this.inlineEditBox.displayNode);}},enableSave:function(){return this.editWidget.isValid?this.editWidget.isValid():true;},focus:function(){this.editWidget.focus();if(this.editWidget.focusNode){fm._onFocusNode(this.editWidget.focusNode);if(this.editWidget.focusNode.tagName=="INPUT"){this.defer(function(){_6b5.selectInputText(this.editWidget.focusNode);});}}}});var _6c0=_6a9("dijit.InlineEditBox",_6b0,{editing:false,autoSave:true,buttonSave:"",buttonCancel:"",renderAsHtml:false,editor:_6b6,editorWrapper:_6b8,editorParams:{},disabled:false,onChange:function(){},onCancel:function(){},width:"100%",value:"",noValueIndicator:has("ie")<=6?"<span style='font-family: wingdings; text-decoration: underline;'>&#160;&#160;&#160;&#160;&#x270d;&#160;&#160;&#160;&#160;</span>":"<span style='text-decoration: underline;'>&#160;&#160;&#160;&#160;&#x270d;&#160;&#160;&#160;&#160;</span>",constructor:function(){this.editorParams={};},postMixInProperties:function(){this.inherited(arguments);this.displayNode=this.srcNodeRef;var _6c1={ondijitclick:"_onClick",onmouseover:"_onMouseOver",onmouseout:"_onMouseOut",onfocus:"_onMouseOver",onblur:"_onMouseOut"};for(var name in _6c1){this.connect(this.displayNode,name,_6c1[name]);}this.displayNode.setAttribute("role","button");if(!this.displayNode.getAttribute("tabIndex")){this.displayNode.setAttribute("tabIndex",0);}if(!this.value&&!("value" in this.params)){this.value=lang.trim(this.renderAsHtml?this.displayNode.innerHTML:(this.displayNode.innerText||this.displayNode.textContent||""));}if(!this.value){this.displayNode.innerHTML=this.noValueIndicator;}_6ab.add(this.displayNode,"dijitInlineEditBoxDisplayMode");},setDisabled:function(_6c2){_6af.deprecated("dijit.InlineEditBox.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",_6c2);},_setDisabledAttr:function(_6c3){this.domNode.setAttribute("aria-disabled",_6c3?"true":"false");if(_6c3){this.displayNode.removeAttribute("tabIndex");}else{this.displayNode.setAttribute("tabIndex",0);}_6ab.toggle(this.displayNode,"dijitInlineEditBoxDisplayModeDisabled",_6c3);this._set("disabled",_6c3);},_onMouseOver:function(){if(!this.disabled){_6ab.add(this.displayNode,"dijitInlineEditBoxDisplayModeHover");}},_onMouseOut:function(){_6ab.remove(this.displayNode,"dijitInlineEditBoxDisplayModeHover");},_onClick:function(e){if(this.disabled){return;}if(e){_6ae.stop(e);}this._onMouseOut();this.defer("edit");},edit:function(){if(this.disabled||this.editing){return;}this._set("editing",true);this._savedTabIndex=_6aa.get(this.displayNode,"tabIndex")||"0";if(this.wrapperWidget){var ew=this.wrapperWidget.editWidget;ew.set("displayedValue" in ew?"displayedValue":"value",this.value);}else{var _6c4=_6ac.create("span",null,this.domNode,"before");var Ewc=typeof this.editorWrapper=="string"?lang.getObject(this.editorWrapper):this.editorWrapper;this.wrapperWidget=new Ewc({value:this.value,buttonSave:this.buttonSave,buttonCancel:this.buttonCancel,dir:this.dir,lang:this.lang,tabIndex:this._savedTabIndex,editor:this.editor,inlineEditBox:this,sourceStyle:_6ad.getComputedStyle(this.displayNode),save:lang.hitch(this,"save"),cancel:lang.hitch(this,"cancel"),textDir:this.textDir},_6c4);if(!this.wrapperWidget._started){this.wrapperWidget.startup();}if(!this._started){this.startup();}}var ww=this.wrapperWidget;_6ab.add(this.displayNode,"dijitOffScreen");_6ab.remove(ww.domNode,"dijitOffScreen");_6ad.set(ww.domNode,{visibility:"visible"});_6aa.set(this.displayNode,"tabIndex","-1");when(ww.editWidget.onLoadDeferred,lang.hitch(ww,function(){this.defer(function(){this.focus();this._resetValue=this.getValue();});}));},_onBlur:function(){this.inherited(arguments);if(!this.editing){}},destroy:function(){if(this.wrapperWidget&&!this.wrapperWidget._destroyed){this.wrapperWidget.destroy();delete this.wrapperWidget;}this.inherited(arguments);},_showText:function(_6c5){var ww=this.wrapperWidget;_6ad.set(ww.domNode,{visibility:"hidden"});_6ab.add(ww.domNode,"dijitOffScreen");_6ab.remove(this.displayNode,"dijitOffScreen");_6aa.set(this.displayNode,"tabIndex",this._savedTabIndex);if(_6c5){fm.focus(this.displayNode);}},save:function(_6c6){if(this.disabled||!this.editing){return;}this._set("editing",false);var ww=this.wrapperWidget;var _6c7=ww.getValue();this.set("value",_6c7);this._showText(_6c6);},setValue:function(val){_6af.deprecated("dijit.InlineEditBox.setValue() is deprecated.  Use set('value', ...) instead.","","2.0");return this.set("value",val);},_setValueAttr:function(val){val=lang.trim(val);var _6c8=this.renderAsHtml?val:val.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;").replace(/\n/g,"<br>");this.displayNode.innerHTML=_6c8||this.noValueIndicator;this._set("value",val);if(this._started){this.defer(function(){this.onChange(val);});}if(this.textDir=="auto"){this.applyTextDir(this.displayNode,this.displayNode.innerText);}},getValue:function(){_6af.deprecated("dijit.InlineEditBox.getValue() is deprecated.  Use get('value') instead.","","2.0");return this.get("value");},cancel:function(_6c9){if(this.disabled||!this.editing){return;}this._set("editing",false);this.defer("onCancel");this._showText(_6c9);},_setTextDirAttr:function(_6ca){if(!this._created||this.textDir!=_6ca){this._set("textDir",_6ca);this.applyTextDir(this.displayNode,this.displayNode.innerText);this.displayNode.align=this.dir=="rtl"?"right":"left";}}});_6c0._InlineEditor=_6b8;return _6c0;});},"wp/Text":function(){define("wp/Text",["dojo/_base/declare"],function(_6cb){return _6cb("wp.Text",null,{constructor:function(_6cc,text){this.a=_6cc;this.t=text;},json:function(){return {"a":this.a,"t":this.t};}});});},"cb/board/itemui/DropDownSelectHiddenComboBox":function(){define(["dojo","dojo/on","dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/dom-class","dojo/dom-attr","dojox/lang/functional","dojo/when","dojo/_base/event","dojo/keys","dojo/query","dijit/_Widget","cb/widget/_TemplatedMixin","dijit/_HasDropDown","dijit/form/_SearchMixin","dijit/form/DataList","cb/widget/DropDownSelectMixin","sp/I18n","dojo/i18n!./nls/itemui"],function(dojo,on,lang,_6cd,_6ce,_6cf,_6d0,_6d1,_6d2,when,_6d3,keys,_6d4,_6d5,_6d6,_6d7,_6d8,_6d9,_6da,_6db,i18n){var I18N=_6db.wrap(i18n);function _6dc(_6dd){return function(_6de,_6df,_6e0){var self=this;when(_6de).then(function(_6e1){_6cd.forEach(_6e1,function(_6e2){_6dd.call(self,_6e2,false);});});if(_6de.observe){this._abortQueryHandles.push(_6de.observe(function(_6e3,_6e4,_6e5){_6dd.call(self,_6e3,_6e5===-1);}));}};};var _6e6=_6ce([_6d5,_6d6,_6d7,_6d8,_6da],{templateString:"<div id=\"widget_${id}\" class=\"dropdown-combobox-anker\"></div>",searchAttr:"displayname",constructor:function(){this._abortQueryHandles=[];this.fetchProperties={sort:[{attribute:"sortKey"},{attribute:"displayname"}]};},onEntrySelect:function(){},isOpen:function(){return this._opened;},showBox:function(){if(!this.isOpen()){this.toggleDropDown();}},hideBox:function(){if(this.isOpen()){this.toggleDropDown();}},searchFor:function(_6e7){if(this._opened){this._startSearch(_6e7);}},_additionalOnKey:function(evt){if(this._opened){var _6e8=this.dropDown.getHighlightedOption();var key=evt.keyCode;if(key!==keys.DOWN_ARROW&&key!==keys.UP_ARROW&&key!==keys.ENTER&&key!==keys.TAB&&key!==keys.ESCAPE){return;}switch(key){case keys.DOWN_ARROW:case keys.UP_ARROW:if(this.dropDown){this.dropDown.handleKey(evt);}_6d3.stop(evt);break;case keys.ENTER:case keys.TAB:if(_6e8){this._selectOption(_6e8);}_6d3.stop(evt);case keys.ESCAPE:if(this._opened){this._lastQuery=null;this.closeDropDown();}break;}}},preventTextareaOnBlur:function(){if(this._opened&&this.dropDown&&this.dropDown._hoveredNode){return true;}else{return false;}},_openResultList:function(_6e9,_6ea,_6eb){var _6ec=this.dropDown.getHighlightedOption();this.dropDown.clearResultList();if(!_6e9.length&&_6eb.start===0){this.closeDropDown();return;}this._nextSearch=this.dropDown.onPage=lang.hitch(this,function(_6ed){_6e9.nextPage(_6ed!==-1);this.focus();});this.dropDown.createOptions(_6e9,_6eb);this._showResultList();},_showResultList:function(){this.closeDropDown(true);this.openDropDown();},loadDropDown:function(){this._startSearchAll();},isLoaded:function(){return false;},closeDropDown:function(){this._abortQuery();if(this._opened){this.inherited(arguments);}},_announceOption:function(node){if(!node){return;}var _6ee;if(node==this.dropDown.nextButton||node==this.dropDown.previousButton){_6ee=node.innerHTML;this.item=undefined;this.value="";}else{var item=this.dropDown.items[node.getAttribute("item")];_6ee=(this.store._oldAPI?this.store.getValue(item,this.searchAttr):item[this.searchAttr]).toString();this.set("item",item,false,_6ee);}},_selectOption:function(_6ef){this.closeDropDown();if(_6ef){this._announceOption(_6ef);}if(!this.item||this.item.valid!==false){this.onEntrySelect(this.item);}},_startSearchAll:function(){this._startSearch("");},_startSearchFromInput:function(){this.item=undefined;this.inherited(arguments);},_startSearch:function(key){if(!this.dropDown){var _6f0=this.id+"_popup",_6f1=lang.isString(this.dropDownClass)?lang.getObject(this.dropDownClass,false):this.dropDownClass;this.dropDown=new _6f1({onChange:lang.hitch(this,this._selectOption),id:_6f0,dir:this.dir,textDir:this.textDir});}this.inherited(arguments);},_getValueField:function(){return this.searchAttr;},postMixInProperties:function(){this.inherited(arguments);if(!this.store){var _6f2=this.srcNodeRef;this.store=new _6d9({},_6f2);if(!("value" in this.params)){var item=(this.item=this.store.fetchSelectedItem());if(item){var _6f3=this._getValueField();this.value=this.store._oldAPI?this.store.getValue(item,_6f3):item[_6f3];}}}},postCreate:function(){this.inherited(arguments);this.connect(this,"onSearch","_openResultList");this.connect(this,"onSearch","_handleLoading");this.connect(this,"onSearch","_handleSocialProviderUnavailable");},_handleLoading:_6dc(function _handleLoading(_6f4,_6f5){if(_6f4.type==="loading"&&_6f5){if(_6f5){if(!this.item||this.item===_6f4){this.set("message",null);this.searchFor(this._lastQuery);}}else{this.displayMessage(I18N("social_provider_loading_"+_6f4.providerId),true);}}}),_handleSocialProviderUnavailable:_6dc(function _handleSocialProviderUnavailable(_6f6,_6f7){if(_6f6.type==="social_provider_unavailable"){if(_6f7){this.displayMessage(null);}else{this.displayMessage(I18N("social_provider_unavailable_"+_6f6.providerId),true);}}}),_abortQuery:function(){this.inherited(arguments);dojo.forEach(this._abortQueryHandles,this.disconnect,this);},reset:function(){this.item=null;this.inherited(arguments);},focus:function(){}});return _6e6;});},"wp/surface/Surface":function(){define("wp/surface/Surface",["dijit","dojo","dojox","dojo/require!wp/surface/SurfaceShapeAddOn,wp/surface/SurfaceAnimationAddOn,wp/surface/SurfaceUserMouseCursorAddOn,wp/surface/SurfaceScrollbarAddOn,dojox/gfx,dojox/lang/functional"],function(_6f8,dojo,_6f9){dojo.provide("wp.surface.Surface");dojo.require("wp.surface.SurfaceShapeAddOn");dojo.require("wp.surface.SurfaceAnimationAddOn");dojo.require("wp.surface.SurfaceUserMouseCursorAddOn");dojo.require("wp.surface.SurfaceScrollbarAddOn");dojo.require("dojox.gfx");dojo.require("dojox.lang.functional");(function(){var _6fa={_moveChildBefore:function(_6fb,succ){var _6fc=false;if(_6fb===succ){return this;}for(var i=0;i<this.children.length;++i){if(this.children[i]===_6fb){this.children.splice(i,1);break;}}for(var j=0;j<this.children.length;++j){if(this.children[j]===succ){this.children.splice(j,0,_6fb);_6fc=true;break;}}if(!_6fc){this.children.push(_6fb);}return this;}};dojo.mixin(_6f9.gfx.shape.Container,_6fa);if(dojo.exists("dojox.gfx.shape.Group")){dojo.extend(_6f9.gfx.shape.Group,_6fa);}if(dojo.exists("dojox.gfx.shape.Surface")){dojo.extend(_6f9.gfx.shape.Surface,_6fa);}if(dojo.exists("dojox.gfx.svg.Group")){dojo.extend(_6f9.gfx.svg.Group,_6fa);}if(dojo.exists("dojox.gfx.svg.Surface")){dojo.extend(_6f9.gfx.svg.Surface,_6fa);}if(dojo.exists("dojox.gfx.vml.Group")){dojo.extend(_6f9.gfx.vml.Group,_6fa);}if(dojo.exists("dojox.gfx.vml.Surface")){dojo.extend(_6f9.gfx.vml.Surface,_6fa);}dojo.extend(_6f9.gfx.shape.Shape,{moveBefore:function(succ){var p=this.getParent();if(p){p._moveChildBefore(this,succ);this._moveBefore(succ);}return this;}});if(dojo.exists("dojox.gfx.svg.Shape")){dojo.extend(_6f9.gfx.svg.Shape,{_moveBefore:function(succ){var _6fd=this.getParent().rawNode;var node=this.rawNode;if(succ){_6fd.insertBefore(node,succ.rawNode);}else{_6fd.appendChild(node);}return this;}});}if(dojo.exists("dojox.gfx.vml.Shape")){dojo.extend(_6f9.gfx.vml.Shape,{_moveBefore:function(succ){var _6fe=this.getParent().rawNode;var node=this.rawNode;if(succ){_6fe.insertBefore(node,succ.rawNode);if(succ.rawNode.tagName=="rect"){succ.rawNode.swapNode(node);}}else{_6fe.appendChild(node);}return this;}});}})();dojo.declare("wp.surface.Surface",[wp.surface.SurfaceShapeAddOn,wp.surface.SurfaceAnimationAddOn,wp.surface.SurfaceUserMouseCursorAddOn,wp.surface.SurfaceScrollbarAddOn],{constructor:function(pad,_6ff){this._pad=pad;this._padUnderlayNode=dojo.byId(_6ff);this._padViewportNode=this._padUnderlayNode.parentNode;this._padUnderlayInnerNode=dojo.create("div",{"style":{position:"relative",height:"100%"},"class":"underlay-inner"},this._padUnderlayNode);this._padTrashNode=dojo.create("div",{"class":"svg-shape-on-touch-trash"},this._padUnderlayNode);this.tDx=0;this.tDy=0;this.tS=1;this._surface=_6f9.gfx.createSurface(this._padUnderlayInnerNode,1,1);this._surfaceWidgets=dojo.create("div",{"style":{zIndex:1,position:"absolute",top:0,left:0,width:"1px",height:"1px",fontSize:"100px"},"class":"widgets-container"},this._padUnderlayInnerNode,"last");this._surfaceSelections=dojo.create("div",{"style":{zIndex:2,position:"absolute",top:0,left:0,width:"1px",height:"1px",fontSize:"100px"},"class":"selections-container"},this._padUnderlayInnerNode,"last");this._surfaceUserCursors=dojo.create("div",{"style":{zIndex:3,position:"absolute",top:0,left:0,width:"1px",height:"1px",fontSize:"100px"},"class":"user-cursors-container"},this._padUnderlayInnerNode,"last");this.overlayHideSubscriptions=[];this._registeredWidgets={};this._registeredSelections={};this.viewportRect={x:0,y:0,w:0,h:0};dojo.subscribe("/window/resize",this,"rebuild");this.uiTreshhold=0.6;this._initScrollbars();},whenLoaded:function(_700,fn){return this._surface.whenLoaded(_700,fn);},getNode:function(){return this._padUnderlayNode;},rebuild:function(){var xy=dojo.coords(this._padViewportNode,false);var wh=dojo.coords(this._padViewportNode.parentNode,false);this.viewportRect={x:xy.x,y:xy.y,w:wh.w,h:wh.h};this._surface.setDimensions(this.getViewportWidth(),this.getViewportHeight());},fixBrowserScrolling:function(){this._padUnderlayNode.scrollTop=0;this._padUnderlayNode.scrollLeft=0;},getViewportLeft:function(){return this.viewportRect.x;},getViewportTop:function(){return this.viewportRect.y;},getViewportWidth:function(){return this.viewportRect.w;},getViewportHeight:function(){return this.viewportRect.h;},getViewportAsItemBBox:function(){return new wp.BBox(this.convertViewport2Item({x:0,y:0}),this.convertViewport2Item({x:this.getViewportWidth(),y:this.getViewportHeight()}));},getZoomFactor:function(){return this.tS;},setZoom:function(_701,_702,_703,_704){var _705=null;if(_702&&_703){if(_704){_705={x:_702,y:_703};}else{_705=this.getPositionXY(_702,_703);}}else{_705=this.getPositionCenter();}this.scaleAt(_705.x,_705.y,_701);},multiplyZoom:function(_706,_707,_708,_709){var _70a=_706*this.getZoomFactor();this.setZoom(_70a,_707,_708,_709);},moveToAndScale:function(x,y,_70b){this.moveTo(x,y);this.scaleAt(x,y,_70b);},scaleAt:function(x,y,_70c){if(isNaN(x)||isNaN(y)||!_70c||isNaN(_70c)){return;}else{if(_70c>50){_70c=50;}else{if(_70c<0.001){_70c=0.001;}else{if(_70c>0.96&&_70c<1.04){_70c=1;}}}}var _70d=this.getZoomFactor();var _70e=_70c/this.getZoomFactor();this._scaleAt(x,y,_70e);if(_70d>this.uiTreshhold&&this.getZoomFactor()<=this.uiTreshhold){dojo.addClass(this.getNode(),"zoomed-far-out");}else{if(_70d<=this.uiTreshhold&&this.getZoomFactor()>this.uiTreshhold){dojo.removeClass(this.getNode(),"zoomed-far-out");}}dojo.publish("/surface/update/zoom",[this.getZoomFactor()]);dojo.publish("/user/viewport/show",[{id:sp.info.user.id,bbox:this.getViewportAsItemBBox()}]);},moveTo:function(x,y){this.translateTo(x-(this.getViewportWidth()/(2*this.getZoomFactor())),y-(this.getViewportHeight()/(2*this.getZoomFactor())));},scrollBy:function(_70f,_710,_711){var _712=this.convertViewport2Item({x:0,y:0});this.translateTo(_712.x-(_70f/this.getZoomFactor()),_712.y-(_710/this.getZoomFactor()));if(_711&&(_70f!==0||_710!==0)){if(dojo.hash()!=""){dojo.hash("");}}},scrollToNaiveStartPosition:function(){var bbox=this._pad.container.getBBox();if(!bbox){this.moveTo(this.getPositionCenter().x,this.getPositionCenter().y);}else{this.moveTo(bbox.getCenter().x,bbox.getCenter().y);}},_scaleAt:function(x,y,_713){this.getRootGroup().applyTransform(_6f9.gfx.matrix.scaleAt(_713,{x:x,y:y}));this.tDx=this.getRootGroup().getTransform().dx.toFixed(9)*1;this.tDy=this.getRootGroup().getTransform().dy.toFixed(9)*1;this.tS=this.getRootGroup().getTransform().xx.toFixed(9)*1;this._transformWidgetsAndSelections();this._adjustScrollbars();},translateTo:function(x,y){this._translateTo(x,y);dojo.publish("/user/viewport/show",[{id:sp.info.user.id,bbox:this.getViewportAsItemBBox()}]);},_translateTo:function(x,y){if(isNaN(x)||isNaN(y)){return;}var _714=this.convertViewport2Item({x:0,y:0});var dx=_714.x-x;var dy=_714.y-y;var _715=_6f9.gfx.matrix.translate(dx,dy);this.getRootGroup().applyTransform(_715);this.tDx=this.getRootGroup().getTransform().dx.toFixed(9)*1;this.tDy=this.getRootGroup().getTransform().dy.toFixed(9)*1;this._transformWidgetsAndSelections();this._adjustScrollbars();},_transformWidgetsAndSelections:function(){this._surfaceWidgets.style.left=this.tDx+"px";this._surfaceWidgets.style.top=this.tDy+"px";this._surfaceWidgets.style.fontSize=this.tS*100+"px";this._surfaceSelections.style.left=this.tDx+"px";this._surfaceSelections.style.top=this.tDy+"px";this._surfaceSelections.style.fontSize=this.tS*100+"px";this._surfaceUserCursors.style.left=this.tDx+"px";this._surfaceUserCursors.style.top=this.tDy+"px";this._surfaceUserCursors.style.fontSize=this.tS*100+"px";},getPositionForNewImports:function(){var bbox=this._pad.container.getBBox();if(!bbox){return {x:-360,y:-200};}else{return {x:-360,y:Math.round(bbox.p2.y+100)};}},getPosition:function(_716){return this.getPositionXY(_716.clientX,_716.clientY);},getPositionCenter:function(){return this.convertViewport2Item({x:this.getViewportWidth()/2,y:this.getViewportHeight()/2});},getPositionXY:function(_717,_718){return this.convertViewport2Item(this.convertClient2Viewport({x:_717,y:_718}));},convertClient2Viewport:function(a){return {x:a.x-this.getViewportLeft(),y:a.y-this.getViewportTop()};},convertViewport2Item:function(a){return _6f9.gfx.matrix.multiplyPoint(_6f9.gfx.matrix.invert(this.getRootGroup().getTransform()),a);},convertItem2Viewport:function(a){return _6f9.gfx.matrix.multiplyPoint(this.getRootGroup().getTransform(),a);},clear:function(){for(var id in this._registeredWidgets){if(this._registeredWidgets.hasOwnProperty(id)){if(this._registeredWidgets[id]){this.hideWidget(id);}}}for(var id in this._registeredSelections){if(this._registeredSelections.hasOwnProperty(id)){if(this._registeredSelections[id]){this.hideSelection(id);}}}this.getRootGroup().clear();},isWidgetRegistered:function(id){return this._registeredWidgets[id];},registerWidget:function(id,type,_719){return this._registerWidget(id,type,_719);},_registerWidget:function(id,type,_71a){if(!this._registeredWidgets[id]){var _71b;if(type==="temporary"){_71b=new wp.widget.TemporaryDiv({},this._createWidgetNode(id));}else{if(_71a==="comment"){_71b=new cb.board.itemui.CommentTxtDiv({},this._createWidgetNode(id));}else{_71b=new cb.board.itemui.SimpleTxtDiv({},this._createWidgetNode(id));}}_71b.startup(this._pad.controller,type,_71a);this._registeredWidgets[id]=_71b;}else{this._registeredWidgets[id].showWidget();}return this._registeredWidgets[id];},unregisterWidget:function(id){this._unregisterWidget(id);},_unregisterWidget:function(id){if(this._registeredWidgets[id]){this._registeredWidgets[id].destroyRecursive();delete this._registeredWidgets[id];}},hideWidget:function(id){if(this._registeredWidgets[id]){this._registeredWidgets[id].hideWidget();}},_createWidgetNode:function(id){return dojo.create("div",{id:"WIDGET_"+id},this._surfaceWidgets,"last");},isSelectionRegistered:function(id){return this._registeredSelections[id];},registerSelection:function(id,type,_71c){return this._registerSelection(id,type,_71c);},_registerSelection:function(id){if(!this._registeredSelections[id]){this._registeredSelections[id]=this._createSelectionNode(id);}if(this._registeredWidgets[id]){this._registeredWidgets[id].markAsSelected();}return this._registeredSelections[id];},removeSelection:function(id){this._unregisterSelection(id);},_unregisterSelection:function(id){if(this._registeredSelections[id]){this.removeNodeVisuallyAndMarkForCleanup(this._registeredSelections[id]);delete this._registeredSelections[id];}if(this._registeredWidgets[id]){this._registeredWidgets[id].markAsUnselected();}},removeAllSelections:function(){dojo.query(this._surfaceSelections).children().orphan();for(var id in this._registeredWidgets){if(this._registeredWidgets.hasOwnProperty(id)){if(this._registeredWidgets[id]){this._registeredWidgets[id].markAsUnselected();}}}this._registeredSelections={};},_createSelectionNode:function(id){return dojo.create("div",{id:"SELECTION_"+id},this._surfaceSelections,"last");},startNewAndEmpty:function(){var _71d=dojo.byId("newdoc-pad-overlay");if(_71d){dojo.removeClass(_71d,"hideBlock");}},hideNewAndEmpty:function(){var _71e=dojo.byId("newdoc-pad-overlay");if(_71e){var anim=dojo.fadeOut({node:_71e});dojo.connect(anim,"onEnd",function(){_71e.style.display="none";});anim.play();}},getAutoScrollByCoos:function(_71f,_720,_721){var _722=0;var _723=0;var _724=this.convertClient2Viewport({x:_71f,y:_720});if(_724.x<_721){_722=_724.x-_721;}else{if(_724.x>this.getViewportWidth()-_721){_722=_724.x-(this.getViewportWidth()-_721);}}if(_724.y<_721){_723=_724.y-_721;}else{if(_724.y>this.getViewportHeight()-_721){_723=_724.y-(this.getViewportHeight()-_721);}}if(_722!==0||_723!==0){return {x:_722,y:_723};}return null;}});});},"cb/page/pad/FollowViewportTracker":function(){define(["dojo","./FollowAndPresentationManager","./ParticipantTracker"],function(dojo,_725,_726){var _727=dojo.declare(null,{surface:null,controller:null,documentId:null,init:function(args){dojo.mixin(this,args);dojo.subscribe("requests/cb/board/followviewport",this,"_handleViewportMessage");dojo.connect(_725,"onAnyModerationStarted",this,"_handleAnyModerationStarted");dojo.connect(_725,"onAnyModerationStopped",this,"_handleAnyModerationStopped");dojo.connect(_725,"onOwnLiveLocationsTurnedOn",this,"_handleOwnLiveLocationsTurnedOn");dojo.connect(_725,"onOwnLiveLocationsTurnedOff",this,"_handleOwnLiveLocationsTurnedOff");dojo.connect(_725,"onViewportSendingRequired",this,"_handleViewportSendingRequired");dojo.connect(_725,"onViewportSendingStopped",this,"_handleViewportSendingStopped");dojo.connect(_726,"onUserRemoved",function(_728){dojo.publish("/user/viewport/hide",[{id:_728}]);});},_handleAnyModerationStarted:function(){},_handleAnyModerationStopped:function(_729){dojo.publish("/user/viewport/hide",[{id:_729}]);},_handleOwnLiveLocationsTurnedOn:function(){},_handleOwnLiveLocationsTurnedOff:function(){dojo.publish("/user/viewport/hideallexcept",[{id:_725.getCurrentModeratorId()}]);},_handleViewportMessage:function(_72a){if(!_726.isUserPresent(_72a.authorid)){return;}var w2=_72a.viewportWidth/2;var h2=_72a.viewportHeight/2;var bbox=new wp.BBox({x:_72a.centerPoint.x-w2,y:_72a.centerPoint.y-h2},{x:_72a.centerPoint.x+w2,y:_72a.centerPoint.y+h2});if(_72a.authorid!==sp.info.user.info.id&&_72a.authorid===_725.getCurrentModeratorId()){this.controller.smoothScrollToItemPosition(_72a.centerPoint.x,_72a.centerPoint.y,_72a.zoomLevel);dojo.publish("/user/viewport/show",[{id:_72a.authorid,bbox:bbox,mousePos:_72a.mousePos}]);}else{if(_72a.authorid!==sp.info.user.info.id&&_725.isLiveLocationsOn()){dojo.publish("/user/viewport/show",[{id:_72a.authorid,bbox:bbox,mousePos:_72a.mousePos}]);}else{if(_72a.authorid===sp.info.user.info.id&&_725.isModeratorModeOn()){dojo.publish("/user/viewport/show",[{id:_72a.authorid,bbox:bbox,mousePos:_72a.mousePos}]);}}}},_handleViewportSendingStopped:function(_72b){dojo.publish("/user/viewport/hide",[{id:sp.info.user.info.id}]);},_handleViewportSendingRequired:function(_72c){this._updateNextTrackingData(this.getCenterPoint(),this.getZoomLevel(),this.getMousePos(),this.getViewportSize(),_72c);var _72d=this._nextTrackingData;if(!_72d){return;}var def=sp.ajax.getInstance().publishItem(dojo.mixin({type:"viewport"},_72d),this.documentId);def.addBoth(dojo.hitch(this,function(_72e){this._oldTrackingData=_72d;return _72e;}));},getCenterPoint:function(){return this.surface.getPositionCenter();},getZoomLevel:function(){return this.surface.getZoomFactor();},getMousePos:function(){var _72f=this.controller.getLastMouseClientCoords();return this.surface.getPositionXY(_72f.x,_72f.y);},getViewportSize:function(){var box=this.surface.getViewportAsItemBBox();return {w:Math.round(box.getWidth()),h:Math.round(box.getHeight())};},_updateNextTrackingData:function(_730,_731,_732,_733,_734){if(!_730){throw "centerPoint required";}if(!_732){throw "mousePos required";}if((typeof _731)!=="number"){throw "zoomLevel required";}var _735={centerPoint:{x:Math.round(_730.x),y:Math.round(_730.y)},zoomLevel:_731,mousePos:{x:Math.round(_732.x),y:Math.round(_732.y)},viewportWidth:Math.round(_733.w),viewportHeight:Math.round(_733.h)};if(_734){this._nextTrackingData=_735;return;}if(!this._oldTrackingData){this._nextTrackingData=_735;return;}if(this._oldTrackingData.viewportWidth!==_735.viewportWidth){this._nextTrackingData=_735;return;}if(this._oldTrackingData.viewportHeight!==_735.viewportHeight){this._nextTrackingData=_735;return;}if(!wp.Point.equals(this._oldTrackingData.mousePos,_735.mousePos)){this._nextTrackingData=_735;return;}if(!wp.Point.equals(this._oldTrackingData.centerPoint,_735.centerPoint)){this._nextTrackingData=_735;return;}if(!wp.Point.equals(this._oldTrackingData.mousePos,_735.mousePos)){this._nextTrackingData=_735;return;}if(this._oldTrackingData.zoomLevel!==_735.zoomLevel){this._nextTrackingData=_735;return;}this._nextTrackingData=null;}});return new _727();});},"cb/board/itemui/TxtDivTextarea":function(){define(["dojo","dojo/DeferredList","dojo/on","dojo/when","dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/dom-class","dojo/dom-attr","dojox/lang/functional","dijit/form/Textarea"],function(dojo,_736,on,when,lang,_737,_738,_739,_73a,_73b,_73c,_73d){return _738([_73d],{constructor:function(args){this.disableAutocorrect=true;this.disableAutocapitalize=true;this.resetCallback=args.resetCallback;this.saveCallback=args.saveCallback;this.txtGroupId=args.txtGroupId;this.createWithAt=args.createWithAt;},buildRendering:function(){this.inherited("buildRendering",arguments);dojo.style(this.textbox,"overflowX","hidden");if(this.disableAutocorrect){dojo.attr(this.textbox,"autocorrect","off");}if(this.disableAutocapitalize){dojo.attr(this.textbox,"autocapitalize","off");}},postCreate:function(){this.inherited(arguments);dojo.connect(this,"onKeyDown",this,function(_73e){var _73f=dijit.byId("mentionSelect");if(_73f){_73f._additionalOnKey(_73e);}var _740=dijit.byId("hashtagSelect");if(_740){_740._additionalOnKey(_73e);}if(_73e.keyCode===dojo.keys.ESCAPE){dojo.stopEvent(_73e);this.resetCallback();}});dojo.connect(this.textbox,"onblur",this,function(){var _741=dijit.byId("mentionSelect");var _742=dijit.byId("hashtagSelect");if((_741&&_741.preventTextareaOnBlur())||(_742&&_742.preventTextareaOnBlur())){}else{this.saveCallback(this.textbox.value);if(_741){_741.hideBox();}if(_742){_742.hideBox();}}});dojo.connect(this,"onResize",this,function(){dojo.publish("wp/widget/textarea/resize",this.txtGroupId);});setTimeout(dojo.hitch(this,function(){this.focusInitially();}),100);},focusInitially:function(){if(this.focusNode&&this.focusNode.focus){this.focusNode.focus();}},resize:function(){var _743=this.textbox.style.height;this.inherited(arguments);var _744=this.textbox.style.height;if(_743!==_744){this.onResize();}},onResize:function(){}});});},"wp/data/ContainerPreviewCache":function(){define("wp/data/ContainerPreviewCache",["dijit","dojo","dojox"],function(_745,dojo,_746){dojo.provide("wp.data.ContainerPreviewCache");dojo.declare("wp.data.ContainerPreviewCache",null,{constructor:function(_747){this._container=_747;this._focusIds=new wp.UniqueArray();this._allIds=new wp.UniqueArray();this._itemCache={};this._isImageItemPresent=false;this._box=null;this._tmpItem=null;},getItem:function(id){if(id=="_TMP"){return this._tmpItem;}else{return this._itemCache[id]||null;}},removeItemById:function(id){delete this._itemCache[id];this._focusIds.del(id);this._allIds.del(id);},getFocusIds:function(){return this._focusIds.toArray();},getPreviewTransformModeForId:function(id){var item=this.getItem(id);if(item){return item.previewTransformMode;}},getFocusIdsWithoutTransformMode:function(){var ids=this.getFocusIds();var ret=[];if(ids&&ids.length>0){for(var i=0;i<ids.length;i++){var id=ids[i];if(!this.getPreviewTransformModeForId(id)){ret.push(id);}}}return ret;},getSingleSelectedGroupItemId:function(){var _748=this.getAllFocusedItemsByType("group");if(_748.length!==1){return null;}var _749=_748[0].id;var _74a=dojo.every(this.getFocusIdsWithoutTransformMode(),function(id){if(id===_749){return true;}return this._isIdInNestedGroups(id,[_749]);},this);return _74a?_749:null;},isIdInFocus:function(id){return this._focusIds.contains(id);},isIdInFocusedGroup:function(id){if(!id){return false;}var _74b=[];var _74c=this.getAllFocusedItemsByType("group");var _74d=dojo.some(_74c,function(_74e){Array.prototype.push.apply(_74b,_74e.ids);return dojo.indexOf(_74e.ids,id)!=-1;});if(_74d){return true;}this._isIdInNestedGroups(id,_74b);},_isIdInNestedGroups:function(_74f,ids,_750){if(!_74f||!ids||ids.length===0){return false;}var _751=_750||{};var _752=this._container;var _753=ids;var _754=false;while(!_754&&_753.length!==0){var _755=_753.shift();var id;var item=null;if(dojo.isString(_755)){id=_755;}else{id=_755.id;item=_755;}if(_751.hasOwnProperty(id)){continue;}_751[id]=true;if(id===_74f){_754=true;continue;}if(!item){item=this.getItem(id);}if(!item){item=_752.getItem(id);}if(!item){continue;}if(item.type==="group"){Array.prototype.push.apply(_753,item.ids);}}return _754;},getFocusItems:function(){var _756=[];var _757=this._allIds.toArray();for(var i=0;i<_757.length;i++){var id=_757[i];if(this.isIdInFocus(id)){_756.push(this._itemCache[id]);}}return _756;},getAllIds:function(){return this._allIds.toArray();},getAllItems:function(){var _758=[];var _759=this._allIds.toArray();for(var i=0;i<_759.length;i++){var id=_759[i];_758.push(this._itemCache[id]);}return _758;},getAllFocusedItemsByType:function(type){return dojo.filter(this.getFocusItems(),function(item){return item.type===type;});},isImageInAllIds:function(){return this._isImageItemPresent;},getSingleItemId:function(type){var ids=this.getFocusIdsWithoutTransformMode();if(ids.length==1){var item=this.getItem(ids[0]);if(item&&(!type||item.type==type)){return ids[0];}}return null;},addItems:function(_75a){if(_75a&&_75a.length){for(var i=0;i<_75a.length;i++){var item=_75a[i];if(item.id=="_TMP"){this.addTmpItem(item);}else{this._addItem(item,_75a,true);}}}},addTmpItem:function(item){this._tmpItem=item;},group:function(){var ids=this.getFocusIdsWithoutTransformMode();if(ids&&ids.length>1){var _75b=new wp.data.item.GroupItem(new Object());_75b.id=this._container._pad.generateItemId();_75b.ids=this.getFocusIdsWithoutTransformMode();this._focusIds=new wp.UniqueArray();this._focusIds.push(_75b.id);this._allIds.push(_75b.id);this._itemCache[_75b.id]=_75b;}},ungroup:function(){var _75c=this.getSingleSelectedGroupItemId();if(_75c){var _75d=this.getItem(_75c);_75d.del="1";this._focusIds.pushArray(_75d.ids);this._focusIds.del(_75c);}},reset:function(){this._focusIds=new wp.UniqueArray();this._allIds=new wp.UniqueArray();this._itemCache={};this._isImageItemPresent=false;this._box=null;this._tmpItem=null;},getBBox:function(){if(!this._box){console.warn("ContainerPreviewCache.getBBox(): this._box is null?! ");}return this._box;},getCommonProperty:function(_75e){var _75f=null;for(var id in this._itemCache){if(this._itemCache.hasOwnProperty(id)){if(this._itemCache[id]){var type=this._itemCache[id].type;if(type!="group"&&type!="txtE"){var key=_75e[type];if(!key){return null;}var prop=this._itemCache[id][key];if(!prop){return null;}if(!_75f){_75f=prop;}else{if(_75f!=prop){return null;}}}}}}return _75f;},_addItem:function(item,_760,_761){var id=item.id;if(_761){this._focusIds.push(id);}this._allIds.push(id);this._itemCache[id]=item;if(item.type=="image"){this._isImageItemPresent=true;}if(!item.previewTransformMode){this._expandBBox(item);}this._collectGroupMembers(item);},_expandBBox:function(item){var _762=this._container.getBBox(item.id);if(_762){if(!this._box){this._box=_762.getACopy();}else{this._box.expandByBBox(_762);}}},_collectGroupMembers:function(item,_763){if(item.type=="group"){if(item.ids&&item.ids.length){for(var i=0;i<item.ids.length;i++){var _764=item.ids[i];var _765=this._extractItemFromArray(_764,_763);if(!_765){_765=this.getItem(_764);}if(!_765&&this._container.containsItem(_764)){_765=this._container.getItemCopy(_764,"_collectGroupMembers");}if(!_765){console.warn("_addItem in group '"+item.id+"' for subId '"+_764+"': Item not found!");}else{this._addItem(_765,_763,false);}}}}},_extractItemFromArray:function(id,_766){if(_766){for(var i=0;i<_766.length;i++){var item=_766[i];if(item.id==id){return item;}}}return null;},adaptFactorXY:function(_767){return {x:(this._box.getWidth()+_767.x)/this._box.getWidth(),y:(this._box.getHeight()+_767.y)/this._box.getHeight()};},adaptDeltaXY:function(_768){return {x:_768.x,y:_768.y};},adaptAttachDeltaXYOrNull:function(_769){if(!_769){return null;}return {x:_769.x,y:_769.y};}});});},"cb/page/pad/ParticipantTracker":function(){define(["dojo","dojox/lang/functional","wp/data/SequenceHelper","./SequenceOrderingHelper","cb/util"],function(dojo,_76a,_76b,_76c,_76d){var _76e=dojo.declare(null,{constructor:function(){this._presentUserIds={};this._sequenceOrderingHelper=new _76c(function(msg){return msg.user.id;});dojo.subscribe("/sp/ajax/incoming/editsession",this,_76d.wrapDefer(this._onEditSessionMessage));dojo.connect(this,"onUserRemoved",this,"_handleUserRemoved");dojo.connect(this,"onUserAdded",this,"_handleUserAdded");},onUserRemoved:function(_76f,_770){},onUserAdded:function(_771,_772){},isUserPresent:function(_773){if(!_773){return false;}return this._presentUserIds.hasOwnProperty(_773);},getUsers:function(){return _76a.keys(this._presentUserIds);},_onEditSessionMessage:function(msg){var _774=msg.user.id;if(this._sequenceOrderingHelper.isLatestMessage(msg)){switch(msg.action){case "left":this.onUserRemoved(_774,msg.user);break;case "joined":this.onUserAdded(_774,msg.user);break;case "hasSeen":default:break;}}},_handleUserRemoved:function(_775){delete this._presentUserIds[_775];},_handleUserAdded:function(_776){this._presentUserIds[_776]=true;}});return new _76e();});},"cb/videochat/VideoChatPanel":function(){define(["dojo","dojo/dom-construct","dojo/dom-class","dojo/ready","dojox/lang/functional/object","./VideoChatManager","dijit/_Widget","cb/widget/_TemplatedMixin","./VideoChatWidget","./VideoChatTooltip","sp/I18n","cb/util","dojo/i18n!./nls/VideoChatPanel","dojo/text!./VideoChatPanel.html"],function(dojo,_777,_778,_779,_77a,_77b,_77c,_77d,_77e,_77f,_780,_781,i18n,_782){return dojo.declare([_77c,_77d],{templateString:_782,streamWidgets:null,publisherWidget:null,i18n:i18n,videobuttonmode:"activate",constructor:function(){this.streamWidgets={};this.videoChatManager=_77b;},startup:function(){this.videoChatManager.set("streamAddedHandler",dojo.hitch(this,"streamAddedHandler"));this.videoChatManager.set("publisherAddedHandler",dojo.hitch(this,"publisherAddedHandler"));dojo.forEach(["StreamCreated","StreamDestroyed","PublisherCreated","PublisherDestroyed"],function(evt){this.connect(this.videoChatManager,"on"+evt,"handle"+evt);},this);_779(dojo.hitch(this,function(){this.videoChatManager.init();}));_781.watchAndGetImmediately(this.videoChatManager,"cancreatestreamMode",dojo.hitch(this,function(attr,old,_783){this.set("videobuttonmode",_783);}));_77f.setupTooltip(this.videoChatManager,[this._videoToggleButton]);},handleStreamCreated:function(_784){},handleStreamDestroyed:function(_785){var _786=this.streamWidgets[_785];if(!_786){return;}_786.destroy();delete this.streamWidgets[_785];},handlePublisherCreated:function(){},handlePublisherDestroyed:function(){if(!this.publisherWidget){return;}this.publisherWidget.destroy();this.publisherWidget=null;},streamAddedHandler:function(info){var _787=this.streamWidgets[info.id];if(!_787){_787=this.streamWidgets[info.id]=new _77e();}_777.place(_787.domNode,this._containerNode,"last");return _787.getInfo();},publisherAddedHandler:function(info){var _788=this.publisherWidget;if(!_788){_788=this.publisherWidget=new _77e(info);}_777.place(_788.domNode,this._videoToggleButton,"after");return _788.getInfo();},_handleToggleButtonClick:function(){switch(this.get("videobuttonmode")){case "deactivate":this.videoChatManager.unpublish();break;case "activate":this.videoChatManager.publish();break;case "activationlimited":undefined;break;default:undefined;break;}},_setVideobuttonmodeAttr:function(_789){switch(_789){case "deactivate":this._videoToggleButton.innerHTML=_780.wrap(i18n)("video_button_deactivate");break;case "activate":this._videoToggleButton.innerHTML=_780.wrap(i18n)("video_button_activate");break;case "activationlimited":this._videoToggleButton.innerHTML=_780.wrap(i18n)("video_button_limited");break;}_778.toggle(this._videoToggleButton,"hideBlock",0===this.videoChatManager.get("numberofstreams"));_778.toggle(this._videoToggleButton,"disabled",(_789==="activationlimited"));this._set("videobuttonmode",_789);}});});},"cb/WheelSupport":function(){define(["dojo/on","dojo/_base/lang"],function(on,lang){var _78a="",_78b=null;if(document.onmousewheel!==undefined){_78b="mousewheel";}try{WheelEvent("wheel");_78b="wheel";}catch(e){}if(!_78b){_78b="DOMMouseScroll";}function _78c(_78d,type,_78e){return on(_78d,type,function(_78f){_78f=_78f||window.event;var _790;if(_78b==="wheel"){_790=_78f;}else{_790=dojo.mixin({},_78f,{originalEvent:_78f,target:_78f.target||_78f.srcElement,type:"wheel",deltaMode:_78f.type=="MozMousePixelScroll"?0:1,deltaX:0,delatZ:0,preventDefault:function(){if(_78f.preventDefault){_78f.preventDefault();}else{_78f.returnValue=false;}},stopPropagation:function(){if(_78f.stopPropagation){_78f.stopPropagation();}else{_78f.bubbles=false;}}});if(_78b=="mousewheel"){_790.deltaY=-1/40*_78f.wheelDelta;if(_78f.wheelDeltaX){_790.deltaY=-1/40*_78f.wheelDeltaY;_790.deltaX=-1/40*_78f.wheelDeltaX;}}else{_790.deltaY=_78f.detail;}_790.delta=_790.deltaY===0?_790.deltaX:_790.deltaY;}return _78e(_790);});};var _791=function(_792,_793){var _794=[];_794.push(_78c(_792,_78b,_793));if(_78b=="DOMMouseScroll"){_794.push(_78c(_792,"MozMousePixelScroll",_793));}_794.remove=function(){for(var i=0;i<_794.length;i++){_794[i].remove();}};return _794;};return {addWheelEvent:_791,connectWidget:function(_795,_796,_797){var _798=_791(_796,lang.hitch(_795,_797));if(_795._connects){_795._connects.push(_798);}return _798;}};});},"wp/TextArray":function(){define("wp/TextArray",["dojo"],function(dojo){return dojo.declare("wp.TextArray",null,{constructor:function(tarr){this.type="tarr";this.entries=[];if(tarr&&tarr.type=="tarr"&&tarr.entries&&tarr.entries.length){this.entries=tarr.entries;}},add:function(text){this.entries[this.entries.length]=text;},json:function(){return {"type":this.type,"entries":this.entries};}});});},"cb/board/toolbar/AttributeContainer":function(){define(["dojo","dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/on","dojo/aspect","dojo/dom-class","dojo/dom-construct","dojo/query","dojo/dom","dojo/html","dojo/window","dijit/_Widget","./ChooseAttributeDialog","./ChooseMoreDialog","sp/I18n","dojo/i18n!../nls/Messages","dojo/NodeList-traverse"],function(dojo,_799,lang,_79a,on,_79b,_79c,_79d,_79e,dom,_79f,win,_7a0,_7a1,_7a2,_7a3,i18n){var _7a4=_7a3.wrap(i18n);return dojo.declare([_7a0],{controller:null,container:null,baseClass:"attribute-container",showCreateNewCommentHint:true,constructor:function(args){dojo.mixin(this,args);},postCreate:function(){this.inherited(arguments);this.own(dojo.subscribe("updates/cb/board/currenttool",this,function(){this._renderUI();}));this.own(dojo.subscribe("updates/cb/board/currentmode",this,function(){this._renderUI();}));this.own(dojo.subscribe("/cb/board/tool/config/current",this,function(){this._renderUI();}));this.own(dojo.subscribe("/cb/board/toolbar/dialogs/selection/update",this,function(){this._renderUI();}));this.own(dojo.subscribe("/window/resize",this,function(){this._renderUI();}));},buildRendering:function(){this.inherited("buildRendering",arguments);this._renderUI();},_renderUI:function(){var tool=this.controller.getCurrentTool();var _7a5=this.controller.getCurrentToolConfig();var _7a6=this.controller.getSelectionConfig();dojo.query(this.domNode).children().orphan();dojo.removeClass(this.domNode,"hideBlock");var _7a7=this._renderAttributeUI(_7a5,_7a6);if(_7a7){_79d.create("span",{"class":"app-button-separator"},this.domNode);}var _7a8=this._renderActionUI();if(_7a7||_7a8){this._moveElementsInsideMoreButton();}if(_7a7||_7a8){this.showCreateNewCommentHint=false;}else{if(this.showCreateNewCommentHint&&this.controller.currentMode==="DISCUSS"){var _7a9=_7a4("toolbar_hint_discuss");var _7aa="<span class=\"toolbar-hint-text\">"+_7a9+"</span>";var _7ab="<i class=\"fonticon-singlearrow-left hint-arrow-4\"></i><i class=\"fonticon-singlearrow-left hint-arrow-3\"></i><i class=\"fonticon-singlearrow-left hint-arrow-2\"></i><i class=\"fonticon-singlearrow-left hint-arrow-1\"></i>";_79d.create("span",{"class":"toolbar-hint light","innerHTML":_7ab+_7aa},this.domNode);}}},_renderActionUI:function(){var _7ac=false;if(this.container.isSthSelected()){_7ac=true;if(this.container.isMultipleSelected()){this.createActionButton(this.domNode,{"title":_7a4("key_action_group"),"markup":this._createActionButtonIconMarkup("fonticon-group"),"spPropKey":"action","spPropValue":"group"});}if(this.container.getSingleSelectedGroupItemId()){this.createActionButton(this.domNode,{"title":_7a4("key_action_ungroup"),"markup":this._createActionButtonIconMarkup("fonticon-ungroup"),"spPropKey":"action","spPropValue":"ungroup"});}var _7ad=this._createDropDownButtonIconMarkup("fonticon-arrange");var _7ae=[{"allValues":["move-to-front","move-to-back"],"renderFunction":dojo.hitch(this,function(_7af,_7b0,_7b1){this._createMenuEntryWithLabelOnly(_7af,{"title":_7a4(_7b1==="move-to-front"?"key_action_arrange_front":"key_action_arrange_back"),"markup":_7a4(_7b1==="move-to-front"?"key_action_arrange_front":"key_action_arrange_back"),"spPropKey":"action","spPropValue":_7b1});})}];this.createDropDownButton(this.domNode,_7ae,_7ad,_7a4("key_action_arrange_title"));var _7b2=this.container.getCommonProperty({"image":"type"});if(_7b2){var _7b3=this._createDropDownButtonIconMarkup("fonticon-rotate");var _7b4=[{"allValues":["plus90","minus90"],"renderFunction":dojo.hitch(this,function(_7b5,_7b6,_7b7){this._createMenuEntryWithLabelOnly(_7b5,{"title":_7a4("key_action_rotate_"+_7b7),"markup":_7a4("key_action_rotate_"+_7b7),"spPropKey":"action","spPropValue":_7b7});})}];this.createDropDownButton(this.domNode,_7b4,_7b3,_7a4("key_action_rotate_title"));}if(_7b2){this.createActionButton(this.domNode,{"title":_7a4("key_action_revert"),"markup":this._createActionButtonIconMarkup("fonticon-revert-size"),"spPropKey":"action","spPropValue":"revert-image-size"});}var _7b8=this.container.getCommonProperty({"txtG":"subtype","image":"type"});if(_7b8=="headline"||_7b8=="image"){this.createActionButton(this.domNode,{"title":_7a4("key_action_outline"),"markup":this._createActionButtonIconMarkup("fonticon-outline"),"spPropKey":"action","spPropValue":"outline"});}this.createActionButton(this.domNode,{"title":_7a4("key_action_duplicate"),"markup":this._createActionButtonIconMarkup("fonticon-copyboard"),"spPropKey":"action","spPropValue":"duplicate"});}return _7ac;},_renderAttributeUI:function(_7b9,_7ba){var _7bb=this.controller.getOrderedUiAttributeKeys();var _7bc=false;for(var i=0;i<_7bb.length;i++){var _7bd=_7bb[i];var _7be=_7b9?_7b9[_7bd]:null;if(_7ba&&_7ba[_7bd]){_7be=_7ba[_7bd];}if(_7be){this._renderDropdownUI(this.domNode,_7bd,_7be);_7bc=true;}}return _7bc;},_moveElementsInsideMoreButton:function(){var _7bf=150;var _7c0=(win.getBox().w-_7bf);var _7c1=_79e(this.domNode).children(":not(.more-button)");var _7c2=_79d.create("div");_7c1.forEach(function(node){_79c.remove(node,"hideBlock");});if(typeof this.moreButton==="undefined"){this.moreButton=_79d.create("span",{"class":"app-button no-shrink more-button hideBlock",innerHTML:"<span class=\"tool-label\">"+_7a4("tool_label_more")+"</span><span class=\"triangle\">▼</span>"},this.domNode,"last");}else{_79d.place(this.moreButton,this.domNode,"last");}_7c1.forEach(function(node,_7c3){var _7c4=node.clientWidth+node.offsetLeft;if(_7c4>=_7c0){_79d.place(node,_7c2);}});_79c.toggle(this.moreButton,"hideBlock",_7c2.children.length===0);on(this.moreButton,"click",function(){(new _7a2({content:_7c2})).show(this);});},_renderDropdownUI:function(_7c5,_7c6,_7c7){var _7c8="";var _7c9=_7a4("key_"+_7c6+"_title");var _7ca=[];var _7cb=this.controller.getAttributeUiMode(_7c6);if(_7cb==="SELECTED-LABEL"){_7c8=this._createDropDownButtonLabelMarkup(this._getMenuEntryTitle(_7c6,_7c7));_7ca.push({"allValues":this.controller.getAllAttributeValues(_7c6),"currentValue":_7c7,"renderFunction":dojo.hitch(this,function(_7cc,_7cd,_7ce){this.createMenuEntryWithSelectedLabel(_7cc,_7c6,_7cd,_7ce);})});}else{if(_7cb==="ICON-ONLY"){_7c8=this._createDropDownButtonIconMarkup(this._getMenuEntryIconClass(_7c6,_7c7));_7ca.push({"allValues":this.controller.getAllAttributeValues(_7c6),"currentValue":_7c7,"renderFunction":dojo.hitch(this,function(_7cf,_7d0,_7d1){this.createMenuEntryWithIconOnly(_7cf,_7c6,_7d0,_7d1);})});}else{if(_7cb==="SELECTED-LABEL-AS-BORDER"){_7c8=this._createDropDownButtonIconMarkup(this._getMenuEntryIconClass(_7c6));_7ca.push({"menuClass":"border-label-menu","allValues":this.controller.getAllAttributeValues(_7c6),"currentValue":_7c7,"renderFunction":dojo.hitch(this,function(_7d2,_7d3,_7d4){this.createMenuEntryWithSelectedLabel(_7d2,_7c6,_7d3,_7d4);})});}else{if(_7cb==="COLOR-SELECTOR"||_7cb==="COLOR-SELECTOR-WITH-TRANSPARENCY"||_7cb==="COLOR-SELECTOR-WITH-TEXT-COLORS"){_7c8=this._createDropDownButtonIconMarkup(this._getMenuEntryIconClass(_7c6),_7c7);_7ca.push({"menuClass":"stand-out-menu","allValues":this.controller.getAllBaseColors(),"currentValue":_7c7,"renderFunction":dojo.hitch(this,function(_7d5,_7d6,_7d7){this.createMenuEntryWithSelectedColor(_7d5,_7c6,_7d6,_7d7);})});_7ca.push({"menuClass":"stand-out-menu-follower","allValues":this.controller.baseColorsUltraLight,"currentValue":_7c7,"renderFunction":dojo.hitch(this,function(_7d8,_7d9,_7da){this.createMenuEntryWithSelectedColor(_7d8,_7c6,_7d9,_7da);})});_7ca.push({"allValues":this.controller.baseColorsLight,"currentValue":_7c7,"renderFunction":dojo.hitch(this,function(_7db,_7dc,_7dd){this.createMenuEntryWithSelectedColor(_7db,_7c6,_7dc,_7dd);})});_7ca.push({"allValues":this.controller.baseColorsDark,"currentValue":_7c7,"renderFunction":dojo.hitch(this,function(_7de,_7df,_7e0){this.createMenuEntryWithSelectedColor(_7de,_7c6,_7df,_7e0);})});if(_7cb!=="COLOR-SELECTOR-WITH-TEXT-COLORS"){_7ca.push({"allValues":this.controller.getAllBWColors(),"currentValue":_7c7,"renderFunction":dojo.hitch(this,function(_7e1,_7e2,_7e3){this.createMenuEntryWithSelectedColor(_7e1,_7c6,_7e2,_7e3);})});}else{_7ca.push({"allValues":this.controller.getAllBWColorsForText(),"currentValue":_7c7,"renderFunction":dojo.hitch(this,function(_7e4,_7e5,_7e6){this.createMenuEntryWithSelectedColor(_7e4,_7c6,_7e5,_7e6);})});}if(_7cb==="COLOR-SELECTOR-WITH-TRANSPARENCY"){_7ca.push({"allValues":["transparent"],"currentValue":_7c7,"renderFunction":dojo.hitch(this,function(_7e7,_7e8,_7e9){this.createMenuEntryWithSelectedLabel(_7e7,_7c6,_7e8,_7e9);})});}if(_7cb==="COLOR-SELECTOR-WITH-TEXT-COLORS"){_7c9=_7a4("key_UI_TEXT_COLOR_title");}else{_7c9=_7a4("key_UI_COLOR_title");}}else{console.error("UI mode not found: ",_7cb);return;}}}}this.createDropDownButton(this.domNode,_7ca,_7c8,_7c9);},_getMenuEntryTitle:function(key,_7ea){return _7a4("key_"+key+"_value_"+_7ea);},_getMenuEntryLabelOrMarkup:function(key,_7eb){switch(key){case "UI_LINE_WIDTH":return "<span class=\"border-label-prefix\">"+this._getMenuEntryTitle(key,_7eb)+"</span> <span class=\"border-label border-label-"+_7eb+"\"></span>";case "UI_LINE_STYLE":return "<span class=\"border-label border-label-"+_7eb+"\"></span>";case "UI_FONT_TYPE":var _7ec=_7eb==="normal"?"":(_7eb==="awesome"?"Enriqueta":(_7eb==="handwrite"?"KGYouWontBringMeDown":_7eb));return "<span style=\"font-size:18px; font-family:"+_7ec+"\">"+this._getMenuEntryTitle(key,_7eb)+"</span>";default:return this._getMenuEntryTitle(key,_7eb);}},_getMenuEntryIconClass:function(key,_7ed){switch(key){case "UI_LINE_COLOR":return "fonticon-pencil";case "UI_FILL_COLOR":return "fonticon-fill-color";case "UI_SHAPE_COLOR":return "fonticon-fill-color";case "UI_FILL_COLOR_WT":return "fonticon-fill-color";case "UI_TEXT_COLOR":return "fonticon-a-uppercase";case "UI_LINE_WIDTH":return "fonticon-line-width";case "UI_FILL_STYLE":return _7ed=="none"?"fonticon-transparent":(_7ed=="full"?"fonticon-opaque":"fonticon-semi");case "UI_LINE_STYLE":return "fonticon-line-style";case "UI_LINE_ARROW":return _7ed=="none"?"fonticon-line":(_7ed=="source"?"fonticon-arrow":(_7ed=="target"?"fonticon-arrow-end":"fonticon-arrow-double"));case "UI_TEXT_ALIGN":return "fonticon-align-"+_7ed;default:console.warn("Key not found for menu icon creation:",key);return "fonticon-exclamation";}},createDropDownButton:function(_7ee,_7ef,_7f0,_7f1){var _7f2=_79d.create("span",{"title":_7f1?_7f1:"","innerHTML":_7f0,"class":"app-button"},_7ee);this.own(on(_7f2,"click",lang.hitch(this,function(e){(new _7a1({"dropdownSections":_7ef})).show(_7f2);})));},_createDropDownButtonIconMarkup:function(_7f3,_7f4){var _7f5="<i class=\""+_7f3+"\"></i>";_7f5+="<span class=\"triangle\">&#9660</span>";if(_7f4){_7f5+="<span class=\"selected-color\" style=\"background-color:"+_7f4+";\"></span>";}return _7f5;},_createDropDownButtonLabelMarkup:function(_7f6){return "<span class=\"attribute-label\">"+_7f6+"</span><span class=\"triangle\">&#9660</span>";},createMenuEntryWithSelectedColor:function(_7f7,_7f8,_7f9,_7fa){this._createMenuEntryWithSelectedColor(_7f7,{"markup":_7fa,"title":_7fa,"isActive":_7f9===_7fa,"spPropKey":_7f8,"spPropValue":_7fa});},_createMenuEntryWithSelectedColor:function(_7fb,_7fc){if(!_7fc.spPropKey||!_7fc.spPropValue||!_7fc.markup){console.warn("Missing parameters for menu entry creation:",_7fc.spPropKey,_7fc.spPropValue,_7fc.markup);return;}var _7fd=dojo.create("li",{"title":_7fc.title?_7fc.title:"","class":"color-selector-entry "+(_7fc.isActive?"active":"")+((_7fc.markup==="#ffffff")?" white":""),"style":"background-color:"+_7fc.markup,"innerHTML":"<i class=\"fonticon-check "+(_7fc.isActive?"":"inactive")+"\"></i><span class=\"selected-color-frame\"></span>","sppropkey":_7fc.spPropKey,"sppropvalue":_7fc.spPropValue},_7fb);this._connectClickHandler(_7fd,_7fc);},createMenuEntryWithIconOnly:function(_7fe,_7ff,_800,_801){this._createMenuEntryWithIconOnly(_7fe,{"title":this._getMenuEntryTitle(_7ff,_801),"iconClass":this._getMenuEntryIconClass(_7ff,_801),"spPropKey":_7ff,"spPropValue":_801});},_createMenuEntryWithIconOnly:function(_802,_803){if(!_803.spPropKey||!_803.spPropValue||!_803.iconClass){console.warn("Missing parameters for menu entry creation:",_803.spPropKey,_803.spPropValue,_803.iconClass);return;}var _804=dojo.create("li",{"title":_803.title?_803.title:"","class":"icon-only-entry","innerHTML":"<i class=\""+_803.iconClass+"\"></i>","sppropkey":_803.spPropKey,"sppropvalue":_803.spPropValue},_802);this._connectClickHandler(_804,_803);},_createMenuEntryWithLabelOnly:function(_805,_806){if(!_806.spPropKey||!_806.spPropValue||!_806.markup){console.warn("Missing parameters for menu entry creation:",_806.spPropKey,_806.spPropValue,_806.markup);return;}var _807=dojo.create("li",{"title":_806.title?_806.title:"","innerHTML":_806.markup,"sppropkey":_806.spPropKey,"sppropvalue":_806.spPropValue},_805);this._connectClickHandler(_807,_806);},createMenuEntryWithSelectedLabel:function(_808,_809,_80a,_80b){this._createMenuEntryWithSelectedLabel(_808,{"title":this._getMenuEntryTitle(_809,_80b),"markup":this._getMenuEntryLabelOrMarkup(_809,_80b),"isActive":_80a===_80b,"spPropKey":_809,"spPropValue":_80b});},_createMenuEntryWithSelectedLabel:function(_80c,_80d){if(!_80d.spPropKey||!_80d.spPropValue||!_80d.markup){console.warn("Missing parameters for menu entry creation:",_80d.spPropKey,_80d.spPropValue,_80d.markup);return;}var _80e=dojo.create("li",{"title":_80d.title?_80d.title:"","innerHTML":"<i class=\"fonticon-check "+(_80d.isActive?"":"inactive")+"\"></i> "+_80d.markup,"sppropkey":_80d.spPropKey,"sppropvalue":_80d.spPropValue},_80c);this._connectClickHandler(_80e,_80d);},createActionButton:function(_80f,_810){if(!_810.spPropKey||!_810.spPropValue||!_810.markup){console.warn("Missing parameters for menu entry creation:",_810.spPropKey,_810.spPropValue,_810.markup);return;}var _811=_79d.create("span",{"title":_810.title?_810.title:"","innerHTML":_810.markup,"class":"app-button icon-only","sppropkey":_810.spPropKey,"sppropvalue":_810.spPropValue},_80f);this._connectClickHandler(_811,_810);},_createActionButtonIconMarkup:function(_812){return "<i class=\""+_812+"\"></i>";},_connectClickHandler:function(_813,_814){if(_814.spToolKey){this.own(on(_813,"click",function(){var _815=dojo.attr(_813,"sptoolkey");dojo.publish("requests/cb/board/currenttoolchange",_815);}));}else{this.own(on(_813,"click",function(){var _816=dojo.attr(_813,"sppropkey");var _817=dojo.attr(_813,"sppropvalue");dojo.publish("/cb/board/tool/config/current",{key:_816,value:_817});}));}},_getRandomHintNumber:function(_818){return Math.floor((Math.random()*_818)+1);}});});},"wp/surface/Drawer":function(){define("wp/surface/Drawer",["dijit","dojo","dojox","dojo/require!wp/common/TransformHelper,wp/surface/DrawerExecutionAddOn,wp/surface/DrawerSelectionAddOn,wp/surface/DrawerCursorAddOn,wp/surface/DrawerOSRAddOn,dojox/lang/functional"],function(_819,dojo,_81a){dojo.provide("wp.surface.Drawer");dojo.require("wp.common.TransformHelper");dojo.require("wp.surface.DrawerExecutionAddOn");dojo.require("wp.surface.DrawerSelectionAddOn");dojo.require("wp.surface.DrawerCursorAddOn");dojo.require("wp.surface.DrawerOSRAddOn");dojo.require("dojox.lang.functional");dojo.declare("wp.surface.Drawer",[wp.surface.DrawerExecutionAddOn,wp.surface.DrawerSelectionAddOn,wp.surface.DrawerCursorAddOn,wp.surface.DrawerOSRAddOn],{constructor:function(_81b,_81c,pad,_81d){this._surface=_81b;this._sidebar=_81c;this._pad=pad;this._isCursorHandlingNeeded=_81d;this._clearJobPending=false;this._drawJobPending=false;this._drawIdsAsArray=[];this._prevJobPending=false;this._prevIdsAsUniqueArray=new wp.UniqueArray();this._selectJobPending=false;this._selectIdsAsUniqueArray=new wp.UniqueArray();this._shapes=this._pad.container._shapes;this._previewShapes={};this._nextTime=null;this._handle=null;this._sleep=50;this._minSleep=40;this._nops=0;this._sendFullyInitiatedOnNextEmptyRun=false;},sendFullyInitiatedOnNextEmptyRun:function(){this._sendFullyInitiatedOnNextEmptyRun=true;},startup:function(){if(!this._handle){this._nextTime=this._now()+this._minSleep;var that=this;var _81e;if(dojo.isIE){_81e=function(){try{that._doIt();}catch(error){console.error("error on drawing",error,error.stack);}that._handle=setTimeout(_81e,that._sleep);};that._handle=setTimeout(_81e,that._sleep);}else{_81e=function(){try{that._doIt();}catch(error){console.error("error on drawing",error,error.stack);}};this._handle=window.setInterval(_81e,this._sleep);}}},_now:function(){return (new Date()).getTime();},_doIt:function(){var now=this._now();if(now<this._nextTime){return;}this._nextTime=now+this._minSleep;if(!(this._clearJobPending||this._prevJobPending||this._drawJobPending||this._selectJobPending)){this._nops++;if(this._sendFullyInitiatedOnNextEmptyRun&&this._nops>=5){this._sendFullyInitiatedOnNextEmptyRun=false;dojo.publish("/sp/ajax/connectivityStatus",["DRAWER-FULLY-INITIATED"]);}return;}this._nops=0;if(this._clearJobPending){this._clear();}if(this._prevJobPending){this._executePreviews();}if(this._drawJobPending){this._executeDrawings();}if(this._selectJobPending){this._executeSelections();}this._nextTime=this._now()+this._minSleep;},enqueueClearing:function(){this._clearJobPending=true;},enqueueDrawing:function(id){this._drawIdsAsArray.push(id);this._drawJobPending=true;},enqueueDrawings:function(_81f){Array.prototype.push.apply(this._drawIdsAsArray,_81f);this._drawJobPending=true;},removeDrawing:function(id){this._removeDrawingForId(id);this._removePreviewForId(id);this._removeSelectionForId(id);},enqueuePreview:function(id){this._prevIdsAsUniqueArray.push(id);this._prevJobPending=true;},removePreview:function(_820,_821){this._prevJobPending=false;this._prevIdsAsUniqueArray=new wp.UniqueArray();var _822=this._pad.container.getPreviewShapes();dojo.forEach(_81a.lang.functional.keys(_822),function(id){if(!_821||id=="_TMP"){this._removePreviewForId(id);}},this);this._removePreviewForId("_TMP");var _823=this._pad.container.getInvisibleTextGroupIds();for(var i=0;i<_823.length;i++){if(this._surface.isWidgetRegistered(_823[i])){this._surface.unregisterWidget(_823[i]);}}if(!_820){this.applyOSR();}},enqueueSelection:function(id){this._selectIdsAsUniqueArray.push(id);this._selectJobPending=true;},enqueueSelections:function(_824){this._selectIdsAsUniqueArray.pushArray(_824);this._selectJobPending=true;},removeSelection:function(){this._selectJobPending=false;this._selectIdsAsUniqueArray=new wp.UniqueArray();this._surface.removeAllSelections();},removeTemporaryShapes:function(_825,_826,_827){if(_825){this.removeSelection();}this.removePreview(_826,_827);}});(function(){if(Date.now){dojo.extend(wp.surface.Drawer,{_now:function(){return Date.now();}});}})();});},"cb/page/pad/WindowTitleManager":function(){define(["dojo","sp/infos/InfoManager","dojox/html/entities","cb/ext/es6-fromcodepoint-shim"],function(dojo,_828,_829,_82a){var _82b=function _82b(_82c){_828.getById({type:"document",id:_82c}).then(function(_82d){var _82e=_82d.document.title+" - Conceptboard";try{var _82f=_829.decode(_82e);_82f=_82f.replace(/&#x([0-9]+);/g,function(_830,_831){try{return _82a(parseInt(_831,16));}catch(e){return _830;}});_82f=_82f.replace(/&#([0-9]+);/g,function(_832,_833){try{return _82a(parseInt(_833,10));}catch(e){return _832;}});dojo.doc.title=_829.decode(_82f);}catch(e){console.warn("error setting browser document title to ",_82e,e);}});};return {start:function(_834){dojo.connect(_828,"onInvalidate",function(_835){if(_835.type==="document"&&_835.id===_834){_82b(_834);}});window.setTimeout(function(){_82b(_834);},100);}};});},"cb/board/itemui/CommentTxtDiv":function(){define(["dojo","dojo/DeferredList","dojo/on","dojo/when","dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/dom-class","dojo/dom-attr","dojox/lang/functional","cb/util","cb/util-mentions","cb/util-hashtags","cb/util-text","cb/api/Api","wp/UniqueArray","wp/common/TextHelper","wp/common/ColorHelper","cb/contacts/ContactSelectStoreFactory","cb/user/ComboBoxMenu","cb/widget/UserDialog","./_TxtDiv","./TxtDivHelper","./TxtDivTextarea","./TxtDivTextareaWithDropDown","./DropDownSelectHiddenComboBox","./HashtagComboBoxMenu","./HashtagSelectStoreFactory","sp/I18n","dojo/i18n!./nls/itemui"],function(dojo,_836,on,when,lang,_837,_838,_839,_83a,_83b,_83c,_83d,_83e,_83f,_840,Api,_841,_842,_843,_844,_845,_846,_847,_848,_849,_84a,_84b,_84c,_84d,_84e,i18n){var I18N=_84e.wrap(i18n);return _838("cb.board.itemui.CommentTxtDiv",[_847],{ownMentionsPerTxtEIds:null,mentionMapDisplayToId:{},mentionMapIdToDisplay:{},hashtagFromDisplayname:{},hashtagToDisplayname:{},userDialogConstructor:null,startup:function(_84f,type,_850){this.inherited("startup",arguments);this.ownMentionsPerTxtEIds=new wp.UniqueArray();dojo.addClass(this.domNode,"pWTD-comment pWTD-stickynoteStyle");this.taskNode=_839.create("div",{"class":"pWTDTaskStatus"},null);this.taskstatusOpen=_839.create("i",{"class":"icon fonticon-task-open"},this.taskNode);this.taskstatusMe=_839.create("i",{"class":"icon fonticon-task-onhold"},this.taskNode);this.taskstatusClosed=_839.create("i",{"class":"icon fonticon-task-round-done"},this.taskNode);dojo.place(this.taskNode,this.domNode,"first");var _851=dojo.create("div",{"sid":"__NOFLOW","class":"comment-ui-inner"},dojo.create("div",{"sid":"__NOFLOW","class":"new-reply-container"},this.domNode));_848.createActionLink(_851,"comment-ui-btn comment-reply-fake-box",I18N("reply_box_placeholder"),null,function(){dojo.publish("requests/cb/board/edittextgroup",this.txtGroupId);},this);var _852="<i sid=\"__NOFLOW\" class=\"fonticon-task-round-done\"></i> "+I18N("task_button_label");_848.createActionLink(_851,"comment-ui-btn comment-task-button",_852,I18N("task_button_title"),function(_853){(new wp.widget.TaskStatusDialog({controller:this.controller,itemId:this.txtGroupId,baseClass:"selection-toolbar-dialog task-status-dialog"})).show(_853.target);},this);var _854="<i sid=\"__NOFLOW\" class=\"fonticon-doublearrow-up\"></i><i sid=\"__NOFLOW\" class=\"fonticon-doublearrow-down\"></i>";_848.createActionLink(_851,"comment-ui-btn comment-collapse-toggle",_854,I18N("toggle_button_title"),function(_855){this.toggleCommentCollapseClick(_855);},this);this.userDialogConstructor=this._createProfileUserDialogConstructor();this.own(dojo.connect(this.domNode,"click",this,function(_856){var node=_856.target;var _857=node?_83b.get(node,"spuseridforprofile"):null;if(node&&_857){var _858=node.parentNode?node.parentNode.parentNode:null;var _859=_858?_83b.get(_858,"eid"):null;var _85a=_859?this.getEntryItem(_859):_859;if(_858&&_859&&_85a){var _85b=this._isEntryEditable(_85a.getFixedAuthorId())||_857==sp.info.user.id;sp.infos.getInstance().getById({type:sp.infos.TYPE.user,id:_857}).addCallback(dojo.hitch(this,function(_85c){var _85d=this;var _85e=new this.userDialogConstructor({isMentionRemovalAllowed:_85b,removeMentionCallback:function(){_85d.removeMentionInTextEntry(_859,_857);},user:_85c.user});_85e.show(node);}));}}}));},_createProfileUserDialogConstructor:function(){return dojo.declare([_846],{postCreate:function(){this.inherited(arguments);if(this.isMentionRemovalAllowed){var _85f=dojo.create("span",{"class":"small button secondary",innerHTML:I18N("remove_mention")},this.content.additionalButtons);this.connect(_85f,"click",function(_860){dojo.stopEvent(_860);this.removeMentionCallback();this.hide();});}}});},_isEntryEditable:function(_861){return this._editable&&this._isEntryPotentiallyEditable(_861);},_isEntryPotentiallyEditable:function(_862){return _862&&_862===sp.info.user.id;},applyId:function(id){this.inherited("applyId",arguments);if(this.txtGroupId!==id){this.taskNode.setAttribute("sid",id);this.taskstatusOpen.setAttribute("sid",id);this.taskstatusClosed.setAttribute("sid",id);this.taskstatusMe.setAttribute("sid",id);}},rearrange:function(item){this.inherited("rearrange",arguments);dojo.style(this.domNode,"color","#333333");dojo.toggleClass(this.domNode,"align-left",true);dojo.toggleClass(this.domNode,"font-arial",true);dojo.toggleClass(this.domNode,"font-s",true);dojo.removeClass(this.domNode,"taskstatus-open taskstatus-open-for-me taskstatus-closed");if(item.taskStatus){if(item.taskStatus==="open"||item.taskStatus==="onhold"){if(this.ownMentionsPerTxtEIds.getLength()<1){dojo.addClass(this.domNode,"taskstatus-open");}else{dojo.addClass(this.domNode,"taskstatus-open-for-me");}}else{if(item.taskStatus==="closed"){dojo.addClass(this.domNode,"taskstatus-closed");}}}dojo.toggleClass(this.domNode,"comment-collapsed",!!item.collapse);},_renderEntryContentAsText:function(_863,_864,_865){var _866=dojo.create("img",{"class":"pWDT-user-photo","sid":this.txtGroupId,"src":"/_/images/userphoto_default_silhouette_medium.png"},_863);var _867=dojo.create("div",{"class":"pWDT-entry-detail","sid":this.txtGroupId},_863);if(_865.getFixedAuthorId()){var _868=this.txtGroupId;sp.infos.getInstance().getById({type:sp.infos.TYPE.user,id:_865.getFixedAuthorId()}).addCallback(function(_869){dojo.create("span",{"innerHTML":sp.I18n.esc(_869.user.displayname)+" "+I18N("entry_title",[dojo.date.stamp.fromISOString(_865.dte)])},_867,"first");if(_869.user.hasUserPhoto){dojo.attr(_866,"src","/__/photo/"+sp.I18n.escAttr(_865.getFixedAuthorId())+".medium.png");}else{var _86a=dojo.create("div",{"class":"initials","sid":_868,"innerHTML":sp.I18n.esc(_869.user.initials)},_866,"after");}});}var _86b=dojo.create("p",{"sid":this.txtGroupId,"class":"enable-user-text-select","innerHTML":_864},_863);this._enrichTextEntryContent(_86b,_864,_865);this.updateOwnMention(_865.id,_864);},_renderEntryContentAsInput:function(_86c,_86d,_86e){dojo.addClass(_86c,"show-user-photo clearfix");var _86f=dojo.create("img",{"class":"pWDT-user-photo","src":"/__/photo/"+sp.info.user.id+".medium.png"},_86c);if(!sp.info.user.info.hasUserPhoto){dojo.create("div",{"class":"initials","innerHTML":sp.I18n.esc(sp.info.user.info.initials)},_86f,"after");}var _870=dijit.byId("pWTextareaNode");if(_870){_870.destroyRecursive();}var _871=_839.create("div",{"class":"textarea-container"},_86c);var _872=this._getTextToDisplayInTextarea(_86d?_86d.text:"");var _873=new _84a({id:"pWTextareaNode",txtGroupId:this.txtGroupId,value:_872,createWithAt:_86e,resetCallback:dojo.hitch(this,function(){this.controller.resetTextEdit();}),saveCallback:dojo.hitch(this,function(_874){this.controller.saveTextEditIfChanged(this._getTextToSend(_874));})},dojo.create("div",{},_871));var _875=dijit.byId("mentionSelect");if(_875){_875.destroyRecursive();}var _876=new _84b({id:"mentionSelect",store:_844.create({}),dropDownClass:_845,queryExpr:"*${0}*",featureRegistrationSelfsignup:false,postCreate:function(){this.inherited("postCreate",arguments);cb.Capabilities.checkFeature("registration.selfsignup").then(dojo.hitch(this,function(_877){this.set("featureRegistrationSelfsignup",_877==="enabled");}));},showBox:function(){if(this.featureRegistrationSelfsignup&&(!sp||!sp.info||!sp.info.company||!sp.info.company.id)){if(sp.info.user&&!sp.info.user.isNamedGuest&&!sp.info.user.isAnonymous){this.displayMessage(I18N("no_contact_select_for_basic"),true);}else{this.displayMessage(I18N("no_contact_select_for_guest"),true);}}else{this.inherited("showBox",arguments);}}},dojo.create("div",{},_871));dojo.connect(_876,"onEntrySelect",this,function(_878){if(_878&&_878.userId&&_878.displayname){this.insertIntoMentionMap(_878.userId,_878.displayname);dijit.byId("pWTextareaNode").replaceAtMentionAtCursorPosition(_878.displayname);}});dojo.connect(_873,"onNewAtMention",this,function(){var _879=dijit.byId("mentionSelect");if(_879){_879.showBox();}});dojo.connect(_873,"onUpdatedAtMention",this,function(){var _87a=dijit.byId("mentionSelect");if(_87a){_87a.searchFor(_873.getCurrentAtMentionStr());}});dojo.connect(_873,"onCanceledAtMention",this,function(){var _87b=dijit.byId("mentionSelect");if(_87b){_87b.hideBox();}});var _87c=dijit.byId("hashtagSelect");if(_87c){_87c.destroyRecursive();}var _87d=new _84b({id:"hashtagSelect",store:_84d.create({}),dropDownClass:_84c,queryExpr:"*${0}*"},dojo.create("div",{},_871));dojo.connect(_87d,"onEntrySelect",this,function(_87e){if(_87e&&_87e.id&&_87e.displayname){this.insertIntoHashtagMap(_87e);dijit.byId("pWTextareaNode").replaceHashtagAtCursorPosition(_87e.displayname);}});dojo.connect(_873,"onNewHashtag",this,function(){var _87f=dijit.byId("hashtagSelect");if(_87f){_87f.showBox();}});dojo.connect(_873,"onUpdatedHashtag",this,function(){var _880=dijit.byId("hashtagSelect");if(_880){_880.searchFor(_873.getCurrentHashtagStr());}});dojo.connect(_873,"onCanceledHashtag",this,function(){var _881=dijit.byId("hashtagSelect");if(_881){_881.hideBox();}});var _882=_839.create("div",{"class":"comment-ui-inner"},_86c);_848.createActionLink(_882,"comment-ui-btn comment-mention-button",I18N("mention_button_label"),"",function(_883){var _884=_873.textbox.value.substr(0,_873.textbox.selectionStart);var _885=_873.textbox.value.substr(_873.textbox.selectionEnd,_873.textbox.value.length);var _886=(_884===""||_884.substr(-1).indexOf(" ")===0||_884.substr(-1).indexOf("\n")===0)?"":" ";_873.textbox.value=_884+_886+"@"+_885;_873.textbox.setSelectionRange((_884+_886+1).length,(_884+_886+1).length);_873.updatePositions();},this,"mousedown, touchstart");_848.createActionLink(_882,"comment-ui-btn comment-save-btn",I18N("save_button_label"),I18N("save_button_label"));},_renderCollapsedStateUi:function(_887,_888){var _889=I18N("more_comments",[_888]);var _88a=_889+"<span class=\"more-comments-hint-arrow\">"+I18N("more_comments_show")+" &nbsp;<i class=\"fonticon-doublearrow-down\"></i></span>";var _88b=dojo.create("li",{"sid":this.txtGroupId,"class":"more-comments-hint","innerHTML":_889});_848.createActionLink(_88b,"more-comments-action-overlay",_88a,I18N("more_comments_show_title"),function(_88c){this.toggleCommentCollapseClick(_88c);},this);dojo.place(_88b,_887,"after");},insertIntoMentionMap:function(_88d,_88e){this.mentionMapDisplayToId[_88e]=_88d;this.mentionMapIdToDisplay[_88d]=_88e;},insertIntoHashtagMap:function(tag){this.hashtagFromDisplayname[tag.displayname]=tag.link;this.hashtagToDisplayname[tag.link]=tag.displayname;},_getTextToSend:function(_88f){_88f=this._mapTextContents(_88f,"@",this.mentionMapDisplayToId);_88f=this._mapTextContents(_88f,"#",this.hashtagFromDisplayname);return _88f;},_getTextToDisplayInTextarea:function(_890){_890=_842.unescape(_890);_890=this._mapTextContents(_890,"@",this.mentionMapIdToDisplay);_890=this._mapTextContents(_890,"#",this.hashtagToDisplayname);return _890;},_mapTextContents:function(_891,sign,_892){dojo.forEach(dojox.lang.functional.keys(_892),function(from){var to=_892[from];var _893=sign+"\\["+from+"\\]";var _894=sign+"["+to+"]";var re=new RegExp(_893,"g");_891=_891.replace(re,_894);});return _891;},_enrichTextEntryContent:function(_895,_896,item){var self=this;dojo.when(true).then(function(){return _83f.getHashtagsFromText(_896);}).then(function(tags){var _897=dojo.map(tags,function(tag){if(tag.displayname){return dojo.when(tag);}else{var _898=[tag.id];return Api.Caching.hashtags.getByDocumentIdAndCommentIdAndEntryIdAndTagIds(sp.info.document.id,item.txtGId,item.id,_898).then(Api.Util.data).otherwise(function(_899){return null;});}});return dojo.promise.all(_897).then(function(tags){return dojo.filter(tags,function(tag){return !!tag;});});}).then(function(tags){dojo.forEach(tags,function(tag){self.insertIntoHashtagMap(tag);});return true;}).otherwise(function(_89a){console.error("error determining hashtags from text",_89a,_89a.stack);return true;}).then(function(){return _83e.getUserIdsFromMentionText(_896);}).then(function(_89b){return sp.infos.getInstance().bulkloadByIds({type:sp.infos.TYPE.user,ids:_89b}).then(function(){return _89b;});}).then(function(_89c){return dojo.promise.all(dojo.map(_89c,function(_89d){return sp.infos.getInstance().getById({type:"user",id:_89d}).then(function(_89e){return _89e.user;});}));}).then(function(_89f){dojo.forEach(_89f,function(user){self.insertIntoMentionMap(user.id,user.displayname);});return true;}).otherwise(function(_8a0){console.error("error determining usermentions from text",_8a0,_8a0.stack);return true;}).then(function(){if(_895){return dojo.when(_840.convertTextToFullyEnrichedMarkup(_896,"sid=\"__NOFLOW\"",true)).then(function(text){_895.innerHTML=text;});}}).otherwise(function(_8a1){});},removeMentionInTextEntry:function(_8a2,_8a3){if(_8a2&&_8a3){var _8a4=this.getEntryItem(_8a2);var _8a5=this.mentionMapIdToDisplay[_8a3];if(_8a4&&_8a5){var _8a6=_8a4.text;var _8a7="@\\["+_8a3+"\\]";var _8a8="@"+_8a5+"";var re=new RegExp(_8a7,"g");_8a6=_8a6.replace(re,_8a8);_8a4.text=_842.unescape(_8a6);this.controller._pad.container.addOrUpdateItems([_8a4]);this.controller.resetTextEdit();}}},updateOwnMention:function(_8a9,text){if(_83e.isOwnMentionInText(text)){this.ownMentionsPerTxtEIds.push(_8a9);}else{this.ownMentionsPerTxtEIds.del(_8a9);}},toggleCommentCollapseClick:function(_8aa){dojo.stopEvent(_8aa);_8aa.stopPropagation();_8aa.cancelBubble=true;var _8ab=dojo.query("li:not(.more-comments-hint):not(:first-child):not(:last-child)",this.entryList);var that=this;var _8ac=50;var _8ad=Array.prototype.reverse.call(_8ab);if(dojo.hasClass(that.domNode,"comment-collapsed")){dojo.style(dojo.query(".more-comments-hint",that.entryList)[0],"display","none");_8ad.forEach(function(_8ae,_8af){dojo.animateProperty({node:_8ae,delay:_8ac-100,easing:dojo.fx.easing.quadIn,beforeBegin:function(_8b0){dojo.addClass(that.domNode,"with-overflow");},onBegin:function(){dojo.style(_8ae,"display","block");},duration:250,properties:{opacity:{start:0,end:1}},onEnd:function(_8b1){dojo.removeClass(that.domNode,"with-overflow");dojo.style(_8b1,{"opacity":""});if(_8af===_8ab.length-1){that.controller.toggleTextGroupCollapse(that.txtGroupId);dojo.removeClass(that.domNode,"comment-collapsed");_8ad.style("display","");}}}).play();_8ac+=50;});}else{dojo.style(dojo.query(".more-comments-hint",that.entryList)[0],"display","block");_8ad.forEach(function(_8b2,_8b3){dojo.animateProperty({node:_8b2,delay:_8ac-100,beforeBegin:function(_8b4){dojo.addClass(that.domNode,"with-overflow");dojo.style(_8b4,{"display":"block"});},duration:100,properties:{opacity:{start:1,end:0}},onEnd:function(_8b5){dojo.removeClass(that.domNode,"with-overflow");dojo.style(_8b5,{"display":"none","opacity":""});if(_8b3===_8ad.length-1){that.controller.toggleTextGroupCollapse(that.txtGroupId);dojo.addClass(that.domNode,"comment-collapsed");_8ad.style("display","");}}}).play();_8ac+=50;});}}});});},"wp/data/item/NullItem":function(){define("wp/data/item/NullItem",["dijit","dojo","dojox","dojo/require!wp/data/Item"],function(_8b6,dojo,_8b7){dojo.provide("wp.data.item.NullItem");dojo.require("wp.data.Item");dojo.declare("wp.data.item.NullItem",wp.data.Item,{constructor:function(){this.type="NULL";}});});},"wp/widget/WelcomeDialog":function(){define("wp/widget/WelcomeDialog",["dijit","dojo","dojox","dojo/i18n!wp/widget/nls/WelcomeDialog","dojo/i18n!sp/nls/I18nWidget","dojo/require!dojo/when,sp/dialog/Dialog,sp/global,sp/I18n,sp/I18nWidget,cb/page/pad/PadParticipantManager,sp/Tooltip,cb/widget/_SimpleTableMixin,cb/widget/UserIconListEntry,cb/widget/ParticipantList,cb/api/Api,cb/Capabilities,sp/infos/InfoManager"],function(_8b8,dojo,_8b9){dojo.provide("wp.widget.WelcomeDialog");dojo.require("dojo.when");dojo.require("sp.dialog.Dialog");dojo.require("sp.global");dojo.require("sp.I18n");dojo.require("sp.I18nWidget");dojo.require("cb.page.pad.PadParticipantManager");dojo.require("sp.Tooltip");dojo.requireLocalization("wp.widget","WelcomeDialog");dojo.requireLocalization("sp","I18nWidget");dojo.require("cb.widget._SimpleTableMixin");dojo.require("cb.widget.UserIconListEntry");dojo.require("cb.widget.ParticipantList");dojo.require("cb.api.Api");dojo.require("cb.Capabilities");dojo.require("sp.infos.InfoManager");dojo.declare("wp.widget.WelcomeDialog",[sp.dialog.Dialog],{baseClass:"body-content welcome-dialog",simpleOrient:"right",disableUpdatePosition:sp.isTouchOnly,disableEsc:true,autofocus:false,documentId:null,loginAlternatives:null,postMixInProperties:function(){this.inherited(arguments);},postCreate:function(){this.inherited(arguments);this.content=new (dojo.declare([sp.dialog.DialogContent,sp.I18nWidget]))({templateString:"<div class=\"dialog-content big-inputs\" dojoAttachPoint=\"_dialogContent\">\r\n\t<div class=\"dialog-title\"><i id=\"where_am_i_hint\" class=\"fonticon-question\"></i></div>\r\n    <span data-dojo-type=\"sp.Tooltip\" data-dojo-props=\"connectId:'where_am_i_hint', showDelay: 50\" class=\"hideBlock\"><span class=\"tooltip-hint-content\">${!i18n.title_tooltip}</span></span>\r\n    \r\n    <div class=\"margin\">\r\n        \t\r\n    \t<div data-dojo-attach-point=\"_chooseLogIn\" class=\"choose-login-container\">\r\n\r\n\t\t\t<h1 data-dojo-attach-point=\"_boardTitle\" class=\"board-title\"></h1>\r\n            <span data-dojo-attach-point=\"_boardMetainfo\" class=\"board-metainfo date\"></span>\r\n\r\n\t\t\t<div class=\"participants\">\r\n\t            <span class=\"participants-label\">${!i18n.participants_label}</span>\r\n\t            <div class=\"participants-container\" data-dojo-attach-point=\"_ParticipantsContainer\">\r\n\t                <div class=\"more-user light hideBlock\" data-dojo-attach-point=\"_ParticipantsUserCount\"></div>\r\n\t            </div>\r\n\t        </div>\r\n            <a class=\"button large\" data-dojo-attach-event=\"click: _handleRegisteredLoginButtonClick\"><i class=\"fonticon-board\"></i> ${!i18n.choose_login_as_user_label}</a>\r\n    \t\t<a class=\"button large secondary\" data-dojo-attach-event=\"click: _handleGuestLoginButtonClick\">${!i18n.choose_login_as_guest_label}</a>\r\n    \t</div>\r\n    \t\r\n        <div class=\"hideBlock\" data-dojo-attach-point=\"_registeredUserLogIn\">\r\n\t\t\t\r\n\t\t\t<p class=\"back-hint\"><span class=\"link\" data-dojo-attach-event=\"click: _handleChooseLoginButtonClick\"><i class=\"fonticon-doublearrow-left\"></i> ${!i18n.back}</span></p>\r\n\t\t\t\r\n            <div class=\"login-area clearfix\" data-dojo-attach-point=\"_loginAreaNode\">\r\n                <form class=\"userLoginForm\" action=\"${loginUrl}\" method=\"post\" data-dojo-attach-point=\"_loginConceptboardNode\">\r\n                    <input type=\"hidden\" name=\"csrftoken\" value=\"${nonce}\"/>\r\n                    <input type=\"hidden\" name=\"afterwardsUrl\" value=\"${urlAfterLogin}\"/>\r\n                    <input type=\"hidden\" name=\"source\" value=\"welcome_login\"/>\r\n                    <label for=\"${id}_userName\">${!i18n.existing_email}</label>\r\n                    <input type=\"email\" value=\"\" id=\"${id}_userName\" data-dojo-attach-point=\"_userLoginName\" name=\"j_username\" class=\"full-width\"/>\r\n                    <label for=\"userPassword\">${!i18n.existing_pswd}</label>\r\n                    <input type=\"password\" value=\"\" id=\"userPassword\" name=\"j_password\" class=\"full-width\"/>\r\n                    <button type=\"submit\" class=\"large\"><i class=\"fonticon-lock\"></i>&nbsp; ${!i18n.existing_login_button} &nbsp;</button>\r\n                    &nbsp;\r\n                    <a href=\"/__/password-recovery-start\" class=\"link\">${!i18n.existing_pswd_forgot}</a>\r\n                </form>\r\n                <form action=\"/saml/sp/login-with-idp\" method=\"post\" data-dojo-attach-point=\"_loginAlternativesSamlNode\" class=\"hideBlock\">\r\n                    <input type=\"hidden\" name=\"csrftoken\" value=\"${nonce}\"/>\r\n                    <input type=\"hidden\" name=\"afterwardsUrl\" value=\"${urlAfterLogin}\" />\r\n                    <input type=\"hidden\" name=\"source\" value=\"saml\"/>\r\n                    <p>${!i18n.saml_message}</p>\r\n                    <button type=\"submit\" class=\"large\"><i class=\"fonticon-lock\"></i>&nbsp; ${!i18n.saml_button} &nbsp;</button>\r\n                </form>\r\n                <div class=\"login-alternatives\"  data-dojo-attach-point=\"_loginAlternativesNode\">\r\n                    <form method=\"post\" action=\"/signin/twitter\" class=\"social-login social-twitter\" data-dojo-attach-point=\"_loginAlternativesTwitterNode\">\r\n                        <input type=\"hidden\" name=\"csrftoken\" value=\"${nonce}\"/>\r\n                        <input type=\"hidden\" name=\"afterwardsUrl\" value=\"${urlAfterLogin}\" />\r\n                        <input type=\"hidden\" name=\"source\" value=\"welcome_social\"/>\r\n                        <button type=\"submit\" class=\"full-width small\"><i class=\"fonticon-twitter fonticon-large\"></i> sign in with Twitter</button>\r\n                    </form>\r\n                    <form method=\"post\" action=\"/signin/facebook\" class=\"social-login social-facebook\" data-dojo-attach-point=\"_loginAlternativesFacebookNode\">\r\n                        <input type=\"hidden\" name=\"csrftoken\" value=\"${nonce}\"/>\r\n                        <input type=\"hidden\" name=\"afterwardsUrl\" value=\"${urlAfterLogin}\" />\r\n                        <input type=\"hidden\" name=\"source\" value=\"welcome_social\"/>\r\n                        <button type=\"submit\" class=\"full-width small\"><i class=\"fonticon-facebook fonticon-large\"></i> sign in with Facebook</button>\r\n                    </form>\r\n                    <form method=\"post\" action=\"/signin/google_oauth\" class=\"social-login social-google_oauth\" data-dojo-attach-point=\"_loginAlternativesGoogleNode\">\r\n                        <input type=\"hidden\" name=\"csrftoken\" value=\"${nonce}\"/>\r\n                        <input type=\"hidden\" name=\"afterwardsUrl\" value=\"${urlAfterLogin}\" />\r\n                        <input type=\"hidden\" name=\"source\" value=\"welcome_social\"/>\r\n                        <button type=\"submit\" class=\"full-width small\"><i class=\"fonticon-google fonticon-large\"></i> sign in with Google</button>\r\n                    </form>\r\n                    <form method=\"post\" action=\"/signin/forcedotcom\" class=\"social-login social-forcedotcom\" data-dojo-attach-point=\"_loginAlternativesForcedotcomNode\">\r\n                        <input type=\"hidden\" name=\"csrftoken\" value=\"${nonce}\"/>\r\n                        <input type=\"hidden\" name=\"afterwardsUrl\" value=\"${urlAfterLogin}\" />\r\n                        <input type=\"hidden\" name=\"source\" value=\"welcome_social\"/>\r\n                        <button type=\"submit\" class=\"full-width small\"><i class=\"fonticon-salesforce fonticon-large\"></i> sign in with Salesforce</button>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n            <p class=\"guest-hint\" data-dojo-attach-point=\"_loginSignupHintNode\"><i class=\"fonticon-heart\"></i>&nbsp; ${!i18n.guest_hint}</p>\r\n        </div>\r\n        \r\n        <div class=\"hideBlock\" data-dojo-attach-point=\"_guestLogIn\">\r\n            \r\n\t\t\t<p class=\"back-hint\"><span class=\"link\" data-dojo-attach-event=\"click: _handleChooseLoginButtonClick\"><i class=\"fonticon-doublearrow-left\"></i> ${!i18n.back}</span></p>\r\n            \r\n            <div class=\"guest-area\">\r\n                <form class=\"guestLoginForm clearfix big-inputs\" action=\"${loginUrlNamed}\" method=\"post\" data-dojo-attach-event=\"submit:_handleRegistrationFormSubmit\">\r\n                    <input type=\"hidden\" name=\"csrftoken\" value=\"${nonce}\"/>\r\n                    <input type=\"hidden\" name=\"afterwardsUrl\" value=\"${urlAfterLogin}\"/>\r\n                    <input type=\"hidden\" name=\"source\" value=\"welcome_guest\"/>\r\n                    <input type=\"hidden\" name=\"welcomedocumentid\" value=\"${documentid}\"/>\r\n                    <label for=\"${id}_guestName\">${!i18n.name_label}</label>\r\n                    <input type=\"text\" value=\"\" dojoAttachPoint=\"_namedGuestNameInput\" id=\"${id}_guestName\" name=\"name\" class=\"full-width large\"/>\r\n                    <span class=\"error hideBlock\" data-dojo-attach-point=\"_nameInputEmptyError\">${!i18n.name_required}</span>\r\n                    <div class=\"hideBlock guest-join-request-container\" data-dojo-attach-point=\"_namedGuestJoinrequestContainer\">\r\n                        <input type=\"checkbox\" name=\"joinrequest\" id=\"${id}_joinrequest\" data-dojo-attach-point=\"_namedGuestJoinrequestCheckbox\"  value=\"true\"/>\r\n                        <label for=\"${id}_joinrequest\" data-dojo-attach-point=\"_namedGuestJoinrequestLabel\">${!i18n.joinrequest_option_label}</label>\r\n                        <div data-dojo-attach-point=\"_namedGuestJoinrequestInputContainer\" class=\"guest-area__joinrequest hideBlock\">\r\n                            <label for=\"${id}_guestEmail\">${!i18n.email_label}</label>\r\n                            <input type=\"text\" value=\"\" dojoAttachPoint=\"_namedGuestEmailInput\" id=\"${id}_guestEmail\" name=\"email\" class=\"full-width\"/>\r\n                        </div>\r\n                    </div>\r\n                    <button type=\"submit\" class=\"full-width\">${!i18n.join_as_guest_button}</button> \r\n                </form>\r\n            </div>\r\n            <p class=\"guest-hint\" data-dojo-attach-point=\"_guestSignupHintNode\"><i class=\"fonticon-heart\"></i>&nbsp; ${!i18n.guest_hint}</p>\r\n        </div>\r\n        \r\n    </div>\r\n</div>",nonce:sp.info.user.nonce,widgetsInTemplate:true,loginUrlNamed:sp.info.app.serverUrlsCurrent.https+"/registration/named",loginUrl:sp.info.app.serverUrlsCurrent.https+"/login",urlAfterLogin:window.location.href,urlAfterLoginEscaped:sp.global.fixedEncodeURIComponent(window.location.href),participantsToShow:2,dialog:this,documentid:sp.info.document.id,i18n:sp.I18n.bundle("wp.widget","WelcomeDialog"),joinrequestvisible:!!sp.info.pageBrandCompany&&sp.info.document.document.ownerId!=="captaincb",loginAlternatives:[],pageBrandCompanyName:sp.info.pageBrandCompany?sp.info.pageBrandCompany.name:"",buildRendering:function(){this.inherited("buildRendering",arguments);this._namedGuestJoinrequestLabel.innerHTML=sp.I18n.get("wp.widget","WelcomeDialog")("joinrequest_option_label",[this.pageBrandCompanyName]);this._boardTitle.innerHTML=this.dialog.documentTitle;var _8ba=null;sp.infos.getInstance().getById({type:"user",id:sp.info.document.document.ownerId}).then(dojo.hitch(this,function(_8bb){_8ba=sp.I18n.get("wp.widget","WelcomeDialog")("metainfo_author",[_8bb.user.displayname]);if(this.pageBrandCompanyName!==""){_8ba+=" ("+this.pageBrandCompanyName+")";}this._boardMetainfo.innerHTML=_8ba;}));this._boardTitle.innerHTML=sp.I18n.esc(this.dialog.documentTitle);},postCreate:function(){this.inherited("postCreate",arguments);this.watch("joinrequestinputvisible",dojo.hitch(this,"_updateRegistrationSelfsignup"));this._initParticipants();this.connect(this._namedGuestJoinrequestCheckbox,"change","_handleGuestJoinRequestCheckboxChange");this.set("joinrequestinputvisible",!!this._namedGuestJoinrequestCheckbox.checked);this._updateRegistrationSelfsignup();sp.global.analytics.trackEvent("board welcome","initial screen open",null,null,true);sp.global.analytics.trackTiming("board welcome","initial screen open");dojo.query("form",this._registeredUserLogIn).on("submit",function(evt){var _8bc="";if(dojo.hasClass(evt.target,"social-twitter")){_8bc="twitter";}if(dojo.hasClass(evt.target,"social-facebook")){_8bc="facebook";}if(dojo.hasClass(evt.target,"social-google_oauth")){_8bc="google";}if(dojo.hasClass(evt.target,"social-forcedotcom")){_8bc="salesforce";}sp.global.analytics.trackEvent("board welcome","user login click",_8bc);sp.global.analytics.trackTiming("board welcome","final button click","login click");});dojo.query("form",this._guestLogIn).on("submit",function(){sp.global.analytics.trackEvent("board welcome","guest login click");sp.global.analytics.trackTiming("board welcome","final button click","guest join click");});},_handleRegistrationFormSubmit:function(_8bd){var _8be=!!dojo.attr(this._namedGuestNameInput,"value");dojo.toggleClass(this._nameInputEmptyError,"hideBlock",_8be);if(!_8be){dojo.stopEvent(_8bd);}},_handleGuestJoinRequestCheckboxChange:function(_8bf){this.set("joinrequestinputvisible",!!this._namedGuestJoinrequestCheckbox.checked);},_handleChooseLoginButtonClick:function(){this._toggleLoginForms();},_handleGuestLoginButtonClick:function(){this._toggleLoginForms(false,true);},_handleRegisteredLoginButtonClick:function(){this._toggleLoginForms(true,false);},_toggleLoginForms:function(_8c0,_8c1){if((_8c0&&!_8c1)||(!_8c0&&_8c1)){dojo.toggleClass(this._chooseLogIn,"hideBlock",true);dojo.toggleClass(this._registeredUserLogIn,"hideBlock",!_8c0);dojo.toggleClass(this._guestLogIn,"hideBlock",!_8c1);if(_8c1){_8b8.focus(this._namedGuestNameInput);sp.global.analytics.trackEvent("board welcome","guest screen open");sp.global.analytics.trackTiming("board welcome","second screen open","guest screen");}if(_8c0){_8b8.focus(this._userLoginName);sp.global.analytics.trackEvent("board welcome","login screen open");sp.global.analytics.trackTiming("board welcome","second screen open","login screen");}}else{dojo.toggleClass(this._chooseLogIn,"hideBlock",false);dojo.toggleClass(this._registeredUserLogIn,"hideBlock",true);dojo.toggleClass(this._guestLogIn,"hideBlock",true);sp.global.analytics.trackEvent("board welcome","initial screen open");}},_setJoinrequestinputvisibleAttr:function(_8c2){dojo.toggleClass(this._namedGuestJoinrequestInputContainer,"hideBlock",!_8c2);this._set("joinrequestinputvisible",_8c2);},_setJoinrequestvisibleAttr:function(_8c3){dojo.toggleClass(this._namedGuestJoinrequestContainer,"hideBlock",!_8c3);this._set("joinrequestvisible",_8c3);},_updateRegistrationSelfsignup:function(){dojo.when(cb.Capabilities.checkFeature("registration.selfsignup")).then(function(_8c4){return _8c4==="enabled";}).then(dojo.hitch(this,function(_8c5){this.set("registrationSelfsignup",_8c5&&!this.joinrequestvisible);}));},_setRegistrationSelfsignupAttr:function(_8c6){dojo.toggleClass(this._loginSignupHintNode,"hideBlock",!_8c6);dojo.toggleClass(this._guestSignupHintNode,"hideBlock",!_8c6);this._set("registrationSelfsignup",_8c6);},_setLoginAlternativesAttr:function(_8c7){var _8c8=_8c7||[];dojo.toggleClass(this._loginAreaNode,"no-login-alternatives",dojo.indexOf(_8c8,"conceptboard")===-1&&dojo.indexOf(_8c8,"saml")===-1);dojo.toggleClass(this._loginAlternativesTwitterNode,"hideBlock",dojo.indexOf(_8c8,"twitter")===-1);dojo.toggleClass(this._loginAlternativesFacebookNode,"hideBlock",dojo.indexOf(_8c8,"facebook")===-1);dojo.toggleClass(this._loginAlternativesGoogleNode,"hideBlock",dojo.indexOf(_8c8,"google")===-1);dojo.toggleClass(this._loginAlternativesForcedotcomNode,"hideBlock",dojo.indexOf(_8c8,"forcedotcom")===-1);dojo.toggleClass(this._loginAlternativesSamlNode,"hideBlock",dojo.indexOf(_8c8,"saml")===-1);dojo.toggleClass(this._loginConceptboardNode,"hideBlock",dojo.indexOf(_8c8,"conceptboard")===-1);this._set("loginAlternatives",_8c8);},_initParticipants:function(){this._participantList=new cb.widget.ParticipantList({participantsToShow:this.participantsToShow,ownUserId:sp.info.user.info.id,documentId:sp.info.document.document.id,parent:this,participantManager:cb.page.pad.PadParticipantManager,postMixInProperties:function(){this.inherited("postMixInProperties",arguments);this.queryOptions.count=this.participantsToShow;}},dojo.create("div",null,this._ParticipantsContainer,"first"));this.connect(this._participantList.participantManager,"onNewUser","_updateUserCount");},_addParticipant:function(_8c9){this._participantList.addParticipant(_8c9).then(dojo.hitch(this,function(){this._updateUserCount();}));},_updateUserCount:function(){var _8ca=this._participantList.participantManager.participants.length-this.participantsToShow;if(_8ca>0){this._ParticipantsUserCount.innerHTML=sp.I18n.get("wp.widget","WelcomeDialog")("participants_more_user_count",[_8ca]);dojo.removeClass(this._ParticipantsUserCount,"hideBlock");}}});this._setupLoginAlternatives();},onCancel:function(){if(this.disableCancel){return;}else{this.inherited(arguments);}},_setupLoginAlternatives:function(){cb.api.Api.Caching.users_me_features.get(["sociallogin.twitter","sociallogin.google","sociallogin.facebook","sociallogin.forcedotcom","saml.sp","conceptboardlogin"]).then(cb.api.Api.Util.data).then(function(_8cb){var ret=[];if(_8cb["sociallogin.twitter"]){ret.push("twitter");}if(_8cb["sociallogin.google"]){ret.push("google");}if(_8cb["sociallogin.facebook"]){ret.push("facebook");}if(_8cb["sociallogin.forcedotcom"]){ret.push("forcedotcom");}if(_8cb["saml.sp"]){ret.push("saml");}if(_8cb["conceptboardlogin"]){ret.push("conceptboard");}return ret;}).then(dojo.hitch(this,function(_8cc){this.content.set("loginAlternatives",_8cc);}));}});});},"wp/common/ColorHelper":function(){define("wp/common/ColorHelper",["dijit","dojo","dojox"],function(_8cd,dojo,_8ce){dojo.provide("wp.common.ColorHelper");dojo.mixin(wp.common.ColorHelper,{WHITE_RGBA_COMPONENTS:dojo.Color.fromString("white").toRgba(),blendOnWhite:function(_8cf){var src=_8cf.toRgba();var dest=wp.common.ColorHelper.WHITE_RGBA_COMPONENTS;var a=src[3]+dest[3]*(1-src[3]);var r=(src[0]*src[3]+dest[0]*dest[3]*(1-src[3]))/a;var g=(src[1]*src[3]+dest[1]*dest[3]*(1-src[3]))/a;var b=(src[2]*src[3]+dest[2]*dest[3]*(1-src[3]))/a;return dojo.Color.fromArray([r,g,b,a]);},convertHexAndPercentToDojoColor:function(hex,_8d0){var _8d1=wp.common.ColorHelper.fromHexToDojoColor(hex);_8d1.a=_8d0/100;return _8d1;},convertHexToHsl:function(hex){var _8d2=wp.common.ColorHelper.fromHexToDojoColor(hex);return wp.common.ColorHelper.convertRgbToHsl(_8d2.r,_8d2.g,_8d2.b);},convertHslToHex:function(h,s,l){var _8d3=wp.common.ColorHelper.convertHslToRgb(h,s,l);return dojo.colorFromArray(_8d3).toHex();},convertRgbToHsl:function(r,g,b){r=r/255;g=g/255;b=b/255;var max=Math.max(r,g,b);var min=Math.min(r,g,b);var h=(max+min)/2;var s=h;var l=h;if(max==min){h=s=0;}else{var d=max-min;s=l>0.5?d/(2-max-min):d/(max+min);switch(max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4;break;}h/=6;}return [Math.round(h*255),Math.round(s*255),Math.round(l*255)];},convertHslToRgb:function(h,s,l){h=h/255;s=s/255;l=l/255;var r;var g;var b;if(s===0){r=l;g=l;b=l;}else{var _8d4=function(p,q,t){if(t<0){t+=1;}if(t>1){t-=1;}if(t<1/6){return p+(q-p)*6*t;}if(t<1/2){return q;}if(t<2/3){return p+(q-p)*(2/3-t)*6;}return p;};var q=(l<0.5)?(l*(1+s)):(l+s-l*s);var p=2*l-q;r=_8d4(p,q,h+1/3);g=_8d4(p,q,h);b=_8d4(p,q,h-1/3);}return [Math.round(r*255),Math.round(g*255),Math.round(b*255)];},fromHexToDojoColor:function(hex){var _8d5=(hex==="transparent")?dojo.colorFromArray([255,255,255,0]):dojo.colorFromHex(hex);if(!_8d5){console.warn("could not convert colorstring",hex,"to valid color; falling back to black");_8d5=dojo.colorFromHex("#000000");}return _8d5;},rgbToXYZ:function(rgb){var r=rgb.r,g=rgb.g,b=rgb.b;function fXYZ(t){return t<=0.04045?t/12.92:Math.pow((t+0.055)/1.055,2.4);};r=fXYZ(r);g=fXYZ(g);b=fXYZ(b);var x=0.4124*r+0.3576*g+0.1805*b;var y=0.2126*r+0.7152*g+0.0722*b;var z=0.0193*r+0.1192*g+0.9505*b;return {x:x,y:y,z:z};},xyzToRGB:function(xyz){var x=xyz.x,y=xyz.y,z=xyz.z;var r=3.241*x-1.5374*y-0.4986*z;var g=-0.9692*x+1.876*y+0.0416*z;var b=0.0556*x-0.204*y+1.057*z;function fXYZ(t){return t<=0.0031308?12.92*t:(1+0.055)*Math.pow(t,1/2.4)-0.055;};r=fXYZ(r);g=fXYZ(g);b=fXYZ(b);r=r<0?0:r>1?1:r;g=g<0?0:g>1?1:g;b=b<0?0:b>1?1:b;return {r:r,g:g,b:b};},xyzToLab:function(xyz){var x=xyz.x,y=xyz.y,z=xyz.z;function fLab(t){return t>0.00886?Math.pow(t,1/3):7.787*t+4/29;};var L=116*fLab(y)-16;var a=500*(fLab(x)-fLab(y));var b=200*(fLab(y)-fLab(z));return {L:L,a:a,b:b};},labToXYZ:function(lab){var L=lab.L,a=lab.a,b=lab.b;var y=(L+16)/116;var x=y+a/500;var z=y-b/200;function fLab(t){return t>0.2069?Math.pow(t,3):(t-16/116)*0.1284;};y=fLab(y);x=fLab(x);z=fLab(z);return {x:x,y:y,z:z};},_lightUpColorList:function(_8d6,_8d7){var ret=[];for(var i=0;i<_8d6.length;i++){var val=wp.common.ColorHelper.convertHexToHsl(_8d6[i]);val[2]=val[2]*_8d7;ret.push(wp.common.ColorHelper.convertHslToHex(val[0],val[1],val[2]));}return ret;}});});},"sp/dialog/ChatterExportDialog":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/dom-construct","dojo/dom-attr","dojo/dom-class","dijit/_Widget","dojox/lang/functional","sp/dialog/TooltipDialog","sp/dialog/DialogContent","sp/ActivityIndicator","sp/infos/InfoManager","sp/ajax/AjaxEngine","cb/widget/SimpleTable","cb/Capabilities","sp/I18n","dojo/text!./ChatterExportDialog.html","dojo/i18n!./nls/ChatterExportDialog"],function(_8d8,lang,dArr,_8d9,_8da,_8db,_8dc,_8dd,_8de,_8df,_8e0,_8e1,_8e2,_8e3,_8e4,_8e5,_8e6,i18n){var _8e7=_8d8([_8dc],{baseClass:"chatter-group-list-entry",buildRendering:function(){this.inherited(arguments);var _8e8=_8d9.create("span",{"class":this.baseClass+"-content"},this.domNode);var _8e9=_8d9.create("span",{"class":this.baseClass+"-controls"},this.domNode);_8d9.create("img",{src:_8e5.escAttr(this.item.chatterGroup.thumbnail),"class":this.baseClass+"-image"},_8e8);_8d9.create("strong",{innerHTML:_8e5.esc(this.item.chatterGroup.name),"class":this.baseClass+"-name"},_8e8);_8d9.create("div",{"class":this.baseClass+"-description small light","innerHTML":_8e5.esc(this.item.chatterGroup.description)},_8e8);if(this.item.connections.length>0){this.connect(_8d9.create("span",{"class":this.baseClass+"-controls-add button secondary small","innerHTML":"repost"},_8e9),"click","_handleAddConnectionClick");}else{this.connect(_8d9.create("span",{"class":this.baseClass+"-controls-add button small","innerHTML":"post"},_8e9),"click","_handleAddConnectionClick");}},onConnectionRemoved:function(_8ea,_8eb){},onConnectionAdded:function(_8ec,_8ed){},_handleRemoveConnectionClick:function(){return _8e2.removeDocumentConnectionWithChatterGroup({chatterGroupId:this.item.id,documentId:this.documentId}).then(lang.hitch(this,function(){this.onConnectionRemoved(this.item.id,this.documentId);}));},_handleAddConnectionClick:function(){return _8e2.addDocumentConnectionWithChatterGroup({chatterGroupId:this.item.id,documentId:this.documentId}).then(lang.hitch(this,function(){this.onConnectionAdded(this.item.id,this.documentId);}));}});var _8ee=_8d8([_8e3],{baseClass:"chatter-group-list",type:"list",createEntryWidget:function(id,item,node){var ret=new _8e7({item:item,documentId:this.documentId},node);this.connect(ret,"onConnectionRemoved","onConnectionRemoved");this.connect(ret,"onConnectionAdded","onConnectionAdded");return ret;},onConnectionRemoved:function(_8ef,_8f0){},onConnectionAdded:function(_8f1,_8f2){}});var _8f3=_8d8([_8df],{templateString:_8e6,widgetsInTemplate:true,postMixInProperties:function(){this.inherited(arguments);this.afterwardsUrlUriComponent=encodeURIComponent(window.location);},postCreate:function(){this.inherited(arguments);var _8f4=new _8e0({activityIndicatorNode:this.activityIndicatorNode});_8f4.show();_8e1.getById({type:"socialconnections",id:sp.info.user.info.id}).then(lang.hitch(this,function(_8f5){var _8f6=dArr.some(_8f5.connections,function(_8f7){return _8f7.key.providerId==="forcedotcom";});if(!_8f6){_8f4.hide();return;}_8db.add(this._connectContent,"hideBlock");var _8f8=new _8ee({documentId:this.documentId},this._groupsListNode);var _8f9=function(){_8e1.invalidateById({type:"chatterdocumentinfos",id:this.documentId});this.dialog.hide();};this.connect(_8f8,"onConnectionRemoved",_8f9);this.connect(_8f8,"onConnectionAdded",_8f9);_8e1.getById({type:"chatterdocumentinfos",id:this.documentId}).then(lang.hitch(this,function(_8fa){var _8fb={};_8f4.hide();_8db.toggle(this._emptyGroupsListNode,"hideBlock",_8fa.chattergroups.length!==0);dArr.forEach(_8fa.chattergroups,function(_8fc){_8fb[_8fc.id]={chatterGroup:_8fc,id:_8fc.id,connections:[]};});dArr.forEach(_8fa.documentconnections,function(_8fd){var _8fe=_8fd.chatterGroupId;if(_8fb[_8fe]){_8fb[_8fe].connections.push(_8fd);}});_8dd.forIn(_8fb,function(item){_8f8.store.put(item);});}));}));}});return _8d8([_8de],{documentId:null,baseClass:"chatter-export-dialog with-title",postCreate:function(){this.inherited(arguments);_8e4.checkForcedotcomChatter().then(lang.hitch(this,function(_8ff){switch(_8ff){case "enabled":new _8f3({dialog:this,i18n:i18n,documentId:this.documentId});break;case "premium":new _8df({dialog:this,i18n:i18n,templateString:"<div><div class=\"dialog-title\">Chatter Connection</div><div class=\"margin\"><p>${i18n.chatter_description}</p><p>The Salesforce Chatter integration is only available for paid accounts with team functionality.</p></div></div>"});break;case "disabled":default:break;}}));}});});},"wp/handler/workflow/ZoomWorkflow":function(){define("wp/handler/workflow/ZoomWorkflow",["dijit","dojo","dojox"],function(_900,dojo,_901){dojo.provide("wp.handler.workflow.ZoomWorkflow");dojo.declare("wp.handler.workflow.ZoomWorkflow",null,{constructor:function(pad){this.type="ZOOM";this._pad=pad;},localReset:function(){this.rubberbandMode="off";},terminateWorkflow:function(){return this.rubberbandMode!=="off";},startWorkflow:function(iCS){this.localReset();if(this.rubberbandMode==="off"){this.rubberbandMode="on";}},processWorkflow:function(iCS,_902){var _903={x:iCS.positionX,y:iCS.positionY};var _904={x:_902.positionX,y:_902.positionY};if(this.rubberbandMode!=="off"){var _905=this._pad.factory.getNewItem("temporary",{"subtype":"rubberband"});_905.id="_TMP";_905.a=_903;_905.b=_904;this._pad.controller.previewNewItems([_905]);}},endWorkflow:function(iCS,_906){var _907={x:iCS.positionX,y:iCS.positionY};var _908={x:_906.positionX,y:_906.positionY};var _909=_906.shiftKey;if(this.rubberbandMode!=="off"){this._pad.container.abortPreview();var _90a=30/this._pad.surface.getZoomFactor();if(Math.abs(_907.x-_908.x)<_90a&&Math.abs(_907.y-_908.y)<_90a){if(_909){this._pad.controller.zoomOut(_907.x,_907.y,true);}else{this._pad.controller.zoomIn(_907.x,_907.y,true);}}else{var bbox=new wp.BBox(_907,_908);this._pad.surface.smoothZoomToBBox(bbox);}}this.localReset();this.terminateWorkflow();}});});},"wp/PointArray":function(){define("wp/PointArray",["dojo/_base/declare"],function(_90b){return _90b("wp.PointArray",null,{constructor:function(pa){this.type="pa";this.points=[];if(pa&&pa.type=="pa"&&pa.points&&pa.points.length){this.points=pa.points;}},add:function(_90c){this.points[this.points.length]=_90c;},getTuplesWithAdditionalStart:function(_90d){var ret=[];ret.push([_90d.x,_90d.y]);for(var i=0;i<this.points.length;i++){ret.push([this.points[i].x,this.points[i].y]);}return ret;},json:function(){return {"type":this.type,"points":this.points};}});});},"wp/surface/DrawerCursorAddOn":function(){define("wp/surface/DrawerCursorAddOn",["dijit","dojo","dojox","dojo/require!dojox/gfx/_base"],function(_90e,dojo,_90f){dojo.provide("wp.surface.DrawerCursorAddOn");dojo.require("dojox.gfx._base");(function(){_90f.gfx._hasClass=function(node,_910){var cls=node.getAttribute("class");return cls&&(" "+cls+" ").indexOf(" "+_910+" ")>=0;};_90f.gfx._addClass=function(node,_911){var cls=node.getAttribute("class")||"";if(!cls||(" "+cls+" ").indexOf(" "+_911+" ")<0){node.setAttribute("class",cls+(cls?" ":"")+_911);}};_90f.gfx._removeClass=function(node,_912){var cls=node.getAttribute("class");if(cls){node.setAttribute("class",cls.replace(new RegExp("(^|\\s+)"+_912+"(\\s+|$)"),"$1$2"));}};})();dojo.declare("wp.surface.DrawerCursorAddOn",null,{constructor:function(){this._currentCClass="cur_default";this._currentCClassContainsTextEdit=false;},setCursorMode:function(_913){this._applyCursorClassToSurface(_913);this._currentCClass=_913;this._currentCClassContainsTextEdit=_913.indexOf("show_text_edit_ui")>-1;},resetCursorMode:function(){this.setCursorMode(this._currentCClass);},overwriteCursorMode:function(_914){this._applyCursorClassToSurface(_914+" "+(this._currentCClassContainsTextEdit?"show_text_edit_ui":""));},_applyCursorClassToSurface:function(_915){var node=this._surface.getNode();dojo.removeClass(node);dojo.addClass(node,_915);},_applyCursorClassToShape:function(_916,_917){if(this._isCursorHandlingNeeded){var _918=(_917=="image"?"cur_select":"cur_move");_90f.gfx._addClass(_916,_918);}},_applyCursorClassToPreviewShape:function(_919){if(this._isCursorHandlingNeeded){var _91a="cur_move";_90f.gfx._addClass(_919,_91a);}}});});},"wp/surface/DrawerOSRAddOn":function(){define("wp/surface/DrawerOSRAddOn",["dijit","dojo","dojox"],function(_91b,dojo,_91c){dojo.provide("wp.surface.DrawerOSRAddOn");dojo.declare("wp.surface.DrawerOSRAddOn",null,{constructor:function(){this._idsOSR=[];},isOriginalPresent:function(id){return id&&this._pad.container.getDrawShape(id);},isOSRActivatedForId:function(id){return dojo.indexOf(this._idsOSR,id)>-1;},activateOSRForId:function(id){this._surface.removeShapeGroup(this._pad.container.getDrawShape(id));this._pad.container.setDrawShape(id,null);this._idsOSR.push(id);},activateOSRForWidgetId:function(id){this._idsOSR.push(id);},removeOSRForId:function(id){var _91d=dojo.indexOf(this._idsOSR,id);if(_91d>-1){this._idsOSR.splice(_91d,1);}},applyOSR:function(){if(this._idsOSR&&this._idsOSR.length>0){for(var i=0;i<this._idsOSR.length;i++){this.enqueueDrawing(this._idsOSR[i]);}this._idsOSR=[];}}});});},"cb/page/pad/SaveStateDisplay":function(){define(["dojo","dojo/html","dojo/dom-style","dojo/dom-class","dojo/_base/fx","dijit/_Widget","cb/widget/_Templated","sp/I18n","sp/I18nWidget","dojo/text!./SaveStateDisplay.html","dojo/i18n!./nls/SaveStateDisplay"],function(dojo,_91e,_91f,_920,_921,_922,_923,_924,_925,_926,_927){return dojo.declare([_922,_923,_925],{templateString:_926,i18n:_927,postCreate:function(){this.inherited("postCreate",arguments);dojo.subscribe("/sp/ajax/savingSuccessful",this,"_showSaveTextForBetterPerformance");},_showSaveTextForBetterPerformance:function(){var that=this;if(this._currentHideTimeout){window.clearTimeout(this._currentHideTimeout);}else{_920.remove(this.saveLinkNode,"hideBlock");}this._currentHideTimeout=window.setTimeout(function(){_920.add(that.saveLinkNode,"hideBlock");that._currentHideTimeout=null;},1000);},_handleUserActivity:function(){var that=this;if(this._currentSaveAnimTimeout){window.clearTimeout(this._currentSaveAnimTimeout);}this._currentSaveAnimTimeout=window.setTimeout(dojo.hitch(this,function(){this._animateSaveButton();this._currentSaveAnimTimeout=null;}),10);},_animateSaveButton:function(){if(this._currentSaveAnim){this._currentSaveAnim.stop();}this._currentSaveAnim=_921.fadeIn({node:this.saveLinkNode,rate:100,delay:1000,end:0,beforeBegin:function(node){_920.remove(node,"hideBlock");_91f.set(node,"opacity",1);_91e.set(node,_924.wrap(_927)("save"));},onEnd:function(node){_91e.set(node,_924.wrap(_927)("saved"));_920.add(node,"hideBlock");}}).play();}});});},"url:sp/dialog/ChatterExportDialog.html":"<div>\r\n    <div class=\"dialog-title\">\r\n        ${!i18n.chatter_title}\r\n        <div data-dojo-attach-event=\"click:_cancelClick\" class=\"dialog-close-button\" title=\"close\"><i class=\"fonticon-cross\"></i></div>\r\n    </div>\r\n    <div class=\"margin\">\r\n        <p>${!i18n.chatter_description}</p>\r\n        <div data-dojo-attach-point=\"_connectContent\" class=\"\">\r\n            <a href=\"/__/signin/forcedotcom?afterwardsUrl=${afterwardsUrlUriComponent}\">${!i18n.chatter_connect}</a>\r\n        </div>\r\n        <div>\r\n            <div data-dojo-attach-point=\"_groupsListNode\"></div>\r\n            <div data-dojo-attach-point=\"activityIndicatorNode\" class=\"activity-indicator\"></div>\r\n            <div data-dojo-attach-point=\"_emptyGroupsListNode\" class=\"hideBlock\">\r\n                ${!i18n.chatter_no_groups}\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>","cb/board/tutorial/TutorialController":function(){define(["dojo","dojo/_base/declare","dojo/_base/lang","dojo/query","dojo/dom-construct","dojo/dom-class","dojo/on","dojo/_base/array","dojo/dom-attr","cb/widget/ShortcutsDialog","./TutorialStepPane","sp/I18n","dojo/i18n!./nls/TutorialMessages"],function(dojo,_928,lang,_929,_92a,_92b,on,arr,_92c,_92d,_92e,_92f,i18n){var I18N=_92f.wrap(i18n);return _928([],{currentStepPane:null,latestCommentIdSeen:null,tutorialGuyUserId:"captaincb",constructor:function(){dojo.subscribe("requests/cb/board/currenttutorialstep",this,"_changeTutorialStep");dojo.subscribe("/sp/items/newOrUpdatedVisibleItem",this,function(item){if(item.type==="txtG"&&item.subtype==="comment"&&!item.del){this.latestCommentIdSeen=item.id;}});},_changeTutorialStep:function(_930){var _931=null;if(this.currentStepPane){_931=this.currentStepPane.tutStepId;this.currentStepPane.onDestroy();this.currentStepPane.destroyRecursive();}var _932=this._getConfigForStep(_930,_931);if(_932){this.currentStepPane=new _92e(_932,_92a.create("div",null,dojo.body()));if(_932.tutSpecial){this.currentStepPane.show();}else{this.currentStepPane.show(dojo.byId("padViewport"));}}},_getConfigForStep:function(_933,_934){switch(_933){case "start":case "1":return this._getConfigStepStart(_933,"2","exit");case "2":return this._getConfigStepImport(_933,"3","1");case "3":return this._getConfigStepImportSuccess(_933,"4","2");case "4":return this._getConfigStepScribble(_933,"5","3");case "5":return this._getConfigStepScribbleSuccess(_933,"6","4");case "6":return this._getConfigStepNavigate(_933,"7","5");case "7":return this._getConfigStepNavigateSuccess(_933,"8","6");case "8":return this._getConfigStepComment(_933,"9","7");case "9":return this._getConfigStepCommentWait(_933,"10","8");case "10":return this._getConfigStepCommentSuccess(_933,"11","9");case "11":return this._getConfigStepMentionWait(_933,"12","10");case "12":return this._getConfigStepMentionSuccess(_933,"13","11");case "13":return this._getConfigStepOpentask(_933,"14","12");case "14":return this._getConfigStepEnd(_933,"15","13");case "abort":return this._getConfigStepAbort(_933,"done",_934);default:return null;}},_getConfigStepStart:function(_935,_936,_937){var _938="<div class=\"start-special\"><h1>"+I18N("step_start_title")+"</h1>"+I18N("step_start_intro")+"</div>";return {tutStepId:_935,tutTitle:"<img src=\"/_/images/cb-logo--horizontal.png\" />",tutSpecial:{markup:_938,bgClass:"with-special-start"},tutButtons:[this._BTN("step_start_next",_936,"button large"),this._BTN("step_start_exit",_937,"link"),this._BTN("dialog_close","abort","dialog-close button quiet")]};},_getConfigStepImport:function(_939,_93a,_93b){return {tutStepId:_939,tutStepBgClass:"with-head-eye",tutTitle:I18N("step_import_title"),tutTip:{markup:I18N("step_import_tip"),bgClass:"next-to-head",onClickFunction:function(_93c){_93c.target.parentNode.innerHTML=I18N("step_import_tip_wait");var _93d=dijit.byId("boardImportManager");_93d.downloadByUrls(_93d.uploader.settings.args,["http://"+sp.info.app.serverhost+"/_/images/tutorial_sample_image.png"]);sp.global.analytics.trackEvent("Tutorial","help_clicked",_939);}},tutActionsNextStep:_93a,tutActions:[{markup:I18N("step_import_task"),extraMarkup:"<img src=\"/_/images/start__feature__drag-drop.png\" class=\"import-image\" />",getCheckerFunction:function(){var _93e=false;dojo.subscribe("/sp/items/newOrUpdatedVisibleItem",function(item){if(item.type==="image"){_93e=true;}});return function(){return _93e;};}}],tutButtons:[this._BTN("step_back",_93b,"link"),this._BTN("dialog_close","abort","dialog-close button quiet")]};},_getConfigStepImportSuccess:function(_93f,_940,_941){return {tutStepId:_93f,tutStepBgClass:"with-head-eye",tutTitle:I18N("step_importsuccess_title"),tutTip:{markup:I18N("step_importsuccess_tip"),onClickFunction:function(){var _942=new sp.dialog.TooltipDialog({style:"width: 853px; heigt: 480px;",content:"<iframe width=\"853\" height=\"480\" style=\"margin: -1px; display: block;\" src=\"https://www.youtube.com/embed/05tykFfoP8o?rel=0\" frameborder=\"0\" allowfullscreen></iframe>"});_942.show();sp.global.analytics.trackEvent("Tutorial","help_clicked",_93f);}},tutButtons:[this._BTN("step_back",_941,"link"),this._BTN("step_forward",_940,"button"),this._BTN("dialog_close","abort","dialog-close button quiet")]};},_getConfigStepScribble:function(_943,_944,_945){return {tutStepId:_943,tutStepBgClass:"with-head-normal",tutTitle:I18N("step_scribble_title"),tutTip:{markup:I18N("step_scribble_tip"),bgClass:"next-to-head"},tutActionsNextStep:_944,tutActions:[{markup:I18N("step_scribble_task_go_review"),iconClass:"fonticon-discuss",getCheckerFunction:function(){var _946=false;dojo.subscribe("updates/cb/board/currentmode",this,function(mode){if(mode==="DISCUSS"){_946=true;}});return function(){return _946;};}},{markup:I18N("step_scribble_task_get_tool"),iconClass:"fonticon-scribble",getCheckerFunction:function(){var _947=false;dojo.subscribe("updates/cb/board/currenttool",this,function(tool){if(tool==="TOOL_SCRIBBLE"){_947=true;}});return function(){return _947;};}},{markup:I18N("step_scribble_task_draw_sth"),iconClass:"fonticon-freeLine",getCheckerFunction:function(){var _948=false;dojo.subscribe("/sp/items/newOrUpdatedVisibleItem",function(item){if(item.type==="freeLine"){_948=true;}});return function(){return _948;};}}],tutButtons:[this._BTN("step_back",_945,"link"),this._BTN("step_skip",_944,"link"),this._BTN("dialog_close","abort","dialog-close button quiet")]};},_getConfigStepScribbleSuccess:function(_949,_94a,_94b){var _94c="<img src=\"/_/images/tutorial_attr_ex_scribble.png\"/> <img src=\"/_/images/tutorial_attr_ex_stroke.png\"/> <img src=\"/_/images/tutorial_attr_ex_linestyle.png\"/>";return {tutStepId:_949,tutStepBgClass:"with-head-smile",tutTitle:I18N("step_scribblesuccess_title"),tutTip:{markup:_94c+"<br/><br/>"+I18N("step_scribblesuccess_tip")},tutButtons:[this._BTN("step_back",_94b,"link"),this._BTN("step_forward",_94a,"button"),this._BTN("dialog_close","abort","dialog-close button quiet")]};},_getConfigStepNavigate:function(_94d,_94e,_94f){return {tutStepId:_94d,tutStepBgClass:"with-head-eye",tutTitle:I18N("step_navigate_title"),tutTip:{markup:I18N("step_navigate_tip"),bgClass:"next-to-head"},tutActionsNextStep:_94e,tutActions:[{markup:I18N("step_navigate_task_pan"),iconClass:"fonticon-arrow-double",getCheckerFunction:function(){var _950=false;dojo.subscribe("updates/cb/board/currentscroll/viaspacepan",this,function(){_950=true;});return function(){return _950;};}},{markup:I18N("step_navigate_task_zoom"),iconClass:"fonticon-magnifier",getCheckerFunction:function(){var _951=false;dojo.subscribe("updates/cb/board/currentzoom/viamousewheel",this,function(){_951=true;});return function(){return _951;};}}],tutButtons:[this._BTN("step_back",_94f,"link"),this._BTN("step_skip",_94e,"link"),this._BTN("dialog_close","abort","dialog-close button quiet")]};},_getConfigStepNavigateSuccess:function(_952,_953,_954){return {tutStepId:_952,tutTitle:I18N("step_navigatesuccess_title"),tutStepBgClass:"with-head-smile",tutTip:{markup:I18N("step_navigatesuccess_tip"),onClickFunction:function(){var _955=new _92d({autofocus:false});_955.show();sp.global.analytics.trackEvent("Tutorial","help_clicked",_952);}},tutButtons:[this._BTN("step_back",_954,"link"),this._BTN("step_forward",_953,"button"),this._BTN("dialog_close","abort","dialog-close button quiet")]};},_getConfigStepComment:function(_956,_957,_958){return {tutStepId:_956,tutStepBgClass:"with-head-normal",tutTitle:I18N("step_comment_title"),tutTip:{markup:I18N("step_comment_tip"),bgClass:"next-to-head"},tutActionsNextStep:_957,tutActions:[{markup:I18N("step_comment_task_get_tool"),iconClass:"fonticon-comment",getCheckerFunction:function(){var _959=false;dojo.subscribe("updates/cb/board/currenttool",this,function(tool){if(tool==="TOOL_TEXT_COMMENT"){_959=true;}});return function(){return _959;};}},{markup:I18N("step_comment_task_click_drag"),iconClass:"fonticon-cross-drag",getCheckerFunction:function(){var _95a=false;dojo.subscribe("/sp/items/newOrUpdatedVisibleItem",function(item){if(item.type==="txtG"&&item.subtype==="comment"&&!item.del){_95a=true;}});return function(){return _95a;};}},{markup:I18N("step_comment_task_write"),iconClass:"fonticon-align-left",getCheckerFunction:function(){var _95b=false;dojo.subscribe("/sp/items/newOrUpdatedVisibleItem",function(item){if(item.type==="txtE"){_95b=true;}});return function(){return _95b;};}}],tutButtons:[this._BTN("step_back",_958,"link"),this._BTN("step_skip",_957,"link"),this._BTN("dialog_close","abort","dialog-close button quiet")]};},_getConfigStepCommentWait:function(_95c,_95d,_95e){return {tutStepId:_95c,tutStepBgClass:"with-head-normal",tutStepOnload:dojo.hitch(this,function(){return this._ANSWER(I18N("step_commentwait_answer"));}),tutTitle:I18N("step_commentwait_title"),tutTip:{markup:I18N("typing_tip"),bgClass:"next-to-head"},tutActionsNextStep:_95d,tutActions:[{getCheckerFunction:function(){var _95f=false;dojo.subscribe("/sp/items/newOrUpdatedVisibleItem",function(item){if(item.type==="txtE"){_95f=true;}});return function(){return _95f;};}}],tutButtons:[this._BTN("step_back",_95e,"link"),this._BTN("step_skip",_95d,"link"),this._BTN("dialog_close","abort","dialog-close button quiet")]};},_getConfigStepCommentSuccess:function(_960,_961,_962){return {tutStepId:_960,tutStepBgClass:"with-head-smile",tutTitle:I18N("step_commentsuccess_title"),tutTip:{markup:I18N("step_commentsuccess_tip")},tutButtons:[this._BTN("step_back",_962,"link"),this._BTN("step_forward",_961,"button"),this._BTN("dialog_close","abort","dialog-close button quiet")]};},_getConfigStepMentionWait:function(_963,_964,_965){return {tutStepId:_963,tutStepBgClass:"with-head-normal",tutStepOnload:dojo.hitch(this,function(){var _966="@["+sp.info.user.id+"]";var _967=I18N("step_mentionwait_answer",[_966]);return this._ANSWER(_967,true);}),tutTitle:I18N("step_mentionwait_title"),tutTip:{markup:I18N("typing_tip"),bgClass:"next-to-head"},tutActionsNextStep:_964,tutActions:[{getCheckerFunction:function(){var _968=false;dojo.subscribe("/sp/items/newOrUpdatedVisibleItem",function(item){if(item.type==="txtE"){_968=true;}});return function(){return _968;};}}],tutButtons:[this._BTN("step_back",_965,"link"),this._BTN("step_skip",_964,"link"),this._BTN("dialog_close","abort","dialog-close button quiet")]};},_getConfigStepMentionSuccess:function(_969,_96a,_96b){return {tutStepId:_969,tutStepBgClass:"with-head-smile",tutTitle:I18N("step_mentionsuccess_title"),tutTip:{markup:I18N("step_mentionsuccess_tip")},tutButtons:[this._BTN("step_back",_96b,"link"),this._BTN("step_mentionsuccess_last_step",_96a,"button"),this._BTN("dialog_close","abort","dialog-close button quiet")]};},_getConfigStepOpentask:function(_96c,_96d,_96e){return {tutStepId:_96c,tutStepBgClass:"with-head-eye",tutTitle:I18N("step_opentask_title"),tutTip:{markup:I18N("step_opentask_tip"),bgClass:"next-to-head"},tutActionsNextStep:_96d,tutActions:[{markup:I18N("step_opentask_task_reply"),iconClass:"fonticon-select",getCheckerFunction:function(){var _96f=false;dojo.subscribe("/sp/items/newOrUpdatedVisibleItem",function(item){if(item.type==="txtE"){_96f=true;}});return function(){return _96f;};}},{markup:I18N("step_opentask_task_close"),iconClass:"fonticon-task-round-done",getCheckerFunction:function(){var _970=false;dojo.subscribe("/sp/items/newOrUpdatedVisibleItem",function(item){if(item.type==="txtG"&&item.subtype==="comment"&&!item.del&&item.taskStatus==="closed"){_970=true;}});return function(){return _970;};}}],tutButtons:[this._BTN("step_back",_96e,"link"),this._BTN("step_skip",_96d,"link"),this._BTN("dialog_close","abort","dialog-close button quiet")]};},_getConfigStepEnd:function(_971,_972,_973){var _974="<div class=\"start-special\"><h1>"+I18N("step_end_title")+"</h1>"+I18N("step_end_intro")+"<div class=\"screenshot\"><div class=\"pointer close-board\"><div class=\"tooltip\"><p>"+I18N("step_end_tt1")+"</p></div></div><div class=\"pointer share-button\"><div class=\"tooltip\"><p>"+I18N("step_end_tt2")+"</p></div></div></div></div>";return {tutStepId:_971,tutSpecial:{markup:_974,bgClass:"with-special-end"},tutButtons:[this._BTN("step_end_exit",_972,"button"),this._BTN("step_back",_973,"link"),this._BTN("dialog_close",_972,"dialog-close button quiet")]};},_getConfigStepAbort:function(_975,_976,_977){var _978="<div class=\"start-special\"><h1>"+I18N("step_abort_title")+"</h1>"+I18N("step_abort_intro")+"<div class=\"screenshot\"><div class=\"pointer close-board\"><div class=\"tooltip\"><p>"+I18N("step_end_tt1")+"</p></div></div><div class=\"pointer help-menu\"><div class=\"tooltip\"><p>"+I18N("step_abort_tt2")+"</p></div></div></div></div>";return {tutStepId:_975,tutSpecial:{markup:_978,bgClass:"with-special-end abort"},tutButtons:[this._BTN("step_end_exit",_976,"button"),this._BTN("step_back",_977,"link"),this._BTN("dialog_close",_976,"dialog-close button quiet")]};},_BTN:function(_979,step,_97a){return {label:I18N(_979),cssClass:_97a,onClickFunction:function(){dojo.hash("#tutorial="+step);}};},_ANSWER:function(_97b,_97c){var _97d=this.latestCommentIdSeen;if(!_97d||!sp.global.pad.container.containsItem(_97d)){console.warn("There's no comment to respond... Someone must have deleted it.. ??");return false;}var _97e=[];var item=sp.global.pad.factory.getNewItem("txtE",{});item.id=sp.global.pad.generateItemId();item.subtype="comment";item.txtGId=_97d;item.text=_97b;item.authorid=this.tutorialGuyUserId;_97e.push(item);if(_97c){var _97f=sp.global.pad.container.getItemCopy(_97d);_97f.taskStatus="open";_97e.push(_97f);}setTimeout(function(){sp.global.pad.container.addOrUpdateItems(_97e);},2000);return true;}});});},"wp/ConnectivityDialogManager":function(){define("wp/ConnectivityDialogManager",["dijit","dojo","dojox","dojo/i18n!sp/dialog/nls/ConnectivityDialog","dojo/require!sp/dialog/ConnectivityDialog,dojo/aspect"],function(_980,dojo,_981){dojo.provide("wp.ConnectivityDialogManager");dojo.require("sp.dialog.ConnectivityDialog");dojo.require("dojo.aspect");dojo.requireLocalization("sp.dialog","ConnectivityDialog");(function(){var _982,_983,_984,_985,_986,_987;var _988=5;var _989=dojo.declare("State",null,{constructor:function(args){dojo.mixin(this,args);},handleMessage:function(_98a){return null;},deactivate:function(_98b){},activate:function(_98c){},permanent:false,success:false});_982=new _989({handleMessage:function(_98d,_98e){switch(_98d){case "DISCONNECTED":return _983;case "SUBSCRIPTION_ERROR":return _984;case "FULLY-INITIATED":return _985;case "RECONNECTED":return null;default:_98e.addMessage(_98d);}},activate:function(_98f){_98f.show();},deactivate:function(){}});_983=new _989({consecutiveDisconnectsCount:1,handleMessage:function(_990,_991){switch(_990){case "SUBSCRIPTION_ERROR":return _987;case "FULLY-INITIATED":return _985;case "RECONNECTED":return _985;case "DISCONNECTED":this.consecutiveDisconnectsCount++;if(this.consecutiveDisconnectsCount>=_988){return _984;}default:return null;}},activate:function(_992){_992.removeMessages();_992.addMessage(sp.I18n.get("sp.dialog","ConnectivityDialog")("disconnected_message"));_992.enableSpinner();_992.show();},deactivate:function(_993){_993.removeMessages();this.consecutiveDisconnectsCount=1;}});_984=new _989({permanent:true,handleMessage:function(_994,_995){switch(_994){case "FULLY-INITIATED":return _987;case "DISCONNECTED":case "SUBSCRIPTION_ERROR":case "RECONNECTED":default:return null;}},activate:function(_996){_996.removeMessages();_996.addMessage(sp.I18n.get("sp.dialog","ConnectivityDialog")("permanent_error_message"));_996.disableSpinner();_996.enableReloadLink();_996.show();}});_985=new _989({success:true,handleMessage:function(_997,_998){switch(_997){case "DISCONNECTED":return _986;case "SUBSCRIPTION_ERROR":return _987;case "FULLY-INITIATED":case "RECONNECTED":default:return null;}},activate:function(_999){_999.removeMessages();_999.hide();}});_986=new _989({consecutiveDisconnectsCount:1,handleMessage:function(_99a,_99b){switch(_99a){case "SUBSCRIPTION_ERROR":return _987;case "RECONNECTED":return _985;case "DISCONNECTED":this.consecutiveDisconnectsCount++;if(this.consecutiveDisconnectsCount>_988){return _987;}case "FULLY-INITIATED":default:return null;}},activate:function(_99c){_99c.removeMessages();_99c.addMessage(sp.I18n.get("sp.dialog","ConnectivityDialog")("disconnected_message"));_99c.enableSpinner();_99c.show();},deactivate:function(_99d){_99d.removeMessages();this.consecutiveDisconnectsCount=1;}});_987=new _989({permanent:true,handleMessage:function(_99e,_99f){switch(_99e){case "FULLY-INITIATED":case "DISCONNECTED":case "SUBSCRIPTION_ERROR":case "RECONNECTED":default:return null;}},activate:function(_9a0){_9a0.removeMessages();_9a0.addMessage(sp.I18n.get("sp.dialog","ConnectivityDialog")("permanent_error_message"));_9a0.disableSpinner();_9a0.enableReloadLink();_9a0.show();},deactivate:function(_9a1){_9a1.disableReloadLink();}});var _9a2=dojo.declare("StateMachine",null,{constructor:function(_9a3,_9a4){this.dialog=_9a4;this.transitionState(_9a3);},handleMessage:function(_9a5){var _9a6=this.state.handleMessage(_9a5,this.dialog);if(_9a6&&_9a6!==this.state){var _9a7=this.state;this.state.deactivate(this.dialog);this.transitionState(_9a6);this.onStateChange(_9a7,this.state);}},transitionState:function(_9a8){this.state=_9a8;this.state.activate(this.dialog);},onStateChange:function(_9a9,_9aa){}});dojo.declare("wp.ConnectivityDialogManager",null,{connectivityDialog:null,lastStatus:null,hasBeenFullyInitiated:false,constructor:function(){var _9ab={hide:dojo.hitch(this,function(){this.destroyConnectivityDialog();})};dojo.forEach(["show","addMessage","removeMessages","enableReloadLink","disableReloadLink","enableSpinner","disableSpinner"],function(_9ac){_9ab[_9ac]=dojo.hitch(this,function(){var d=this.getConnectivityDialog();d[_9ac].apply(d,arguments);});},this);this.stateMachine=new _9a2(_982,_9ab);dojo.aspect.after(this.stateMachine,"onStateChange",function(_9ad,_9ae){dojo.publish("/sp/ajax/connectivity",_9ae);},true);dojo.subscribe("/sp/ajax/connectivityStatus",this,"_changeStatus");},_changeStatus:function(_9af){var _9b0=this.stateMachine;window.setTimeout(function(){_9b0.handleMessage(_9af);},1);},onStatusChange:function(_9b1){},getConnectivityDialog:function(){if(!this.connectivityDialog){this.connectivityDialog=new sp.dialog.ConnectivityDialog({});}return this.connectivityDialog;},destroyConnectivityDialog:function(){if(this.connectivityDialog){this.getConnectivityDialog().hide();this.connectivityDialog=null;}}});})();});},"wp/widget/SidebarList":function(){define("wp/widget/SidebarList",["dijit","dojo","dojox","dojo/i18n!wp/widget/nls/SidebarList","dojo/require!dijit/_Widget,cb/widget/_Templated,dijit/_Container,wp/widget/SidebarEditBox,wp/common/TextHelper,cb/Capabilities,sp/I18n,sp/I18nWidget"],function(_9b2,dojo,_9b3){dojo.provide("wp.widget.SidebarList");dojo.require("dijit._Widget");dojo.require("cb.widget._Templated");dojo.require("dijit._Container");dojo.require("wp.widget.SidebarEditBox");dojo.require("wp.common.TextHelper");dojo.require("cb.Capabilities");dojo.require("sp.I18n");dojo.require("sp.I18nWidget");dojo.requireLocalization("wp.widget","SidebarList");dojo.declare("wp.widget.SidebarList",[_9b2._Widget,cb.widget._Templated,sp.I18nWidget,_9b2._Container],{templateString:"",templateString:"<div class=\"hideBlock sidebar-list ${ulClass}\" data-dojo-attach-point=\"_scrollWrapper\">\r\n\t<div class=\"index-list-menu\">\r\n\t\t<span class=\"prev link\" dojoAttachEvent=\"onclick: _onListMenuPrevClick\" title=\"${!i18n.prev_title}\"><i class=\"fonticon-skip-left\"></i> ${!i18n.prev}</span>\r\n\t\t<span class=\"next link\" dojoAttachEvent=\"onclick: _onListMenuNextClick\" title=\"${!i18n.next_title}\">${!i18n.next} <i class=\"fonticon-skip-right\"></i></span>\r\n\r\n\t\t<span class=\"close-link\" onclick='dijit.byId(\"outline-container\").toggle();' title=\"${!i18n.close}\"><i class=\"fonticon-cross\"></i></span>\r\n\t\t<span class=\"edit-link\" dojoAttachEvent=\"onclick: toggleEdit\" title=\"${!i18n.edit}\" dojoAttachPoint=\"_editNode\"><i class=\"fonticon-pencil\"></i></span>\r\n\t</div>\r\n\t<ul class=\"index-list pretty-scrollbars\" dojoAttachPoint=\"_listNode, containerNode\"></ul>\r\n</div>\r\n\r\n",_sidebarElements:null,sidebar:null,useTheLastEntry:false,undoneTaskBubble:null,scrollableContainerMixinCreateNodes:false,widgetsInTemplate:true,_isOpen:false,vertical:true,constructor:function(){this._sidebarElements={};this._highestOrderingKey=wp.widget.Sidebar.ORDERING_MIDDLE;this._lowestOrderingKey=this._highestOrderingKey;dojo.subscribe("/sp/items/newOrUpdatedTxtOrImageItemId",this,function(_9b4){setTimeout(dojo.hitch(this,"_newItem",_9b4),10);});},postCreate:function(){this.inherited(arguments);this.connect(this._listNode,"onclick",this._onListClick);this.connect(this._listNode,"ontouchstart",this._onListClick);this._changeAccessControlState();},_changeAccessControlState:function(){this.sidebar.pad.controller.status.getAndWatch("editing",dojo.hitch(this,function(attr,old,_9b5){dojo.toggleClass(this._editNode,"hideBlock",_9b5.readonly);if(_9b5.readonly){this.endEdit();}}));},isOpen:function(){return this._isOpen;},show:function(){dojo.removeClass(this.domNode,"hideBlock");this._isOpen=true;this.onShow();},onShow:function(){},hide:function(){this.endEdit();dojo.addClass(this.domNode,"hideBlock");this._isOpen=false;this.onHide();},onHide:function(){},endEdit:function(){dojo.removeClass(this._listNode,"edit-enabled");},toggleEdit:function(){dojo.toggleClass(this._listNode,"edit-enabled");},isRelevantItem:function(item,_9b6){return true;},itemComparator:function(a,b){return sp.global.simpleComparator(a.y,b.y);},onSidebarElementRemoved:function(_9b7,_9b8){},onSidebarElementAdded:function(_9b9,_9ba){},_newItem:function(_9bb){var _9bc=this.pad.container.getItem(_9bb);var item=this._getCorrectItem(_9bc);if(!item||!item.authorid||!_9bc.authorid){return;}if(item.del||!this.isRelevantItem(item,_9bc)){this._removeSidebarElement(item.id);}else{if(this.isRelevantItem(item,_9bc)){switch(item.type){case "txtG":this._processForTxtGroups(item,_9bc);break;case "image":this._processForImage(item,_9bc);break;default:return;}this._processForLastSeen(item,_9bc);}}if(this._itemProcessingHandle){window.clearTimeout(this._itemProcessingHandle);}var that=this;this._itemProcessingHandle=window.setTimeout(function(){that._sort();that._processLastSeen();that.checkEmptiness();that._itemProcessingHandle=null;},10);},_getCorrectItem:function(item){if(item&&item.type==="txtE"){if(this.pad.container.containsItem(item.txtGId)){return this.pad.container.getItem(item.txtGId);}else{return null;}}return item;},_processForImage:function(item,_9bd){if(item.type!=="image"){return;}var _9be=this._getOrCreateSidebarElement(item);if(item.title){_9be.title=item.title;}this._updateEditable(_9be,item);this._updatePosition(_9be,item);this._updateAuthor(_9be,item,_9bd);this._updateOrdering(_9be,item,_9bd);this._updateContentForAllImages();},_processForTxtGroups:function(item,_9bf){if(item.type!=="txtG"){return;}var _9c0=this.pad.container.getTextEntryItems(item.id);var _9c1=this._getContentFromEntryItems(item,_9c0,this.useTheLastEntry);if(!_9c1){this.removeTxtGroup(item.id);return;}var _9c2=this._getOrCreateSidebarElement(item);this._updateTaskStatus(_9c2,item);this._updatePosition(_9c2,item);this._updateContentForTxtGroup(_9c2,item,_9c1);this._updateAuthor(_9c2,item,_9bf);this._updateOrdering(_9c2,item,_9bf);},_processForLastSeen:function(item,_9c3){var id=item.id;var _9c4=this._sidebarElements[id];if(!_9c4){return;}var _9c5=_9c3.dte?dojo.date.stamp.fromISOString(_9c3.dte):new Date();if(!_9c4.lastModifiedAt||_9c5>_9c4.lastModifiedAt){_9c4.lastModifiedAt=_9c5;}},removeTxtGroup:function(id){this._removeSidebarElement(id);},_updateAuthor:function(_9c6,item,_9c7){if(!_9c6.authorId){_9c6.authorId=_9c7.authorid;}_9c6.lastAuthorId=_9c7.authorid;},_updatePosition:function(_9c8,item){if(!item.a){return;}_9c8.x=item.a.x;_9c8.y=item.a.y;},_updateContentForTxtGroup:function(_9c9,_9ca,_9cb){var _9cc=_9c9.liNode;if(!_9cb){return;}var _9cd=_9cb.authorId;var date=_9cb.date;var text=_9cb.text;var _9ce=_9cb.authorIds.length-1;var _9cf=[];_9cf.push(sp.infos.getInstance().getById({type:"user",id:_9cb.authorIds[0]}));if(_9ce>0){if(_9ce===1){_9cf.push(sp.infos.getInstance().getById({type:"user",id:_9cb.authorIds[1]}));}else{var _9d0=new dojo.Deferred();_9d0.callback({furtherAuthorCounter:_9ce});_9cf.push(_9d0);}}dojo.DeferredList.gatherResults(_9cf).then(function(_9d1){var _9d2=sp.I18n.get("wp.widget","Sidebar")("meta_author_joiner");var _9d3=[_9d2];_9d3.push(_9d1[0].user.displayname);if(_9d1[1]){if(_9d1[1].user){_9d3.push(_9d1[1].user.displayname);}else{if(_9d1[1].hasOwnProperty("furtherAuthorCounter")){_9d3.push(sp.I18n.get("wp.widget","Sidebar")("meta_author_multiple",[_9d1[1].furtherAuthorCounter]));}}}var _9d4=dojo.query("img",_9c9.contentContainer)[0];if(!_9d4){_9d4=dojo.create("img",null,_9c9.contentContainer);}dojo.attr(_9d4,{"src":"/__/photo/"+_9cd+".small.png"});var _9d5=dojo.query("span.meta",_9c9.contentContainer)[0];var _9d6=sp.I18n.get("wp.widget","Sidebar")("meta_author",[_9d3]);if(!_9d5){_9d5=dojo.create("span",null,_9c9.contentContainer);}dojo.attr(_9d5,{"innerHTML":_9d6,"class":"meta"});var _9d7=dojo.query("p",_9c9.contentContainer)[0];if(!_9d7){_9d7=dojo.create("p",null,_9c9.contentContainer);}dojo.attr(_9d7,{"innerHTML":sp.I18n.esc(text)});var _9d8=dojo.query(".created-at",_9c9.contentContainer)[0];if(!_9d8){_9d8=dojo.create("span",null,_9c9.contentContainer);}var _9d9;if(dojo.date.compare(date,null,"date")===0){_9d9=sp.I18n.get("wp.widget","Sidebar")("sidebar_created_at_today",[date]);}else{_9d9=sp.I18n.get("wp.widget","Sidebar")("sidebar_created_at",[date]);}dojo.attr(_9d8,{"innerHTML":_9d9,"class":"created-at"});var _9da;if(_9ca.subtype==="comment"){_9da=_9d6;}else{_9da=text;}dojo.attr(_9c9.contentContainer,{"title":_9da});});},_updateContentForAllImages:function(){var _9db=this._getSortedSidebarElements();var _9dc=dojo.filter(_9db,function(_9dd){return _9dd.type==="image";});dojo.forEach(_9dc,function(_9de,_9df){var _9e0=_9b2.byNode(dojo.query(".sidebar-editbox",_9de.contentContainer)[0]);if(!_9e0){console.warn("editor missing for image");return;}if(_9e0.editing){return;}var text=(_9df+1)+". Element";if(_9de.title){text=_9de.title;}_9e0._setValueAttr(wp.common.TextHelper.unescape(text),true);dojo.attr(_9de.liNode,"title",wp.common.TextHelper.unescape(text));});},_updateEditable:function(_9e1,item){if(dojo.hasClass(_9e1.liNode,"editable")){return;}var _9e2=new wp.widget.SidebarEditBox({},dojo.create("span",{"innerHTML":""},_9e1.contentContainer));this.connect(_9e2,"_onClick",function(e){this._onListClick(e);});this.connect(_9e2,"onChange",function(_9e3){var _9e4=this.pad.container.getItemCopy(item.id);_9e4.title=_9e3;this.pad.container.addOrUpdateItems([_9e4]);if(dojo.doc.activeElement&&dojo.doc.activeElement.blur){dojo.doc.activeElement.blur();}});_9e2.startup();var _9e5=dojo.create("span",{"innerHTML":"<i class=\"fonticon-pencil\"></i>","title":sp.I18n.get("wp.widget","Sidebar")("sidebar_outline_edittitle")},_9e1.controlsNode,"first");dojo.connect(_9e5,"onclick",_9e2,"edit");dojo.addClass(_9e1.liNode,"editable");},_updateOrdering:function(_9e6,item,_9e7){_9e6.outline=item.outline;if(item.orderingKey){_9e6.orderingKey=item.orderingKey;}else{_9e6.orderingKey=this.newOrderingKeyAtEnd();}if(_9e6.orderingKey){if(_9e6.orderingKey>this._highestOrderingKey){this._highestOrderingKey=_9e6.orderingKey;}if(_9e6.orderingKey<this._lowestOrderingKey){this._lowestOrderingKey=_9e6.orderingKey;}}},_getHighestOrderingKey:function(){return this._highestOrderingKey;},_getLowestOrderingKey:function(){return this._lowestOrderingKey;},newOrderingKeyAtStart:function(){return this._getLowestOrderingKey()-wp.widget.Sidebar.ORDERING_KEY_INCREMENT;},newOrderingKeyAtEnd:function(){return this._getHighestOrderingKey()+wp.widget.Sidebar.ORDERING_KEY_INCREMENT;},_getSortedSidebarElements:function(){var _9e8=_9b3.lang.functional.values(this._sidebarElements);var _9e9=_9e8.sort(this.itemComparator);return _9e9;},_sort:function(){this.correctOrder=this._getSortedSidebarElements();dojo.forEach(this.correctOrder,function(txtG,_9ea){dojo.place(txtG.liNode,this._listNode,_9ea);},this);},_removeSidebarElement:function(id){var _9eb=this._sidebarElements[id];if(_9eb){dojo.forEach(_9b2.findWidgets(_9eb.liNode),function(w){w.destroyRecursive();});dojo.destroy(_9eb.liNode);delete this._sidebarElements[id];this.onSidebarElementRemoved(_9eb,this.getLength());}},_onListClick:function(_9ec){console.warn("LIST CLICK",_9ec);if(dojo.hasClass(this._listNode,"edit-enabled")){return;}var _9ed=this._getCorrectSidebarElementNode(_9ec.target);if(!_9ed){return;}return this._visitListNode(_9ed);},_onListMenuNextClick:function(_9ee){this.visitNextListNode();},_onListMenuPrevClick:function(_9ef){this.visitPreviousListNode();},visitNextListNode:function(_9f0){this.endEdit();var _9f1=null;if(!this.isEmpty()){var _9f2=dojo.query("li.current-nav",this._listNode).next();if(_9f2&&_9f2.length>0){_9f1=_9f2[0];}if(!_9f1){_9f1=dojo.query("li",this._listNode)[0];}return this._visitListNode(_9f1,_9f0);}},visitPreviousListNode:function(_9f3){this.endEdit();var _9f4=null;if(!this.isEmpty()){var _9f5=dojo.query("li.current-nav",this._listNode).prev();if(_9f5&&_9f5.length>0){_9f4=_9f5[0];}if(!_9f4){_9f4=dojo.query("li",this._listNode)[0];}return this._visitListNode(_9f4,_9f3);}},_visitListNode:function(_9f6,_9f7){dojo.removeClass(_9f6,"unread");this._removeAllNavs();dojo.addClass(_9f6,"current-nav");var _9f8=dojo.attr(_9f6,"spItemId");if(this._sidebarElements[_9f8]){this._sidebarElements[_9f8].lastReadAt=new Date();}if(!_9f7){dojo.hash("#item="+_9f8,true);}else{this.pad.surface.smoothScrollToItemId(_9f8);}return _9f8;},_removeAllNavs:function(){dojo.query("li",this._onListNode).removeClass("current-nav");},_getCorrectSidebarElementNode:function(_9f9){if(!_9f9){return null;}if(_9f9===this._listNode){return null;}if(dojo.hasClass(_9f9,"sidebar-element")){return _9f9;}return this._getCorrectSidebarElementNode(_9f9.parentNode);},_getContentFromEntryItems:function(item,_9fa,_9fb){var _9fc=null;var _9fd=null;var _9fe=new wp.UniqueArray();if(_9fa&&_9fa.length){for(var i=0;i<_9fa.length;i++){var _9ff=_9fa[i];if(_9ff.del||!_9ff.authorid||!_9ff.dte){continue;}_9fe.push(_9ff.authorid);if(_9fc&&!_9fb){continue;}_9fc={authorId:_9ff.authorid,date:dojo.date.stamp.fromISOString(_9ff.dte),text:_9ff.text,authorIds:null};}}if(_9fc){_9fc.authorIds=_9fe.toArray();}return _9fc;},_processLastSeen:function(){var _a00=dojo.filter(_9b3.lang.functional.values(this._sidebarElements),function(_a01){if(_a01.lastAuthorId===sp.info.user.id){return false;}if(!_a01.lastModifiedAt){return false;}if(_a01.lastModifiedAt&&_a01.lastReadAt){if(_a01.lastModifiedAt<_a01.lastReadAt){return false;}}return true;});dojo.forEach(_a00,function(_a02){dojo.addClass(_a02.liNode,"unread");});},_getOrCreateSidebarElement:function(item){var _a03=this._sidebarElements[item.id];if(!_a03){_a03=this._sidebarElements[item.id]={lastReadAt:sp.info.padConfig.lastVisited,lastModifiedAt:null,liNode:null,id:item.id,type:item.type,subtype:item.subtype,authorId:item.authorid,orderingKey:item.orderingKey};_a03.liNode=dojo.create("li",{"class":"sidebar-element "+item.type+(item.subtype?" sidebar-element-sub-"+item.subtype:""),"spItemId":item.id},this._listNode);_a03.contentContainer=dojo.create("div",{"class":"sidebar-element-content"},_a03.liNode);_a03.controlsNode=dojo.create("div",{"class":"sidebar-element-controls"},_a03.contentContainer);this.onSidebarElementAdded(_a03,this.getLength());}return _a03;},_updateTaskStatus:function(_a04,_a05){dojo.removeClass(_a04.liNode,"taskstatus-open taskstatus-onhold taskstatus-closed taskstatus-none");dojo.destroy(dojo.query(".task-badge",_a04.contentContainer)[0]);if(_a05.taskStatus){dojo.addClass(_a04.liNode,"taskstatus-"+_a05.taskStatus);dojo.create("span",{"class":"task-badge",innerHTML:"<i class=\"fonticon-task-"+sp.I18n.escAttr(_a05.taskStatus)+"\"></i>"},_a04.contentContainer);}else{dojo.addClass(_a04.liNode,"taskstatus-none");}},getLength:function(){return _9b3.lang.functional.values(this._sidebarElements).length;},isEmpty:function(){return this.getLength()===0;},getFirstScrollableNode:function(){return this.correctOrder[0].liNode;},hasScrollableNodes:function(){return !this.isEmpty();},checkEmptiness:function(){if(this._emptyMessageNode){dojo.toggleClass(this._emptyMessageNode,"hideBlock",!this.isEmpty());}}});});},"wp/handler/ControllerWorkflowAddOn":function(){define("wp/handler/ControllerWorkflowAddOn",["dojo"],function(dojo){return dojo.declare("wp.handler.ControllerWorkflowAddOn",null,{constructor:function(){this.inputControlState={};this.inputControlStateOnMove={};this.onTDownEdgeWeightPoint=null;this.onTDownEdgeWeightPointOnPad=null;this.onTDownTouchDistance=null;this.onTDownScrollOffset=null;this.onTDownZoomFactor=null;this.lastOnTMoveEdgeWeightPoint=null;this.lastOnTMoveTouchDistance=null;this._touchTreshold=10;this._scrollStraightXDefaultOnThisDevice=sp.isTouchOnly;this._scrollStraightXOn=this._scrollStraightXDefaultOnThisDevice;this._scrollStraightXCounter=0;this._scrollStraightXTreshold=75;this._pinchRetardDefaultOnThisDevice=sp.isTouchOnly;this._pinchRetardOn=this._pinchRetardDefaultOnThisDevice;this._pinchRetardTreshold=75;},handleMouseDown:function(_a06,_a07,_a08,_a09,keys){this._scrollStraightXOn=this._scrollStraightXDefaultOnThisDevice;this._scrollStraightXCounter=0;var _a0a=this._pad.getPositionXY(_a06,_a07);var iCS=this.inputControlState={"currentTool":this.currentTool,"currentToolConfig":this.toolConfigBuffer[this.currentTool],"buttonType":_a08,"copyKey":keys.copyKey,"spaceKey":keys.spaceKey,"shiftKey":keys.shiftKey,"screenPositionX":_a06,"screenPositionY":_a07,"positionX":_a0a.x,"positionY":_a0a.y,"eventSID":_a09,"isSIDSelectionUI":this._isSIDSelectionUI(_a09)};var _a0b=this.inputControlStateOnMove={"shiftKey":keys.shiftKey,"screenPositionX":_a06,"screenPositionY":_a07,"positionX":_a0a.x,"positionY":_a0a.y,"lastScreenPositionX":_a06,"lastScreenPositionY":_a07,"lastPositionX":_a0a.x,"lastPositionY":_a0a.y,"eventSID":_a09,"isSIDSelectionUI":this._isSIDSelectionUI(_a09)};if(this._hideFromAllWorkflows(iCS)){this.setCurrentWorkflow(null);return false;}this.setCurrentWorkflow(this._findNewWorkflowOnMouseDown(iCS));if(this.currentWorkflow){this.currentWorkflow.startWorkflow(iCS);}},handle2FingerTouchDown:function(_a0c,_a0d,_a0e){this.onTDownEdgeWeightPoint={x:_a0c,y:_a0d};this.onTDownEdgeWeightPointOnPad=this._pad.getPositionXY(_a0c,_a0d);this.onTDownTouchDistance=_a0e;this.onTDownZoomFactor=this._pad.surface.getZoomFactor(true);this.lastOnTMoveEdgeWeightPoint=this.onTDownEdgeWeightPoint;this.lastOnTMoveTouchDistance=this.onTDownTouchDistance;this._scrollStraightXOn=this._scrollStraightXDefaultOnThisDevice;this._scrollStraightXCounter=0;this._pinchRetardOn=this._pinchRetardDefaultOnThisDevice;},handleMouseMoveDrag:function(_a0f,_a10,keys,_a11){var _a12=this._pad.getPositionXY(_a0f,_a10);var _a13=_a11?_a11:this.inputControlStateOnMove.eventSID;var iCS=this.inputControlState;var _a14=this.inputControlStateOnMove={"shiftKey":keys.shiftKey,"screenPositionX":_a0f,"screenPositionY":_a10,"positionX":_a12.x,"positionY":_a12.y,"lastScreenPositionX":this.inputControlStateOnMove.screenPositionX,"lastScreenPositionY":this.inputControlStateOnMove.screenPositionY,"lastPositionX":this.inputControlStateOnMove.positionX,"lastPositionY":this.inputControlStateOnMove.positionY,"eventSID":_a13,"isSIDSelectionUI":this._isSIDSelectionUI(_a13)};if(this.currentWorkflow){this.currentWorkflow.processWorkflow(iCS,_a14);}},handle2FingerTouchMove:function(_a15,_a16,_a17){var _a18={x:_a15,y:_a16};var _a19=_a17;if(this.lastOnTMoveTouchDistance!=null&&this.lastOnTMoveEdgeWeightPoint!=null&&Math.abs(_a19-this.lastOnTMoveTouchDistance)<this._touchTreshold&&Math.abs(_a18.x-this.lastOnTMoveEdgeWeightPoint.x)<this._touchTreshold&&Math.abs(_a18.y-this.lastOnTMoveEdgeWeightPoint.y)<this._touchTreshold){return;}if(!this._pinchRetardOn||Math.abs(_a19-this.onTDownTouchDistance)>this._pinchRetardTreshold){var _a1a=this.onTDownTouchDistance!==0?_a19/this.onTDownTouchDistance:1;var _a1b=this.onTDownZoomFactor*_a1a;this._pad.surface.scaleAt(this.onTDownEdgeWeightPointOnPad.x,this.onTDownEdgeWeightPointOnPad.y,_a1b);this._pinchRetardOn=false;this._scrollStraightXOn=false;}this.scrollStraightBy(_a18.x-this.lastOnTMoveEdgeWeightPoint.x,_a18.y-this.lastOnTMoveEdgeWeightPoint.y);this.lastOnTMoveEdgeWeightPoint=_a18;this.lastOnTMoveTouchDistance=_a19;},handleMouseUp:function(_a1c,_a1d,keys,_a1e){var _a1f=this._pad.getPositionXY(_a1c,_a1d);var iCS=this.inputControlState;var _a20=this.inputControlStateOnMove={"shiftKey":keys.shiftKey,"screenPositionX":_a1c,"screenPositionY":_a1d,"positionX":_a1f.x,"positionY":_a1f.y,"lastScreenPositionX":this.inputControlStateOnMove.screenPositionX,"lastScreenPositionY":this.inputControlStateOnMove.screenPositionY,"lastPositionX":this.inputControlStateOnMove.positionX,"lastPositionY":this.inputControlStateOnMove.positionY,"eventSID":this.inputControlStateOnMove.eventSID};if(this.currentWorkflow){this.currentWorkflow.endWorkflow(iCS,_a20);}},handle2FingerTouchUp:function(){},handleKeyDown:function(_a21,keys){},handleKeyUp:function(_a22,keys){},handleShortcut:function(_a23,_a24){switch(_a24){case "m":dojo.publish("requests/cb/board/currenttoolchange","TOOL_HAND");this.showToolChangedFlashMessage("hand");return true;case "s":dojo.publish("requests/cb/board/currenttoolchange","TOOL_SELECT");this.showToolChangedFlashMessage("select");return true;case "q":dijit.byId("screenshotButton").showDialogAndStartApplet();this.showToolChangedFlashMessage("camera");return true;case "p":dojo.publish("requests/cb/board/currenttoolchange","TOOL_SCRIBBLE");this.showToolChangedFlashMessage("freeLine");return true;case "x":dojo.publish("requests/cb/board/currenttoolchange","TOOL_HIGHLIGHT");this.showToolChangedFlashMessage("highlight");return true;case "u":dojo.publish("requests/cb/board/currenttoolchange","TOOL_SHAPE_RECTANGLE");this.showToolChangedFlashMessage("rectangle");return true;case "o":dojo.publish("requests/cb/board/currenttoolchange","TOOL_SHAPE_ELLIPSE");this.showToolChangedFlashMessage("ellipse");return true;case "a":dojo.publish("requests/cb/board/currenttoolchange","TOOL_SHAPE_ARROW");this.showToolChangedFlashMessage("arrow");return true;case "l":dojo.publish("requests/cb/board/currenttoolchange","TOOL_SHAPE_LINE");this.showToolChangedFlashMessage("line");return true;case "c":dojo.publish("requests/cb/board/currenttoolchange","TOOL_TEXT_COMMENT");this.showToolChangedFlashMessage("commentText");return true;case "t":dojo.publish("requests/cb/board/currenttoolchange","TOOL_TEXT_BLOCK");this.showToolChangedFlashMessage("blockText");return true;case "n":dojo.publish("requests/cb/board/currenttoolchange","TOOL_TEXT_NOTE");this.showToolChangedFlashMessage("noteText");return true;case "h":dojo.publish("requests/cb/board/currenttoolchange","TOOL_TEXT_HEADLINE");this.showToolChangedFlashMessage("headlineText");return true;case "e":dojo.publish("requests/cb/board/currenttoolchange","TOOL_ERASER");this.showToolChangedFlashMessage("eraser");return true;case "z":dojo.publish("requests/cb/board/currenttoolchange","TOOL_ZOOM");this.showToolChangedFlashMessage("zoom");return true;case "+":this.zoomIn();return true;case "-":this.zoomOut();return true;case "0":this.zoomSmoothlyToFit();return true;case "1":this.zoomSmoothly(1);return true;case "k":this._pad.sidebar.visitPreviousListNode();return true;case "j":this._pad.sidebar.visitNextListNode();return true;case "up":if(!this.moveItemAround("up",2)){this._pad.sidebar.visitPreviousListNode();}return true;case "left":if(!this.moveItemAround("left",2)){this._pad.sidebar.visitPreviousListNode();}break;case "down":if(!this.moveItemAround("down",2)){this._pad.sidebar.visitNextListNode();}return true;case "right":if(!this.moveItemAround("right",2)){this._pad.sidebar.visitNextListNode();}return true;case "shift+up":this.moveItemAround("up",20);return true;case "shift+left":this.moveItemAround("left",20);return true;case "shift+down":this.moveItemAround("down",20);return true;case "shift+right":this.moveItemAround("right",20);return true;case "del":this._pad.controller.deleteItem();return true;case "backspace":this._pad.controller.deleteItem();return true;case "esc":this.cancelCurrentWorkflowProcessing();return true;case "space":if(_a23.type==="keydown"){if(!this.isSpacePressed){this.isSpacePressed=true;this._pad.drawer.overwriteCursorMode("cur_hand");}}else{if(_a23.type==="keyup"){if(this.isSpacePressed){this.isSpacePressed=false;this._pad.drawer.resetCursorMode();}}}return true;case "shift":if(this.currentTool==="TOOL_ZOOM"){if(_a23.type==="keydown"){this._pad.drawer.overwriteCursorMode("cur_zoom_out");}else{if(_a23.type==="keyup"){this._pad.drawer.overwriteCursorMode("cur_zoom_in");}}}return false;case "mod+g":this.group();return true;case "mod+shift+g":this.ungroup();return true;case "mod+z":this.undo();return true;case "mod+y":this.redo();return true;case "mod+c":return this.copy()&&!this.isTextSelected();case "mod+v":return this.paste();case "mod+x":this.cut();return true;case "?":this._pad.propbarWidget.openHelpDialog();return true;case "mod+s":return true;case "mod+p":return true;case "tab":dijit.byId("outline-container").toggle();return true;case "mod+o":dijit.byId("outline-container").toggle();return true;case "mod+shift+o":dijit.byId("outline-container").toggle();return true;default:}return false;},isTextSelected:function(){var _a25="";if(window.getSelection){_a25=window.getSelection();}else{if(document.selection){_a25=document.selection.createRange().text;}}if(_a25!=""){return true;}else{return false;}},clearTextSelection:function(){if(window.getSelection){window.getSelection().removeAllRanges();}else{if(document.selection){document.selection.empty();}}},_hideFromAllWorkflows:function(iCS){return iCS.eventSID==="__NOFLOW";},_isSIDSelectionUI:function(_a26){return _a26&&_a26.indexOf("__")==0;},cancelCurrentWorkflowProcessing:function(){this.setCurrentWorkflow(null,true);},setCurrentWorkflow:function(_a27,_a28){var _a29=this.currentWorkflow?this.currentWorkflow.type:null;var _a2a=_a27?_a27.type:null;if(!_a28&&_a29===_a2a){return;}if(this.currentWorkflow){var _a2b=this.currentWorkflow.terminateWorkflow();if(_a2b||_a28){this._pad.container.abortPreview();}}this.currentWorkflow=_a27;},scrollStraightBy:function(_a2c,_a2d){if(this._scrollStraightXOn){this._scrollStraightXCounter+=_a2c;if(Math.abs(this._scrollStraightXCounter)<this._scrollStraightXTreshold){this._pad.surface.scrollBy(0,_a2d,true);}else{this._pad.surface.scrollBy(this._scrollStraightXCounter,_a2d,true);this._scrollStraightXOn=false;}}else{this._pad.surface.scrollBy(_a2c,_a2d,true);}},_findNewWorkflowOnMouseDown:function(iCS){if(iCS.buttonType==="LEFT"&&!iCS.spaceKey&&(iCS.isSIDSelectionUI||(this._pad.container.isIdSelected(iCS.eventSID)&&this._pad.container.getItemType(iCS.eventSID)==="txtG"))){return this.selectWorkflow;}if(iCS.buttonType==="LEFT"&&(iCS.currentTool==="TOOL_HAND"||iCS.spaceKey)){return this.panWorkflow;}if(iCS.buttonType==="LEFT"){return this._getWorkflowByTool(iCS.currentTool);}return null;},_getWorkflowByTool:function(tool){switch(tool){case "TOOL_HAND":return this.panWorkflow;break;case "TOOL_ZOOM":return this.zoomWorkflow;break;case "TOOL_ERASER":return this.eraseWorkflow;break;case "TOOL_SELECT":return this.selectWorkflow;break;case "TOOL_SCRIBBLE":case "TOOL_SHAPE_FREELINE":return this.freeLineWorkflow;break;case "TOOL_TEXT_COMMENT":case "TOOL_TEXT_NOTE":case "TOOL_HIGHLIGHT":case "TOOL_TEXT_BLOCK":case "TOOL_TEXT_HEADLINE":case "TOOL_SHAPE_RECTANGLE":case "TOOL_SHAPE_ELLIPSE":case "TOOL_SHAPE_LINE":case "TOOL_SHAPE_ARROW":return this.squareWorkflow;break;default:return null;break;}}});});},"dijit/form/_ExpandingTextAreaMixin":function(){define(["dojo/_base/declare","dojo/dom-construct","dojo/has","dojo/_base/lang","dojo/on","dojo/_base/window","../Viewport"],function(_a2e,_a2f,has,lang,on,win,_a30){has.add("textarea-needs-help-shrinking",function(){var body=win.body(),te=_a2f.create("textarea",{rows:"5",cols:"20",value:" ",style:{zoom:1,fontSize:"12px",height:"96px",overflow:"hidden",visibility:"hidden",position:"absolute",border:"5px solid white",margin:"0",padding:"0",boxSizing:"border-box",MsBoxSizing:"border-box",WebkitBoxSizing:"border-box",MozBoxSizing:"border-box"}},body,"last");var _a31=te.scrollHeight>=te.clientHeight;body.removeChild(te);return _a31;});return _a2e("dijit.form._ExpandingTextAreaMixin",null,{_setValueAttr:function(){this.inherited(arguments);this.resize();},postCreate:function(){this.inherited(arguments);var _a32=this.textbox;_a32.style.overflowY="hidden";this.own(on(_a32,"focus, resize",lang.hitch(this,"_resizeLater")));},startup:function(){this.inherited(arguments);this.own(_a30.on("resize",lang.hitch(this,"_resizeLater")));this._resizeLater();},_onInput:function(e){this.inherited(arguments);this.resize();},_estimateHeight:function(){var _a33=this.textbox;_a33.rows=(_a33.value.match(/\n/g)||[]).length+1;},_resizeLater:function(){this.defer("resize");},resize:function(){var _a34=this.textbox;function _a35(){var _a36=false;if(_a34.value===""){_a34.value=" ";_a36=true;}var sh=_a34.scrollHeight;if(_a36){_a34.value="";}return sh;};if(_a34.style.overflowY=="hidden"){_a34.scrollTop=0;}if(this.busyResizing){return;}this.busyResizing=true;if(_a35()||_a34.offsetHeight){var newH=_a35()+Math.max(_a34.offsetHeight-_a34.clientHeight,0);var _a37=newH+"px";if(_a37!=_a34.style.height){_a34.style.height=_a37;_a34.rows=1;}if(has("textarea-needs-help-shrinking")){var _a38=_a35(),_a39=_a38,_a3a=_a34.style.minHeight,_a3b=4,_a3c,_a3d=_a34.scrollTop;_a34.style.minHeight=_a37;_a34.style.height="auto";while(newH>0){_a34.style.minHeight=Math.max(newH-_a3b,4)+"px";_a3c=_a35();var _a3e=_a39-_a3c;newH-=_a3e;if(_a3e<_a3b){break;}_a39=_a3c;_a3b<<=1;}_a34.style.height=newH+"px";_a34.style.minHeight=_a3a;_a34.scrollTop=_a3d;}_a34.style.overflowY=_a35()>_a34.clientHeight?"auto":"hidden";if(_a34.style.overflowY=="hidden"){_a34.scrollTop=0;}}else{this._estimateHeight();}this.busyResizing=false;}});});},"dojox/gfx":function(){define("dojox/gfx",["dojo/_base/lang","./gfx/_base","./gfx/renderer!"],function(lang,_a3f,_a40){_a3f.switchTo(_a40);return _a3f;});},"wp/data/item/FreeLineItem":function(){define("wp/data/item/FreeLineItem",["dijit","dojo","dojox","dojo/require!wp/data/Item"],function(_a41,dojo,_a42){dojo.provide("wp.data.item.FreeLineItem");dojo.require("wp.data.Item");dojo.declare("wp.data.item.FreeLineItem",wp.data.Item,{constructor:function(map){this.type="freeLine";},draw:function(_a43,_a44){if(this.del){return;}var MH=wp.common.MathsHelper;var _a45=this.ls.toLowerCase()!="none"?this.lw*1:"0";var _a46=this.ls.toLowerCase()!="none"?this.ls:"solid";var _a47=this.ls.toLowerCase()!="none"?this.lo:"0";var _a48=wp.common.ColorHelper.convertHexAndPercentToDojoColor(this.lc,_a47);var _a49=wp.common.ColorHelper.convertHexAndPercentToDojoColor(this.lc,50);var _a4a={color:_a48,width:_a45,style:_a46,cap:"round",join:this.lj};var _a4b={color:_a49,width:_a45/3,style:_a46,cap:"round",join:this.lj};var _a4c=this.a.x;var _a4d=this.a.y;var _a4e=this.pa;var _a4f=null;var _a50=null;var _a51=Math.min(this.lw/2,1.25);var _a52=-_a51;if(this.v==="0"){var _a53=MH.convertPointArrayToLinePathListWithSharpCorr(_a4e,{x:_a4c,y:_a4d});_a43.createPath().moveTo(_a4c+0.5,_a4d+0.5).lineTo(_a53).setStroke(_a4a);return;}else{if(this.v==="1"){return;}else{if(this.v==="2"){_a4f=MH.convertPointArrayToCurvePathListV2(_a4e,{x:_a4c,y:_a4d});_a43.createPath().moveTo(_a4c,_a4d).curveTo(_a4f).setStroke(_a4a);}else{if(this.v==="3"){_a4f=MH.convertPointArrayToCurvePathListV3(_a4e,{x:_a4c,y:_a4d});var _a54=[];var _a55=[];var i=0;while(i<_a4e.points.length){_a54.push(_a4e.points[i]);i++;if(i<_a4e.points.length){_a55.push(_a4e.points[i]);i++;}}var _a56=MH.convertPointArrayToCurvePathListV3({points:_a54},{x:_a4c,y:_a4d});var _a57=MH.convertPointArrayToCurvePathListV3({points:_a55},{x:_a4c,y:_a4d});if(!_a44&&_a4a.width<this.MIN_LINE_WIDTH){_a43.createPath().moveTo(_a4c,_a4d).curveTo(_a4f).setStroke(this.TRANSPARENT_STROKE);}_a43.createPath().moveTo(_a4c,_a4d).curveTo(_a57).setStroke(_a4b);_a43.createPath().moveTo(_a4c,_a4d).curveTo(_a56).setStroke(_a4b);_a43.createPath().moveTo(_a4c,_a4d).curveTo(_a4f).setStroke(_a4a);}else{if(this.v==="4"){_a50=MH.convertPointArrayToCurvePathListV4(_a4e,{x:_a4c,y:_a4d});if(!_a44&&_a4a.width<this.MIN_LINE_WIDTH){_a43.createPath().moveTo(_a4c,_a4d).curveTo(_a50).setStroke(this.TRANSPARENT_STROKE);}_a43.createPath().moveTo(_a4c,_a4d).curveTo(_a50).setStroke(_a4a);}else{_a50=MH.convertPointArrayToCurvePathListV5(_a4e,{x:_a4c,y:_a4d});var _a58=[];_a58[0]=_a4c+_a51;_a58[1]=_a4c+_a52;var _a59=[];_a59[0]=_a4d+_a51;_a59[1]=_a4d+_a52;var _a5a=[];_a5a[0]=[];_a5a[1]=[];for(var k=0;k<_a50.length;k++){_a5a[0].push(_a50[k]+_a51);_a5a[1].push(_a50[k]+_a52);}if(!_a44&&_a4a.width<this.MIN_LINE_WIDTH){_a43.createPath().moveTo(_a4c,_a4d).curveTo(_a50).setStroke(this.TRANSPARENT_STROKE);}_a43.createPath().moveTo(_a58[0],_a59[0]).curveTo(_a5a[0]).moveTo(_a58[1],_a59[1]).curveTo(_a5a[1]).moveTo(_a4c,_a4d).curveTo(_a50).setStroke(_a4a);}}}}}},drawDebugPoints:function(_a5b,_a5c,_a5d,_a5e,_a5f){var _a60=wp.common.ColorHelper.convertHexAndPercentToDojoColor("#00ff00",100);var _a61=wp.common.ColorHelper.convertHexAndPercentToDojoColor("#ff0000",100);_a5b.createEllipse({cx:_a5c,cy:_a5d,rx:2,ry:2}).setFill(_a60);var s1="";var p;for(var i=0;i<_a5e.points.length;i++){p=_a5e.points[i];s1+=" "+p.x+"/"+p.y;_a5b.createEllipse({cx:p.x,cy:p.y,rx:2,ry:2}).setFill(_a60);}if(_a5f){var i2=0;var s2="";while(i2<_a5f.length){p={x:_a5f[i2],y:_a5f[i2+1]};s2+=" "+p.x+"/"+p.y;_a5b.createEllipse({cx:p.x,cy:p.y,rx:1,ry:1}).setFill(_a61);i2=i2+2;}}},json:function(){return {"type":this.type,"del":this.del,"id":this.id,"seq":this.seq,"z":this.z,"v":this.v,"lc":this.lc,"lo":this.lo,"lw":this.lw,"ls":this.ls,"lj":this.lj,"a":this.a,"pa":this.pa,"authorid":this.authorid,"origAuthorid":this.origAuthorid,"origSeq":this.origSeq,"origDte":this.origDte,"dte":this.dte};}});});},"cb/board/toolbar/ImportContainer":function(){define(["dojo","dojo/_base/declare","dojo/_base/lang","dojo/on","dojo/aspect","dojo/dom-class","dojo/dom-construct","dojo/html","plupload/plupload","dijit/_Widget","./ImportManager","wp/widget/ScreenshotDialog","sp/I18n","dojo/i18n!../nls/Messages"],function(dojo,_a62,lang,on,_a63,_a64,_a65,_a66,_a67,_a68,_a69,_a6a,_a6b,i18n){var _a6c=_a6b.wrap(i18n);var err=sp.global.err;return dojo.declare([_a68],{controller:null,container:null,baseClass:"import-container",importManager:null,overlayState:null,formUploadOnly:dojo.isIE&&dojo.isIE<10,dropSupported:false,dropPotentiallySupported:!sp.isTouchOnly&&!(dojo.isIE&&dojo.isIE<10),javaPotentiallySupported:!(dojo.isIos||dojo.isAndroid),uploadBrowseButtonId:"uploadBrowserButton",uploadDropTargetContainer:null,uploadDropTargetContainerId:"uploadDropTargetContainer",uploadDropTarget:null,uploadDropTargetId:"uploadDropTarget",bgInnerNode:null,bgInnerNodeForApplet:null,constructor:function(args){dojo.mixin(this,args);this.importManager=new _a69();},buildRendering:function(){this.inherited("buildRendering",arguments);if(this.javaPotentiallySupported){this._screenshotButton=_a65.create("span",{"title":_a6c("tool_label_screenshot"),"innerHTML":"<i class=\"fonticon-camera\"></i> <span class=\"tool-label\">"+_a6c("tool_label_screenshot")+"</span>","class":"app-button no-shrink"},this.domNode);this.own(on(this._screenshotButton,"click",lang.hitch(this,function(e){this._screenshotButtonClicked();})));}this._uploadButton=_a65.create("span",{"id":this.uploadBrowseButtonId,"title":_a6c("tool_label_upload"),"innerHTML":"<i class=\"fonticon-upload\"></i> <span class=\"tool-label\">"+_a6c("tool_label_upload")+"</span>","class":"app-button no-shrink"},this.domNode);this._pluploadWrapper=_a65.create("div",{"id":"pluploadwrapper","style":"padding:0;","class":"app-button"},this.domNode);if(this.dropPotentiallySupported){this.uploadDropTargetContainer=dojo.byId(this.uploadDropTargetContainerId);this._renderDropTargetUI();_a65.create("span",{"class":"app-button-separator"},this.domNode);var _a6d="<i class=\"fonticon-video hint-icon\"></i>";var _a6e="<span class=\"toolbar-hint-text light link\">"+_a6c("toolbar_hint_import")+"</span>";this._videoLink=_a65.create("span",{"class":"toolbar-hint light","innerHTML":_a6d+_a6e},this.domNode);this.own(on(this._videoLink,"click",lang.hitch(this,function(e){this._showWebsiteUploadVideoDialog();})));}},postCreate:function(){this.inherited(arguments);if(this.formUploadOnly){this.importManager.startupWithFormUploadOnly(this.uploadBrowseButtonId);this.dropSupported=false;}else{if(!this.dropPotentiallySupported){this.importManager.startupWithoutDropSupport(this.uploadBrowseButtonId);this.dropSupported=false;}else{this.dropSupported=this.importManager.startup(this.uploadBrowseButtonId,this.uploadDropTarget);}}if(this.dropSupported){this.connect(dojo.byId("padViewport"),"dragenter",function(_a6f){if(this.controller.currentMode!=="IMPORT"){dojo.publish("requests/cb/board/currentmodechange","IMPORT");this.showDropOverlayOnDrag();}});}this.connect(this.importManager,"onDragEnter",lang.hitch(this,function(){this.showDropOverlayOnDrag();}));this.connect(this.importManager,"onDragLeave",lang.hitch(this,function(){this.showDropOverlay();}));this.connect(this.importManager,"onImportStarted",lang.hitch(this,function(){err.handle(err.getNewMessageObject("uploadprogress","...",_a6c("import_progress_prepare")));this._exitImportMode();}));this.connect(this.importManager,"onUploadProgress",lang.hitch(this,function(_a70){err.handle(err.getNewMessageObject("uploadprogress",_a70+"%",_a6c("import_progress_uploading")));}));this.connect(this.importManager,"onConversionProgress",lang.hitch(this,function(_a71){err.handle(err.getNewMessageObject("uploadprogress","...",_a6c("import_progress_converting")));}));this.connect(this.importManager,"onImportSuccessfull",lang.hitch(this,function(){setTimeout(function(){sp.global.spinInTaskbar();},2000);}));this.connect(this.importManager,"onImportFailed",lang.hitch(this,function(_a72){console.error("onImportFailed",_a72);if(!_a72){_a72=_a6c("import_fail_unknown");}err.handle(err.getNewMessageObject("warning",_a72,"Import problems"));}));this.connect(this.importManager,"onImportCanceled",lang.hitch(this,function(){this._exitImportMode();}));},showDropOverlay:function(){if(this.dropSupported){this.overlayState=null;this._switchDropOverlayToDefault();this._blurUnderlay();this._hideNonImportUI();this._initAndShowDropTargetContainer();}},showDropOverlayOnDrag:function(){if(this.dropSupported&&this.overlayState!=="DRAGGING"){this.overlayState="DRAGGING";this._switchDropOverlayToDefault();this._unblurUnderlay();this._hideNonImportUI();this._initAndShowDropTargetContainerOnDrag();}},removeImportModeUI:function(){if(this.dropSupported){this.overlayState=null;this._switchDropOverlayToDefault();this._unblurUnderlay();this._hideDropTargetContainer();this._restoreNonImportUI();}},_blurUnderlay:function(){dojo.addClass(dojo.byId("padUnderlay"),"blur-out");},_unblurUnderlay:function(){dojo.removeClass(dojo.byId("padUnderlay"),"blur-out");},_initAndShowDropTargetContainer:function(){if(this.uploadDropTargetContainer){dojo.removeClass(this.uploadDropTargetContainer,"drag-active");dojo.removeClass(this.uploadDropTargetContainer,"drag-dropped");dojo.removeClass(this.uploadDropTargetContainer,"hideBlock");}},_initAndShowDropTargetContainerOnDrag:function(){if(this.uploadDropTargetContainer){dojo.addClass(this.uploadDropTargetContainer,"drag-active");dojo.removeClass(this.uploadDropTargetContainer,"drag-dropped");dojo.removeClass(this.uploadDropTargetContainer,"hideBlock");}},_hideDropTargetContainer:function(){if(this.uploadDropTargetContainer){dojo.addClass(this.uploadDropTargetContainer,"hideBlock");}},_hideNonImportUI:function(){dojo.query("#outline-container").style("display","none");dojo.query(".minimap-container").style("display","none");dojo.query(".timeline").style("display","none");dojo.query("#errContainer").style("display","none");dojo.query("#zenbox_tab").style("display","none");},_restoreNonImportUI:function(){dojo.query("#outline-container").style("display","block");dojo.query(".minimap-container").style("display","block");dojo.query(".timeline").style("display","block");dojo.query("#errContainer").style("display","block");dojo.query("#zenbox_tab").style("display","block");},_switchDropOverlayToDefault:function(){if(this.bgInnerNode&&this.bgInnerNodeForApplet){dojo.addClass(this.bgInnerNodeForApplet,"hideBlock");dojo.removeClass(this.bgInnerNode,"hideBlock");}},_switchDropOverlayToAppletHint:function(){if(this.bgInnerNode&&this.bgInnerNodeForApplet){dojo.addClass(this.bgInnerNode,"hideBlock");dojo.removeClass(this.bgInnerNodeForApplet,"hideBlock");}},_exitImportMode:function(){dojo.publish("requests/cb/board/currenttoolchange",["TOOL_SELECT","CREATE"]);},_screenshotButtonClicked:function(){this._switchDropOverlayToAppletHint();var _a73=new _a6a({documentId:sp.info.document.id});this.connect(_a73,"onHide",function(){dojo.publish("requests/cb/board/currenttoolchange",["TOOL_SELECT","CREATE"]);});_a73.show(this.domNode);},_showWebsiteUploadVideoDialog:function(){var _a74=new sp.dialog.TooltipDialog({style:"width: 853px; heigt: 480px;",content:"<iframe width=\"853\" height=\"480\" style=\"margin: -1px; display: block;\" src=\"https://www.youtube.com/embed/05tykFfoP8o?rel=0\" frameborder=\"0\" allowfullscreen></iframe>"});_a74.show();},_renderDropTargetUI:function(){var _a75=_a65.create("div",{"class":"upload-drop-target-background"},this.uploadDropTargetContainer);this.bgInnerNode=_a65.create("div",{"class":"background-inner"},_a75);_a65.create("span",{"class":"file-type-icon pdf"},this.bgInnerNode);_a65.create("span",{"class":"file-type-icon doc"},this.bgInnerNode);_a65.create("span",{"class":"file-type-icon ppt"},this.bgInnerNode);_a65.create("span",{"class":"file-type-icon xls"},this.bgInnerNode);_a65.create("span",{"class":"file-type-icon psd"},this.bgInnerNode);_a65.create("span",{"class":"file-type-icon png"},this.bgInnerNode);_a65.create("span",{"class":"file-type-icon jpg"},this.bgInnerNode);_a65.create("span",{"class":"file-type-icon eps"},this.bgInnerNode);_a65.create("div",{"class":"background-message","innerHTML":_a6c("import_drop_call_to_action")},this.bgInnerNode);this.bgInnerNodeForApplet=_a65.create("div",{"class":"background-inner hideBlock"},_a75);_a65.create("div",{"class":"background-message","innerHTML":_a6c("import_applet_hint")},this.bgInnerNodeForApplet);this.uploadDropTarget=_a65.create("div",{"class":"upload-drop-target","id":this.uploadDropTargetId},this.uploadDropTargetContainer);_a65.create("div",{"class":"position-image"},_a75);}});});},"wp/handler/workflow/EraseWorkflow":function(){define("wp/handler/workflow/EraseWorkflow",["dijit","dojo","dojox"],function(_a76,dojo,_a77){dojo.provide("wp.handler.workflow.EraseWorkflow");dojo.declare("wp.handler.workflow.EraseWorkflow",null,{constructor:function(pad){this.type="ERASE";this._pad=pad;},localReset:function(){this.forceSIDInvestigationOnMove=true;this.itemIds=new wp.UniqueArray();this.singleErasingId=null;},terminateWorkflow:function(){return this.itemIds.getLength()>0;},startWorkflow:function(iCS){this.localReset();var _a78=iCS.eventSID;var _a79=iCS.isSIDSelectionUI;this.singleErasingId=null;if(_a78&&!_a79){var type=this._pad.container.getItemType(_a78);if(type=="image"||type=="txtG"){this.singleErasingId=_a78;}else{this.itemIds.push(_a78);this._pad.controller.previewModifiedItemsByIds(this.itemIds.toArray(),"del",1);}}},processWorkflow:function(iCS,_a7a){var _a7b=_a7a.eventSID;var _a7c=_a7a.isSIDSelectionUI;if(_a7b&&!_a7c){if(this.itemIds.contains(_a7b)){}else{var type=this._pad.container.getItemType(_a7b);if(type=="image"||type=="txtG"){}else{this.itemIds.push(_a7b);this._pad.controller.previewModifiedItemsByIds(this.itemIds.toArray(),"del",1);}}}},endWorkflow:function(iCS,_a7d){if(this.singleErasingId&&this.itemIds.getLength()<1){this._pad.controller.saveModifiedItemsByIds([this.singleErasingId],"del",1);}else{if(this.itemIds.getLength()>0){this._pad.controller.saveModifiedItemsByIds(this.itemIds.toArray(),"del",1);}}this.localReset();this.terminateWorkflow();}});});},"cb/videochat/VideoChatTooltip":function(){define(["dojo/_base/declare","sp/Tooltip","sp/I18n","cb/util","dojo/i18n!./nls/VideoChatPanel"],function(_a7e,_a7f,_a80,_a81,i18n){var _a82=_a7e([_a7f],{position:["above-centered"],showDelay:200,label:"",postCreate:function(){this.inherited(arguments);this.set("numberofmaxstreams",this.get("numberofmaxstreams"));},_setNumberofmaxstreamsAttr:function(_a83){this.set("label","<span class=\"tooltip-hint-content\">"+_a80.wrap(i18n)("video_button_limited_tt",[_a83])+"</span>");this._set("numberofmaxstreams",_a83);}});_a82.setupTooltip=function setupTooltip(_a84,_a85){var _a86=new _a82();_a81.watchAndGetImmediately(_a84,"numberofmaxstreams",function(attr,old,_a87){_a86.set("numberofmaxstreams",_a87);});_a81.watchAndGetImmediately(_a84,"cancreatestreamMode",function(attr,old,_a88){switch(_a88){case "activationlimited":_a86.set("connectId",_a85);break;case "activate":case "deactivate":_a86.close();_a86.set("connectId",null);}});return _a86;};return _a82;});},"cb/board/timeline/SimplifiedTimeline":function(){define(["dojo","dojo/_base/array","dojo/_base/lang","dojo/date/locale","dojo/date/stamp","dojo/on","dojo/topic","dojo/dom-construct","dojo/dom-style","dojo/dom-class","dojo/dom-geometry","dojo/query","dojo/NodeList-traverse","dijit","dijit/_Widget","dojo/DeferredList","sp/infos/InfoManager","cb/ext/timeago/Timeago","cb/widget/HighlightFlash","cb/Capabilities","wp/UniqueArray","./CommentActivityDialog","cb/notifications/AlertsButton","sp/I18n","dojo/i18n!../nls/Messages"],function(dojo,arr,lang,_a89,_a8a,on,_a8b,_a8c,_a8d,_a8e,_a8f,_a90,_a91,_a92,_a93,_a94,_a95,_a96,_a97,_a98,_a99,_a9a,_a9b,_a9c,i18n){var _a9d=_a9c.wrap(i18n);return dojo.declare([_a93],{baseClass:"timeline simplified-timeline",constructor:function(){this.allCommentsTxtGIds=new _a99();this.ownMentionsInTxtEPerTxtG={};this.latestTimestampsPerTxtG={};this.taskStatusPerTxtG={};this.allCommentsTxtGIdsWithTimestamp=[];this.commentsTxtGIdsSorted=[];this.myMentionedCommentsTxtGIdsSorted=[];this.tasksTxtGIdsSorted=[];this.openTasksTxtGIdsSorted=[];this.myOpenTasksTxtGIdsSorted=[];this.documentId=sp.info.document.document.id;dojo.subscribe("/zendesk/zenbox/initiated",this,"_repositionZendeskTab");dojo.subscribe("/window/resize",this,"_repositionZendeskTab");},postCreate:function(){this.inherited("postCreate",arguments);_a98.checkFeature("registration.selfsignup").then(lang.hitch(this,function(_a9e){this.featureRegistrationSelfsignup=(_a9e==="enabled");}));dojo.subscribe("/cb/messaging/incoming",this,"addActivity");var _a9f=this.documentId;this.alertsButtonWidget=new _a9b({"isBoardMode":true,getQuery:function(){var _aa0=this.inherited("getQuery",arguments);return function(n){return _aa0(n)&&n.eventSubject&&n.eventSubject.documentId===_a9f;};}},_a8c.create("div",{"class":"alerts-button timeline-button"},this.domNode));this.tasksButtonNode=_a8c.create("div",{"class":"tasks-button timeline-button","innerHTML":"<span class=\"fonticon-task-round-done\"></span>"},this.domNode);this.tasksHightlightNode=_a8c.create("div",{"class":"highlight-number hideBlock","innerHTML":""},this.tasksButtonNode);this.own(on(this.tasksButtonNode,"click",dojo.hitch(this,this.openTasksDialog)));this.commentsButtonNode=_a8c.create("div",{"class":"comments-button timeline-button","innerHTML":"<span class=\"fonticon-commentText\"></span>"},this.domNode);this.commentsHightlightNode=_a8c.create("div",{"class":"highlight-number hideBlock","innerHTML":"n"},this.commentsButtonNode);this.own(on(this.commentsButtonNode,"click",dojo.hitch(this,this.openCommentsDialog)));this.refreshSoon();},openTasksDialog:function(){this._openCommentActivityDialog("TASKS",this.tasksButtonNode);},openCommentsDialog:function(){this._openCommentActivityDialog("COMMENTS",this.commentsButtonNode);},_openCommentActivityDialog:function(mode,node){if(dojo.query(".comment-activity-dialogPopup").length>0&&this.commentActivityDialog&&this.commentActivityDialog.mode==mode){this.commentActivityDialog=null;_a8b.publish("/window/resize");}else{this.commentActivityDialog=new _a9a({mode:mode,commentsTxtGIdsSorted:this.commentsTxtGIdsSorted,myMentionedCommentsTxtGIdsSorted:this.myMentionedCommentsTxtGIdsSorted,tasksTxtGIdsSorted:this.tasksTxtGIdsSorted,openTasksTxtGIdsSorted:this.openTasksTxtGIdsSorted,myOpenTasksTxtGIdsSorted:this.myOpenTasksTxtGIdsSorted,latestTimestampsPerTxtG:this.latestTimestampsPerTxtG,featureRegistrationSelfsignup:this.featureRegistrationSelfsignup});this.commentActivityDialog.show(node);sp.global.analytics.trackEvent(mode.toLowerCase()+"Dialog","opened");}},addActivity:function(_aa1){if(_aa1.userid&&(_aa1.type=="txtG"||_aa1.type=="txtE")){if(_aa1.type=="txtE"){var _aa2=this.ownMentionsInTxtEPerTxtG[_aa1.txtg];if(_aa2&&(_aa1.del||!_aa1.ownMention)){_aa2.del(_aa1.id);}else{if(!_aa1.del&&_aa1.ownMention){if(!_aa2){_aa2=new _a99();this.ownMentionsInTxtEPerTxtG[_aa1.txtg]=_aa2;}_aa2.push(_aa1.id);}}}if(_aa1.type=="txtE"&&!_aa1.del){this.latestTimestampsPerTxtG[_aa1.txtg]=_aa1.timestamp;}if(_aa1.type=="txtG"&&_aa1.subtype=="comment"){if(_aa1.del){this.allCommentsTxtGIds.del(_aa1.id);}else{this.allCommentsTxtGIds.push(_aa1.id);this.taskStatusPerTxtG[_aa1.id]=_aa1.task;this.latestTimestampsPerTxtG[_aa1.id]=_aa1.timestamp;}}}this.refreshSoon();},refreshSoon:function(){if(this._refreshTimeout){window.clearTimeout(this._refreshTimeout);}this._refreshTimeout=window.setTimeout(dojo.hitch(this,this._refresh),400);},_refresh:function(){this.allCommentsTxtGIdsWithTimestamp=[];this.commentsTxtGIdsSorted=[];this.myMentionedCommentsTxtGIdsSorted=[];this.tasksTxtGIdsSorted=[];this.openTasksTxtGIdsSorted=[];this.myOpenTasksTxtGIdsSorted=[];var _aa3=this.allCommentsTxtGIds.toArray();var i,id;for(i=0;i<_aa3.length;i++){id=_aa3[i];this.allCommentsTxtGIdsWithTimestamp.push({"id":id,"timestamp":this.latestTimestampsPerTxtG[id]});}this.allCommentsTxtGIdsWithTimestamp.sort(function(a,b){return a.timestamp<b.timestamp?1:-1;});for(i=0;i<this.allCommentsTxtGIdsWithTimestamp.length;i++){id=this.allCommentsTxtGIdsWithTimestamp[i].id;var _aa4=false;if(this.ownMentionsInTxtEPerTxtG[id]&&this.ownMentionsInTxtEPerTxtG[id].getLength()>0){_aa4=true;this.myMentionedCommentsTxtGIdsSorted.push(id);}this.commentsTxtGIdsSorted.push(id);if(this.taskStatusPerTxtG[id]=="open"||this.taskStatusPerTxtG[id]=="onhold"||this.taskStatusPerTxtG[id]=="closed"){this.tasksTxtGIdsSorted.push(id);if(this.taskStatusPerTxtG[id]=="open"||this.taskStatusPerTxtG[id]=="onhold"){this.openTasksTxtGIdsSorted.push(id);if(_aa4){this.myOpenTasksTxtGIdsSorted.push(id);}}}}this.tasksHightlightNode.innerHTML=_a9c.esc(this.myOpenTasksTxtGIdsSorted.length===0?"":this.myOpenTasksTxtGIdsSorted.length);this.commentsHightlightNode.innerHTML=_a9c.esc(this.commentsTxtGIdsSorted.length===0?"":this.commentsTxtGIdsSorted.length);dojo.toggleClass(this.tasksHightlightNode,"hideBlock",this.tasksHightlightNode.innerHTML==="");dojo.toggleClass(this.commentsHightlightNode,"hideBlock",this.commentsHightlightNode.innerHTML==="");this._repositionZendeskTab();},_repositionZendeskTab:function(){var _aa5=dojo.byId("zenbox_tab");if(_aa5){if(dojo.byId("zenbox_tab").parentNode.id!="pad-main"){_a8c.place(dojo.byId("zenbox_tab"),this.domNode,"after");}_a8d.set(_aa5,"top",(_a92.byId("pad-main").t*1+_a8f.getMarginBox(this.domNode).h*1+24)+"px");}}});});},"cb/board/itemui/HashtagSelectStoreFactory":function(){define(["dojo/store/Memory","dojo/store/Observable","./trelloHashtagFiller"],function(_aa6,_aa7,_aa8){return {create:function(){var _aa9=_aa7(new _aa6());_aa8(_aa9);return _aa9;}};});},"wp/handler/workflow/SelectWorkflow":function(){define("wp/handler/workflow/SelectWorkflow",["dijit","dojo","dojox"],function(_aaa,dojo,_aab){dojo.provide("wp.handler.workflow.SelectWorkflow");dojo.declare("wp.handler.workflow.SelectWorkflow",null,{constructor:function(pad){this.type="SELECT";this._pad=pad;},localReset:function(){this.dragMode="off";this.rubberbandMode="off";this.alignModeLastCycle=false;this.autoScrollWorkflow=true;},terminateWorkflow:function(){this._pad.drawer.resetCursorMode();return this.dragMode!=="off"||this.rubberbandMode!=="off";},startWorkflow:function(iCS){this.localReset();var _aac=iCS.shiftKey||iCS.copyKey;var _aad=!iCS.eventSID;var _aae=!_aac&&iCS.eventSID&&!iCS.isSIDSelectionUI&&this._pad.container.getItemType(iCS.eventSID)==="image"&&!this._pad.container.isIdSelected(iCS.eventSID);if(this.dragMode==="off"&&this.rubberbandMode==="off"){if(this._pad.container.isSthSelected()&&(_aad||_aae)){this._pad.controller.selectItemsByIds([]);}if(!_aad&&!_aae&&!iCS.isSIDSelectionUI){if(this._pad.container.isIdSelected(iCS.eventSID)){if(_aac){this._pad.controller.unselectSingleItemById(iCS.eventSID);}}else{if(this._pad.container.isSthSelected()&&_aac){this._pad.controller.selectAdditionalItemsByIds([iCS.eventSID]);}else{this._pad.controller.selectItemsByIds([iCS.eventSID]);}}}if(this._pad.container.isSthSelected()){this.dragMode=iCS.isSIDSelectionUI?iCS.eventSID:"__0";this._pad.drawer.overwriteCursorMode("cur_sel"+this.dragMode);}else{this.rubberbandMode="on";this._pad.drawer.overwriteCursorMode("cur_default");}}},processWorkflow:function(iCS,_aaf){var _ab0={x:iCS.positionX,y:iCS.positionY};var _ab1={x:_aaf.positionX,y:_aaf.positionY};var _ab2=_aaf.shiftKey;if(this._pad.container.isSthSelected()&&this.dragMode!=="off"&&this._dndMakesSense(_ab0,_ab1)){var _ab3={x:_ab1.x-_ab0.x,y:_ab1.y-_ab0.y};this._normalizeAspectRatioForDiffXY(_ab3,this.dragMode);this._normalizeDirectionsForDiffXY(_ab3,this.dragMode);this._normalizeAutoSnapForDiffXY(_ab3,this.dragMode,_ab2);var _ab4=this._calcDeltaScaleXY(_ab3,this.dragMode);var _ab5=this._calcDeltaMoveXY(_ab3,this.dragMode);var _ab6=this._calcAttachDeltaXYOrNull(_ab3,this.dragMode);var _ab7=this._calcClippingDiffOrNull(_ab3,this.dragMode);this._pad.container.transformPreview(_ab4,_ab5,_ab6,_ab7);}if(this.rubberbandMode!=="off"){var _ab8=this._pad.factory.getNewItem("temporary",{"subtype":"rubberband"});_ab8.id="_TMP";_ab8.a=_ab0;_ab8.b=_ab1;this._pad.controller.previewNewItems([_ab8]);}},endWorkflow:function(iCS,_ab9){var _aba={x:iCS.positionX,y:iCS.positionY};var _abb={x:_ab9.positionX,y:_ab9.positionY};var _abc=_ab9.shiftKey;var _abd=iCS.eventSID;var _abe=iCS.isSIDSelectionUI;if(this.dragMode!=="off"&&this._dndMakesSense(_aba,_abb)){var _abf=_abb;var _ac0={x:_abf.x-_aba.x,y:_abf.y-_aba.y};this._normalizeAspectRatioForDiffXY(_ac0,this.dragMode);this._normalizeDirectionsForDiffXY(_ac0,this.dragMode);this._normalizeAutoSnapForDiffXY(_ac0,this.dragMode,_abc);var _ac1=this._calcDeltaScaleXY(_ac0,this.dragMode);var _ac2=this._calcDeltaMoveXY(_ac0,this.dragMode);var _ac3=this._calcAttachDeltaXYOrNull(_ac0,this.dragMode);var _ac4=this._calcClippingDiffOrNull(_ac0,this.dragMode);this._pad.container.saveTransformedPreview(_ac1,_ac2,_ac3,_ac4);}var bbox;if(this.rubberbandMode!=="off"){this._pad.container.abortPreview();if(this._dndMakesSense(_aba,_abb)){bbox=new wp.BBox(_aba,_abb);var _ac5=this._pad.container.getItemIdsByBBox(bbox);if(_ac5.length>0){this._pad.controller.selectItemsByIds(_ac5);}}else{if(_aba.x===_abb.x&&_aba.y===_abb.y){if(!this._pad.container.isSthSelected()){var _ac6=_abd&&!_abe&&this._pad.container.getItem(_abd).type=="image";if(_ac6){this._pad.controller.selectItemsByIds([_abd]);}}}}if(!this._pad.container.isSthSelected()&&Math.abs(_aba.x-_abb.x)>9&&Math.abs(_aba.y-_abb.y)>9){bbox=new wp.BBox(_aba,_abb);var _ac7=this._pad.container.getItemIdsByTouchedBBox(bbox);if(_ac7.length>0){var _ac8=null;for(var i=_ac7.length-1;i>=0;i--){var id=_ac7[i];if(this._pad.container.containsItem(id)){_ac8=this._pad.container.getItem(id);if(_ac8.type==="image"){break;}else{_ac8=null;}}}if(_ac8){var _ac9=bbox.shrinkToIntersection(_ac8.getBBox());var _aca=this._pad.factory.getNewItem("temporary",{"subtype":"slicearea"});_aca.id="_TMP";_aca.a=_ac9.p1;_aca.b=_ac9.p2;_aca.ids=[_ac8.id];this._pad.controller.previewNewItems([_aca]);}}}}this.localReset();this.terminateWorkflow();},_dndMakesSense:function(_acb,_acc){var _acd=_acb&&(_acb.x!==0||_acb.y!==0);var _ace=_acc&&(_acc.x!==0||_acc.y!==0);return _acd&&_ace&&!(Math.round(_acb.x)===Math.round(_acc.x)&&Math.round(_acb.y)===Math.round(_acc.y));},_normalizeAspectRatioForDiffXY:function(_acf,mode){if(this._pad.container.isImageInSelection()&&this.dragMode!="__0"){var _ad0=this._pad.container.getPrevBBox();var _ad1=_ad0.getWidth()/_ad0.getHeight();var _ad2=null;var _ad3=null;if(mode=="__1"||mode=="__5"){if(mode=="__1"){_ad2={x:_ad0.getWidth()+_acf.x,y:_ad0.getHeight()-_acf.y};}if(mode=="__5"){_ad2={x:_ad0.getWidth()-_acf.x,y:_ad0.getHeight()+_acf.y};}_ad3=Math.abs(_ad2.x/_ad2.y);if(_ad3<_ad1){_acf.x=1*_acf.x;_acf.y=-1/_ad1*_acf.x;}else{_acf.x=-1*_ad1*_acf.y;_acf.y=1*_acf.y;}}if(mode=="__3"||mode=="__7"){if(mode=="__3"){_ad2={x:_ad0.getWidth()+_acf.x,y:_ad0.getHeight()+_acf.y};}if(mode=="__7"){_ad2={x:_ad0.getWidth()-_acf.x,y:_ad0.getHeight()-_acf.y};}_ad3=Math.abs(_ad2.x/_ad2.y);if(_ad3<_ad1){_acf.x=1*_acf.x;_acf.y=1/_ad1*_acf.x;}else{_acf.x=1*_ad1*_acf.y;_acf.y=1*_acf.y;}}}},_normalizeDirectionsForDiffXY:function(_ad4,mode){if(mode=="__2"||mode=="__6"){_ad4.y=0;}if(mode=="__4"||mode=="__8"){_ad4.x=0;}},_normalizeAutoSnapForDiffXY:function(_ad5,mode,_ad6){var _ad7=!_ad6;var _ad8;if(_ad7&&this._pad.container.isSthSelected()&&mode=="__0"){var _ad9=this._pad.container.getPrevBBox();if(_ad9){this.alignModeLastCycle=true;var _ada=new wp.BBox({x:_ad9.p1.x+_ad5.x,y:_ad9.p1.y+_ad5.y},{x:_ad9.p2.x+_ad5.x,y:_ad9.p2.y+_ad5.y});var _adb=Math.round(300/this._pad.surface.getZoomFactor());var _adc=new wp.BBox({x:_ada.p1.x-_adb,y:_ada.p1.y-_adb},{x:_ada.p2.x+_adb,y:_ada.p2.y+_adb});var _add=this._pad.container.getItemAlignByBBoxAndSearchBox(_ada,_adc);var a=null,b=null,c=null,d=null;var pa=new wp.PointArray();if(_add.horizontal.align&&Math.abs(_add.horizontal.diff)<10){a={x:(_add.horizontal.align=="left"?_ada.p1.x:(_add.horizontal.align=="right"?_ada.p2.x:_ada.getCenter().x))+_add.horizontal.diff,y:_ada.p1.y-_adb};b={x:a.x,y:_ada.p2.y+_adb};_ad5.x+=_add.horizontal.diff;pa.add(a);pa.add(b);}if(_add.vertical.align&&Math.abs(_add.vertical.diff)<10){c={x:_ada.p1.x-_adb,y:(_add.vertical.align=="top"?_ada.p1.y:(_add.vertical.align=="bottom"?_ada.p2.y:_ada.getCenter().y))+_add.vertical.diff};d={x:_ada.p2.x+_adb,y:c.y};_ad5.y+=_add.vertical.diff;pa.add(c);pa.add(d);}_ad8=this._pad.factory.getNewItem("temporary",{"subtype":"alignment"});_ad8.id="_TMP";_ad8.pa=pa;this._pad.container.addTmpItemToPreview(_ad8);}}else{if(this.alignModeLastCycle){this.alignModeLastCycle=true;_ad8=this._pad.factory.getNewItem("temporary",{"subtype":"alignment"});_ad8.id="_TMP";this._pad.container.addTmpItemToPreview(_ad8);}}},_calculateAutoSnapDiffValue:function(_ade,_adf){var sb=5;var sg=25/this._pad.surface.getZoomFactor();var _ae0=_ade+_adf;var _ae1=Math.abs(_ae0%sg);if(true||_ae1<=sb||_ae1>=sg-sb){return Math.round(Math.round(_ae0/sg)*sg)-_ade;}else{return _adf;}},_calcDeltaScaleXY:function(_ae2,mode){var _ae3={x:0,y:0};if(mode==="__1"||mode==="__2"||mode==="__3"||mode==="__4"||mode==="__5"||mode==="__6"||mode==="__7"||mode==="__8"){if(_ae2.x!==0){var dx=mode=="__5"||mode=="__6"||mode=="__7"?-_ae2.x:_ae2.x;_ae3.x=dx;}if(_ae2.y!==0){var dy=mode=="__1"||mode=="__7"||mode=="__8"?-_ae2.y:_ae2.y;_ae3.y=dy;}}return _ae3;},_calcDeltaMoveXY:function(_ae4,mode){if(mode=="__0"||mode=="__9_attach"){return {x:_ae4.x,y:_ae4.y};}if(mode=="__2"||mode=="__3"||mode=="__4"){return {x:0,y:0};}if(mode=="__1"||mode=="__8"){return {x:0,y:_ae4.y};}if(mode=="__5"||mode=="__6"){return {x:_ae4.x,y:0};}if(mode=="__7"){return {x:_ae4.x,y:_ae4.y};}return {x:0,y:0};},_calcAttachDeltaXYOrNull:function(_ae5,mode){if(mode=="__9_attach"){return {x:_ae5.x,y:_ae5.y};}return null;},_calcClippingDiffOrNull:function(_ae6,mode){if(mode==="__2_crop"){return {side1:_ae6.x};}else{if(mode==="__4_crop"){return {side2:_ae6.y};}else{if(mode==="__6_crop"){return {side3:_ae6.x};}else{if(mode==="__8_crop"){return {side4:_ae6.y};}else{return null;}}}}}});});},"cb/xdomain/storage/StorageIframeClient":function(){define(["dojo/ready","dojo/_base/array","dojo/Deferred","dojo/dom-construct","dojo/_base/window","cb/xdomain/Communicator"],function(_ae7,arr,_ae8,_ae9,_aea,_aeb){return function StorageIframeClient(_aec){var _aed=new _ae8();var _aee=new _ae8();_ae7(function(){var _aef;if(window.location&&window.location.hasOwnProperty&&window.location.hasOwnProperty("origin")){_aef=window.location.origin;}else{_aef=window.location.protocol+"//"+window.location.host;}_aee.resolve(_ae9.create("iframe",{src:sp.info.app.serverUrls.https+"/__/xdomainstorage"+"#"+_aef,sandbox:"allow-scripts allow-same-origin",style:"position: absolute; height: 1px; width: 1px; top: -1000px; left: -1000px;"},_aea.body()));});var _af0={};function _af1(_af2){if(!_af0[_af2]){_af0[_af2]=[];_aed.then(function(_af3){_af4.send(_af3.contentWindow,sp.info.app.serverUrls.https,"listen",{storeName:_af2});});}return _af0[_af2];};var _af4=new _aeb(new RegExp("^https://"+sp.info.app.serverhost+"(?:\\:.*)?"),{storageevent:function(data,_af5,_af6){var ls=_af0[data.storeName]||[];arr.forEach(ls,function(l){l(data.event);});},loaded:function(data,_af7,_af8){_aee.then(function(i){if(i.contentWindow===_af7){_aed.resolve(i);}});}});this.setObj=function(key,_af9){_aed.then(function(_afa){_af4.send(_afa.contentWindow,sp.info.app.serverUrls.https,"set",{key:key,value:_af9,storeName:_aec});});};this.getObj=function(key){var ret=new _ae8();_aed.then(function(_afb){_af4.send(_afb.contentWindow,sp.info.app.serverUrls.https,"get",{key:key,storeName:_aec},function(v){ret.resolve(v);});});return ret;};this.listen=function(_afc){_af1(_aec).push(_afc);};};});},"dojo/request/script":function(){define(["module","./watch","./util","../_base/array","../_base/lang","../on","../dom","../dom-construct","../has","../_base/window"],function(_afd,_afe,util,_aff,lang,on,dom,_b00,has,win){has.add("script-readystatechange",function(_b01,_b02){var _b03=_b02.createElement("script");return typeof _b03["onreadystatechange"]!=="undefined"&&(typeof _b01["opera"]==="undefined"||_b01["opera"].toString()!=="[object Opera]");});var mid=_afd.id.replace(/[\/\.\-]/g,"_"),_b04=0,_b05=has("script-readystatechange")?"readystatechange":"load",_b06=/complete|loaded/,_b07=this[mid+"_callbacks"]={},_b08=[];function _b09(id,url,_b0a){var doc=(_b0a||win.doc),_b0b=doc.createElement("script");_b0b.type="text/javascript";_b0b.src=url;_b0b.id=id;_b0b.async=true;_b0b.charset="utf-8";return doc.getElementsByTagName("head")[0].appendChild(_b0b);};function _b0c(id,_b0d,_b0e){_b00.destroy(dom.byId(id,_b0d));if(_b07[id]){if(_b0e){_b07[id]=function(){delete _b07[id];};}else{delete _b07[id];}}};function _b0f(dfd){var _b10=dfd.response.options,_b11=_b10.ioArgs?_b10.ioArgs.frameDoc:_b10.frameDoc;_b08.push({id:dfd.id,frameDoc:_b11});if(_b10.ioArgs){_b10.ioArgs.frameDoc=null;}_b10.frameDoc=null;};function _b12(dfd,_b13){if(dfd.canDelete){_b14._remove(dfd.id,_b13.options.frameDoc,true);}};function _b15(_b16){if(_b08&&_b08.length){_aff.forEach(_b08,function(_b17){_b14._remove(_b17.id,_b17.frameDoc);_b17.frameDoc=null;});_b08=[];}return _b16.options.jsonp?!_b16.data:true;};function _b18(_b19){return !!this.scriptLoaded;};function _b1a(_b1b){var _b1c=_b1b.options.checkString;return _b1c&&eval("typeof("+_b1c+") !== \"undefined\"");};function _b1d(_b1e,_b1f){if(this.canDelete){_b0f(this);}if(_b1f){this.reject(_b1f);}else{this.resolve(_b1e);}};function _b14(url,_b20,_b21){var _b22=util.parseArgs(url,util.deepCopy({},_b20));url=_b22.url;_b20=_b22.options;var dfd=util.deferred(_b22,_b12,_b15,_b20.jsonp?null:(_b20.checkString?_b1a:_b18),_b1d);lang.mixin(dfd,{id:mid+(_b04++),canDelete:false});if(_b20.jsonp){var _b23=new RegExp("[?&]"+_b20.jsonp+"=");if(!_b23.test(url)){url+=_b23+(_b20.frameDoc?"parent.":"")+mid+"_callbacks."+dfd.id;}dfd.canDelete=true;_b07[dfd.id]=function(json){_b22.data=json;dfd.handleResponse(_b22);};}if(util.notify){util.notify.emit("send",_b22,dfd.promise.cancel);}if(!_b20.canAttach||_b20.canAttach(dfd)){var node=_b14._attach(dfd.id,url,_b20.frameDoc);if(!_b20.jsonp&&!_b20.checkString){var _b24=on(node,_b05,function(evt){if(evt.type==="load"||_b06.test(node.readyState)){_b24.remove();dfd.scriptLoaded=evt;}});}}_afe(dfd);return _b21?dfd:dfd.promise;};_b14.get=_b14;_b14._attach=_b09;_b14._remove=_b0c;_b14._callbacksProperty=mid+"_callbacks";return _b14;});},"wp/widget/Sidebar":function(){define("wp/widget/Sidebar",["dijit","dojo","dojox","dojo/i18n!wp/widget/nls/Sidebar","dojo/require!dojox/lang/functional,cb/widget/_Templated,dijit/_Widget,dijit/_Contained,dojo/cache,dojo/dnd/Manager,dojo/dnd/Source,dojo/dnd/AutoSource,dojo/dnd/Target,dojox/html/metrics,sp/I18n,sp/I18nWidget,wp/widget/SidebarList,cb/page/pad/sidebar/OutlineList"],function(_b25,dojo,_b26){dojo.provide("wp.widget.Sidebar");dojo.require("dojox.lang.functional");dojo.require("cb.widget._Templated");dojo.require("dijit._Widget");dojo.require("dijit._Contained");dojo.require("dojo.cache");dojo.require("dojo.dnd.Manager");dojo.require("dojo.dnd.Source");dojo.require("dojo.dnd.AutoSource");dojo.require("dojo.dnd.Target");dojo.require("dojox.html.metrics");dojo.require("sp.I18n");dojo.require("sp.I18nWidget");dojo.requireLocalization("wp.widget","Sidebar");dojo.require("wp.widget.SidebarList");dojo.require("cb.page.pad.sidebar.OutlineList");dojo.declare("wp.widget.Sidebar",[_b25._Widget,cb.widget._Templated,sp.I18nWidget,_b25._Contained],{widgetsInTemplate:true,templateString:dojo.cache("wp.widget","Sidebar.html","<div class=\"pad-side hideBlock\">\r\n    <div class=\"list-container\" dojoAttachPoint=\"_listContainer\"></div>\r\n</div>\r\n"),pad:null,_sidebarLists:null,_sidebarManuallyChanged:false,TOGGLE_SNAP_DISTANCE:5,changedSidebarWidth:null,dragSource:null,constructor:function(){this._sidebarLists={};},postCreate:function(){this.inherited("postCreate",arguments);this._setupList("outline",cb.page.pad.sidebar.OutlineList);var _b27=function(_b28){var _b29=[];var _b2a=3;var NONE=1;var _b2b=NONE;var _b2c=false;function _b2d(_b2e){_b2b=Math.max(_b2b,_b2e);};function _b2f(){if(!_b2c){return;}switch(_b2b){case _b2a:_b28.sidebar._showListIfNotManuallyInterferred("outline");break;case NONE:default:break;}};_b29.push(dojo.connect(_b28.outline,"onSidebarElementAdded",function(){_b2d(_b2a);_b2f();}));this.startup=function(){setTimeout(function(){_b2c=true;_b2f();},2000);};};this._initialSidebarStateController=new _b27({outline:this._sidebarLists.outline.list,sidebar:this});this._checkSidebarEmptiness();},startup:function(){this._initialSidebarStateController.startup();},_setupList:function(name,_b30,_b31){var _b32=dojo.create("div",{"class":"tab-button "+name+"-button","innerHTML":"<span><i class=\"fonticon-"+name+"\"></i> "+sp.I18n.get("wp.widget","Sidebar")("sidebar_"+name+"_label")+"</span>",title:sp.I18n.get("wp.widget","Sidebar")("sidebar_"+name+"_label")},this._tabContainer,"last");dojo.connect(_b32,"click",this,function(){this.toggleList(name);});var list=new _b30({id:"sidebar-widget-"+name,pad:this.pad,sidebar:this,ulClass:"sidebar-"+name,empty_hint:sp.I18n.get("wp.widget","Sidebar")("sidebar_empty_"+name+"_message"),documentId:sp.info.document.id,sidebarButton:_b32,postCreate:function(){this.inherited("postCreate",arguments);dojo.connect(this,"onShow",function(){dojo.addClass(_b32,"active");});dojo.connect(this,"onHide",function(){dojo.removeClass(_b32,"active");});}},dojo.create("ul",null,this._listContainer,"last"));this.connect(list,"onShow",function(_b33){this._checkSidebarEmptiness();});this.connect(list,"onHide",function(_b34){this._checkSidebarEmptiness();});this.connect(list,"onSidebarElementAdded",function(){this._checkSidebarEmptiness();});this.connect(list,"onSidebarElementRemoved",function(){this._checkSidebarEmptiness();});this._sidebarLists[name]={list:list,button:_b32};},getOpenList:function(){var _b35=null;_b26.lang.functional.forIn(this._sidebarLists,function(list,_b36){if(list.list.isOpen()){_b35=_b36;}});return _b35;},toggle:function(){var _b37=this.getOpenList();if(_b37){this._toggleList(_b37);}else{this._toggleList("outline");}},_showList:function(name){this._toggleList(name,true);},toggleList:function(name){this._sidebarManuallyChanged=true;this._toggleList(name,true);},_showListIfNotManuallyInterferred:function(name){if(!this._sidebarManuallyChanged){this._showList(name);}},_toggleList:function(name,_b38){var _b39=_b38;if(_b39===undefined){_b39=!this._sidebarLists[name].list.isOpen();}if(this._sidebarLists[name].list.isOpen()===_b39){return;}if(_b39===true){_b26.lang.functional.forIn(this._sidebarLists,function(list,_b3a){if(_b3a!==name&&list.list.isOpen()){list.list.hide();}});}if(_b39){this._sidebarLists[name].list.show();}else{this._sidebarLists[name].list.hide();}if(!this.getOpenList()){dojo.addClass(this.domNode,"hideBlock");}else{dojo.removeClass(this.domNode,"hideBlock");}},visitNextListNode:function(_b3b){return this._sidebarLists["outline"].list.visitNextListNode(_b3b);},visitPreviousListNode:function(_b3c){return this._sidebarLists["outline"].list.visitPreviousListNode(_b3c);},_checkSidebarEmptiness:function(){var _b3d=dojo.some(_b26.lang.functional.values(this._sidebarLists),function(list){return list.list.isOpen();});dojo.toggleClass(this.domNode,"sidebar-empty",!_b3d);dojo.toggleClass(this.domNode,"sidebar-open",_b3d);},onHide:function(){},onShow:function(){}});wp.widget.Sidebar.ORDERING_MIDDLE=500;wp.widget.Sidebar.ORDERING_KEY_INCREMENT=1000;});},"cb/board/toolbar/ImportManager":function(){define(["dojo","dojo/_base/declare","dojo/_base/lang","dojo/on","dojo/aspect","dojo/dom-class","dojo/dom-construct","dojo/html","dojo/has","plupload/plupload","dijit/_Widget","sp/I18n","dojo/i18n!../nls/Messages"],function(dojo,_b3e,lang,on,_b3f,_b40,_b41,_b42,has,_b43,_b44,_b45,i18n){var _b46=_b45.wrap(i18n);return dojo.declare([_b44],{id:"boardImportManager",DEFAULT_IMPORT_Y_OFFSET:40,uploader:null,uploadBrowseButtonId:null,uploadDropTargetContainer:null,uploadDropTargetId:null,uploadDropTarget:null,uploadDropPositionImage:null,forceFormUploadOnly:false,positionRecordingOn:false,uploadErrorMessages:"",_importStartedDeferreds:null,_fileIdToUploadIdMap:null,constructor:function(args){dojo.mixin(this,args);this._importStartedDeferreds={};this._fileIdToUploadIdMap={};},startupWithFormUploadOnly:function(_b47){return this._startup(_b47,null,true);},startupWithoutDropSupport:function(_b48){return this._startup(_b48,null,false);},startup:function(_b49,_b4a){return this._startup(_b49,_b4a,false);},_startup:function(_b4b,_b4c,_b4d){this.forceFormUploadOnly=_b4d;this.uploadBrowseButtonId=_b4b;if(_b4c){this.uploadDropTarget=_b4c;this.uploadDropTargetId=this.uploadDropTarget.id;this.uploadDropTargetContainer=this.uploadDropTarget.parentNode;this.uploadDropPositionImage=dojo.query(".position-image",this.uploadDropTargetContainer)[0];}this.err=new sp.err({container:this._messagesContainer});this.subscribe("/sp/ajax/incoming/importstarted",function(msg){var def=this._getWaitForImportDeferred(msg.uploadId);if(def.fired===-1){def.callback(msg);}});return this._initUploader();},onDragEnter:function(){},onDragLeave:function(){},onImportStarted:function(){this.trackImportStart();},onUploadProgress:function(_b4e){},onConversionProgress:function(){},onImportSuccessfull:function(){this.trackImportEnd("upload finish");},onImportFailed:function(_b4f){this.trackImportEnd("upload fail");},onImportCanceled:function(){this.trackImportEnd("upload cancel");},uploadTrackingStartTime:null,uploadTrackingMethod:null,setUploadTrackingMethod:function(_b50){this.uploadTrackingMethod=_b50;},trackImportStart:function(){sp.global.analytics.trackEvent("board insert","upload start",this.uploadTrackingMethod||"default");this.uploadTrackingStartTime=new Date().getTime();},trackImportEnd:function(_b51){sp.global.analytics.trackEvent("board insert",_b51,this.uploadTrackingMethod||"default");if(this.uploadTrackingStartTime){var _b52=new Date().getTime()-this.uploadTrackingStartTime;sp.global.analytics.trackTiming("board insert",_b51,this.uploadTrackingMethod||"default",_b52);}this.uploadTrackingStartTime=null;this.uploadTrackingMethod=null;},_initUploader:function(){var _b53={"container":"pluploadwrapper","browse_button":this.uploadBrowseButtonId,"url":"/__/inbox","headers":dojo.mixin({},sp.ajax.DEFAULT_HEADERS),"args":{"addTo":sp.info.document.id,"csrftoken":sp.info.user.nonce},"multi_selection":(has("ios"))?false:true};if(this.forceFormUploadOnly){_b53["runtimes"]="html4";this.uploader=new _b43.Uploader(_b53);dojo.addClass(this.uploadBrowseButtonId,"hideBlock");}else{if(!this.uploadDropTargetId){_b53["runtimes"]="html5";this.uploader=new _b43.Uploader(_b53);}else{_b53["runtimes"]="html5";_b53["drop_element"]=this.uploadDropTargetId;this.uploader=new _b43.Uploader(_b53);this._connectDragTargetEvents();this.connect(document,"onpaste",lang.hitch(this,function(_b54){if(sp.global.pad.controller.isPastingFromExternalAllowed()){var _b55=(_b54.clipboardData||_b54.originalEvent.clipboardData);this.importClipboardData(_b55);}}));}}this._connectUploaderEvents();this.uploader.init();return this.uploader.features.dragdrop;},_connectDragTargetEvents:function(){this.connect(this.uploadDropTarget,"dragenter",lang.hitch(this,function(_b56){this.positionRecordingOn=true;this.onDragEnter();}));this.connect(this.uploadDropTarget,"dragleave",lang.hitch(this,function(_b57){if(sp.global.pad.surface.getViewportLeft()>_b57.clientX||sp.global.pad.surface.getViewportLeft()+sp.global.pad.surface.getViewportWidth()<_b57.clientX||sp.global.pad.surface.getViewportTop()>_b57.clientY||sp.global.pad.surface.getViewportTop()+sp.global.pad.surface.getViewportHeight()<_b57.clientY){this.positionRecordingOn=false;this.onDragLeave();}}));this.connect(this.uploadDropTarget,"drop",lang.hitch(this,function(_b58){this.positionRecordingOn=false;this.setUploadTrackingMethod("dnd");}));this.connect(this.uploadDropTarget,"mousemove, dragover",lang.hitch(this,function(_b59){if(this.positionRecordingOn){var p=sp.global.pad.getPosition(_b59);this.setUploaderImportPosition(p,true);var q=sp.global.pad.surface.convertItem2Viewport(p);dojo.style(this.uploadDropPositionImage,{left:q.x+"px",top:q.y+"px"});}}));this.connect(this.uploadDropTarget,"click",lang.hitch(this,function(_b5a){this.positionRecordingOn=false;this.onImportCanceled();}));this.uploader.bind("OtherDrop",lang.hitch(this,function(_b5b,_b5c){this.positionRecordingOn=false;this.uploadErrorMessages="";this.setUploadTrackingMethod("web");this.onImportStarted();var dt=_b5c.dataTransfer;var html=dt.getData("text/html");var _b5d=dt.getData("text/uri-list");window.setTimeout(lang.hitch(this,function(){var src,uris;if(html){var _b5e=/<img[^>]+src\s*=\s*(?:'([^'>]+)'|"([^>"]+)")/g;var _b5f;var _b60=[];while((_b5f=_b5e.exec(html))!==null){var t=_b5f[1]||_b5f[2];if(t){_b60.push(t);}}if(_b60.length>0){uris=_b60;}if(!src&&!uris){uris=dojo.query("img",dojo.toDom(html)).attr("src")[0];}}if(src){uris=[src];}else{if(!uris){var _b61=_b5d.split(/\r?\n/g);uris=dojo.filter(_b61,function(line){return line.charAt(0)!=="#"&&line!=="";});}}this.downloadByUrls(_b5b.settings.args,uris);}),0);}));},_connectUploaderEvents:function(){this.uploader.bind("FilesAdded",lang.hitch(this,function(_b62,_b63){this.positionRecordingOn=false;this.uploadErrorMessages="";this.onImportStarted();window.setTimeout(function(){_b62.start();},1);}));this.uploader.bind("UploadFile",lang.hitch(this,function(_b64,file){if(!this.uploader.settings.args.importPositionY){this.setUploaderImportPosition(this.getImportPosition());}this.uploader.settings.args.importZIndex=this.getImportZIndex();}));this.uploader.bind("UploadProgress",lang.hitch(this,function(_b65,file){if(_b65&&_b65.total&&_b65.total.percent){this.onUploadProgress(_b65.total.percent);}}));this.uploader.bind("FileUploaded",lang.hitch(this,function(_b66,file,_b67){this.incrementImportdata(_b66.settings.args);var _b68=dojo.fromJson(_b67.response).uploadId;this._fileIdToUploadIdMap[file.id]=_b68;this._getWaitForImportDeferred(_b68);}));this.uploader.bind("UploadComplete",lang.hitch(this,function(_b69,_b6a){this.setUploaderImportPosition({x:0,y:0});if(_b69&&_b69.total&&_b69.total.uploaded>0){this.onConversionProgress();}var _b6b=dojo.map(_b6a,lang.hitch(this,function(file){return this._fileIdToUploadIdMap[file.id];}));var _b6c=dojo.map(_b6b,lang.hitch(this,function(_b6d){return this._getWaitForImportDeferred(_b6d);}));var _b6e=new dojo.DeferredList(_b6c);_b6e.addCallback(lang.hitch(this,function(_b6f){var _b70=dojo.every(_b6f,function(_b71){return _b71[0];});if(_b70){this.onImportSuccessfull();}}));_b6e.addErrback(lang.hitch(this,function(obj){this.onImportFailed(_b46("import_conversion_failed"));}));}));this.uploader.bind("Error",lang.hitch(this,function(_b72,_b73){console.warn("FileUpload Error: ",_b73);var _b74=_b46("import_upload_fail_unknown");if(_b73&&_b73.file){_b74=_b46("import_upload_fail_w_details",[_b73.file.name,_b73.status]);}else{if(_b73){_b74=_b46("import_upload_fail_w_status",[_b73.status]);}}this.uploadErrorMessages+=_b74+" ";if(_b72&&_b72.total&&_b72.total.queued>1){return;}this.onImportFailed(this.uploadErrorMessages);}));},_getWaitForImportDeferred:function(_b75){if(!this._importStartedDeferreds.hasOwnProperty(_b75)){this._importStartedDeferreds[_b75]=new dojo.Deferred();}return this._importStartedDeferreds[_b75];},getImportPosition:function(){var ret=new wp.Point(0,0);if(sp.global.pad){ret=new wp.Point(sp.global.pad.surface.getPositionForNewImports());}return ret.toIntCoordinates();},setUploaderImportPosition:function(p,_b76){this.uploader.settings.args.importPositionX=Math.round(p.x);this.uploader.settings.args.importPositionY=Math.round(p.y)-(_b76?this.DEFAULT_IMPORT_Y_OFFSET:0);},getImportZIndex:function(){return sp.global.pad?sp.global.pad.container._itemMap.getNextMaxZ():0;},incrementImportdata:function(args){args.importPositionX+=50;args.importPositionY+=50;args.importZIndex=this.getImportZIndex();},downloadByUrls:function(_b77,uris){var self=this;var _b78=new dojo.Deferred();_b78.resolve(true);var _b79=[];dojo.forEach(uris,function(uri){_b78=_b78.then(function(){return sp.ajax.getInstance().uploadByUrl(dojo.mixin({},_b77,{url:uri})).then(function(_b7a){_b79.push(_b7a.uploadId);self._getWaitForImportDeferred(_b7a.uploadid);self.incrementImportdata(_b77);});});},this);_b78.then(function(){return true;},function(){return true;}).then(dojo.hitch(this,function(){if(_b79.length===0){self.onImportFailed();}else{dojo.promise.all(dojo.map(_b79,this._getWaitForImportDeferred,this)).then(function(){window.setTimeout(function(){self.onImportSuccessfull();},1);},function(){self.onImportFailed();});}}));},importClipboardData:function(_b7b){if(_b7b&&_b7b.items&&_b7b.items.length>0){var _b7c=lang.hitch(this,this._uploadClipboardDataItemAsString);for(var i=0;i<_b7b.items.length;i++){var item=_b7b.items[i];var mime=item.type;if(item.kind==="file"&&mime==="image/png"){try{var file=item.getAsFile();this._uploadClipboardDataItemAsFile(file,mime);}catch(e){console.warn("getting a file from clipboard api didn't work; mime = ["+mime+"]",e);}}else{if(item.kind==="string"&&mime==="text/plain"){try{item.getAsString(_b7c);}catch(e){console.warn("getting a string from clipboard api didn't work; mime = ["+mime+"]",e);}}else{console.warn("pasting a binary of type = ["+item.kind+"] and mime = ["+mime+"] stopped");}}}}},_uploadClipboardDataItemAsString:function(_b7d){var str=_b7d&&_b7d.trim?_b7d.trim():"";if(str.length&&str.length>0){sp.global.analytics.trackEvent("board insert","paste text from os clipboard");sp.global.pad.controller.insertStringAsDefaultStickyNote(str);}else{console.warn("pasting a string of size 0 stopped");}},_uploadClipboardDataItemAsFile:function(file,mime){if(!this.uploader.cbUploadFile){console.error("plupload broken: uploader.cbUploadFile function not specified!");return;}var _b7e=file.fileSize||file.size;if(_b7e>0){this.setUploaderImportPosition(sp.global.pad.surface.getPositionCenter(),true);var _b7f=_b7e*2;var _b80=Math.round(Math.sqrt(_b7f)/2);this.uploader.settings.args.importPositionX-=_b80;this.uploader.settings.args.importPositionY-=_b80;this.setUploadTrackingMethod("os clipboard");this.uploader.cbUploadFile(file);}else{console.warn("pasting a binary of size 0 stopped; mime = ["+mime+"]");}}});});},"wp/common/MathsHelper":function(){define("wp/common/MathsHelper",["dijit","dojo","dojox","dojo/require!wp/SimpleObjects,dojox/math/matrix"],function(_b81,dojo,_b82){dojo.provide("wp.common.MathsHelper");dojo.require("wp.SimpleObjects");dojo.require("dojox.math.matrix");(function(){var MH=wp.common.MathsHelper;var _b83=Math.round;var _b84=Math.pow;var _b85=Math.sin;var _b86=Math.cos;var _b87=Math.PI/2;var _b88=Math.PI/4;var _b89=Math.PI/6;var _b8a=Math.PI/8;dojo.mixin(MH,{vector:function(x,y){return {x:x,y:y};},vectLen:function(v){return Math.sqrt(v.x*v.x+v.y*v.y);},unitVect:function(c){var l=MH.vectLen(c);return MH.vector(c.x/l,c.y/l);},vectDelta:function(a,b){return MH.vector(a.x-b.x,a.y-b.y);},vectScale:function(c,f){return MH.vector(c.x*f,c.y*f);},vectAdd:function(a,b){return MH.vector(a.x+b.x,a.y+b.y);},vectRotate:function(v,a){return MH.vector(v.x*Math.cos(a)-v.y*Math.sin(a),v.x*Math.sin(a)+v.y*Math.cos(a));},vectCross:function(a,b){return a.x*b.y-a.y*b.x;},vectAngle:function(d){return Math.atan((1*d.y)/d.x);},vectAngleBetween:function(a,b){return Math.acos((a.x*b.x+a.y*b.y)/(MH.vectLen(a)*MH.vectLen(b)));},vectOrient:function(p,a,b,q){var _b8b=MH.unitVect(MH.vectDelta(a,b));var _b8c=MH.unitVect(MH.vectDelta(a,p));var _b8d=MH.unitVect(MH.vectDelta(a,q));return MH.vectCross(_b8b,_b8c)*MH.vectCross(_b8b,_b8d);},averagePoint:function(l){var x=0;var y=0;for(var i=0;i<l.length;i++){x+=l[i].x;y+=l[i].y;}return MH.vector(x/l.length,y/l.length);},recognizeCorners:function(_b8e,_b8f,_b90){if(_b8e.length!=0){throw new Error("illegal argument");}_b90.box=new wp.BBox(_b8f[0],_b8f[0]);for(var i=1;i<_b8f.length;i++){_b90.box.expand(_b8f[i]);}var _b91=Math.min(_b90.box.getWidth(),_b90.box.getHeight())/3;var _b92=10;var _b93=_b8a;_b8e.push(_b8f[0]);var _b94=_b8f[0];for(var i=1;i<_b8f.length-2;i++){var pt=_b8f[i];var d=MH.vectDelta(_b94,pt);if(MH.vectLen(d)>_b92){var ac1=Math.abs(MH.vectAngleBetween(MH.vectDelta(pt,_b8f[i+1]),d));var ac2=Math.abs(MH.vectAngleBetween(MH.vectDelta(pt,_b8f[i+2]),d));if(ac1>_b93&&ac2>_b93){_b8e.push(pt);_b94=pt;}}}var _b95=MH.vectLen(MH.vectDelta(_b8f[_b8f.length-1],_b8f[0]))<_b91;if(_b95){if(_b8e.length>2){_b8e.push(_b8f[0]);return true;}else{return false;}}else{_b8e.push(_b8f[_b8f.length-1]);return false;}},recognizeSingleAlignment:function(_b96,_b97){var _b98=MH.fixSingleAlignment(_b96);if(!_b98){return false;}_b97.box=new wp.BBox(_b98[0],_b98[1]);return true;},fixSingleAlignment:function(_b99){if(_b99.length!==2){return null;}var p1=_b99[0];var p2=_b99[1];var _b9a=MH.vectDelta(p1,p2);var _b9b=Math.abs(MH.vectAngle(_b9a));if(_b9b>_b87-0.1){return [{x:(p1.x+p2.x)/2,y:p1.y},{x:(p1.x+p2.x)/2,y:p2.y}];}else{if(_b9b<0.1){return [{x:p1.x,y:(p1.y+p2.y)/2},{x:p2.x,y:(p1.y+p2.y)/2}];}else{return null;}}},recognizeRectangle:function(_b9c,_b9d,_b9e,_b9f){if(_b9d&&_b9c.length==5){var p1=_b9c[0];var p2=_b9c[1];var p3=_b9c[2];var p4=_b9c[3];var p1p2=MH.vectDelta(p1,p2);var p2p3=MH.vectDelta(p2,p3);var p3p4=MH.vectDelta(p3,p4);var p4p1=MH.vectDelta(p4,p1);if((Math.abs(MH.vectAngleBetween(p1p2,p2p3)-_b87))<_b89&&(Math.abs(MH.vectAngleBetween(p2p3,p3p4)-_b87))<_b89&&(Math.abs(MH.vectAngleBetween(p3p4,p4p1)-_b87))<_b89&&(Math.abs(MH.vectAngleBetween(p4p1,p1p2)-_b87))<_b89){var p1p3=MH.vectDelta(p1,p3);var p2p4=MH.vectDelta(p2,p4);var diag=(MH.vectLen(p1p3)+MH.vectLen(p2p4))/4;var _ba0=MH.vectScale(MH.unitVect(p1p3),-diag);var _ba1=MH.vectScale(MH.unitVect(p2p4),-diag);var _ba2=MH.averagePoint([p1,p2,p3,p4]);_b9f[0]=MH.vectAdd(_ba2,_ba0);_b9f[1]=MH.vectAdd(_ba2,_ba1);_b9f[2]=MH.vectAdd(_ba2,MH.vectScale(_ba0,-1));_b9f[3]=MH.vectAdd(_ba2,MH.vectScale(_ba1,-1));_b9f[4]=MH.vectAdd(_ba2,_ba0);var _ba3=MH.vectDelta(_b9f[0],_b9f[1]);var _ba4=Math.abs(Math.abs(Math.abs(MH.vectAngle(_ba3))-_b88)-_b88);if(_ba4<0.2){_b9e.box=new wp.BBox(p1,p2);_b9e.box.expand(p3);_b9e.box.expand(p4);return true;}}}return false;},recognizeEllipse:function(_ba5,_ba6,_ba7){if(_ba6&&!_ba7&&_ba5.length>=5){var _ba8=[];for(var i=1;i<_ba5.length-2;i++){_ba8.push(MH.vectOrient(_ba5[i-1],_ba5[i],_ba5[i+1],_ba5[i+2]));}i=_ba5.length-2;_ba8.push(MH.vectOrient(_ba5[i-1],_ba5[i],_ba5[i+1],_ba5[1]));i=_ba5.length-1;_ba8.push(MH.vectOrient(_ba5[i-1],_ba5[i],_ba5[1],_ba5[2]));var _ba9=true;var _baa=0;for(var i=0;i<_ba8.length;i++){var _bab=_ba8[i];if(Math.abs(_bab)>0.1){var _bac=_bab>0?1:-1;if(_baa==0){_baa=_bac;}else{if(_baa!=_bac){_ba9=false;}}}}return _ba9;}return false;},recognizeZickzack:function(_bad,_bae){if(!_bae&&_bad.length>2&&_bad.length<5){var _baf=[];var _bb0="";var _bb1=null;var _bb2=null;for(var i=1;i<_bad.length-1;i++){var _bb3=MH.vectDelta(_bad[i-1],_bad[i]);var _bb4=MH.vectDelta(_bad[i],_bad[i+1]);var _bb5=MH.vectAngleBetween(_bb3,_bb4);_baf.push(_bb5);_bb0+=_bb5+" ";_bb1=_bb1?Math.max(_bb1,_bb5):_bb5;_bb2=_bb2?Math.min(_bb2,_bb5):_bb5;}if(_bb2>_b87){return true;}}return false;},calculateArrowHead:function(a,b,_bb6){var _bb7=0.5;var vX=b.x-a.x;var vY=b.y-a.y;var vL=Math.sqrt(vX*vX+vY*vY);if(vL<0.000001){return null;}var _bb8=vY>0?1:-1;var beta=Math.asin(vX/vL)*_bb8;var _bb9=beta-_bb7;var rX=vX-(_b85(_bb9)*_bb6*_bb8);var rY=vY-(_b86(_bb9)*_bb6*_bb8);var _bba=beta+_bb7;var lX=vX-(_b85(_bba)*_bb6*_bb8);var lY=vY-(_b86(_bba)*_bb6*_bb8);var _bbb=new wp.PointArray();_bbb.add(new wp.Point(rX,rY));_bbb.add(new wp.Point(lX,lY));return _bbb;},convertPointArrayToLinePathListWithSharpCorr:function(pa,a){var _bbc=(pa&&pa.points)?pa.points.length:0;if(_bbc===0){return [a.x+0.5,a.y+0.5];}var ret=[];var i=0;while(i<_bbc){var _bbd=pa.points[i];ret.push(_bbd.x+0.5);ret.push(_bbd.y+0.5);i++;}return ret;},convertPointArrayToCurvePathListV1:function(pa,a){},convertPointArrayToCurvePathListV2:function(pa,a){var _bbe=(pa&&pa.points)?pa.points.length:0;if(_bbe===0){return [a.x,a.y,a.x,a.y,a.x,a.y];}var _bbf=null;var _bc0=0.33;var ret=[];var i=0;while(i<_bbe){var _bc1=i===0?a:pa.points[i-1];var _bc2=pa.points[i];var _bc3=i<_bbe-1?pa.points[i+1]:null;var _bc4=MH.distanceAbs(_bc1,_bc2)*_bc0;var _bc5=null;if(i===0){_bc5=_bc1;}else{_bc5=MH.calculateCtrlPoint(_bbf,_bc4,_bc1,_bc2);}var _bc6=null;if(i===_bbe-1){_bc6=pa.points[i];}else{var _bc7=MH.linSlope(_bc1,_bc3);var _bc8=MH.perpendicularSlope(_bc7);_bbf=MH.intersectLines(_bc1,_bc7,_bc2,_bc8);_bc6=MH.calculateCtrlPoint(_bbf,_bc4,_bc2,_bc1);}ret.push(_b83(_bc5.x));ret.push(_b83(_bc5.y));ret.push(_b83(_bc6.x));ret.push(_b83(_bc6.y));ret.push(_bc2.x);ret.push(_bc2.y);i++;}return ret;},convertPointArrayToCurvePathListV3:function(pa,a){return pa.points;},convertPointArrayToCurvePathListV4:function(pa,a){var _bc9=[];var _bca=sp.global.ctrlPointDistance?sp.global.ctrlPointDistance:0.33;var _bcb=Math.PI*(sp.global.thresholdAngle?sp.global.thresholdAngle:0.55);var _bcc=[];_bcc.push({x:a.x,y:a.y});_bcc=(pa&&pa.points)?_bcc.concat(pa.points):_bcc;var i=1;var _bcd=_bcc[0];var _bce=null;while(i<_bcc.length){var _bcf=_bcc[i-1];var _bd0=_bcc[i];var _bd1=i+1<_bcc.length?_bcc[i+1]:null;var _bd2=MH.distanceAbs(_bcf,_bd0)*_bca;if(i>1){if(_bce.x==_bcf.x&&_bce.y==_bcf.y){_bcd=_bce;}else{_bcd=MH.reflectPointAtPointAndScale(_bce,_bcf,_bd2);}}if(_bd1==null){_bce=_bd0;}else{var _bd3=MH.vectDelta(_bcf,_bd0);var _bd4=MH.vectDelta(_bd1,_bd0);var _bd5=MH.vectAngleBetween(_bd3,_bd4);if(_bd5<_bcb){_bce=_bd0;}else{var _bd6=MH.linSlope(_bcf,_bd1);var _bd7=MH.perpendicularSlope(_bd6);var _bd8=MH.intersectLines(_bcf,_bd6,_bd0,_bd7);_bce=MH.calculateCtrlPoint(_bd8,_bd2,_bd0,_bcf);}}_bc9.push(_bcd.x);_bc9.push(_bcd.y);_bc9.push(_bce.x);_bc9.push(_bce.y);_bc9.push(_bd0.x);_bc9.push(_bd0.y);i++;}return _bc9;},convertPointArrayToCurvePathListV5:function(pa,a){return MH.convertPointArrayToCurvePathListV4(pa,a);},calculateCtrlPoint:function(_bd9,_bda,_bdb,_bdc){var _bdd=MH.distanceV(_bd9,_bdc);var _bde=MH.distanceAbs(_bd9,_bdc);if(_bde<0.01){_bde=0.01;}var _bdf=_bda/_bde;return {x:_bdb.x+_bdd.x*_bdf,y:_bdb.y+_bdd.y*_bdf};},meanPoint:function(p1,p2){return {x:(p1.x+p2.x)/2,y:(p1.y+p2.y)/2};},reflectPointAtPoint:function(p1,p2){return {x:p2.x+p2.x-p1.x,y:p2.y+p2.y-p1.y};},reflectPointAtPointAndScale:function(p1,p2,_be0){var _be1=MH.distanceV(p1,p2);var _be2=MH.unitVect(_be1);return {x:p2.x+_be2.x*_be0,y:p2.y+_be2.y*_be0};},distanceV:function(p1,p2){return {x:p2.x-p1.x,y:p2.y-p1.y};},distanceAbs:function(p1,p2){return Math.sqrt(_b84(p2.x-p1.x,2)+_b84(p2.y-p1.y,2));},linSlope:function(p1,p2){if(p2.x==p1.x){return null;}else{return (p2.y-p1.y)/(p2.x-p1.x);}},perpendicularSlope:function(m1){if(m1===null){return 0;}else{if(m1===0){return null;}else{return -1/m1;}}},linValue:function(p1,m,x){return p1.y+m*(x-p1.x);},intersectLines:function(fp1,fm,gp1,gm){var ret=null;if(fm==gm){ret=MH.meanPoint(fp1,gp1);}else{if(fm===null){var x=fp1.x;ret={x:x,y:MH.linValue(gp1,gm,x)};}else{if(gm===null){var x=gp1.x;ret={x:x,y:MH.linValue(fp1,fm,x)};}else{var x=(gp1.y-fp1.y-gm*gp1.x+fm*fp1.x)/(fm-gm);ret={x:x,y:MH.linValue(fp1,fm,x)};}}}return ret;},zoomInt:function(x,_be3){var ret=x*_be3;return ret!==0?ret:1;},zoomX:function(x,_be4,_be5){return MH.zoomInt(x,_be4)+_be5.x;},zoomY:function(y,_be6,_be7){return MH.zoomInt(y,_be6)+_be7.y;},zoomPoint:function(a,_be8,_be9){return {x:MH.zoomX(a.x,_be8,_be9),y:MH.zoomY(a.y,_be8,_be9)};},zoomPointArray:function(pa,_bea,_beb){var ret=new wp.PointArray();var _bec=pa.points;var _bed=_bec.length;for(var i=0;i<_bed;i++){ret.add(MH.zoomPoint(_bec[i],_bea,_beb));}return ret;},simplifyPath:function(_bee,_bef){var arr=MH.douglasPeucker(_bee,_bef);arr.push(_bee[_bee.length-1]);return arr;},douglasPeucker:function(_bf0,_bf1){var _bf2=[];if(_bf0.length<=2){return [_bf0[0]];}var _bf3=_bf0[0];var _bf4=_bf0[_bf0.length-1];var _bf5=0;var _bf6=0;for(var i=1;i<=_bf0.length-2;i++){var _bf7=MH.douglasPeuckerDistanceToPoint(_bf3,_bf4,_bf0[i]);if(_bf7>_bf5){_bf5=_bf7;_bf6=i;}}if(_bf5>=_bf1){_bf2=_bf2.concat(MH.douglasPeucker(_bf0.slice(0,_bf6+1),_bf1));_bf2=_bf2.concat(MH.douglasPeucker(_bf0.slice(_bf6,_bf0.length),_bf1));}else{_bf2=[_bf0[0]];}return _bf2;},douglasPeuckerDistanceToPoint:function(_bf8,_bf9,_bfa){var m=(_bf9.y-_bf8.y)/(_bf9.x-_bf8.x);if(isNaN(m)||!isFinite(m)){m=1;}var b=_bf8.y-(m*_bf8.x);var d=[];d.push(Math.abs(_bfa.y-(m*_bfa.x)-b)/Math.sqrt(Math.pow(m,2)+1));d.push(Math.sqrt(Math.pow((_bfa.x-_bf8.x),2)+Math.pow((_bfa.y-_bf8.y),2)));d.push(Math.sqrt(Math.pow((_bfa.x-_bf9.x),2)+Math.pow((_bfa.y-_bf9.y),2)));return d.sort(function(a,b){return (a-b);})[0];}});})();});},"wp/data/item/TxtEItem":function(){define("wp/data/item/TxtEItem",["dijit","dojo","dojox","dojo/require!wp/data/Item"],function(_bfb,dojo,_bfc){dojo.provide("wp.data.item.TxtEItem");dojo.require("wp.data.Item");dojo.declare("wp.data.item.TxtEItem",wp.data.Item,{constructor:function(map){this.type="txtE";this.isWidget=true;},drawWidget:function(){},json:function(){return {"type":this.type,"subtype":this.subtype,"del":this.del,"id":this.id,"txtGId":this.txtGId,"seq":this.seq,"text":this.text,"authorid":this.authorid,"origAuthorid":this.origAuthorid,"origSeq":this.origSeq,"origDte":this.origDte,"dte":this.dte};}});});},"dojo/dnd/Avatar":function(){define(["../_base/declare","../_base/window","../dom","../dom-attr","../dom-class","../dom-construct","../hccss","../query"],function(_bfd,win,dom,_bfe,_bff,_c00,has,_c01){return _bfd("dojo.dnd.Avatar",null,{constructor:function(_c02){this.manager=_c02;this.construct();},construct:function(){var a=_c00.create("table",{"class":"dojoDndAvatar",style:{position:"absolute",zIndex:"1999",margin:"0px"}}),_c03=this.manager.source,node,b=_c00.create("tbody",null,a),tr=_c00.create("tr",null,b),td=_c00.create("td",null,tr),k=Math.min(5,this.manager.nodes.length),i=0;if(has("highcontrast")){_c00.create("span",{id:"a11yIcon",innerHTML:this.manager.copy?"+":"<"},td);}_c00.create("span",{innerHTML:_c03.generateText?this._generateText():""},td);_bfe.set(tr,{"class":"dojoDndAvatarHeader",style:{opacity:0.9}});for(;i<k;++i){if(_c03.creator){node=_c03._normalizedCreator(_c03.getItem(this.manager.nodes[i].id).data,"avatar").node;}else{node=this.manager.nodes[i].cloneNode(true);if(node.tagName.toLowerCase()=="tr"){var _c04=_c00.create("table"),_c05=_c00.create("tbody",null,_c04);_c05.appendChild(node);node=_c04;}}node.id="";tr=_c00.create("tr",null,b);td=_c00.create("td",null,tr);td.appendChild(node);_bfe.set(tr,{"class":"dojoDndAvatarItem",style:{opacity:(9-i)/10}});}this.node=a;},destroy:function(){_c00.destroy(this.node);this.node=false;},update:function(){_bff.toggle(this.node,"dojoDndAvatarCanDrop",this.manager.canDropFlag);if(has("highcontrast")){var icon=dom.byId("a11yIcon");var text="+";if(this.manager.canDropFlag&&!this.manager.copy){text="< ";}else{if(!this.manager.canDropFlag&&!this.manager.copy){text="o";}else{if(!this.manager.canDropFlag){text="x";}}}icon.innerHTML=text;}_c01(("tr.dojoDndAvatarHeader td span"+(has("highcontrast")?" span":"")),this.node).forEach(function(node){node.innerHTML=this.manager.source.generateText?this._generateText():"";},this);},_generateText:function(){return this.manager.nodes.length.toString();}});});},"wp/Pad":function(){define("wp/Pad",["dojo","dijit","dojox","cb/page/pad/FollowViewportTracker","cb/page/pad/UserColorTracker","cb/page/pad/WindowTitleManager","cb/board/tutorial/TutorialController","cb/widget/BoardCheatSheetDialog","cb/util","dojox/gfx","wp/ConnectivityDialogManager","wp/data/ItemFactory","wp/data/Container","wp/handler/Controller","wp/surface/Drawer","wp/surface/Surface","wp/widget/Propbar","cb/board/toolbar/SecondaryToolbar","wp/widget/Sidebar","wp/widget/Minimap","cb/board/itemui/SimpleTxtDiv","cb/board/itemui/CommentTxtDiv","wp/widget/TemporaryDiv","wp/widget/TaskStatusDialog","sp/err","sp/EditSessionMessageCreator","wp/BayeuxConnector"],function(dojo,_c06,_c07,_c08,_c09,_c0a,_c0b,_c0c,util){var _c0d=util.randomString;return dojo.declare("wp.Pad",null,{isAntiTextSelection:true,factory:null,container:null,drawer:null,controller:null,propbarWidget:null,sidebar:null,_editSessionMessageCreator:null,_newAndEmptySubscriptions:null,_showMinimapOnceSubscription:null,participantManager:null,borderContainer:null,constructor:function(_c0e){dojo.mixin(this,_c0e);this._newAndEmptySubscriptions=[];this._itemIdClientPrefix=_c0d(5)+"-";this._itemIdCounter=0;this._editSessionMessageCreator=new sp.EditSessionMessageCreator({errHandler:dojo.global.sm_err});this.factory=new wp.data.ItemFactory();this.container=new wp.data.Container({pad:this,documentId:this.documentId});this.surface=new wp.surface.Surface(this,this.underlayNodeId);this.controller=new wp.handler.Controller(this);this.sidebar=new wp.widget.Sidebar({pad:this},dojo.byId("outline-container"));this.minimap=new wp.widget.Minimap({controller:this.controller},dojo.create("div",{"class":"minimap-container"},dojo.byId("borderContainer"),"after"));this.propbarWidget=new wp.widget.Propbar({controller:this.controller,container:this.container,documentId:this.documentId,sidebar:this.sidebar},dojo.byId(this.propbarNodeId));this.secondaryToolbarWidget=new cb.board.toolbar.SecondaryToolbar({controller:this.controller,container:this.container},dojo.byId("secondarytoolbar"));this.drawer=new wp.surface.Drawer(this.surface,this.sidebar,this,!sp.isTouchOnly);this.tutorialController=new _c0b();this.surface.whenLoaded(this,"_initAfterSurfaceLoading");},_initAfterSurfaceLoading:function(){this._removeLoadingGif();this.surface.rebuild();this.drawer.startup();if(!this.showWelcomeDialog){new wp.ConnectivityDialogManager();this.connectBayeux();dojo.publish("/sp/ajax/connectivityStatus",["SURFACE-LOADED"]);var _c0f=dojo.queryToObject(dojo.hash());if(sp.info.user.info.showTutorial!==false&&!_c0f.hasOwnProperty("tutorial")){var _c10=new _c0c();_c10.show();}}this.propbarWidget.startup();this._registerNewAndEmptyUnderlayHandling();if(sp.info.padConfig.startNewAndEmpty){this.surface.startNewAndEmpty();dojo.publish("requests/cb/board/currenttoolchange",["TOOL_SHAPE_FREELINE","CREATE"]);this._showMinimapOnceSubscription=dojo.subscribe("/sp/items/newOrUpdatedVisibleItem",this,"_showMinimapOnce");}else{dojo.publish("requests/cb/board/currenttoolchange",["TOOL_HAND","DISCUSS"]);this.minimap.show();}this.sidebar.startup();_c0a.start(this.documentId);_c08.init({surface:this.surface,controller:this.controller,documentId:this.documentId});},_removeLoadingGif:function(){dojo.style(dojo.doc.documentElement,"backgroundImage","url(/_/images/blank_1x1.png)");dojo.style(dojo.doc.documentElement,"backgroundColor","#ffffff");dojo.style(dojo.doc.body,"background","none");window.setTimeout(function(){dojo.style(dojo.doc.documentElement,"overflow","visible");window.setTimeout(function(){dojo.style(dojo.doc.documentElement,"overflow","hidden");},250);},250);},_registerNewAndEmptyUnderlayHandling:function(){this._newAndEmptySubscriptions.push(dojo.subscribe("/sp/pad/controller/mousedown",this,"_hideNewAndEmptyUnderlay"));this._newAndEmptySubscriptions.push(dojo.subscribe("/sp/ajax/incoming/dedicatedPadItems",this,"_hideNewAndEmptyUnderlay"));},_hideNewAndEmptyUnderlay:function(){this.surface.hideNewAndEmpty();if(this._newAndEmptySubscriptions){var i;for(i=0;i<this._newAndEmptySubscriptions.length;i++){dojo.unsubscribe(this._newAndEmptySubscriptions[i]);this._newAndEmptySubscriptions[i]=null;}this._newAndEmptySubscriptions.length=0;this._newAndEmptySubscriptions=[];}},_showMinimapOnce:function(item){if(this._showMinimapOnceSubscription&&item&&item.type=="image"){dojo.unsubscribe(this._showMinimapOnceSubscription);this._showMinimapOnceSubscription=null;setTimeout(dojo.hitch(this.minimap,"show"),500);}},getPosition:function(_c11){return this.surface.getPosition(_c11);},getPositionXY:function(_c12,_c13){return this.surface.getPositionXY(_c12,_c13);},generateItemId:function(){return sp.info.padConfig.itemIdPrefix+this._itemIdClientPrefix+this._itemIdCounter++;},connectBayeux:function(){if(!sp.global.bayeux){sp.global.bayeux=new wp.BayeuxConnector({bayeuxurl:sp.info.app.baseUrl+"__/cometd",documenteditkey:sp.info.document.document.currentLocation.editKey});sp.global.bayeux.setSubscriptionHandler("/pad/"+sp.info.document.id+"/items",function(_c14){var item=null;try{item=dojo.fromJson(_c14.data);if(!item||!item.type||!item.type.length){console.error("onBayeuxItem: Item has no type",item);}else{var type=item.type;if(type=="ellipse"||type=="freeLine"||type=="image"||type=="line"||type=="rectangle"||type=="text"||type=="headline"||type=="txtE"||type=="txtG"||type=="group"){dojo.publish("/sp/ajax/incoming/dedicatedPadItems",[[item]]);}else{dojo.publish("/sp/ajax/incoming/"+type,[item]);}}}catch(e){console.error("Error in Bayeux Handling",e,item);}});sp.global.bayeux.startup();dojo.subscribe("/sp/ajax/connectivityStatus",this,"prepareFullyInitiated");}else{console.warn("Trying to start second bayeux!");}dojo.subscribe("/sp/ajax/incoming/msgItem",function(_c15){if(!_c15){console.warn("_handleMsgItem ignoring non msgItem",_c15);return;}if(!dojo.isString(_c15.type)){console.warn("_handleMsgItem ignoring msgItem without type",_c15);return;}if(_c15.type!="msgItem"){console.warn("_handleMsgItem ignoring msgItem with wrong type"+_c15.type,_c15);return;}if(!_c15.msgItem){console.warn("_handleMsgItem ignoring msgItem without contained Msg",_c15);return;}dojo.global.err.handleMessage(_c15.msgItem);});},prepareFullyInitiated:function(_c16){if(_c16==="BAYEUX-FULLY-INITIATED"){this.container.sendFullyInitiatedOnNextEmptyRun();}else{if(_c16==="CONTAINER-FULLY-INITIATED"){this.drawer.sendFullyInitiatedOnNextEmptyRun();}else{if(_c16==="DRAWER-FULLY-INITIATED"){window.setTimeout(dojo.hitch(this,function(){dojo.publish("/sp/ajax/connectivityStatus",["FULLY-INITIATED"]);}),250);}}}}});});},"dojox/cometd/ack":function(){define("dojox/cometd/ack",["org/cometd/AckExtension","dojox/cometd"],function(_c17,_c18){var _c19=new _c17();_c18.registerExtension("ack",_c19);return _c19;});},"dojo/dnd/move":function(){define(["../_base/declare","../dom-geometry","../dom-style","./common","./Mover","./Moveable"],function(_c1a,_c1b,_c1c,dnd,_c1d,_c1e){var _c1f=_c1a("dojo.dnd.move.constrainedMoveable",_c1e,{constraints:function(){},within:false,constructor:function(node,_c20){if(!_c20){_c20={};}this.constraints=_c20.constraints;this.within=_c20.within;},onFirstMove:function(_c21){var c=this.constraintBox=this.constraints.call(this,_c21);c.r=c.l+c.w;c.b=c.t+c.h;if(this.within){var mb=_c1b.getMarginSize(_c21.node);c.r-=mb.w;c.b-=mb.h;}},onMove:function(_c22,_c23){var c=this.constraintBox,s=_c22.node.style;this.onMoving(_c22,_c23);_c23.l=_c23.l<c.l?c.l:c.r<_c23.l?c.r:_c23.l;_c23.t=_c23.t<c.t?c.t:c.b<_c23.t?c.b:_c23.t;s.left=_c23.l+"px";s.top=_c23.t+"px";this.onMoved(_c22,_c23);}});var _c24=_c1a("dojo.dnd.move.boxConstrainedMoveable",_c1f,{box:{},constructor:function(node,_c25){var box=_c25&&_c25.box;this.constraints=function(){return box;};}});var _c26=_c1a("dojo.dnd.move.parentConstrainedMoveable",_c1f,{area:"content",constructor:function(node,_c27){var area=_c27&&_c27.area;this.constraints=function(){var n=this.node.parentNode,s=_c1c.getComputedStyle(n),mb=_c1b.getMarginBox(n,s);if(area=="margin"){return mb;}var t=_c1b.getMarginExtents(n,s);mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;if(area=="border"){return mb;}t=_c1b.getBorderExtents(n,s);mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;if(area=="padding"){return mb;}t=_c1b.getPadExtents(n,s);mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;return mb;};}});return {constrainedMoveable:_c1f,boxConstrainedMoveable:_c24,parentConstrainedMoveable:_c26};});},"cb/board/itemui/trelloHashtagFiller":function(){define(["dojo","dojo/ready","dojo/when","dojo/promise/all","cb/api","cb/Capabilities","sp/infos/InfoManager"],function(dojo,_c28,when,_c29,api,_c2a,_c2b){_c28(9000,function(){when(true).then(function(_c2c){return _c2c&&_c2a.checkFeature("trello.hashtags").then(function(_c2d){return _c2d==="enabled";});}).then(function(_c2e){return _c2e&&_c2b.getById({type:"socialconnections",id:sp.info.user.id}).then(function(_c2f){return dojo.some(_c2f.connections,function(_c30){return _c30.key.providerId==="trello";});});}).then(function(_c31){if(_c31){return api.Caching.hashtags.trello.get();}}).then(function(){}).otherwise(function(_c32){});});return function trelloHashtagFiller(_c33){return when(true).then(function(_c34){return _c34&&_c2a.checkFeature("trello.hashtags").then(function(_c35){return _c35==="enabled";});}).then(function(_c36){if(_c36){return _c2b.getById({type:"socialconnections",id:sp.info.user.id}).then(function(_c37){return dojo.some(_c37.connections,function(_c38){return _c38.key.providerId==="trello";});}).then(function(_c39){_c33.add({id:"trello_hashtags_loading",providerId:"trello",valid:false,displayname:"Loadinġ",type:"loading"});if(_c39){return api.Caching.hashtags.trello.get().then(api.Util.data).then(function(_c3a){return _c29(dojo.map(_c3a,function(tag){tag=dojo.delegate(tag);tag.valid=true;tag.sortKey=tag.displayname.toLocaleLowerCase();return when(_c33.put(tag));}));});}else{return when(_c33.add({id:"trello_unavailable",providerId:"trello",type:"social_provider_unavailable",valid:false}));}}).otherwise(function(){return when(_c33.add({id:"trello_unavailable",providerId:"trello",type:"error",valid:false}));}).always(function finishedLoading(){return when(_c33.remove("trello_hashtags_loading"));});}else{}});};});},"wp/common/TransformHelper":function(){define("wp/common/TransformHelper",["dijit","dojo","dojox"],function(_c3b,dojo,_c3c){dojo.provide("wp.common.TransformHelper");dojo.mixin(wp.common.TransformHelper,{transformItem:function(_c3d){var item=_c3d.item;var _c3e=_c3d.origItem;var _c3f=_c3d.factorXY;var _c40=_c3d.deltaXY;var _c41=_c3d.attachDeltaXYOrNull;var p1=_c3d.originPoint;var _c42=_c3d.clippingDiffOrNull;if(_c42){this._applyClippingDifference(item,_c3e,_c42);}var facX=_c3f?_c3f.x:null;var facY=_c3f?_c3f.y:null;var delX=_c40?_c40.x:null;var delY=_c40?_c40.y:null;if(_c41){if(item.previewTransformMode==="SOURCE"&&item.a&&item.b){item.a.x=_c3e.a.x+_c41.x;item.a.y=_c3e.a.y+_c41.y;item.b.x=_c3e.b.x;item.b.y=_c3e.b.y;}return;}else{if(!_c3f||(facX===1&&facY===1)){if(item.a){item.a.x=_c3e.a.x;item.a.y=_c3e.a.y;}if(item.b){item.b.x=_c3e.b.x;item.b.y=_c3e.b.y;}if(item.pa&&item.pa.points){var _c43=item.pa.points.length;for(var i=0;i<_c43;i++){item.pa.points[i].x=_c3e.pa.points[i].x;item.pa.points[i].y=_c3e.pa.points[i].y;}}}else{if(item.a){if(item.previewTransformMode==="SOURCE"){item.a.x=_c3e.a.x;item.a.y=_c3e.a.y;}else{item.a.x=p1.x+Math.round((_c3e.a.x-p1.x)*facX);item.a.y=p1.y+Math.round((_c3e.a.y-p1.y)*facY);}}if(item.b){item.b.x=p1.x+Math.floor((_c3e.b.x-p1.x)*facX);item.b.y=p1.y+Math.floor((_c3e.b.y-p1.y)*facY);}if(item.pa&&item.pa.points){var _c43=item.pa.points.length;for(var i=0;i<_c43;i++){item.pa.points[i].x=p1.x+Math.floor((_c3e.pa.points[i].x-p1.x)*facX);item.pa.points[i].y=p1.y+Math.floor((_c3e.pa.points[i].y-p1.y)*facY);}}}}if(_c40&&(delX!==0||delY!==0)){if(item.a){if(item.previewTransformMode==="SOURCE"){}else{item.a.x+=delX;item.a.y+=delY;}}if(item.b){item.b.x+=delX;item.b.y+=delY;}if(item.pa&&item.pa.points){var _c43=item.pa.points.length;for(var i=0;i<_c43;i++){item.pa.points[i].x+=delX;item.pa.points[i].y+=delY;}}}if(item.a&&item.b&&_c3e.minWidth&&_c3e.minWidth>0){if(Math.abs(item.b.x-item.a.x)<_c3e.minWidth){if(Math.abs(_c3e.b.x-item.b.x)>=Math.abs(_c3e.a.x-item.a.x)){if(item.a.x<item.b.x){item.b.x=_c3e.a.x+_c3e.minWidth;}else{item.b.x=_c3e.a.x-_c3e.minWidth;}}else{if(item.a.x>item.b.x){item.a.x=_c3e.b.x+_c3e.minWidth;}else{item.a.x=_c3e.b.x-_c3e.minWidth;}}}}},_applyClippingDifference:function(item,_c44,cd){var _c45=_c44.clip?_c44.clip:{x1:0,y1:0,x2:1,y2:1};if(!item.clip){item.clip={x1:0,y1:0,x2:1,y2:1};}var _c46;var _c47=item.getFixedRotateDegree();var _c48=item.getUnclippedUnrotatedBBox();if(_c47===90){_c46={side1:cd.side2,side2:this._negIf(cd.side3),side3:cd.side4,side4:this._negIf(cd.side1)};}else{if(_c47===180){_c46={side1:this._negIf(cd.side3),side2:this._negIf(cd.side4),side3:this._negIf(cd.side1),side4:this._negIf(cd.side2)};}else{if(_c47===270){_c46={side1:this._negIf(cd.side4),side2:cd.side1,side3:this._negIf(cd.side2),side4:cd.side3};}else{_c46={side1:cd.side1,side2:cd.side2,side3:cd.side3,side4:cd.side4};}}}var _c49=0.03;var _c4a;if(this.isNumber(_c46.side1)){_c4a=_c46.side1/_c48.getWidth();item.clip.x2=Math.max(Math.min(_c45.x2+_c4a,1),_c45.x1+_c49);}else{if(this.isNumber(_c46.side2)){_c4a=_c46.side2/_c48.getHeight();item.clip.y2=Math.max(Math.min(_c45.y2+_c4a,1),_c45.y1+_c49);}else{if(this.isNumber(_c46.side3)){_c4a=_c46.side3/_c48.getWidth();item.clip.x1=Math.min(Math.max(_c45.x1+_c4a,0),_c45.x2-_c49);}else{if(this.isNumber(_c46.side4)){_c4a=_c46.side4/_c48.getHeight();item.clip.y1=Math.min(Math.max(_c45.y1+_c4a,0),_c45.y2-_c49);}}}}if(item.clip.x1<=0&&item.clip.x2>=1&&item.clip.y1<=0&&item.clip.y2>=1){item.clip=null;}},_negIf:function(num){if(this.isNumber(num)){return num*-1;}else{return undefined;}},isNumber:function(n){return !isNaN(parseFloat(n))&&isFinite(n);},getTransformedBBox:function(_c4b,_c4c,_c4d){var facX=_c4c?_c4c.x:null;var facY=_c4c?_c4c.y:null;var delX=_c4d?_c4d.x:null;var delY=_c4d?_c4d.y:null;var p1x=_c4b.p1.x;var p1y=_c4b.p1.y;var p2x=_c4b.p2.x;var p2y=_c4b.p2.y;if(_c4c&&(facX!=1||facY!=1)){p2x=_c4b.p1.x+Math.floor((_c4b.p2.x-_c4b.p1.x)*facX);p2y=_c4b.p1.y+Math.floor((_c4b.p2.y-_c4b.p1.y)*facY);}if(_c4d&&(delX!==0||delY!==0)){p1x+=delX;p1y+=delY;p2x+=delX;p2y+=delY;}return new wp.BBox({x:p1x,y:p1y},{x:p2x,y:p2y});}});});},"wp/surface/SurfaceAnimationAddOn":function(){define("wp/surface/SurfaceAnimationAddOn",["dijit","dojo","dojox","dojo/require!dojo/fx,dojo/hash,dojox/html/ext-dojo/style"],function(_c4e,dojo,_c4f){dojo.provide("wp.surface.SurfaceAnimationAddOn");dojo.require("dojo.fx");dojo.require("dojo.hash");dojo.require("dojox.html.ext-dojo.style");dojo.declare("wp.surface.SurfaceAnimationAddOn",null,{constructor:function(){this.scrollAnimation=null;},smoothScrollToBoxIfNeededWithZoomThresholds:function(_c50,_c51,_c52){var _c53=Math.max(Math.min(this.getZoomFactor(),_c52),_c51);var _c54=this.getZoomFactor()/_c53;var _c55=this.getViewportAsItemBBox();var _c56=_c55.getCenter();var _c57=_c55.getWidth()/2;var _c58=_c55.getHeight()/2;var _c59=new wp.BBox({x:_c56.x-_c57*_c54,y:_c56.y-_c58*_c54},{x:_c56.x+_c57*_c54,y:_c56.y+_c58*_c54});var _c5a=_c59.transformToContainBBox(_c50);this.smoothScrollToItemPos(_c5a.getCenter(),_c53);},smoothScrollToBoxIfNeeded:function(_c5b){var _c5c=40;var _c5d=this.getViewportAsItemBBox();var _c5e=(_c5b.getWidth()+_c5c)/_c5d.getWidth();var _c5f=(_c5b.getHeight()+_c5c)/_c5d.getHeight();if(_c5e<1.001&&_c5f<1.001){this.smoothScrollToBoxIfNeededWithZoomThresholds(_c5b,this.getZoomFactor(),this.getZoomFactor());}else{var _c60=this.getZoomFactor()/Math.max(_c5e,_c5f);this.smoothScrollToBoxIfNeededWithZoomThresholds(_c5b,_c60,_c60);}},smoothScrollToBoxAndCenter:function(_c61){},smoothScrollToItemId:function(_c62){var _c63=true;var _c64=40;if(!_c62){return;}var _c65=this.getViewportAsItemBBox();var _c66=this._pad.container.getBBox(_c62);if(!_c66){console.warn("no box yet for id "+_c62);return;}var _c67=(_c66.getWidth()+_c64)/_c65.getWidth();var _c68=(_c66.getHeight()+_c64)/_c65.getHeight();var _c69=this.getZoomFactor()/Math.max(_c67,_c68);var _c6a=null;var _c6b=null;if(_c67<1.001&&_c68<1.001&&!_c63){_c6a=_c66.getCenter();}else{if(_c67<1.001&&_c68<1.001&&_c63){_c6a=_c66.getCenter();_c6b=this.getZoomFactor()!=1?Math.min(_c69,1):null;}else{if(!_c63){_c6a=_c66.getTopCenter();}else{_c6a=_c66.getCenter();_c6b=_c69;}}}this.smoothScrollToItemPos(_c66.getCenter(),_c6b);},smoothScrollToBBox:function(bbox){if(!bbox){bbox=wp.BBox({x:0,y:0},{x:1,y:1});}var _c6c=bbox.getCenter();var _c6d={width:Math.max(bbox.getWidth(),this.getViewportWidth()),height:Math.max(bbox.getHeight(),this.getViewportHeight())};var _c6e=Math.min(this.getViewportWidth()/_c6d.width,this.getViewportHeight()/_c6d.height)*0.9;this.smoothScrollToItemPos(_c6c,_c6e);},smoothZoomToBBox:function(bbox){if(!bbox){bbox=wp.BBox({x:0,y:0},{x:1,y:1});}var _c6f=Math.min(this.getViewportWidth()/bbox.getWidth(),this.getViewportHeight()/bbox.getHeight());this.smoothScrollToItemPos(bbox.getCenter(),_c6f);},smoothScrollToItemPos:function(_c70,_c71){var _c72=this.getPositionCenter();var _c73=this.getZoomFactor();if(!_c71||_c71===0){_c71=1;}if(_c72.x===_c70.x&&_c72.y===_c70.y&&_c73===_c71){return;}if(this.scrollAnimation&&this.scrollAnimation.status()!=="stopped"){var _c74=this.scrollAnimation.controlEndPoint;var _c75=Math.sqrt(Math.pow(_c74.x-_c70.x,2)+Math.pow(_c74.y-_c70.y,2));if(_c75<50){return;}this.scrollAnimation.stop();}this.scrollAnimation=this._createScrollAnimation(_c72,_c73,_c70,_c71);this.scrollAnimation.play(1);},_createScrollAnimation:function(_c76,_c77,_c78,_c79){var _c7a=Math.sqrt(Math.pow(_c78.x-_c76.x,2)+Math.pow(_c78.y-_c76.y,2))*((_c77+_c79)/2);var _c7b=300;var _c7c=500;var _c7d=3000;var _c7e=Math.min(Math.max(_c7b,_c7a),_c7d);var args={};args.easing=dojo.fx.easing.linear;args.curve=[0,1];args.duration=_c7e;args.rate=50;var anim=new dojo._Animation(args);var that=this;dojo.connect(anim,"onAnimate",dojo.hitch(this,function(_c7f){var _c80=dojo.fx.easing.quartInOut(_c7f);var _c81=dojo.fx.easing.quadInOut(_c7f);var x=_c76.x+(_c78.x-_c76.x)*_c80;var y=_c76.y+(_c78.y-_c76.y)*_c80;var _c82=0;if(_c7e>_c7c){_c82=(0.5-Math.abs(_c81-0.5))*_c7e/_c7d;}var z=(_c77*(1-_c81)+_c79*_c81)*(1-_c82);that.moveToAndScale(x,y,z);}));dojo.connect(anim,"onEnd",function(){that.moveToAndScale(_c78.x,_c78.y,_c79);});anim.controlEndPoint=_c78;return anim;}});});},"cb/widget/_ParticipantsNumberReduceMixin":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/dom-style","dojo/dom-class","dojo/dom-geometry","dojo/query","cb/util","sp/I18n","dojo/NodeList-traverse"],function(_c83,lang,_c84,_c85,_c86,_c87,_c88,_c89){return _c83(null,{liElementWidth:null,constructor:function(){this.checkWidthDebaunce=_c88.debounce(this.checkWidth,500);},postCreate:function(){this.inherited(arguments);_c84.set(this.domNode,"whiteSpace","nowrap");},checkWidth:function(){if(!this.liElementWidth){if(!this.containerNode.childNodes[0]){return false;}this.liElementWidth=_c86.getMarginBox(this.containerNode.childNodes[0]).w;}var _c8a=this.domNode.parentNode.clientWidth;var _c8b=(this.shareButton)?_c86.getMarginBox(this.shareButton).w:0;var _c8c=Math.floor((_c8a-_c8b)/this.liElementWidth);if(this.domNode.scrollWidth>_c8a){this.reduceNumberOfParticipants(_c8c);}else{if(this.domNode.scrollWidth<=_c8a&&this.participantsToHide){this.enlargeNumberOfParticipants(_c8c);}}},reduceNumberOfParticipants:function(_c8d){this.participantsToHide=null;this.participantsToHide=_c87(this.containerNode).children().slice(-(this.containerNode.childNodes.length-_c8d));this.participantsToHide.forEach(function(node){_c85.add(node,"hideBlock");});this._setShareButtonLabel(this.participantsToHide.length);},enlargeNumberOfParticipants:function(_c8e){var _c8f=_c87(this.containerNode).children();var _c90=_c8f.length-this.participantsToHide.length;var _c91=_c8f.slice(-(_c8e-_c90));_c91.forEach(function(node){_c85.remove(node,"hideBlock");});this._setShareButtonLabel(this.participantsToHide.length-_c91.length);if((this.participantsToHide.length-_c91.length)<=0){this.participantsToHide=null;}},_setShareButtonLabel:function(_c92){if(this.shareButton){if(_c92<=0){this.shareButton.innerHTML="<i class=\"icon fonticon-participants-small fonticon-large\"></i>";_c85.remove(this.shareButton,"participants-hidden");}else{this.shareButton.innerHTML="+ "+_c89.esc(_c92);_c85.add(this.shareButton,"participants-hidden");}}},resize:function(){this.inherited(arguments);this.checkWidthDebaunce();}});});},"cb/messaging/MessageHub":function(){define(["dojo","dojo/date/stamp","dijit/Destroyable","sp/infos/InfoManager","sp/I18n","cb/util-mentions","./ErrorMessage","./ErrContainerReceiver"],function(dojo,_c93,_c94,_c95,I18n,_c96,_c97,_c98){var _c99=false;var _c9a=new _c94();function _c9b(msg){if(msg.system&&msg.timestamp&&msg.text){dojo.publish("/cb/messaging/incoming",{type:"system",text:msg.text,ownMention:_c96.isOwnMentionInText(msg.text),timestamp:msg.timestamp});}};function _c9c(){if(_c99){return;}_c9a.own(dojo.subscribe("/sp/ajax/incoming/chatmessage",function(item){if(item.authorid&&item.dte&&item.id){dojo.publish("/cb/messaging/incoming",{type:"chat",userid:item.authorid,text:item.text,ownMention:_c96.isOwnMentionInText(item.text),timestamp:_c93.fromISOString(item.dte).getTime(),del:item.del,id:item.id});}}));_c9a.own(dojo.subscribe("/sp/items/newOrUpdatedVisibleItem",function(item){if(item.type&&item.authorid&&item.dte&&item.id){dojo.publish("/cb/messaging/incoming",{type:item.type,subtype:item.subtype,userid:item.authorid,text:item.text||null,ownMention:_c96.isOwnMentionInText(item.text),timestamp:_c93.fromISOString(item.dte).getTime(),del:item.del,txtg:item.txtGId,task:item.taskStatus,id:item.id});}}));_c99=true;};function stop(){if(!_c99){return;}_c99=false;_c9a.destroy();};return {start:_c9c,stop:stop};});},"cb/popup":function(){define(["dojo/_base/window","dojo/_base/array","dojo/dom-attr","dojo/on","cb/assert"],function(_c9d,_c9e,_c9f,on,_ca0){var _ca1=(function(){var _ca2=0;return function(){return "popup_"+_ca2++;};})();var _ca3=_c9d.global._windowPopups={};function _ca4(_ca5,_ca6){var _ca7=window.setInterval(function(){try{if(_ca5!==null&&_ca5.closed){window.clearInterval(_ca7);_ca6();}}catch(e){}},1000);return {remove:function(){window.clearInterval(_ca7);}};};function _ca8(opts){_ca0.dom(opts.element);_ca0.string(opts.url);_ca0.string.optional(opts.options);_ca0.func.optional(opts.onOpen);_ca0.func.optional(opts.onClose);var _ca9=[],name;do{name=_ca1();}while(_ca3.hasOwnProperty(name));var data=_ca3[name]={};data.opener=function popupOpener(_caa){if(opts.onOpen){opts.onOpen();}var wh=window.open(opts.url,name,opts.options);if(opts.onClose){_ca9.push(_ca4(wh,opts.onClose));}return false;};_c9f.set(opts.element,"onclick","try{return window._windowPopups[\""+name+"\"].opener(this);}catch(e){ return false; }");return {remove:function(){_c9e.forEach(_ca9,function(r){r.remove();});}};};return _ca8;});},"url:sp/dialog/GoogleDriveExportDialog.html":"<div>\r\n    <div class=\"dialog-title\">\r\n        ${!i18n.title}\r\n        <div data-dojo-attach-event=\"click:_cancelClick\" class=\"dialog-close-button\" title=\"close\"><i class=\"fonticon-cross\"></i></div>\r\n    </div>\r\n    <div class=\"margin\">\r\n        <p>${!i18n.description}</p>\r\n        <div data-dojo-attach-point=\"_connectContent\" class=\"\">\r\n            <div data-dojo-attach-point=\"_connectHint\"></div>\r\n            <a href=\"/__/signin/google_oauth?afterwardsUrl=${afterwardsUrlUriComponent}\" data-dojo-attach-point=\"_connectButton\" class=\"button small\">${!i18n.connect_to_service}</a>\r\n        </div>\r\n        <div>\r\n            <div data-dojo-attach-point=\"_listNode\"></div>\r\n            <div data-dojo-attach-point=\"activityIndicatorNode\" class=\"activity-indicator\"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n","wp/data/ContainerPreviewAddOn":function(){define("wp/data/ContainerPreviewAddOn",["dijit","dojo","dojox","dojo/require!wp/data/ContainerPreviewCache,dojox/lang/functional,cb/util"],function(_cab,dojo,_cac){dojo.provide("wp.data.ContainerPreviewAddOn");dojo.require("wp.data.ContainerPreviewCache");dojo.require("dojox.lang.functional");dojo.require("cb.util");dojo.declare("wp.data.ContainerPreviewAddOn",null,{constructor:function(){this._cache=new wp.data.ContainerPreviewCache(this);this._isSthSelected=false;dojo.subscribe("wp/widget/textarea/resize",this,function(_cad){if(this.isIdSelected(_cad)){this._pad.drawer.enqueueSelection(_cad);}});this._prevItemFactorXY={x:1,y:1};this._prevItemDeltaXY={x:0,y:0};this._prevAttachDeltaXYOrNull=null;this._prevClippingDiffOrNull=null;},getPreviewItem:function(id){return this._cache.getItem(id);},getPreviewItems:function(){return this._cache.getFocusItems();},getPreviewIds:function(){return this._cache.getFocusIds();},getPreviewIdsWithoutTransformMode:function(){return this._cache.getFocusIdsWithoutTransformMode();},getAllPreviewItems:function(){return this._cache.getAllItems();},newPreview:function(_cae,_caf,_cb0){if(!!_caf){window.setTimeout(function(){dojo.publish("/cb/board/toolbar/dialogs/selection/update");},1);}if(_cb0){this._pad.drawer.removePreview();}this._pad.drawer.removeSelection();this._cache.reset();this._cache.addItems(_cae);this._isSthSelected=_caf&&_cae.length>0;this._performPreview();},addTmpItemToPreview:function(_cb1){this._cache.addTmpItem(_cb1);},removePreviewItemById:function(id){this._cache.removeItemById(id);},newPreviewByIds:function(_cb2,_cb3,_cb4){var _cb5=new wp.UniqueArray();for(var i=0;i<_cb2.length;i++){var id=_cb2[i];if(!id){continue;}var _cb6=this._checkItemIdForPreview(id);if(_cb6&&_cb6.id){if(_cb6.id!==id&&_cb6.inGroup){_cb5.push(_cb6.origId);}_cb5.push(_cb6.id);}}var _cb7=[];var tmp=_cb5.toArray();if(tmp.length>0){for(var i=0;i<tmp.length;i++){var id=tmp[i];if(this.containsItem(id)){_cb7.push(this.getItemCopy(id,"newPreviewByIds("+tmp.length+")"));var _cb8=this._itemMap.getSourceConnectionsByMasterId(id);for(var k=0;k<_cb8.length;k++){if(dojo.indexOf(tmp,_cb8[k])<0){var _cb9=this.getItemCopy(_cb8[k]);_cb9.previewTransformMode="SOURCE";_cb7.push(_cb9);}}}}}this.newPreview(_cb7,_cb3,_cb4);},newPreviewByAdditionalIds:function(_cba,_cbb){var ids=this.getPreviewIdsWithoutTransformMode().concat(_cba);this.newPreviewByIds(ids,_cbb,false);},newPreviewBySubstractedSingleId:function(id,_cbc){var ids=dojo.filter(this.getPreviewIdsWithoutTransformMode(),function(o){return o!==id;});this.newPreviewByIds(ids,_cbc,true);},_checkItemIdForPreview:function(id){var ret={origId:id,id:null,inGroup:false};if(id){var _cbd=this._itemMap.getGroupId(id);if(_cbd){id=this._checkItemIdForPreview(_cbd).id;ret.inGroup=true;}}ret.id=id;return ret;},transformPreview:function(_cbe,_cbf,_cc0,_cc1){var _cc2=this._cache.adaptFactorXY(_cbe);var _cc3=this._cache.adaptDeltaXY(_cbf);var _cc4=this._cache.adaptAttachDeltaXYOrNull(_cc0);this._performPreview(_cc2,_cc3,_cc4,_cc1);},modifyPreview:function(key,_cc5,_cc6){var _cc7=_cc6?[this._cache.getItem(_cc6)]:this._cache.getAllItems();var _cc8=null,_cc9=0,_cca=0,maxZ=0;if(key==="z"){_cc8=this._generateZOffsetLookup(_cc7);maxZ=_cc8.length;_cc9=this._itemMap.getNextMaxZ();_cca=this._itemMap.getNextMinZ();}for(var i=0;i<_cc7.length;i++){var item=_cc7[i];if(!item){continue;}if(key==="z"){item[key]=(_cc5==="max")?(_cc9+(_cc8[""+item[key]]||0)):(_cca-maxZ+(_cc8[""+item[key]]||0));}else{item[key]=_cc5;}}this._performPreview();},groupPreview:function(){if(this.isMultipleSelected()){this._cache.group();this._pad.drawer.removeTemporaryShapes(true);}},ungroupPreview:function(){if(this.getSingleSelectedGroupItemId()){this._cache.ungroup();}},savePreview:function(){this.addOrUpdateItems(this._cache.getAllItems());},saveTransformedPreview:function(_ccb,_ccc,_ccd,_cce){var _ccf=this._cache.adaptFactorXY(_ccb);var _cd0=this._cache.adaptDeltaXY(_ccc);var _cd1=this._cache.adaptAttachDeltaXYOrNull(_ccd);var ids=this._cache.getAllIds();var _cd2=[];for(var i=0;i<ids.length;i++){var id=ids[i];var item=this.getItemCopy(id,"saveTransformedPreview("+_cd2.length+")");item.previewTransformMode=this._cache.getPreviewTransformModeForId(id);wp.common.TransformHelper.transformItem({item:item,origItem:item,factorXY:_ccf,deltaXY:_cd0,attachDeltaXYOrNull:_cd1,originPoint:this._cache.getBBox().p1,clippingDiffOrNull:_cce});_cd2.push(item);}this.addOrUpdateItems(_cd2);},_performPreview:function(_cd3,_cd4,_cd5,_cd6){this._prevItemFactorXY=_cd3;this._prevItemDeltaXY=_cd4;this._prevAttachDeltaXYOrNull=_cd5;this._prevClippingDiffOrNull=_cd6;var ids=this._cache.getAllIds();for(var i=0;i<ids.length;i++){var id=ids[i];this._pad.drawer.enqueuePreview(id);}if(this._cache.getItem("_TMP")){this._pad.drawer.enqueuePreview("_TMP");}},_performSelectionOnly:function(){if(this._isSthSelected){var ids=this._cache.getFocusIdsWithoutTransformMode();for(var i=0;i<ids.length;i++){var id=ids[i];this._pad.drawer.enqueueSelection(id);}}},refreshPreview:function(_cd7,_cd8){var _cd9=this._isSthSelected;var _cda=this._cache.getFocusIdsWithoutTransformMode();this._resetPreview(_cd7,true,_cd8);if(_cda&&_cda.length>0){this.newPreviewByIds(_cda,_cd9,false);}},abortPreview:function(){this._resetPreview(true);},_resetPreview:function(_cdb,_cdc,_cdd){if(this._isSthSelected){window.setTimeout(function(){dojo.publish("/cb/board/toolbar/dialogs/selection/update");},1);}this._isSthSelected=false;this._cache.reset();this._pad.drawer.removeTemporaryShapes(_cdb,_cdc,_cdd);},isSthSelected:function(){return this._isSthSelected;},isMultipleSelected:function(){if(!this._isSthSelected){return false;}var ids=this._cache.getFocusIdsWithoutTransformMode();return ids&&ids.length>1;},isIdSelected:function(id){if(!this._isSthSelected){return false;}return !!this.getPreviewItem(id);},isIdInFocus:function(id){return this._cache.isIdInFocus(id);},isIdInFocusedGroup:function(id){return this._cache.isIdInFocusedGroup(id);},getSingleSelectedItemId:function(){return this._cache.getSingleItemId();},getSingleSelectedItem:function(){var id=this.getSingleSelectedItemId();return id?this._cache.getItem(id):null;},getSingleSelectedGroupItemId:function(){return this._cache.getSingleSelectedGroupItemId();},getSingleSelectedTextGroupItemId:function(){return this._cache.getSingleItemId("txtG");},getSingleSelectedImageItemId:function(){return this._cache.getSingleItemId("image");},getCommonProperty:function(_cde){return this._cache.getCommonProperty(_cde);},isImageInSelection:function(){return this._cache.isImageInAllIds();},getPrevBBox:function(){return this._cache.getBBox();},getPrevBBoxTransformed:function(){var _cdf=this.getPrevBBox();if(_cdf){return wp.common.TransformHelper.getTransformedBBox(_cdf,this.getPrevItemFactorXY(),this.getPrevItemDeltaXY());}else{return null;}},getPrevBBoxP1:function(){var _ce0=this.getPrevBBox();return _ce0?_ce0.p1:null;},resetPrevItemTransformators:function(){this._prevItemFactorXY={x:1,y:1};this._prevItemDeltaXY={x:0,y:0};this._prevAttachDeltaXYOrNull=null;this._prevClippingDiffOrNull=null;},getPrevItemFactorXY:function(){return this._prevItemFactorXY;},getPrevItemDeltaXY:function(){return this._prevItemDeltaXY;},getPrevAttachDeltaXYOrNull:function(){return this._prevAttachDeltaXYOrNull;},getPrevClippingDiffOrNull:function(){return this._prevClippingDiffOrNull;},_generateZOffsetLookup:function(_ce1){var _ce2=dojo.filter(_ce1,function(i){return i.z!==undefined&&i.z!==null;});var _ce3=dojo.map(_ce2,function(i){return i.z*1;});var _ce4=cb.util.uniqueValues(_ce3);var _ce5=_ce4.sort();var ret={};dojo.forEach(_ce5,function(_ce6,_ce7){ret[_ce6+""]=_ce7;});ret.length=_ce5.length;return ret;}});});},"cb/common/Queue":function(){define(["dojo/_base/declare","dojo/_base/Deferred","dojo/_base/lang","dojo/when"],function(_ce8,_ce9,lang,when){var _cea=1;return _ce8([],{constructor:function(_ceb){this._queue=[];this._queueWorkersMax=_ceb||_cea;this._queueWorkersFree=this._queueWorkersMax;this._jobFinishedScoped=lang.hitch(this,this._jobFinished);},submit:function(job){this._queue.push(job);this._notifiy();},_notifiy:function(){if(this._queue.length>0){if(this._queueWorkersFree>0){this._trigger();}}},_trigger:function(){var job=this._queue.shift();if(job){this._queueWorkersFree--;var _cec=job();when(_cec).then(this._jobFinishedScoped,this._jobFinishedScoped);}else{this._notifiy();}},_jobFinished:function(_ced){this._queueWorkersFree++;this._notifiy();}});});},"cb/board/conference/Chat":function(){define(["dojo","dojo/_base/lang","dojo/_base/array","dojo/on","dojo/dom-class","dojo/dom-construct","dojo/dom-style","dojo/dom-attr","dojo/query","dojo/window","dojox/lang/functional","dojo/date","dijit","dijit/_Widget","sp/infos/InfoManager","sp/ajax/AjaxEngine","cb/board/conference/ChatInput","cb/messaging/MessageHub","cb/widget/UserIconListEntry","cb/util","cb/util-text","sp/dialog/YesNoDialog","sp/I18n","dojo/i18n!../nls/Messages"],function(dojo,lang,_cee,on,_cef,_cf0,_cf1,_cf2,_cf3,_cf4,_cf5,_cf6,_cf7,_cf8,_cf9,_cfa,_cfb,_cfc,_cfd,_cfe,_cff,_d00,_d01,i18n){var _d02=_d01.wrap(i18n);var _d03=1;_cfc.start();var _d04=dojo.declare([_cf8],{markfirstofday:false,hasBeenDeleted:false,msg:null,constructor:function(args){dojo.mixin(this,args);if(!this.timestamp){this.timestamp=this.msg.timestamp||new Date().getTime();}this.id=_cf7.getUniqueId("cb.board.conference.ChatMessage");this.domNode=_cf0.create("div",{"class":"message"});this.update(this.msg);},postCreate:function(){this.inherited(arguments);},refresh:function(){if(this.markfirstofday&&!this.hasBeenDeleted){if(!this.daymarker){this.daymarker=_cf0.create("div",{"class":"mark-day-break",innerHTML:_d02("chat_day_break_marker",[new Date(this.msg.timestamp)])});}_cf0.place(this.daymarker,this.domNode,"before");}else{if(this.daymarker){dojo.destroy(this.daymarker);this.daymarker=null;}}},update:function(msg){if(this.hasBeenDeleted){return;}this.msg=msg;if(msg.del){_cef.add(this.domNode,"hideBlock");this.hasBeenDeleted=true;}else{this.updateMessageCssClasses(this.domNode);this.updateImage(this.domNode);this.updateText(this.domNode);}},getNode:function(){return this.domNode;},updateMessageCssClasses:function(node){_cef.toggle(node,"user",!!this.msg.userid);_cef.toggle(node,"me",this.msg.userid===sp.info.user.info.id);},updateImage:function(node){_cf0.place(new _cfd({userid:this.msg.userid,small:true}).domNode,_cf0.create("ul",{"class":"profile-image-container"},node));},updateText:function(node){if(this.msg.text){this.textNode=this.textNode||_cf0.create("div",{"class":"text"},node);this.textEntryNode=this.textEntryNode||_cf0.create("span",null,this.textNode);_cf2.set(this.textEntryNode,"innerHTML",_cff.insertLinkMarkup(this.msg.text,null,true));if(this.msg.userid){_cf9.getById({type:"user",id:this.msg.userid}).then(dojo.hitch(this,function(_d05){this.usernameNode=this.usernameNode||_cf0.create("span",{"class":"user"},this.textNode,"first");_cf2.set(this.usernameNode,"innerHTML",_d01.esc(_d05.user.displayname)+": ");}));}else{_cf0.destroy(this.usernameNode);this.usernameNode=null;}this.dateNode=this.dateNode||_cf0.create("span",{"class":"time"},this.textNode,"first");_cf2.set(this.dateNode,"innerHTML",_d02("chat_msg_time",[new Date(this.msg.timestamp)]));}else{_cf0.destroy(this.textNode);_cf0.destroy(this.usernameNode);_cf0.destroy(this.dateNode);this.textNode=null;this.usernameNode=null;this.dateNode=null;}},destroy:function(){_cf0.destroy(this.domNode);}});return dojo.declare([_cf8],{baseClass:"chat enable-user-text-select",_messages:null,documentId:null,constructor:function(){this._messages=[];this._messageIds={};this._refresh=_cfe.debounce(this._refresh,150);this._scrollToLatest=_cfe.debounce(this._scrollToLatest,150);},buildRendering:function(){this.inherited(arguments);this.containerNode=_cf0.create("div",{"class":"chat-messages pretty-scrollbars"},this.domNode);this._chatInput=new _cfb({placeholder:_d02("chat_input_placeholder"),value:"",blurValue:""});dojo.place(this._chatInput.domNode,_cf0.create("div",{"class":"chat-input-container"},this.domNode),"last");this.connect(this._chatInput,"onChange","_handleChatInputChange");this._createChatMessagesNote();},postCreate:function(){this.inherited(arguments);this.own(dojo.subscribe("/cb/messaging/incoming",_cfe.wrapDefer(dojo.hitch(this,function(msg){if(msg.type==="chat"){this._handleChatMessage(msg);}}))));},startup:function(){this.inherited(arguments);this._chatInput.startup();},onAddOrUpdatedMessage:function(){this._refresh();},_refresh:function(){this._sort();this._markDayBreaks();this._reorderNodesAndRefresh();this._scrollToLatest();},scrollToLatest:function(){this._scrollToLatest();},_scrollToLatest:function(){if(this.containerNode.lastElementChild){_cf4.scrollIntoView(this.containerNode.lastElementChild);}},_sort:function(){this._messages.sort(function(a,b){return (b.msg.timestamp-a.msg.timestamp)*-1;});},_markDayBreaks:function(){if(this._messages.length===0){return;}this._messages[0].markfirstofday=true;_cf5.reduce(this._messages,function(acc,val){if(_cf6.compare(acc.msg.timestamp,val.msg.timestamp,"date")<0){val.markfirstofday=true;}else{val.markfirstofday=!!acc.msg.del;}return val;});},_reorderNodesAndRefresh:function(){_cf3(this.containerNode).children().orphan();this._createChatMessagesNote();dojo.forEach(this._messages,function(_d06){if(!_d06.msg.del){_cf0.place(_d06.domNode,this.containerNode);}},this);dojo.forEach(this._messages,function(_d07){if(!_d07.msg.del){_d07.refresh();}},this);},_createChatMessagesNote:function(){var _d08=_cf0.create("div",{"innerHTML":_d02("chat_clear_note"),"class":"light chat-messages-note"},this.containerNode);this.own(_cf3("span.link",_d08).on("click",dojo.hitch(this,function(_d09){var _d0a=new _d00({questionText:_d02("chat_clear_confirm"),okButtonText:_d02("chat_clear_ok"),additionalCssClass:"chat-confirm-delete-dialog",onYes:dojo.hitch(this,function(){this.deleteAllChatMessages();_d0a.hide();})});_d0a.show(_d09.currentTarget);})));},_handleChatMessage:function(msg){var _d0b=false;if(msg.id){_d0b=this._messageIds[msg.id];}if(_d0b){_d0b.update(msg);}else{_d0b=new _d04({msg:msg});this._messages.push(_d0b);this._messageIds[msg.id]=_d0b;}this.onAddOrUpdatedMessage(_d0b);},_handleChatInputChange:function(_d0c){if(_d0c&&_d0c.length>0){_cfa.publishItem({type:"chatmessage",text:_d0c,id:this.generateNewId()},this.documentId);this._chatInput.reset();sp.global.analytics.trackEvent("board conference","chat message send");}},generateNewId:function(){return sp.info.padConfig.itemIdPrefix+"_c_"+_d03++;},getNumberOfUndeletedMessages:function(){var ret=0;dojo.forEach(this._messages,function(_d0d){if(!_d0d.msg.del){ret++;}},this);return ret;},deleteAllChatMessages:function(){dojo.forEach(this._messages,function(_d0e){if(!_d0e.msg.del){_cfa.publishItem({type:"chatmessage",del:"1",id:_d0e.msg.id},this.documentId);}},this);}});});},"cb/board/toolbar/BoardTitle":function(){define(["dojo","dojo/_base/lang","dojo/_base/array","dojo/dom-class","dojo/dom-construct","dojo/dom-attr","dojo/on","dojo/promise/all","dojo/when","dijit/_Widget","sp/infos/InfoManager","cb/Capabilities","./BoardTitleDialog","cb/util","sp/I18n","dojo/i18n!../nls/Messages"],function(dojo,lang,dArr,_d0f,_d10,_d11,on,_d12,when,_d13,_d14,_d15,_d16,_d17,_d18,i18n){var _d19=_d18.wrap(i18n);return dojo.declare([_d13],{baseClass:"board-title button quiet",buildRendering:function(){this.inherited(arguments);this.titleNode=_d10.create("h1",null,this.domNode);_d10.create("i",{"class":"fonticon-chevron-down-thin"},this.domNode);},postCreate:function(){this.inherited(arguments);this.own(_d14.watchById({type:"document",id:sp.info.document.id},lang.hitch(this,function(_d1a){this.update(_d1a);_d14.getById({type:"portfolio",id:_d1a.document.projectId});})));this.own(on(this.domNode,"click",lang.hitch(this,function(e){(new _d16({})).show(this.domNode);})));},update:function(_d1b){_d11.set(this.titleNode,"innerHTML",_d18.esc(_d1b.document.title));_d0f.toggle(this.domNode,"board-title--unnamed",this._isUnnamedBoard(_d1b.document.title));},_isUnnamedBoard:function(_d1c){return _d1c==="Neues Board"||_d1c==="New Board";}});});},"dojox/math/matrix":function(){define("dojox/math/matrix",["dojo","dojox"],function(dojo,_d1d){dojo.getObject("math.matrix",true,_d1d);dojo.mixin(_d1d.math.matrix,{iDF:0,ALMOST_ZERO:1e-10,multiply:function(a,b){var ay=a.length,ax=a[0].length,by=b.length,bx=b[0].length;if(ax!=by){console.warn("Can't multiply matricies of sizes "+ax+","+ay+" and "+bx+","+by);return [[0]];}var c=[];for(var k=0;k<ay;k++){c[k]=[];for(var i=0;i<bx;i++){c[k][i]=0;for(var m=0;m<ax;m++){c[k][i]+=a[k][m]*b[m][i];}}}return c;},product:function(){if(arguments.length==0){console.warn("can't multiply 0 matrices!");return 1;}var m=arguments[0];for(var i=1;i<arguments.length;i++){m=this.multiply(m,arguments[i]);}return m;},sum:function(){if(arguments.length==0){console.warn("can't sum 0 matrices!");return 0;}var m=this.copy(arguments[0]);var rows=m.length;if(rows==0){console.warn("can't deal with matrices of 0 rows!");return 0;}var cols=m[0].length;if(cols==0){console.warn("can't deal with matrices of 0 cols!");return 0;}for(var i=1;i<arguments.length;++i){var arg=arguments[i];if(arg.length!=rows||arg[0].length!=cols){console.warn("can't add matrices of different dimensions: first dimensions were "+rows+"x"+cols+", current dimensions are "+arg.length+"x"+arg[0].length);return 0;}for(var r=0;r<rows;r++){for(var c=0;c<cols;c++){m[r][c]+=arg[r][c];}}}return m;},inverse:function(a){if(a.length==1&&a[0].length==1){return [[1/a[0][0]]];}var tms=a.length,m=this.create(tms,tms),mm=this.adjoint(a),det=this.determinant(a),dd=0;if(det==0){console.warn("Determinant Equals 0, Not Invertible.");return [[0]];}else{dd=1/det;}for(var i=0;i<tms;i++){for(var j=0;j<tms;j++){m[i][j]=dd*mm[i][j];}}return m;},determinant:function(a){if(a.length!=a[0].length){console.warn("Can't calculate the determinant of a non-squre matrix!");return 0;}var tms=a.length,det=1,b=this.upperTriangle(a);for(var i=0;i<tms;i++){var bii=b[i][i];if(Math.abs(bii)<this.ALMOST_ZERO){return 0;}det*=bii;}det*=this.iDF;return det;},upperTriangle:function(m){m=this.copy(m);var f1=0,temp=0,tms=m.length,v=1;this.iDF=1;for(var col=0;col<tms-1;col++){if(typeof m[col][col]!="number"){console.warn("non-numeric entry found in a numeric matrix: m["+col+"]["+col+"]="+m[col][col]);}v=1;var _d1e=0;while((m[col][col]==0)&&!_d1e){if(col+v>=tms){this.iDF=0;_d1e=1;}else{for(var r=0;r<tms;r++){temp=m[col][r];m[col][r]=m[col+v][r];m[col+v][r]=temp;}v++;this.iDF*=-1;}}for(var row=col+1;row<tms;row++){if(typeof m[row][col]!="number"){console.warn("non-numeric entry found in a numeric matrix: m["+row+"]["+col+"]="+m[row][col]);}if(typeof m[col][row]!="number"){console.warn("non-numeric entry found in a numeric matrix: m["+col+"]["+row+"]="+m[col][row]);}if(m[col][col]!=0){var f1=(-1)*m[row][col]/m[col][col];for(var i=col;i<tms;i++){m[row][i]=f1*m[col][i]+m[row][i];}}}}return m;},create:function(a,b,_d1f){_d1f=_d1f||0;var m=[];for(var i=0;i<b;i++){m[i]=[];for(var j=0;j<a;j++){m[i][j]=_d1f;}}return m;},ones:function(a,b){return this.create(a,b,1);},zeros:function(a,b){return this.create(a,b);},identity:function(size,_d20){_d20=_d20||1;var m=[];for(var i=0;i<size;i++){m[i]=[];for(var j=0;j<size;j++){m[i][j]=(i==j?_d20:0);}}return m;},adjoint:function(a){var tms=a.length;if(tms<=1){console.warn("Can't find the adjoint of a matrix with a dimension less than 2");return [[0]];}if(a.length!=a[0].length){console.warn("Can't find the adjoint of a non-square matrix");return [[0]];}var m=this.create(tms,tms),ap=this.create(tms-1,tms-1);var ii=0,jj=0,ia=0,ja=0,det=0;for(var i=0;i<tms;i++){for(var j=0;j<tms;j++){ia=0;for(ii=0;ii<tms;ii++){if(ii==i){continue;}ja=0;for(jj=0;jj<tms;jj++){if(jj==j){continue;}ap[ia][ja]=a[ii][jj];ja++;}ia++;}det=this.determinant(ap);m[i][j]=Math.pow(-1,(i+j))*det;}}return this.transpose(m);},transpose:function(a){var m=this.create(a.length,a[0].length);for(var i=0;i<a.length;i++){for(var j=0;j<a[i].length;j++){m[j][i]=a[i][j];}}return m;},format:function(a,_d21){_d21=_d21||5;function _d22(x,dp){var fac=Math.pow(10,dp);var a=Math.round(x*fac)/fac;var b=a.toString();if(b.charAt(0)!="-"){b=" "+b;}if(b.indexOf(".")>-1){b+=".";}while(b.length<dp+3){b+="0";}return b;};var ya=a.length;var xa=ya>0?a[0].length:0;var _d23="";for(var y=0;y<ya;y++){_d23+="| ";for(var x=0;x<xa;x++){_d23+=_d22(a[y][x],_d21)+" ";}_d23+="|\n";}return _d23;},copy:function(a){var ya=a.length,xa=a[0].length,m=this.create(xa,ya);for(var y=0;y<ya;y++){for(var x=0;x<xa;x++){m[y][x]=a[y][x];}}return m;},scale:function(a,_d24){a=this.copy(a);var ya=a.length,xa=a[0].length;for(var y=0;y<ya;y++){for(var x=0;x<xa;x++){a[y][x]*=_d24;}}return a;}});return _d1d.math.matrix;});},"wp/data/ContainerCopyAddOn":function(){define("wp/data/ContainerCopyAddOn",["dijit","dojo","dojox","dojo/require!wp/common/TransformHelper,wp/data/SequenceHelper,dojox/lang/functional,cb/SecureStorage,sp/ajax/AjaxEngine,cb/util,cb/xdomain/storage/StorageIframeClient,dojo/Deferred,wp/common/TextHelper"],function(_d25,dojo,_d26){dojo.provide("wp.data.ContainerCopyAddOn");dojo.require("wp.common.TransformHelper");dojo.require("wp.data.SequenceHelper");dojo.require("dojox.lang.functional");dojo.require("cb.SecureStorage");dojo.require("sp.ajax.AjaxEngine");dojo.require("cb.util");dojo.require("cb.xdomain.storage.StorageIframeClient");dojo.require("dojo.Deferred");dojo.require("wp.common.TextHelper");dojo.declare("wp.data.ContainerCopyAddOn",null,{constructor:function(){this._copySelection=null;this._copyDeltaInPx=50;this._originalSelectionCenter=null;this._lastPastePos=null;this._zIndexCalculator=null;cb.util.defer(dojo.hitch(this,this._loadStorage));this.COPYDATA_VERSION=0;this.MAXIMUM_AGE_OF_LOADED_DATA=new Date().getTime()-(8*60*60*1000);},_loadStorage:function(){if(window.localStorage){var _d27=new cb.xdomain.storage.StorageIframeClient("default");var _d28=[];var _d29=dojo.hitch(this,function(v){if(v===null||v===undefined){return;}if((!v)||(v.version!==this.COPYDATA_VERSION)||(v.createdAtTimestamp<this.MAXIMUM_AGE_OF_LOADED_DATA)){_d27.setObj("copyBuffer",null);return;}this._save(v);});_d27.listen(function(_d2a){if(_d2a.key==="copyBuffer"){_d29(_d2a.newValue);}});this._store=function(_d2b){this._save(_d2b);_d27.setObj("copyBuffer",_d2b);};this.clearClipboard();}},isClipboardFilled:function(){return this._copyData&&this._copyData.items&&this._copyData.items.length>0;},clearClipboard:function(){this._store({items:[],selection:[],documentId:sp.info.document.id,createdAtTimestamp:new Date().getTime(),version:this.COPYDATA_VERSION});},copy:function(){if(this.isSthSelected()){var _d2c=[];var _d2d=this.getAllPreviewItems();for(var i=0;i<_d2d.length;i++){var _d2e=_d2d[i];var _d2f=this._pad.factory.getItemCopy(_d2e);if(_d2f.type=="txtG"){_d2d.push.apply(_d2d,dojo.map(this.getTextEntryItems(_d2e.id),function(_d30){_d30.previewTransformMode="SOURCE";return _d30;}));}var copy={item:_d2f,attributeOverlay:{}};if(_d2e.previewTransformMode){copy.attributeOverlay.previewTransformMode=_d2e.previewTransformMode;}_d2c.push(copy);}_d2c.sort(wp.data.SequenceHelper.comparator);this._store({items:_d2c,centerOfItems:this.getPrevBBox().getCenter(),selection:this.getPreviewIds(),documentId:sp.info.document.id,createdAtTimestamp:new Date().getTime(),version:this.COPYDATA_VERSION});}},_store:function(_d31){this._save(_d31);},_save:function(_d32){this._zIndexCalculator=null;this._lastPastePos=null;this._copyData=_d32;},_load:function(){return this._copyData||[];},paste:function(){if(!this.isClipboardFilled()){return;}var _d33=this._load();var _d34=_d33.items;var _d35=[];this.abortPreview();var _d36=this._pad.surface.getPositionCenter();if(this._lastPastePos&&Math.abs(this._lastPastePos.x-_d36.x)<this._copyDeltaInPx&&Math.abs(this._lastPastePos.y-_d36.y)<this._copyDeltaInPx){_d36={x:_d36.x+this._copyDeltaInPx,y:_d36.y+this._copyDeltaInPx};}this._lastPastePos=_d36;var _d37={x:_d36.x-_d33.centerOfItems.x,y:_d36.y-_d33.centerOfItems.y};if(!this._zIndexCalculator){this._zIndexCalculator=this._createZIndexCalculator(_d34);}var _d38={};var _d39=dojo.map(_d34,function(copy){return dojo._mixin(this._pad.factory.getItemCopy(copy.item),copy.attributeOverlay);},this);var _d3a={};var _d3b=this._itemMap.getNextMaxZ();dojo.forEach(_d39,function(_d3c){_d3c.z=_d3b+this._zIndexCalculator(_d3c);_d3c.seq=null;_d3c.orderingkey=null;if(_d3c.type==="image"){_d38[_d3c.src]=true;}wp.common.TransformHelper.transformItem({item:_d3c,origItem:_d3c,deltaXY:_d37});var _d3d=_d3c.id;var _d3e=this._pad.generateItemId();_d3c.id=_d3e;_d3a[_d3d]=_d3e;if(dojo.indexOf(_d33.selection,_d3d)>-1){if(!_d3c.previewTransformMode){_d35.push(_d3e);}}},this);var _d3f=_d39.length;while(_d3f--){var item=_d39[_d3f];if(item.type=="group"){var _d40=[];for(var k=0;k<item.ids.length;k++){var _d41=item.ids[k];var _d42=_d3a[_d41]||_d41;_d40.push(_d42);}item.ids=_d40;_d39.push(_d39.splice(_d3f,1)[0]);}else{if(item.type=="txtE"){var _d43=item.txtGId;item.txtGId=_d3a[_d43]||_d43;item.text=wp.common.TextHelper.unescape(item.text);}}if(item.conn){dojo.forEach(item.conn,function(conn){var _d44=conn.id;conn.id=_d3a[_d44]||_d44;});}}var _d45=_d26.lang.functional.keys(_d38);var _d46;if(_d45.length!==0&&_d33.documentId!==sp.info.document.id){_d46=sp.ajax.getInstance().copyImageAssociations({imageids:_d45,source:_d33.documentId,target:sp.info.document.id}).then(function(){return true;},function(){console.warn("error copying image associations",arguments);return true;});}else{_d46=new dojo.Deferred();_d46.resolve(true);}_d46.then(dojo.hitch(this,function(){this.newPreview(_d39,true,true);this.savePreview();setTimeout(dojo.hitch(this,function(){this.newPreviewByIds(_d35,true,true);}),5);}));},_createZIndexCalculator:function(_d47){var self=this;var _d48=_d26.lang.functional.reduce(_d47,function(acc,_d49){var item=_d49.item;if(item.z){acc[self._getFullId(item)]=item.z;}return acc;},{});var _d4a=_d26.lang.functional.keys(_d48).sort(function(a,b){return _d48[a]-_d48[b];});return function(item){return dojo.indexOf(_d4a,self._getFullId(item));};},_getFullId:function(item){var ret="";if(item.id){ret+=item.id;}if(item.seq){if(typeof item.seq==="number"){ret+="/"+item.seq;}else{ret+="/"+item.seq.hi+"/"+item.seq.low;}}return ret;}});});},"wp/BBox":function(){define("wp/BBox",["dojo","./Point"],function(dojo,_d4b){var wp={};wp.Point=_d4b;wp.BBox=dojo.declare("wp.BBox",null,{constructor:function(p1,p2){this.p1={x:Math.floor(Math.min(p1.x,p2.x)),y:Math.floor(Math.min(p1.y,p2.y))};this.p2={x:Math.ceil(Math.max(p1.x,p2.x)),y:Math.ceil(Math.max(p1.y,p2.y))};},getACopy:function(){return new wp.BBox({x:this.p1.x,y:this.p1.y},{x:this.p2.x,y:this.p2.y});},expand:function(p){if(p.x<this.p1.x){this.p1.x=Math.floor(p.x);}else{if(p.x>this.p2.x){this.p2.x=Math.ceil(p.x);}}if(p.y<this.p1.y){this.p1.y=Math.floor(p.y);}else{if(p.y>this.p2.y){this.p2.y=Math.ceil(p.y);}}return this;},expandByBBox:function(bbox){if(bbox){this.expand(bbox.p1);this.expand(bbox.p2);}return this;},equals:function(bbox){if(!bbox){return false;}return (bbox.p1.x==this.p1.x&&bbox.p2.x==this.p2.x&&bbox.p1.y==this.p1.y&&bbox.p2.y==this.p2.y);},contains:function(p){return (p.x>=this.p1.x&&p.x<=this.p2.x&&p.y>=this.p1.y&&p.y<=this.p2.y);},containsBox:function(bbox){if(!bbox){return false;}return (bbox.p1.x>=this.p1.x&&bbox.p2.x<=this.p2.x&&bbox.p1.y>=this.p1.y&&bbox.p2.y<=this.p2.y);},collides:function(bbox){if(!bbox){return false;}return !(bbox.p2.x<this.p1.x||bbox.p1.x>this.p2.x||bbox.p2.y<this.p1.y||bbox.p1.y>this.p2.y);},transformToContainBBox:function(bbox){if(bbox){var _d4c=0;var _d4d=0;if(this.getWidth()>bbox.getWidth()){var _d4e=Math.max(this.p1.x-bbox.p1.x,0);var _d4f=Math.max(bbox.p2.x-this.p2.x,0);_d4c=_d4e>0?-_d4e:_d4f;}if(this.getHeight()>bbox.getHeight()){var _d50=Math.max(this.p1.y-bbox.p1.y,0);var _d51=Math.max(bbox.p2.y-this.p2.y,0);_d4d=_d50>0?-_d50:_d51;}this.p1.x+=_d4c;this.p1.y+=_d4d;this.p2.x+=_d4c;this.p2.y+=_d4d;}return this;},shrinkToIntersection:function(bbox){if(bbox&&this.collides(bbox)){this.p1.x=Math.max(this.p1.x,bbox.p1.x);this.p1.y=Math.max(this.p1.y,bbox.p1.y);this.p2.x=Math.min(this.p2.x,bbox.p2.x);this.p2.y=Math.min(this.p2.y,bbox.p2.y);}return this;},rotate90:function(){var _d52=this.getWidth()/2;var _d53=this.getHeight()/2;var _d54={x:this.p1.x+_d52,y:this.p1.y+_d53};this.p1={x:_d54.x-_d53,y:_d54.y-_d52};this.p2={x:_d54.x+_d53,y:_d54.y+_d52};},rotate:function(_d55,_d56){var _d57=dojox.gfx.matrix.rotategAt(_d55,_d56.x,_d56.y);var p1=dojox.gfx.matrix.multiplyPoint(_d57,this.p1);var p2=dojox.gfx.matrix.multiplyPoint(_d57,this.p2);this.p1={x:Math.floor(Math.min(p1.x,p2.x)),y:Math.floor(Math.min(p1.y,p2.y))};this.p2={x:Math.ceil(Math.max(p1.x,p2.x)),y:Math.ceil(Math.max(p1.y,p2.y))};},getWidth:function(){return this.p2.x!=this.p1.x?this.p2.x-this.p1.x:1;},getHeight:function(){return this.p2.y!=this.p1.y?this.p2.y-this.p1.y:1;},getCenter:function(){return new wp.Point(Math.round((this.p1.x+this.p2.x)/2),Math.round((this.p1.y+this.p2.y)/2));},getTopCenter:function(){var _d58=this.getTopLeft();var _d59=this.getTopRight();return new wp.Point(Math.round((_d58.x+_d59.x)/2),_d58.y);},getTopLeft:function(){return new wp.Point(this.p1.x,this.p1.y);},getTopRight:function(){return new wp.Point(this.p2.x,this.p1.y);},getBottomLeft:function(){return new wp.Point(this.p1.x,this.p2.y);},getBottomRight:function(){return new wp.Point(this.p2.x,this.p2.y);},translate:function(x,y){return new wp.BBox(this.getTopLeft().translate(x,y),this.getBottomRight().translate(x,y));},json:function(){return {"p1":this.p1,"p2":this.p2};}});return wp.BBox;});},"wp/surface/DrawerExecutionAddOn":function(){define("wp/surface/DrawerExecutionAddOn",["dijit","dojo","dojox"],function(_d5a,dojo,_d5b){dojo.provide("wp.surface.DrawerExecutionAddOn");dojo.declare("wp.surface.DrawerExecutionAddOn",null,{_scriptTimeOutTime:null,constructor:function(){if(dojo.isFF){this._scriptTimeOutTime=8000;}else{if(dojo.isWebKit){this._scriptTimeOutTime=4000;}else{this._scriptTimeOutTime=4000;}}this.sortByZIndexScoped=dojo.hitch(this,this.sortByZIndex);},_clear:function(){this._surface.clear();this._clearJobPending=false;},_executeDrawings:function(){var _d5c=this._pad.container,_d5d=this._pad.controller,_d5e=this._now,_d5f=this._scriptTimeOutTime,self=this,i,id,item;var _d60=this._drawIdsAsArray;this._drawIdsAsArray=[];var _d61={};for(i=_d60.length;i--;){id=_d60[i];item=_d5c.containsItem(id)?_d5c.getItem(id):null;if(!item){console.error("D: item with id "+id+" not found in container!!!");_d60[i]=null;continue;}if(item.type=="txtE"){var _d62=_d5c.containsItem(item.txtGId)?_d5c.getItem(item.txtGId):null;if(_d62){_d60[i]=_d62.id;_d61[id]=_d62;}}else{_d61[id]=item;}}var _d63=_d5e();var ids=wp.UniqueArray.makeUniqueReversed(_d60);ids.sort(this.sortByZIndexScoped);for(i=ids.length;i--;){if(_d5e()-_d63>_d5f&&i>1){this._drawIdsAsArray=ids.slice(0,i-1);break;}id=ids[i];item=_d61[id]||(_d5c.containsItem(id)?_d5c.getItem(id):null);if(!item){console.error("D: item with id "+id+" not found in container!!!");}var _d64=_d5c.getDrawShape(id);var _d65=null;if(item&&item.isWidget){if(item.type=="txtG"){if(!item.del){var _d66=this._surface.registerWidget(item.id,item.type,item.subtype);var _d67=_d5c.getTextEntryItems(item.id);item.drawWidget(_d66,_d67);if(_d5c.isIdSelected(item.id)&&_d5c.isIdInFocus(item.id)){this.enqueueSelection(item.id);}}else{this._surface.unregisterWidget(item.id);}}}else{if(this.isOSRActivatedForId(id)){this.removeOSRForId(id);}if(item.del!="1"){_d65=this._surface.createShapeGroup();item.draw(_d65);this._applyIdToShape(_d65,id);var _d68=_d65.getEventSource();if(_d68){this._applyCursorClassToShape(_d68,item.type);}_d5c.setDrawShape(id,_d65);if(_d5c.isIdSelected(id)&&_d5c.isIdInFocus(id)){this.enqueueSelection(id);}}else{_d5c.setDrawShape(id,null);}}this._surface.removeShapeGroup(_d64);this._removePreviewForIdAndLookup(id);if(item){if(!item.del){var bbox=_d5c.getBBox(item.id);if(bbox){this._pad.minimap.addOrUpdateBox(item.id,bbox);}}else{this._pad.minimap.deleteBox(item.id);}}}this._pad.minimap.refreshWithContainerBox(_d5c.getBBox());for(var j=ids.length;j--;){var id=ids[j];var _d69=_d5c.getDrawShape(id);if(!_d69){continue;}var _d6a=this._getViableZListSuccessorShape(id);if(_d6a){_d69.moveBefore(_d6a);}else{_d69.moveToFront();}}this._drawJobPending=this._drawIdsAsArray.length!==0;},_getViableZListSuccessorShape:function(id){var _d6b=this._pad.container;var _d6c=_d6b.getZListSuccessorId(id);if(_d6c===null){return null;}var _d6d=_d6b.getDrawShape(_d6c);return _d6d?_d6d:this._getViableZListSuccessorShape(_d6c);},_executePreviews:function(){var _d6e=this._pad.container,_d6f=this._pad.controller,self=this,_d70;var ids=this._prevIdsAsUniqueArray.toArray();for(var i=0,_d71=ids.length;i<_d71;i++){var id=ids[i];var item=_d6e.getPreviewItem(id);if(!item){console.warn("P: item with id "+id+" not found in container; preview drawing for this id canceled");}var _d72;if(item&&item.isWidget){if(item.type==="txtG"){this.activateOSRForWidgetId(item.id);if(!item.del){_d70=id.substr(0,1)!="_"?_d6e.getItem(id):item;wp.common.TransformHelper.transformItem({item:item,origItem:_d70,factorXY:_d6e.getPrevItemFactorXY(),deltaXY:_d6e.getPrevItemDeltaXY(),attachDeltaXYOrNull:_d6e.getPrevAttachDeltaXYOrNull(),originPoint:_d6e.getPrevBBoxP1(),clippingDiffOrNull:_d6e.getPrevClippingDiffOrNull()});_d72=this._surface.registerWidget(item.id,item.type,item.subtype);_d72.render(item);}else{this._surface.unregisterWidget(item.id);}}else{if(item.type==="temporary"){_d72=this._surface.registerWidget(item.id,item.type,item.subtype);_d72.render(item);}}}else{var _d73=_d6e.getPreviewShape(id);var _d74=null;if(!item){if(!_d73){_d6e.setPreviewShape(id,null);}}else{var _d75=_d6e.isIdSelected(id);if((_d75||item.previewTransformMode)&&id!="_TMP"){_d70=id.substr(0,1)!="_"?_d6e.getItem(id):item;wp.common.TransformHelper.transformItem({item:item,origItem:_d70,factorXY:_d6e.getPrevItemFactorXY(),deltaXY:_d6e.getPrevItemDeltaXY(),attachDeltaXYOrNull:_d6e.getPrevAttachDeltaXYOrNull(),originPoint:_d6e.getPrevBBoxP1(),clippingDiffOrNull:_d6e.getPrevClippingDiffOrNull()});item.resetBBox();}if(this.isOriginalPresent(id)){this.activateOSRForId(id);}_d74=this._surface.createShapeGroup();item.draw(_d74,true);if(item.z){this._applyIdToShape(_d74,id);var _d76=_d74.getEventSource();if(_d76){this._applyCursorClassToPreviewShape(_d76);}var _d77=this._getViableZListSuccessorShape(id);if(_d77){_d74.moveBefore(_d77);}}_d6e.setPreviewShape(id,_d74);this._surface.removeShapeGroup(_d73);}}if(_d6e.isIdSelected(id)&&_d6e.isIdInFocus(id)){this.enqueueSelection(id);}}this._prevJobPending=false;this._prevIdsAsUniqueArray=new wp.UniqueArray();},_executeSelections:function(){var _d78=this._pad.container,_d79=this._pad.controller;var ids=this._selectIdsAsUniqueArray.toArray();var _d7a=_d78.isMultipleSelected();var _d7b=dojo.map(ids,function(id){return _d78.getPreviewItem(id);});for(var i=0,_d7c=_d7b.length;i<_d7c;i++){var item=_d7b[i];if(!item){console.warn("S: item not found in container; selection drawing canceled");continue;}var id=item.id;this._removeSelectionForId(id);if(item&&!item.del){var _d7d=!_d78.isIdInFocusedGroup(id);if(_d7d){var bbox=_d78.getBBox(id);if(bbox){if(!item.previewTransformMode){this.drawItemSelection(item,bbox,_d7a);}else{if(!_d7a&&item.previewTransformMode==="SOURCE"&&item.a){this.drawAttachedSourceSelection(item.id,item.a);}}}}}}this._removeSelectionForId("WRAPPER_ID");if(_d7a){var _d7e=_d78.getPrevBBoxTransformed();if(_d7e){this.drawWrappingSelection(_d7e);}}this._selectJobPending=0;this._selectIdsAsUniqueArray=new wp.UniqueArray();},_removeDrawingForId:function(id){var _d7f=this._pad.container.getDrawShape(id);if(_d7f){this._surface.removeShapeGroup(_d7f);this._pad.container.setDrawShape(id,null);}else{this._surface.unregisterWidget(id);}},_removePreviewForIdAndLookup:function(id){this._removePreviewForId(id);var _d80=this._pad.container.getPrevIdByGenId(id);if(_d80){this._removePreviewForId(_d80);this._removeSelectionForId(_d80);}},_removePreviewForId:function(id){var _d81=this._pad.container.getPreviewShape(id);if(_d81){this._surface.removeShapeGroup(_d81);}this._pad.container.setPreviewShape(id,null);if(id==="_TMP"){this._surface.unregisterWidget(id);}},_removeSelectionForId:function(id){this._surface.removeSelection(id);},_applyIdToShape:function(_d82,id){if(!id){throw new Error("_applyIdToShape called without id");}if(!_d82){throw new Error("_applyIdToShape called without shapeGroup");}if(!_d82.children){throw new Error("_applyIdToShape called without shapeGroup children");}var _d83=_d82.getEventSource();if(_d83){_d83.setAttribute("sid",id);}for(var i=0;i<_d82.children.length;i++){var _d84=_d82.children[i].getEventSource();if(_d84){_d84.setAttribute("sid",id);}else{}}},_redrawSelection:function(item){this._surface.removeSelection(item.id);this.drawItemSelection(item,this._pad.container.getBBox(item.id),this._pad.container.isMultipleSelected());},sortByZIndex:function(a,b){var aIdx=this._pad.container.getZListIndex(a);var bIdx=this._pad.container.getZListIndex(b);return aIdx-bIdx;}});});},"url:cb/videochat/VideoChatWidget.html":"<div class=\"video-chat-user\">\n    <div class=\"video-stream\" data-dojo-attach-point=\"_videoStream\">\n        <div class=\"video-container\" id=\"${id}__video_container\" data-dojo-attach-point=\"_videoContainer\"></div>\n    </div>\n</div>","cb/widget/HighlightFlash":function(){define(["dojo","dojo/dom-class","dojo/query","dojo/dom-style","dojo/has","dojo/_base/sniff"],function(dojo,_d85,_d86,_d87,has){return dojo.declare(null,{node:null,duration:350,repeat:2,getCSSPrefix:function(){if(has("mozilla")){return "Moz";}else{if(has("webkit")){return "Webkit";}else{if(has("opera")){return "O";}else{if(has("ie")){return "ms";}else{return "";}}}}},highlight:function(node,_d88){var _d89="all "+this.duration+"ms";var _d8a=this.getCSSPrefix()+"Transition";_d87.set(node,_d8a,_d89);var _d8b=(_d88)?_d88:this.repeat;var i=0;var _d8c=this.duration;var _d8d=function(){i++;window.setTimeout(function(){_d85.add(node,"highlight");},10);window.setTimeout(function(){_d85.remove(node,"highlight");},_d8c);if(i<_d8b){window.setTimeout(_d8d,(_d8c*(i+1)));}else{window.setTimeout(function(){_d87.set(node,_d8a,"");},(_d8c*(i+1)));}};_d8d();}});});},"cb/videochat/VideoChatWidget":function(){define(["dojo","dojo/dom-geometry","dojo/dom-prop","dijit/_Widget","cb/widget/_TemplatedMixin","dojo/text!./VideoChatWidget.html"],function(dojo,_d8e,_d8f,_d90,_d91,_d92){return dojo.declare([_d90,_d91],{templateString:_d92,constructor:function(args){},getInfo:function(){var _d93=_d8e.getContentBox(this._videoContainer);return {domId:this.get("id")+"__video_container",width:_d93.w,height:_d93.h,widget:this};},resize:function(_d94){_d8e.setContentSize(this._videoStream,_d94);}});});},"plupload/plupload":function(){define("plupload/plupload",["dijit","dojo","dojox"],function(_d95,dojo,_d96){dojo.provide("plupload.plupload");(function(){var _d97;(function(){var _d98=0,_d99=[],i18n={},_d9a={},_d9b={"<":"lt",">":"gt","&":"amp","\"":"quot","'":"#39"},_d9c=/[<>&\"\']/g,_d9d,_d9e=window.setTimeout,_d9f={},uid;function _da0(){this.returnValue=false;};function _da1(){this.cancelBubble=true;};(function(_da2){var _da3=_da2.split(/,/),i,y,ext;for(i=0;i<_da3.length;i+=2){ext=_da3[i+1].split(/ /);for(y=0;y<ext.length;y++){_d9a[ext[y]]=_da3[i];}}})("application/msword,doc dot,"+"application/pdf,pdf,"+"application/pgp-signature,pgp,"+"application/postscript,ps ai eps,"+"application/rtf,rtf,"+"application/vnd.ms-excel,xls xlb,"+"application/vnd.ms-powerpoint,ppt pps pot,"+"application/zip,zip,"+"application/x-shockwave-flash,swf swfl,"+"application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,"+"application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,"+"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,"+"application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,"+"application/vnd.openxmlformats-officedocument.presentationml.template,potx,"+"application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,"+"application/x-javascript,js,"+"application/json,json,"+"audio/mpeg,mpga mpega mp2 mp3,"+"audio/x-wav,wav,"+"audio/mp4,m4a,"+"image/bmp,bmp,"+"image/gif,gif,"+"image/jpeg,jpeg jpg jpe,"+"image/photoshop,psd,"+"image/png,png,"+"image/svg+xml,svg svgz,"+"image/tiff,tiff tif,"+"text/plain,asc txt text diff log,"+"text/html,htm html xhtml,"+"text/css,css,"+"text/csv,csv,"+"text/rtf,rtf,"+"video/mpeg,mpeg mpg mpe m2v,"+"video/quicktime,qt mov,"+"video/mp4,mp4,"+"video/x-m4v,m4v,"+"video/x-flv,flv,"+"video/x-ms-wmv,wmv,"+"video/avi,avi,"+"video/webm,webm,"+"video/3gpp,3gp,"+"video/3gpp2,3g2,"+"video/vnd.rn-realvideo,rv,"+"application/vnd.oasis.opendocument.formula-template,otf,"+"application/octet-stream,exe");var _da4={VERSION:"1.5.7-cb",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,IMAGE_FORMAT_ERROR:-700,IMAGE_MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:_d9a,ua:(function(){var nav=navigator,_da5=nav.userAgent,_da6=nav.vendor,_da7,_da8,_da9;_da7=/WebKit/.test(_da5);_da9=_da7&&_da6.indexOf("Apple")!==-1;_da8=window.opera&&window.opera.buildNumber;return {windows:navigator.platform.indexOf("Win")!==-1,android:/Android/.test(_da5),ie:!_da7&&!_da8&&(/MSIE/gi).test(_da5)&&(/Explorer/gi).test(nav.appName),webkit:_da7,gecko:!_da7&&/Gecko/.test(_da5),safari:_da9,opera:!!_da8};}()),typeOf:function(o){return ({}).toString.call(o).match(/\s([a-z|A-Z]+)/)[1].toLowerCase();},extend:function(_daa){_da4.each(arguments,function(arg,i){if(i>0){_da4.each(arg,function(_dab,key){_daa[key]=_dab;});}});return _daa;},cleanName:function(name){var i,_dac;_dac=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"];for(i=0;i<_dac.length;i+=2){name=name.replace(_dac[i],_dac[i+1]);}name=name.replace(/\s+/g,"_");name=name.replace(/[^a-z0-9_\-\.]+/gi,"");return name;},addRuntime:function(name,_dad){_dad.name=name;_d99[name]=_dad;_d99.push(_dad);return _dad;},guid:function(){var guid=new Date().getTime().toString(32),i;for(i=0;i<5;i++){guid+=Math.floor(Math.random()*65535).toString(32);}return (_da4.guidPrefix||"p")+guid+(_d98++).toString(32);},buildUrl:function(url,_dae){var _daf="";_da4.each(_dae,function(_db0,name){_daf+=(_daf?"&":"")+encodeURIComponent(name)+"="+encodeURIComponent(_db0);});if(_daf){url+=(url.indexOf("?")>0?"&":"?")+_daf;}return url;},each:function(obj,_db1){var _db2,key,i;if(obj){_db2=obj.length;if(_db2===_d9d){for(key in obj){if(obj.hasOwnProperty(key)){if(_db1(obj[key],key)===false){return;}}}}else{for(i=0;i<_db2;i++){if(_db1(obj[i],i)===false){return;}}}}},formatSize:function(size){if(size===_d9d||/\D/.test(size)){return _da4.translate("N/A");}if(size>1073741824){return Math.round(size/1073741824,1)+" GB";}if(size>1048576){return Math.round(size/1048576,1)+" MB";}if(size>1024){return Math.round(size/1024,1)+" KB";}return size+" b";},getPos:function(node,root){var x=0,y=0,_db3,doc=document,_db4,_db5;node=node;root=root||doc.body;function _db6(node){var _db7,rect,x=0,y=0;if(node){rect=node.getBoundingClientRect();_db7=doc.compatMode==="CSS1Compat"?doc.documentElement:doc.body;x=rect.left+_db7.scrollLeft;y=rect.top+_db7.scrollTop;}return {x:x,y:y};};if(node&&node.getBoundingClientRect&&_da4.ua.ie&&(!doc.documentMode||doc.documentMode<8)){_db4=_db6(node);_db5=_db6(root);return {x:_db4.x-_db5.x,y:_db4.y-_db5.y};}_db3=node;while(_db3&&_db3!=root&&_db3.nodeType){x+=_db3.offsetLeft||0;y+=_db3.offsetTop||0;_db3=_db3.offsetParent;}_db3=node.parentNode;while(_db3&&_db3!=root&&_db3.nodeType){x-=_db3.scrollLeft||0;y-=_db3.scrollTop||0;_db3=_db3.parentNode;}return {x:x,y:y};},getSize:function(node){return {w:node.offsetWidth||node.clientWidth,h:node.offsetHeight||node.clientHeight};},parseSize:function(size){var mul;if(typeof (size)=="string"){size=/^([0-9]+)([mgk]?)$/.exec(size.toLowerCase().replace(/[^0-9mkg]/g,""));mul=size[2];size=+size[1];if(mul=="g"){size*=1073741824;}if(mul=="m"){size*=1048576;}if(mul=="k"){size*=1024;}}return size;},xmlEncode:function(str){return str?(""+str).replace(_d9c,function(chr){return _d9b[chr]?"&"+_d9b[chr]+";":chr;}):str;},toArray:function(obj){var i,arr=[];for(i=0;i<obj.length;i++){arr[i]=obj[i];}return arr;},inArray:function(_db8,_db9){if(_db9){if(Array.prototype.indexOf){return Array.prototype.indexOf.call(_db9,_db8);}for(var i=0,_dba=_db9.length;i<_dba;i++){if(_db9[i]===_db8){return i;}}}return -1;},addI18n:function(pack){return _da4.extend(i18n,pack);},translate:function(str){return i18n[str]||str;},isEmptyObj:function(obj){if(obj===_d9d){return true;}for(var prop in obj){return false;}return true;},hasClass:function(obj,name){var _dbb;if(obj.className==""){return false;}_dbb=new RegExp("(^|\\s+)"+name+"(\\s+|$)");return _dbb.test(obj.className);},addClass:function(obj,name){if(!_da4.hasClass(obj,name)){obj.className=obj.className==""?name:obj.className.replace(/\s+$/,"")+" "+name;}},removeClass:function(obj,name){var _dbc=new RegExp("(^|\\s+)"+name+"(\\s+|$)");obj.className=obj.className.replace(_dbc,function($0,$1,$2){return $1===" "&&$2===" "?" ":"";});},getStyle:function(obj,name){if(obj.currentStyle){return obj.currentStyle[name];}else{if(window.getComputedStyle){return window.getComputedStyle(obj,null)[name];}}},addEvent:function(obj,name,_dbd){var func,_dbe,_dbf,key;key=arguments[3];name=name.toLowerCase();if(uid===_d9d){uid="Plupload_"+_da4.guid();}if(obj.addEventListener){func=_dbd;obj.addEventListener(name,func,false);}else{if(obj.attachEvent){func=function(){var evt=window.event;if(!evt.target){evt.target=evt.srcElement;}evt.preventDefault=_da0;evt.stopPropagation=_da1;_dbd(evt);};obj.attachEvent("on"+name,func);}}if(obj[uid]===_d9d){obj[uid]=_da4.guid();}if(!_d9f.hasOwnProperty(obj[uid])){_d9f[obj[uid]]={};}_dbe=_d9f[obj[uid]];if(!_dbe.hasOwnProperty(name)){_dbe[name]=[];}_dbe[name].push({func:func,orig:_dbd,key:key});},removeEvent:function(obj,name){var type,_dc0,key;if(typeof (arguments[2])=="function"){_dc0=arguments[2];}else{key=arguments[2];}name=name.toLowerCase();if(obj[uid]&&_d9f[obj[uid]]&&_d9f[obj[uid]][name]){type=_d9f[obj[uid]][name];}else{return;}for(var i=type.length-1;i>=0;i--){if(type[i].key===key||type[i].orig===_dc0){if(obj.removeEventListener){obj.removeEventListener(name,type[i].func,false);}else{if(obj.detachEvent){obj.detachEvent("on"+name,type[i].func);}}type[i].orig=null;type[i].func=null;type.splice(i,1);if(_dc0!==_d9d){break;}}}if(!type.length){delete _d9f[obj[uid]][name];}if(_da4.isEmptyObj(_d9f[obj[uid]])){delete _d9f[obj[uid]];try{delete obj[uid];}catch(e){obj[uid]=_d9d;}}},removeAllEvents:function(obj){var key=arguments[1];if(obj[uid]===_d9d||!obj[uid]){return;}_da4.each(_d9f[obj[uid]],function(_dc1,name){_da4.removeEvent(obj,name,key);});}};_da4.Uploader=function(_dc2){var _dc3={},_dc4,_dc5=[],_dc6,_dc7=false;_dc4=new _da4.QueueProgress();_dc2=_da4.extend({chunk_size:0,multipart:true,multi_selection:true,file_data_name:"file",filters:[],args:{}},_dc2);function _dc8(){var file,_d98=0,i;if(this.state==_da4.STARTED){for(i=0;i<_dc5.length;i++){if(!file&&_dc5[i].status==_da4.QUEUED){file=_dc5[i];file.status=_da4.UPLOADING;if(this.trigger("BeforeUpload",file)){this.trigger("UploadFile",file);}}else{_d98++;}}if(_d98==_dc5.length){this.stop();this.trigger("UploadComplete",_dc5);}}};function calc(){var i,file;_dc4.reset();for(i=0;i<_dc5.length;i++){file=_dc5[i];if(file.size!==_d9d){_dc4.size+=file.size;_dc4.loaded+=file.loaded;}else{_dc4.size=_d9d;}if(file.status==_da4.DONE){_dc4.uploaded++;}else{if(file.status==_da4.FAILED){_dc4.failed++;}else{_dc4.queued++;}}}if(_dc4.size===_d9d){_dc4.percent=_dc5.length>0?Math.ceil(_dc4.uploaded/_dc5.length*100):0;}else{_dc4.bytesPerSec=Math.ceil(_dc4.loaded/((+new Date()-_dc6||1)/1000));_dc4.percent=_dc4.size>0?Math.ceil(_dc4.loaded/_dc4.size*100):0;}};_da4.extend(this,{state:_da4.STOPPED,runtime:"",features:{},files:_dc5,settings:_dc2,total:_dc4,id:_da4.guid(),init:function(){var self=this,i,_dc9,a,_dca=0,_dcb;if(typeof (_dc2.preinit)=="function"){_dc2.preinit(self);}else{_da4.each(_dc2.preinit,function(func,name){self.bind(name,func);});}_dc2.page_url=_dc2.page_url||document.location.pathname.replace(/\/[^\/]+$/g,"/");if(!/^(\w+:\/\/|\/)/.test(_dc2.url)){_dc2.url=_dc2.page_url+_dc2.url;}_dc2.chunk_size=_da4.parseSize(_dc2.chunk_size);_dc2.max_file_size=_da4.parseSize(_dc2.max_file_size);self.bind("FilesAdded",function(up,_dcc){var i,file,_d98=0,_dcd,_dce=_dc2.filters;if(_dce&&_dce.length){_dcd=[];_da4.each(_dce,function(_dcf){_da4.each(_dcf.extensions.split(/,/),function(ext){if(/^\s*\*\s*$/.test(ext)){_dcd.push("\\.*");}else{_dcd.push("\\."+ext.replace(new RegExp("["+("/^$.*+?|()[]{}\\".replace(/./g,"\\$&"))+"]","g"),"\\$&"));}});});_dcd=new RegExp(_dcd.join("|")+"$","i");}for(i=0;i<_dcc.length;i++){file=_dcc[i];file.loaded=0;file.percent=0;file.status=_da4.QUEUED;if(_dcd&&!_dcd.test(file.name)){up.trigger("Error",{code:_da4.FILE_EXTENSION_ERROR,message:_da4.translate("File extension error."),file:file});continue;}if(file.size!==_d9d&&file.size>_dc2.max_file_size){up.trigger("Error",{code:_da4.FILE_SIZE_ERROR,message:_da4.translate("File size error."),file:file});continue;}_dc5.push(file);_d98++;}if(_d98){_d9e(function(){self.trigger("QueueChanged");self.refresh();},1);}else{return false;}});if(_dc2.unique_names){self.bind("UploadFile",function(up,file){var _dd0=file.name.match(/\.([^.]+)$/),ext="tmp";if(_dd0){ext=_dd0[1];}file.target_name=file.id+"."+ext;});}self.bind("UploadProgress",function(up,file){file.percent=file.size>0?Math.ceil(file.loaded/file.size*100):100;calc();});self.bind("StateChanged",function(up){if(up.state==_da4.STARTED){_dc6=(+new Date());}else{if(up.state==_da4.STOPPED){for(i=up.files.length-1;i>=0;i--){if(up.files[i].status==_da4.UPLOADING){up.files[i].status=_da4.QUEUED;calc();}}}}});self.bind("QueueChanged",calc);self.bind("Error",function(up,err){if(err.file){err.file.status=_da4.FAILED;calc();if(up.state==_da4.STARTED){_d9e(function(){_dc8.call(self);},1);}}});self.bind("FileUploaded",function(up,file){file.status=_da4.DONE;file.loaded=file.size;up.trigger("UploadProgress",file);_d9e(function(){_dc8.call(self);},1);});if(_dc2.runtimes){_dc9=[];_dcb=_dc2.runtimes.split(/\s?,\s?/);for(i=0;i<_dcb.length;i++){if(_d99[_dcb[i]]){_dc9.push(_d99[_dcb[i]]);}}}else{_dc9=_d99;}function _dd1(){var _dd2=_dc9[_dca++],_dd3,_dd4,i;if(_dd2){_dd3=_dd2.getFeatures();_dd4=self.settings.required_features;if(_dd4){_dd4=_dd4.split(",");for(i=0;i<_dd4.length;i++){if(!_dd3[_dd4[i]]){_dd1();return;}}}_dd2.init(self,function(res){if(res&&res.success){self.features=_dd3;self.runtime=_dd2.name;self.trigger("Init",{runtime:_dd2.name});self.trigger("PostInit");self.refresh();}else{_dd1();}});}else{self.trigger("Error",{code:_da4.INIT_ERROR,message:_da4.translate("Init error.")});}};_dd1();if(typeof (_dc2.init)=="function"){_dc2.init(self);}else{_da4.each(_dc2.init,function(func,name){self.bind(name,func);});}},refresh:function(){this.trigger("Refresh");},start:function(){if(_dc5.length&&this.state!=_da4.STARTED){this.state=_da4.STARTED;this.trigger("StateChanged");_dc8.call(this);}},stop:function(){if(this.state!=_da4.STOPPED){this.state=_da4.STOPPED;this.trigger("CancelUpload");this.trigger("StateChanged");}},disableBrowse:function(){_dc7=arguments[0]!==_d9d?arguments[0]:true;this.trigger("DisableBrowse",_dc7);},getFile:function(id){var i;for(i=_dc5.length-1;i>=0;i--){if(_dc5[i].id===id){return _dc5[i];}}},removeFile:function(file){var i;for(i=_dc5.length-1;i>=0;i--){if(_dc5[i].id===file.id){return this.splice(i,1)[0];}}},splice:function(_dd5,_dd6){var _dd7;_dd7=_dc5.splice(_dd5===_d9d?0:_dd5,_dd6===_d9d?_dc5.length:_dd6);this.trigger("FilesRemoved",_dd7);this.trigger("QueueChanged");return _dd7;},trigger:function(name){var list=_dc3[name.toLowerCase()],i,args;if(list){args=Array.prototype.slice.call(arguments);args[0]=this;for(i=0;i<list.length;i++){if(list[i].func.apply(list[i].scope,args)===false){return false;}}}return true;},hasEventListener:function(name){return !!_dc3[name.toLowerCase()];},bind:function(name,func,_dd8){var list;name=name.toLowerCase();list=_dc3[name]||[];list.push({func:func,scope:_dd8||this});_dc3[name]=list;},unbind:function(name){name=name.toLowerCase();var list=_dc3[name],i,func=arguments[1];if(list){if(func!==_d9d){for(i=list.length-1;i>=0;i--){if(list[i].func===func){list.splice(i,1);break;}}}else{list=[];}if(!list.length){delete _dc3[name];}}},unbindAll:function(){var self=this;_da4.each(_dc3,function(list,name){self.unbind(name);});},destroy:function(){this.stop();this.trigger("Destroy");this.unbindAll();}});};_da4.File=function(id,name,size){var self=this;self.id=id;self.name=name;self.size=size;self.loaded=0;self.percent=0;self.status=0;};_da4.Runtime=function(){this.getFeatures=function(){};this.init=function(_dd9,_dda){};};_da4.QueueProgress=function(){var self=this;self.size=0;self.loaded=0;self.uploaded=0;self.failed=0;self.queued=0;self.percent=0;self.bytesPerSec=0;self.reset=function(){self.size=self.loaded=self.uploaded=self.failed=self.queued=self.percent=self.bytesPerSec=0;};};_da4.runtimes={};_d97=_da4;})();plupload.plupload=_d97;})();});},"cb/widget/_OnDijitDblClickMixin":function(){define(["dojo/on","dojo/_base/array","dojo/keys","dojo/_base/declare","dojo/_base/sniff","dojo/_base/unload","dojo/_base/window"],function(on,_ddb,keys,_ddc,has,_ddd,win){var _dde=null;if(has("ie")){(function(){var _ddf=function(evt){_dde=evt.srcElement;};win.doc.attachEvent("onkeydown",_ddf);_ddd.addOnWindowUnload(function(){win.doc.detachEvent("onkeydown",_ddf);});})();}else{win.doc.addEventListener("keydown",function(evt){_dde=evt.target;},true);}var _de0=function(node,_de1){if(/input|button/i.test(node.nodeName)){return on(node,"click",_de1);}else{function _de2(e){return (e.keyCode==keys.ENTER||e.keyCode==keys.SPACE)&&!e.ctrlKey&&!e.shiftKey&&!e.altKey&&!e.metaKey;};var _de3=[on(node,"keypress",function(e){if(_de2(e)){_dde=e.target;e.preventDefault();}}),on(node,"keyup",function(e){if(_de2(e)&&e.target==_dde){_dde=null;_de1.call(this,e);}}),on(node,"dblclick",function(e){_de1.call(this,e);})];return {remove:function(){_ddb.forEach(_de3,function(h){h.remove();});}};}};return _ddc("dijit._OnDijitDblClickMixin",null,{connect:function(obj,_de4,_de5){return this.inherited(arguments,[obj,_de4=="ondijitdblclick"?_de0:_de4,_de5]);}});});},"sp/dialog/GoogleDriveExportDialog":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/dom-construct","dojo/dom-attr","dojo/dom-class","dojo/dom-style","dojo/promise/all","dojo/on","dijit/_Widget","cb/widget/_TemplatedMixin","dojox/lang/functional","cb/api","sp/dialog/TooltipDialog","sp/dialog/DialogContent","sp/ActivityIndicator","sp/infos/InfoManager","sp/ajax/AjaxEngine","cb/widget/SimpleTable","cb/Capabilities","sp/I18n","cb/util-http","cb/popup","dojo/text!./GoogleDriveExportDialog.html","dojo/i18n!./nls/GoogleDriveExportDialog"],function(_de6,lang,dArr,_de7,_de8,_de9,_dea,_deb,on,_dec,_ded,_dee,api,_def,_df0,_df1,_df2,_df3,_df4,_df5,_df6,_df7,_df8,_df9,i18n){var _dfa=(function(){var id=1;return function(_dfb){return "driveexportdialogcallback"+(_dfb+"")+id++;};})();var _dfc="";var Item=_de6([_dec,_ded],{baseClass:"googledrive-folder",i18n:i18n,templateString:"<li><div><img class=\"${baseClass}-icon\" data-dojo-attach-point=\"_iconNode\"></img><strong class=\"${baseClass}-title\" data-dojo-attach-point=\"_titleNode\"></strong><i class=\"${baseClass}-icon-starred fonticon-star\"></i><span class=\"${baseClass}-hint-alreadyconnected\">${i18n.hint_alreadyconnected}</span></div><span class=\"${baseClass}-action button small\" data-dojo-attach-point=\"_actionButton\" data-dojo-attach-event=\"click:_handleActionClick\">${i18n.save_in_folder}</span></div></li>",_setItemAttr:function(item){this._set("item",item);this.set("title",item.googledrivefile.title);this.set("root",item.googledrivefile.parents.length===0);this.set("iconLink",item.googledrivefile.iconLink);this.set("starred",item.googledrivefile.starred);this.set("hierarchydepth",item.hierarchy.length);this.set("alreadyconnected",item.connections.length>0);},_setTitleAttr:function(_dfd){this._titleNode.innerHTML=_df6.esc(_dfd);this._set("title",_dfd);},_setRootAttr:function(root){this._set("root",root);_de9.toggle(this.domNode,this.baseClass+"-root",root);},_setIconLinkAttr:function(_dfe){this._set("iconLink",_dfe);_de8.set(this._iconNode,"src",_dfe||_dfc);},_setStarredAttr:function(_dff){this._set("starred",_dff);_de9.toggle(this.domNode,this.baseClass+"-starred",_dff);},_setHierarchydepthAttr:function(_e00){this._set("hierarchydepth",_e00);_dea.set(this.domNode,"paddingLeft",((_e00-1)*16)+"px");},_setAlreadyconnectedAttr:function(_e01){this._set("alreadyconnected",_e01);_de9.toggle(this.domNode,this.baseClass+"-alreadyconnected",_e01);},onAction:function(_e02,_e03){},_handleActionClick:function(){_de7.create("div",{"class":"activity-indicator"},this._actionButton,"replace");return _df3.saveDocumentToGoogleDrive({parentId:this.item.googledrivefile.id,documentId:this.documentId}).then(lang.hitch(this,function(_e04){this.onAction(_e04.googledrivefile,_e04.documentId);}));}});var List=_de6([_df4],{baseClass:"googledrive-folder-list",type:"list",createEntryWidget:function(id,item,node){var ret=new Item({item:item,documentId:this.documentId},node);this.connect(ret,"onAction","onAction");return ret;},onAction:function(_e05,_e06){},queryOptions:{sort:function(a,b){var _e07=a.hierarchy.length;var _e08=b.hierarchy.length;var _e09=Math.max(_e07,_e08);var curr=0,i,_e0a,_e0b,_e0c,_e0d;for(i=0;i<_e09;i++){_e0a=a.hierarchy[i];_e0b=b.hierarchy[i];if(_e0a&&!_e0b){return 1;}else{if(!_e0a&&_e0b){return -1;}else{if(!_e0a&&!_e0b){break;}}}if(i===0){if(_e0a.googledrivefile.userPermission.isOwner&&!_e0b.googledrivefile.userPermission.isOwner){return -1;}else{if(!_e0a.googledrivefile.userPermission.isOwner&&_e0b.googledrivefile.userPermission.isOwner){return 1;}}}_e0c=_e0a?_e0a.googledrivefile.title.toLowerCase():null;_e0d=_e0b?_e0b.googledrivefile.title.toLowerCase():null;curr=_e0c<_e0d?-1:_e0c===_e0d?0:1;if(curr!==0){return curr;}}return 0;}}});var _e0e=_de6([_df0],{templateString:_df9,widgetsInTemplate:true,postMixInProperties:function(){this.inherited(arguments);this.afterwardsUrlUriComponent=encodeURIComponent(window.location);},postCreate:function(){this.inherited(arguments);this.activityIndicator=new _df1({activityIndicatorNode:this.activityIndicatorNode});this.activityIndicator.show();this.connect(this,"onAction",function(){api.Invalidate.users_me_ext_googledrive_folders.get();api.Invalidate.document_ext_googledrive_connections.getByDocumentid(this.documentId);});this.reload();},reload:function(){_deb({documentconnections:api.Caching.document_ext_googledrive_connections.getByDocumentid(this.documentId).then(api.Util.data),googledrivefolders:api.Caching.users_me_ext_googledrive_folders.get().then(api.Util.data)}).then(lang.hitch(this,function(_e0f){_de9.add(this._connectContent,"hideBlock");var list=this.list=(this.list||new List({documentId:this.documentId},this._listNode));list.store.query().forEach(function(item){list.store.remove(item.id);});this.connect(list,"onAction","onAction");var _e10={};dArr.forEach(_e0f.googledrivefolders,function(item){_e10[item.id]={googledrivefile:item,id:item.id,connections:[]};});dArr.forEach(_e0f.documentconnections,function(_e11){dArr.forEach(_e11.googleDriveFile.parents,function(_e12){if(_e10[_e12.id]){_e10[_e12.id].connections.push(_e11);}});});_dee.forIn(_e10,function(item,id){var _e13=item.googledrivefile.parents[0];var _e14=null;item.hierarchy=[item];while(_e13){_e14=_e10[_e13.id];if(_e14){if(_e14.hierarchy){item.hierarchy.unshift.apply(item.hierarchy,_e14.hierarchy);_e13=null;}else{item.hierarchy.unshift(_e14);_e13=_e14.googledrivefile.parents[0];}}else{_e13=null;}}list.store.put(item);});this.activityIndicator.hide();this.dialog.reposition();}),lang.hitch(this,function(_e15){if(!_e15||!_e15.error||!_e15.error.problemType){throw _e15;}if(_e15.error.problemType!=="social_connection_unauthorized"&&_e15.error.problemType!=="social_connection_missing"){throw _e15;}this.activityIndicator.hide();_de8.set(this._connectHint,{innerHTML:_df6.wrap(i18n)(_e15.error.problemType==="social_connection_unauthorized"?"connect_to_service_hint":"connect_to_account_hint")});_de8.set(this._connectButton,{href:_df7.addParamToUrl(_e15.error.detailObjects[0].connectUrl,"afterwardsUrl",window.location),innerHTML:_df6.wrap(i18n)(_e15.error.problemType==="social_connection_unauthorized"?"connect_to_service":"connect_to_account")});var _e16=_df8({element:this._connectButton,url:_df7.addParamToUrl(_e15.error.detailObjects[0].connectUrl,"afterwardsUrl","/__/js-close"),windowOptions:"width=360,dialog",onOpen:lang.hitch(this,function(){this.activityIndicator.show();}),onClose:lang.hitch(this,function(){_e16.remove();window.location.reload();})});this.own(_e16);_de9.remove(this._connectContent,"hideBlock");})).otherwise(lang.hitch(this,function(_e17){this.activityIndicator.hide();if(this._loadErrorNode){_de7.destroy(this._loadErrorNode);}this._loadErrorNode=_de7.create("span",{"class":"error","innerHTML":_df6.wrap(i18n)("error_loading_folders")},this._listNode,"after");}));},onAction:function(_e18,_e19){}});return _de6([_def],{documentId:null,baseClass:"export-to-googledrive-dialog with-title",postCreate:function(){this.inherited(arguments);_df5.checkGoogleDrive().then(lang.hitch(this,function(_e1a){switch(_e1a){case "enabled":var _e1b=new _e0e({dialog:this,i18n:i18n,documentId:this.documentId});this.connect(_e1b,"onAction","hide");break;case "premium":new _df0({dialog:this,i18n:i18n,templateString:"<div><div class=\"dialog-title\">${i18n.title}</div><div class=\"margin\"><p>${i18n.description}</p><p>${i18n.premium_account_only}The Salesforce Chatter integration is only available for paid accounts with team functionality.</p></div></div>"});break;case "disabled":default:break;}}));}});});},"wp/common/TextHelper":function(){define("wp/common/TextHelper",["dijit","dojo","dojox"],function(_e1c,dojo,_e1d){dojo.provide("wp.common.TextHelper");dojo.mixin(wp.common.TextHelper,{unescape:function(s){if(!s){return s;}var ret=s;ret=ret.replace(/&amp;/g,"&");ret=ret.replace(/&lt;/g,"<");ret=ret.replace(/&gt;/g,">");ret=ret.replace(/&quot;/g,"\"");ret=ret.replace(/&#39;/g,"'");return ret;}});});},"dojox/gfx/matrix":function(){define("dojox/gfx/matrix",["./_base","dojo/_base/lang"],function(g,lang){var m=g.matrix={};var _e1e={};m._degToRad=function(_e1f){return _e1e[_e1f]||(_e1e[_e1f]=(Math.PI*_e1f/180));};m._radToDeg=function(_e20){return _e20/Math.PI*180;};m.Matrix2D=function(arg){if(arg){if(typeof arg=="number"){this.xx=this.yy=arg;}else{if(arg instanceof Array){if(arg.length>0){var _e21=m.normalize(arg[0]);for(var i=1;i<arg.length;++i){var l=_e21,r=m.normalize(arg[i]);_e21=new m.Matrix2D();_e21.xx=l.xx*r.xx+l.xy*r.yx;_e21.xy=l.xx*r.xy+l.xy*r.yy;_e21.yx=l.yx*r.xx+l.yy*r.yx;_e21.yy=l.yx*r.xy+l.yy*r.yy;_e21.dx=l.xx*r.dx+l.xy*r.dy+l.dx;_e21.dy=l.yx*r.dx+l.yy*r.dy+l.dy;}lang.mixin(this,_e21);}}else{lang.mixin(this,arg);}}}};lang.extend(m.Matrix2D,{xx:1,xy:0,yx:0,yy:1,dx:0,dy:0});lang.mixin(m,{identity:new m.Matrix2D(),flipX:new m.Matrix2D({xx:-1}),flipY:new m.Matrix2D({yy:-1}),flipXY:new m.Matrix2D({xx:-1,yy:-1}),translate:function(a,b){if(arguments.length>1){return new m.Matrix2D({dx:a,dy:b});}return new m.Matrix2D({dx:a.x,dy:a.y});},scale:function(a,b){if(arguments.length>1){return new m.Matrix2D({xx:a,yy:b});}if(typeof a=="number"){return new m.Matrix2D({xx:a,yy:a});}return new m.Matrix2D({xx:a.x,yy:a.y});},rotate:function(_e22){var c=Math.cos(_e22);var s=Math.sin(_e22);return new m.Matrix2D({xx:c,xy:-s,yx:s,yy:c});},rotateg:function(_e23){return m.rotate(m._degToRad(_e23));},skewX:function(_e24){return new m.Matrix2D({xy:Math.tan(_e24)});},skewXg:function(_e25){return m.skewX(m._degToRad(_e25));},skewY:function(_e26){return new m.Matrix2D({yx:Math.tan(_e26)});},skewYg:function(_e27){return m.skewY(m._degToRad(_e27));},reflect:function(a,b){if(arguments.length==1){b=a.y;a=a.x;}var a2=a*a,b2=b*b,n2=a2+b2,xy=2*a*b/n2;return new m.Matrix2D({xx:2*a2/n2-1,xy:xy,yx:xy,yy:2*b2/n2-1});},project:function(a,b){if(arguments.length==1){b=a.y;a=a.x;}var a2=a*a,b2=b*b,n2=a2+b2,xy=a*b/n2;return new m.Matrix2D({xx:a2/n2,xy:xy,yx:xy,yy:b2/n2});},normalize:function(_e28){return (_e28 instanceof m.Matrix2D)?_e28:new m.Matrix2D(_e28);},isIdentity:function(_e29){return _e29.xx==1&&_e29.xy==0&&_e29.yx==0&&_e29.yy==1&&_e29.dx==0&&_e29.dy==0;},clone:function(_e2a){var obj=new m.Matrix2D();for(var i in _e2a){if(typeof (_e2a[i])=="number"&&typeof (obj[i])=="number"&&obj[i]!=_e2a[i]){obj[i]=_e2a[i];}}return obj;},invert:function(_e2b){var M=m.normalize(_e2b),D=M.xx*M.yy-M.xy*M.yx;M=new m.Matrix2D({xx:M.yy/D,xy:-M.xy/D,yx:-M.yx/D,yy:M.xx/D,dx:(M.xy*M.dy-M.yy*M.dx)/D,dy:(M.yx*M.dx-M.xx*M.dy)/D});return M;},_multiplyPoint:function(_e2c,x,y){return {x:_e2c.xx*x+_e2c.xy*y+_e2c.dx,y:_e2c.yx*x+_e2c.yy*y+_e2c.dy};},multiplyPoint:function(_e2d,a,b){var M=m.normalize(_e2d);if(typeof a=="number"&&typeof b=="number"){return m._multiplyPoint(M,a,b);}return m._multiplyPoint(M,a.x,a.y);},multiplyRectangle:function(_e2e,rect){var M=m.normalize(_e2e);rect=rect||{x:0,y:0,width:0,height:0};if(m.isIdentity(M)){return {x:rect.x,y:rect.y,width:rect.width,height:rect.height};}var p0=m.multiplyPoint(M,rect.x,rect.y),p1=m.multiplyPoint(M,rect.x,rect.y+rect.height),p2=m.multiplyPoint(M,rect.x+rect.width,rect.y),p3=m.multiplyPoint(M,rect.x+rect.width,rect.y+rect.height),minx=Math.min(p0.x,p1.x,p2.x,p3.x),miny=Math.min(p0.y,p1.y,p2.y,p3.y),maxx=Math.max(p0.x,p1.x,p2.x,p3.x),maxy=Math.max(p0.y,p1.y,p2.y,p3.y);return {x:minx,y:miny,width:maxx-minx,height:maxy-miny};},multiply:function(_e2f){var M=m.normalize(_e2f);for(var i=1;i<arguments.length;++i){var l=M,r=m.normalize(arguments[i]);M=new m.Matrix2D();M.xx=l.xx*r.xx+l.xy*r.yx;M.xy=l.xx*r.xy+l.xy*r.yy;M.yx=l.yx*r.xx+l.yy*r.yx;M.yy=l.yx*r.xy+l.yy*r.yy;M.dx=l.xx*r.dx+l.xy*r.dy+l.dx;M.dy=l.yx*r.dx+l.yy*r.dy+l.dy;}return M;},_sandwich:function(_e30,x,y){return m.multiply(m.translate(x,y),_e30,m.translate(-x,-y));},scaleAt:function(a,b,c,d){switch(arguments.length){case 4:return m._sandwich(m.scale(a,b),c,d);case 3:if(typeof c=="number"){return m._sandwich(m.scale(a),b,c);}return m._sandwich(m.scale(a,b),c.x,c.y);}return m._sandwich(m.scale(a),b.x,b.y);},rotateAt:function(_e31,a,b){if(arguments.length>2){return m._sandwich(m.rotate(_e31),a,b);}return m._sandwich(m.rotate(_e31),a.x,a.y);},rotategAt:function(_e32,a,b){if(arguments.length>2){return m._sandwich(m.rotateg(_e32),a,b);}return m._sandwich(m.rotateg(_e32),a.x,a.y);},skewXAt:function(_e33,a,b){if(arguments.length>2){return m._sandwich(m.skewX(_e33),a,b);}return m._sandwich(m.skewX(_e33),a.x,a.y);},skewXgAt:function(_e34,a,b){if(arguments.length>2){return m._sandwich(m.skewXg(_e34),a,b);}return m._sandwich(m.skewXg(_e34),a.x,a.y);},skewYAt:function(_e35,a,b){if(arguments.length>2){return m._sandwich(m.skewY(_e35),a,b);}return m._sandwich(m.skewY(_e35),a.x,a.y);},skewYgAt:function(_e36,a,b){if(arguments.length>2){return m._sandwich(m.skewYg(_e36),a,b);}return m._sandwich(m.skewYg(_e36),a.x,a.y);}});g.Matrix2D=m.Matrix2D;return m;});},"cb/xdomain/Communicator":function(){define(["dojo/on","dojo/Deferred","dojo/when","dojo/json","cb/util","dojox/lang/functional"],function(on,_e37,when,json,util,_e38){return function Communicator(_e39,_e3a){var _e3b={};if(!_e3a.reply){_e3a.reply=function(_e3c,_e3d,_e3e){if(!_e3c){return;}if(!_e3c.replyId){return;}if(_e3b[_e3c.replyId]){_e3b[_e3c.replyId].resolve(_e3c.reply);delete _e3b[_e3c.replyId];}else{}};}_e3a=_e38.mapIn(_e3a,function(_e3f,type){return function(){return _e3f.apply(this,arguments);};});var send=this.send=function send(_e40,_e41,type,_e42,_e43){var _e44=util.randomString(5);var _e45={type:type,value:_e42};if(_e43){_e45.replyId=_e44;_e3b[_e44]=new _e37();_e3b[_e44].then(function(_e46){_e43(_e46);});}_e40.postMessage(json.stringify(_e45),_e41);return function(){delete _e3b[_e44];};};on(window,"message",function(_e47){var _e48=_e39;var _e49=_e47.origin;if(!_e39.test(_e47.origin)){return;}var data=json.parse(_e47.data,true);if(data===null||!data){}else{if(!data.type){}else{if(_e3a.hasOwnProperty(data.type)){var _e4a=_e3a[data.type].call(null,data.value,_e47.source,_e47.origin);if(data.replyId){when(_e4a).then(function(v){if(v!==undefined){send(_e47.source,_e47.origin,"reply",{replyId:data.replyId,reply:v});}});}}else{}}}});};});},"dojo/dnd/Source":function(){define(["../_base/array","../_base/connect","../_base/declare","../_base/kernel","../_base/lang","../dom-class","../dom-geometry","../mouse","../ready","../topic","./common","./Selector","./Manager"],function(_e4b,_e4c,_e4d,_e4e,lang,_e4f,_e50,_e51,_e52,_e53,dnd,_e54,_e55){if(!_e4e.isAsync){_e52(0,function(){var _e56=["dojo/dnd/AutoSource","dojo/dnd/Target"];require(_e56);});}var _e57=_e4d("dojo.dnd.Source",_e54,{isSource:true,horizontal:false,copyOnly:false,selfCopy:false,selfAccept:true,skipForm:false,withHandles:false,autoSync:false,delay:0,accept:["text"],generateText:true,constructor:function(node,_e58){lang.mixin(this,lang.mixin({},_e58));var type=this.accept;if(type.length){this.accept={};for(var i=0;i<type.length;++i){this.accept[type[i]]=1;}}this.isDragging=false;this.mouseDown=false;this.targetAnchor=null;this.targetBox=null;this.before=true;this._lastX=0;this._lastY=0;this.sourceState="";if(this.isSource){_e4f.add(this.node,"dojoDndSource");}this.targetState="";if(this.accept){_e4f.add(this.node,"dojoDndTarget");}if(this.horizontal){_e4f.add(this.node,"dojoDndHorizontal");}this.topics=[_e53.subscribe("/dnd/source/over",lang.hitch(this,"onDndSourceOver")),_e53.subscribe("/dnd/start",lang.hitch(this,"onDndStart")),_e53.subscribe("/dnd/drop",lang.hitch(this,"onDndDrop")),_e53.subscribe("/dnd/cancel",lang.hitch(this,"onDndCancel"))];},checkAcceptance:function(_e59,_e5a){if(this==_e59){return !this.copyOnly||this.selfAccept;}for(var i=0;i<_e5a.length;++i){var type=_e59.getItem(_e5a[i].id).type;var flag=false;for(var j=0;j<type.length;++j){if(type[j] in this.accept){flag=true;break;}}if(!flag){return false;}}return true;},copyState:function(_e5b,self){if(_e5b){return true;}if(arguments.length<2){self=this==_e55.manager().target;}if(self){if(this.copyOnly){return this.selfCopy;}}else{return this.copyOnly;}return false;},destroy:function(){_e57.superclass.destroy.call(this);_e4b.forEach(this.topics,function(t){t.remove();});this.targetAnchor=null;},onMouseMove:function(e){if(this.isDragging&&this.targetState=="Disabled"){return;}_e57.superclass.onMouseMove.call(this,e);var m=_e55.manager();if(!this.isDragging){if(this.mouseDown&&this.isSource&&(Math.abs(e.pageX-this._lastX)>this.delay||Math.abs(e.pageY-this._lastY)>this.delay)){var _e5c=this.getSelectedNodes();if(_e5c.length){m.startDrag(this,_e5c,this.copyState(dnd.getCopyKeyState(e),true));}}}if(this.isDragging){var _e5d=false;if(this.current){if(!this.targetBox||this.targetAnchor!=this.current){this.targetBox=_e50.position(this.current,true);}if(this.horizontal){_e5d=(e.pageX-this.targetBox.x<this.targetBox.w/2)==_e50.isBodyLtr(this.current.ownerDocument);}else{_e5d=(e.pageY-this.targetBox.y)<(this.targetBox.h/2);}}if(this.current!=this.targetAnchor||_e5d!=this.before){this._markTargetAnchor(_e5d);m.canDrop(!this.current||m.source!=this||!(this.current.id in this.selection));}}},onMouseDown:function(e){if(!this.mouseDown&&this._legalMouseDown(e)&&(!this.skipForm||!dnd.isFormElement(e))){this.mouseDown=true;this._lastX=e.pageX;this._lastY=e.pageY;_e57.superclass.onMouseDown.call(this,e);}},onMouseUp:function(e){if(this.mouseDown){this.mouseDown=false;_e57.superclass.onMouseUp.call(this,e);}},onDndSourceOver:function(_e5e){if(this!==_e5e){this.mouseDown=false;if(this.targetAnchor){this._unmarkTargetAnchor();}}else{if(this.isDragging){var m=_e55.manager();m.canDrop(this.targetState!="Disabled"&&(!this.current||m.source!=this||!(this.current.id in this.selection)));}}},onDndStart:function(_e5f,_e60,copy){if(this.autoSync){this.sync();}if(this.isSource){this._changeState("Source",this==_e5f?(copy?"Copied":"Moved"):"");}var _e61=this.accept&&this.checkAcceptance(_e5f,_e60);this._changeState("Target",_e61?"":"Disabled");if(this==_e5f){_e55.manager().overSource(this);}this.isDragging=true;},onDndDrop:function(_e62,_e63,copy,_e64){if(this==_e64){this.onDrop(_e62,_e63,copy);}this.onDndCancel();},onDndCancel:function(){if(this.targetAnchor){this._unmarkTargetAnchor();this.targetAnchor=null;}this.before=true;this.isDragging=false;this.mouseDown=false;this._changeState("Source","");this._changeState("Target","");},onDrop:function(_e65,_e66,copy){if(this!=_e65){this.onDropExternal(_e65,_e66,copy);}else{this.onDropInternal(_e66,copy);}},onDropExternal:function(_e67,_e68,copy){var _e69=this._normalizedCreator;if(this.creator){this._normalizedCreator=function(node,hint){return _e69.call(this,_e67.getItem(node.id).data,hint);};}else{if(copy){this._normalizedCreator=function(node){var t=_e67.getItem(node.id);var n=node.cloneNode(true);n.id=dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}else{this._normalizedCreator=function(node){var t=_e67.getItem(node.id);_e67.delItem(node.id);return {node:node,data:t.data,type:t.type};};}}this.selectNone();if(!copy&&!this.creator){_e67.selectNone();}this.insertNodes(true,_e68,this.before,this.current);if(!copy&&this.creator){_e67.deleteSelectedNodes();}this._normalizedCreator=_e69;},onDropInternal:function(_e6a,copy){var _e6b=this._normalizedCreator;if(this.current&&this.current.id in this.selection){return;}if(copy){if(this.creator){this._normalizedCreator=function(node,hint){return _e6b.call(this,this.getItem(node.id).data,hint);};}else{this._normalizedCreator=function(node){var t=this.getItem(node.id);var n=node.cloneNode(true);n.id=dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}}else{if(!this.current){return;}this._normalizedCreator=function(node){var t=this.getItem(node.id);return {node:node,data:t.data,type:t.type};};}this._removeSelection();this.insertNodes(true,_e6a,this.before,this.current);this._normalizedCreator=_e6b;},onDraggingOver:function(){},onDraggingOut:function(){},onOverEvent:function(){_e57.superclass.onOverEvent.call(this);_e55.manager().overSource(this);if(this.isDragging&&this.targetState!="Disabled"){this.onDraggingOver();}},onOutEvent:function(){_e57.superclass.onOutEvent.call(this);_e55.manager().outSource(this);if(this.isDragging&&this.targetState!="Disabled"){this.onDraggingOut();}},_markTargetAnchor:function(_e6c){if(this.current==this.targetAnchor&&this.before==_e6c){return;}if(this.targetAnchor){this._removeItemClass(this.targetAnchor,this.before?"Before":"After");}this.targetAnchor=this.current;this.targetBox=null;this.before=_e6c;if(this.targetAnchor){this._addItemClass(this.targetAnchor,this.before?"Before":"After");}},_unmarkTargetAnchor:function(){if(!this.targetAnchor){return;}this._removeItemClass(this.targetAnchor,this.before?"Before":"After");this.targetAnchor=null;this.targetBox=null;this.before=true;},_markDndStatus:function(copy){this._changeState("Source",copy?"Copied":"Moved");},_legalMouseDown:function(e){if(e.type!="touchstart"&&!_e51.isLeft(e)){return false;}if(!this.withHandles){return true;}for(var node=e.target;node&&node!==this.node;node=node.parentNode){if(_e4f.contains(node,"dojoDndHandle")){return true;}if(_e4f.contains(node,"dojoDndItem")||_e4f.contains(node,"dojoDndIgnore")){break;}}return false;}});return _e57;});},"cb/common/ImageLoaderQueue":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/Deferred","dojo/_base/window","dojo/ready","dojo/on","dojo/when","dojo/dom-construct","dojo/dom-attr","./Queue"],function(_e6d,lang,_e6e,_e6f,_e70,on,when,_e71,_e72,_e73){function _e74(_e75,src,fn){var _e76=new _e6e();var _e77;function _e78(){if(_e76.fired!==-1||(_e76.isResolved&&_e76.isResolved())){return;}_e71.destroy(_e77);try{var ret=fn();_e76.resolve(ret,false);}catch(e){_e76.resolve(e,false);}};return function(){_e77=_e71.create("img",null,_e75);on.once(_e77,"load",_e78);_e72.set(_e77,"src",src);if(_e77.complete){_e78();}return _e76;};};var _e79=_e6d([_e73],{constructor:function(){this._cache={};_e70(lang.hitch(this,function(){this.preloaderNode=_e71.create("div",{"class":"preloadernode"},_e6f.body(),"first");}));},waitForImageLoad:function(src,fn){var _e7a=this._cache;if(_e7a[src]){fn();return;}return this.submit(_e74(this.preloaderNode,src,function(){_e7a[src]=true;fn();}));}});return new _e79();});},"cb/page/pad/sidebar/OutlineList":function(){define(["dojo","dojo/_base/declare","dojo/dom-construct","dojo/dom-class","dojo/dom","wp/widget/SidebarList","dojo/dnd/Source","dojo/dnd/Manager","sp/I18n","./_SidebarSizer","dojo/i18n!wp/widget/nls/Sidebar"],function(dojo,_e7b,_e7c,_e7d,dom,_e7e,_e7f,_e80,_e81,_e82,_e83){return _e7b([_e7e],{useTheLastEntry:false,postCreate:function(){this.inherited("postCreate",arguments);var _e84=dojo.declare([_e7f],{copyState:function(){return false;}});this.dragSource=new _e84(this._listNode,{singular:true});_e80.manager().OFFSET_X=4;_e80.manager().OFFSET_Y=4;this.connect(this.dragSource,"onDrop",function(_e85,copy){this._reorderElementsAfterDrag(copy);});this.connect(this.dragSource,"onDraggingOut",function(){dojo.publish("/dnd/cancel");_e80.manager().stopDrag();});this.connect(this,"onSidebarElementAdded",function(_e86,_e87){dojo.publish("/sp/sidebar/itemadded",[_e86.id,_e87]);});this.connect(this,"onSidebarElementAdded",function(_e88,_e89){this._enhanceWithOutlineRemoval(_e88);this._enhanceWithReordering(_e88);});this.subscribe("/sp/outline/add","_addItemsToOutline");this.subscribe("/sp/outline/toggle","_toggleItemsInOutline");this.subscribe("/sp/outline/callback/orderingkeyatend","_callbackOrderingKeyAtEnd");this._emptyMessageNode=_e7c.create("div",{"class":"empty-message",innerHTML:_e81.wrap(_e83)("sidebar_empty_outline_message")},this.domNode);var _e8a=_e7c.create("h3",{"class":"outline-headline",innerHTML:sp.I18n.get("wp.widget","Sidebar")("sidebar_outline_label")},this.domNode,"first");this._sizer=new _e82({node:this.containerNode,list:this,sidebar:this.sidebar});},itemComparator:function(a,b){return a.orderingKey-b.orderingKey;},isRelevantItem:function(item,_e8b){var ret=item.outline&&((item.type==="txtG"&&item.subtype!=="textbox")||item.type==="image");return ret;},_callbackOrderingKeyAtEnd:function(fn){fn(this.newOrderingKeyAtEnd());},_addSingleItemToOutline:function(_e8c){if(this._sidebarElements[_e8c]){return;}var _e8d=this.pad.container.getItemCopy(_e8c);_e8d.orderingKey=this.newOrderingKeyAtEnd();_e8d.outline=true;if(this.isRelevantItem(_e8d,_e8d)){this.pad.container.addOrUpdateItems([_e8d]);}},_removeSingleItemFromOutline:function(_e8e){var _e8f=this.pad.container.getItemCopy(_e8e);_e8f.outline=false;this.pad.container.addOrUpdateItems([_e8f]);this.dragSource.delItem(_e8e);},_addItemsToOutline:function(_e90){dojo.forEach(_e90,function(item){this._addSingleItemToOutline(item.id);},this);},_toggleItemsInOutline:function(_e91){dojo.forEach(_e91,function(item){if(this._sidebarElements[item.id]&&item.outline){this._removeSingleItemFromOutline(item.id);}else{this._addSingleItemToOutline(item.id);}},this);},_enhanceWithOutlineRemoval:function(_e92){if(dojo.hasClass(_e92.liNode,"outline-removable")){return;}var _e93=dojo.create("span",{"innerHTML":"<i class=\"fonticon-trashcan\"></i>","title":sp.I18n.get("wp.widget","Sidebar")("sidebar_outline_remove")},_e92.controlsNode);this.connect(_e93,"click",function(){this._removeSingleItemFromOutline(_e92.id);});dojo.addClass(_e92.liNode,"outline-removable");},_enhanceWithReordering:function(_e94){if(dojo.hasClass(_e94.liNode,"outline-reorderable")){return;}var _e95=dojo.create("span",{"innerHTML":"<i class=\"fonticon-arrow-down\"></i>","title":sp.I18n.get("wp.widget","Sidebar")("sidebar_outline_movedown")},_e94.controlsNode,"first");var _e96=dojo.create("span",{"innerHTML":"<i class=\"fonticon-arrow-up\"></i>","title":sp.I18n.get("wp.widget","Sidebar")("sidebar_outline_moveup")},_e94.controlsNode,"first");this.connect(_e96,"click",function(){this._moveElementUp(_e94);});this.connect(_e95,"click",function(){this._moveElementDown(_e94);});dojo.attr(_e94.liNode,"id",_e94.id);dojo.addClass(_e94.liNode,"outline-reorderable dojoDndItem");this.dragSource.setItem(_e94.id,{data:_e94.liNode,type:["draggable"]});},_reorderElementsAfterDrag:function(node){this.dragSource.selectNone();var _e97=this._getOrCreateSidebarElement(node[0]);var prev=dojo.query(_e97.liNode).prev();var _e98=prev.length>0?prev[0]:null;var next=dojo.query(_e97.liNode).next();var _e99=next.length>0?next[0]:null;this._moveElementBetween(_e97,_e98,_e99);},_moveElementUp:function(_e9a){var prev=dojo.query(_e9a.liNode).prev();if(prev.length<1){return;}var _e9b=prev.prev();var _e9c=prev[0];var _e9d=_e9b.length>0?_e9b[0]:null;this._moveElementBetween(_e9a,_e9d,_e9c);},_moveElementDown:function(_e9e){var next=dojo.query(_e9e.liNode).next();if(next.length<1){return;}var _e9f=next.next();var _ea0=next[0];var _ea1=_e9f.length>0?_e9f[0]:null;this._moveElementBetween(_e9e,_ea0,_ea1);},_moveElementBetween:function(_ea2,_ea3,_ea4){var _ea5=_ea3?this._sidebarElements[dojo.attr(_ea3,"spItemId")]:null;var _ea6=_ea4?this._sidebarElements[dojo.attr(_ea4,"spItemId")]:null;var _ea7;var _ea8=(_ea5?_ea5.orderingKey:null);var _ea9=(_ea6?_ea6.orderingKey:null);var _eaa=!!_ea8||_ea8===0;var _eab=!!_ea9||_ea9===0;if(_eaa&&_eab){_ea7=(_ea8+_ea9)/2;}else{if(_eaa&&!_eab){_ea7=this.newOrderingKeyAtEnd();}else{if(!_eaa&&_eab){_ea7=this.newOrderingKeyAtStart();}else{_ea7=this.newOrderingKeyAtEnd();}}}if(!_ea7){return;}var _eac=this.pad.container.getItemCopy(_ea2.id);_eac.orderingKey=_ea7;this.pad.container.addOrUpdateItems([_eac]);}});});},"url:cb/board/conference/ConferenceContainer.html":"<div class=\"conference-container\">\r\n    \r\n    \r\n    <span \r\n            type=\"checkbox\" \r\n            id=\"${id}_live_locations\" \r\n            data-dojo-type=\"cb/widget/StateButton\" \r\n            data-dojo-attach-event=\"onChange:_handleChangeLiveLocations\"\r\n            data-dojo-props=\"iconClass: 'fonticon-live-location'\"\r\n            data-dojo-attach-point=\"_livelocationsSwitch\">${!i18n.live_locations_label}</span>\r\n                    \r\n\t<span\r\n            type=\"checkbox\"\r\n\t\t\tid=\"${id}_video\"\r\n            data-dojo-type=\"cb/widget/StateButton\"\r\n            data-dojo-attach-event=\"onChange:_handleChangeVideo\"\r\n            data-dojo-attach-point=\"_videoSwitch\"\r\n            disabled=\"true\"\r\n            data-dojo-props=\"iconClass: 'fonticon-video-camera'\"\r\n            ${videoCheckedAttr}>${!i18n.video_label}</span>\r\n                    \r\n\t<span\r\n            type=\"checkbox\"\r\n            id=\"${id}_moderator\"\r\n            data-dojo-type=\"cb/widget/StateButton\"\r\n            data-dojo-attach-event=\"onChange:_handleChangeModerator\"\r\n            data-dojo-attach-point=\"_moderatorSwitch\"\r\n            disabled=\"true\"\r\n            data-dojo-props=\"iconClass: 'fonticon-presentation-alt'\">${!i18n.moderator_label}</span>\r\n    \r\n</div>\r\n","dojox/gfx/path":function(){define("dojox/gfx/path",["./_base","dojo/_base/lang","dojo/_base/declare","./matrix","./shape"],function(g,lang,_ead,_eae,_eaf){var Path=_ead("dojox.gfx.path.Path",_eaf.Shape,{constructor:function(_eb0){this.shape=lang.clone(g.defaultPath);this.segments=[];this.tbbox=null;this.absolute=true;this.last={};this.rawNode=_eb0;this.segmented=false;},setAbsoluteMode:function(mode){this._confirmSegmented();this.absolute=typeof mode=="string"?(mode=="absolute"):mode;return this;},getAbsoluteMode:function(){this._confirmSegmented();return this.absolute;},getBoundingBox:function(){this._confirmSegmented();return (this.bbox&&("l" in this.bbox))?{x:this.bbox.l,y:this.bbox.t,width:this.bbox.r-this.bbox.l,height:this.bbox.b-this.bbox.t}:null;},_getRealBBox:function(){this._confirmSegmented();if(this.tbbox){return this.tbbox;}var bbox=this.bbox,_eae=this._getRealMatrix();this.bbox=null;for(var i=0,len=this.segments.length;i<len;++i){this._updateWithSegment(this.segments[i],_eae);}var t=this.bbox;this.bbox=bbox;this.tbbox=t?[{x:t.l,y:t.t},{x:t.r,y:t.t},{x:t.r,y:t.b},{x:t.l,y:t.b}]:null;return this.tbbox;},getLastPosition:function(){this._confirmSegmented();return "x" in this.last?this.last:null;},_applyTransform:function(){this.tbbox=null;return this.inherited(arguments);},_updateBBox:function(x,y,m){if(m){var t=_eae.multiplyPoint(m,x,y);x=t.x;y=t.y;}if(this.bbox&&("l" in this.bbox)){if(this.bbox.l>x){this.bbox.l=x;}if(this.bbox.r<x){this.bbox.r=x;}if(this.bbox.t>y){this.bbox.t=y;}if(this.bbox.b<y){this.bbox.b=y;}}else{this.bbox={l:x,b:y,r:x,t:y};}},_updateWithSegment:function(_eb1,_eb2){var n=_eb1.args,l=n.length,i;switch(_eb1.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(i=0;i<l;i+=2){this._updateBBox(n[i],n[i+1],_eb2);}this.last.x=n[l-2];this.last.y=n[l-1];this.absolute=true;break;case "H":for(i=0;i<l;++i){this._updateBBox(n[i],this.last.y,_eb2);}this.last.x=n[l-1];this.absolute=true;break;case "V":for(i=0;i<l;++i){this._updateBBox(this.last.x,n[i],_eb2);}this.last.y=n[l-1];this.absolute=true;break;case "m":var _eb3=0;if(!("x" in this.last)){this._updateBBox(this.last.x=n[0],this.last.y=n[1],_eb2);_eb3=2;}for(i=_eb3;i<l;i+=2){this._updateBBox(this.last.x+=n[i],this.last.y+=n[i+1],_eb2);}this.absolute=false;break;case "l":case "t":for(i=0;i<l;i+=2){this._updateBBox(this.last.x+=n[i],this.last.y+=n[i+1],_eb2);}this.absolute=false;break;case "h":for(i=0;i<l;++i){this._updateBBox(this.last.x+=n[i],this.last.y,_eb2);}this.absolute=false;break;case "v":for(i=0;i<l;++i){this._updateBBox(this.last.x,this.last.y+=n[i],_eb2);}this.absolute=false;break;case "c":for(i=0;i<l;i+=6){this._updateBBox(this.last.x+n[i],this.last.y+n[i+1],_eb2);this._updateBBox(this.last.x+n[i+2],this.last.y+n[i+3],_eb2);this._updateBBox(this.last.x+=n[i+4],this.last.y+=n[i+5],_eb2);}this.absolute=false;break;case "s":case "q":for(i=0;i<l;i+=4){this._updateBBox(this.last.x+n[i],this.last.y+n[i+1],_eb2);this._updateBBox(this.last.x+=n[i+2],this.last.y+=n[i+3],_eb2);}this.absolute=false;break;case "A":for(i=0;i<l;i+=7){this._updateBBox(n[i+5],n[i+6],_eb2);}this.last.x=n[l-2];this.last.y=n[l-1];this.absolute=true;break;case "a":for(i=0;i<l;i+=7){this._updateBBox(this.last.x+=n[i+5],this.last.y+=n[i+6],_eb2);}this.absolute=false;break;}var path=[_eb1.action];for(i=0;i<l;++i){path.push(g.formatNumber(n[i],true));}if(typeof this.shape.path=="string"){this.shape.path+=path.join("");}else{Array.prototype.push.apply(this.shape.path,path);}},_validSegments:{m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},_pushSegment:function(_eb4,args){this.tbbox=null;var _eb5=this._validSegments[_eb4.toLowerCase()],_eb6;if(typeof _eb5=="number"){if(_eb5){if(args.length>=_eb5){_eb6={action:_eb4,args:args.slice(0,args.length-args.length%_eb5)};this.segments.push(_eb6);this._updateWithSegment(_eb6);}}else{_eb6={action:_eb4,args:[]};this.segments.push(_eb6);this._updateWithSegment(_eb6);}}},_collectArgs:function(_eb7,args){for(var i=0;i<args.length;++i){var t=args[i];if(typeof t=="boolean"){_eb7.push(t?1:0);}else{if(typeof t=="number"){_eb7.push(t);}else{if(t instanceof Array){this._collectArgs(_eb7,t);}else{if("x" in t&&"y" in t){_eb7.push(t.x,t.y);}}}}}},moveTo:function(){this._confirmSegmented();var args=[];this._collectArgs(args,arguments);this._pushSegment(this.absolute?"M":"m",args);return this;},lineTo:function(){this._confirmSegmented();var args=[];this._collectArgs(args,arguments);this._pushSegment(this.absolute?"L":"l",args);return this;},hLineTo:function(){this._confirmSegmented();var args=[];this._collectArgs(args,arguments);this._pushSegment(this.absolute?"H":"h",args);return this;},vLineTo:function(){this._confirmSegmented();var args=[];this._collectArgs(args,arguments);this._pushSegment(this.absolute?"V":"v",args);return this;},curveTo:function(){this._confirmSegmented();var args=[];this._collectArgs(args,arguments);this._pushSegment(this.absolute?"C":"c",args);return this;},smoothCurveTo:function(){this._confirmSegmented();var args=[];this._collectArgs(args,arguments);this._pushSegment(this.absolute?"S":"s",args);return this;},qCurveTo:function(){this._confirmSegmented();var args=[];this._collectArgs(args,arguments);this._pushSegment(this.absolute?"Q":"q",args);return this;},qSmoothCurveTo:function(){this._confirmSegmented();var args=[];this._collectArgs(args,arguments);this._pushSegment(this.absolute?"T":"t",args);return this;},arcTo:function(){this._confirmSegmented();var args=[];this._collectArgs(args,arguments);this._pushSegment(this.absolute?"A":"a",args);return this;},closePath:function(){this._confirmSegmented();this._pushSegment("Z",[]);return this;},_confirmSegmented:function(){if(!this.segmented){var path=this.shape.path;this.shape.path=[];this._setPath(path);this.shape.path=this.shape.path.join("");this.segmented=true;}},_setPath:function(path){var p=lang.isArray(path)?path:path.match(g.pathSvgRegExp);this.segments=[];this.absolute=true;this.bbox={};this.last={};if(!p){return;}var _eb8="",args=[],l=p.length;for(var i=0;i<l;++i){var t=p[i],x=parseFloat(t);if(isNaN(x)){if(_eb8){this._pushSegment(_eb8,args);}args=[];_eb8=t;}else{args.push(x);}}this._pushSegment(_eb8,args);},setShape:function(_eb9){this.inherited(arguments,[typeof _eb9=="string"?{path:_eb9}:_eb9]);this.segmented=false;this.segments=[];if(!g.lazyPathSegmentation){this._confirmSegmented();}return this;},_2PI:Math.PI*2});var _eba=_ead("dojox.gfx.path.TextPath",Path,{constructor:function(_ebb){if(!("text" in this)){this.text=lang.clone(g.defaultTextPath);}if(!("fontStyle" in this)){this.fontStyle=lang.clone(g.defaultFont);}},getText:function(){return this.text;},setText:function(_ebc){this.text=g.makeParameters(this.text,typeof _ebc=="string"?{text:_ebc}:_ebc);this._setText();return this;},getFont:function(){return this.fontStyle;},setFont:function(_ebd){this.fontStyle=typeof _ebd=="string"?g.splitFontString(_ebd):g.makeParameters(g.defaultFont,_ebd);this._setFont();return this;}});return g.path={Path:Path,TextPath:_eba};});},"wp/data/ContainerHistoryAddOn":function(){define("wp/data/ContainerHistoryAddOn",["dijit","dojo","dojox"],function(_ebe,dojo,_ebf){dojo.provide("wp.data.ContainerHistoryAddOn");dojo.declare("wp.data.ContainerHistoryAddOn",null,{constructor:function(){this._historyMapU={};this._historyMapR={};this._historyPointer=-1;this._historyCBSize=65;this._historyCBStart=0;this._historyCBEnd=0;},_nextHistoryEntry:function(){this._historyPointer=this._incCBPointer(this._historyPointer);this._historyCBEnd=this._incCBPointer(this._historyPointer);this._historyMapU[this._historyCBEnd]=null;this._historyMapR[this._historyCBEnd]=null;if(this._historyCBStart==this._historyCBEnd){this._historyCBStart=this._incCBPointer(this._historyCBStart);}this._historyMapU[this._historyPointer]=[];this._historyMapR[this._historyPointer]=[];},_addToHistory:function(_ec0,_ec1){this._historyMapU[this._historyPointer].push(_ec0);this._historyMapR[this._historyPointer].push(_ec1);this.sendHistoryPossibilites();},sendHistoryPossibilites:function(){dojo.publish("/container/history/undo",[this.isUndoPossible()]);dojo.publish("/container/history/redo",[this.isRedoPossible()]);},_createCleanCopyFromHistory:function(item){if(dojo.isArrayLike(item)){return dojo.map(item,this._createCleanCopyFromHistory,this);}else{var ret=dojo.delegate(item);ret.seq=null;return ret;}},isUndoPossible:function(){return this._historyMapU[this._historyPointer]&&this._historyMapU[this._historyPointer].length>0;},undo:function(){if(this.isUndoPossible()){this._addOrUpdateItems(this._createCleanCopyFromHistory(this._historyMapU[this._historyPointer]),true,true);this._historyPointer=this._decCBPointer(this._historyPointer);this.sendHistoryPossibilites();}},isRedoPossible:function(){return this._historyMapR[this._incCBPointer(this._historyPointer)]&&this._historyMapR[this._incCBPointer(this._historyPointer)].length>0;},redo:function(){if(this.isRedoPossible()){this._addOrUpdateItems(this._createCleanCopyFromHistory(this._historyMapR[this._incCBPointer(this._historyPointer)]),true,true);this._historyPointer=this._incCBPointer(this._historyPointer);this.sendHistoryPossibilites();}},_incCBPointer:function(_ec2){return _ec2+1>=this._historyCBSize?0:_ec2+1;},_decCBPointer:function(_ec3){return _ec3-1<0?this._historyCBSize-1:_ec3-1;}});});},"wp/SimpleObjects":function(){define("wp/SimpleObjects",["./Point","./PointArray","./Text","./TextArray","./BBox","./UniqueArray"],{});},"dojox/gfx/renderer":function(){define("dojox/gfx/renderer",["./_base","dojo/_base/lang","dojo/_base/sniff","dojo/_base/window","dojo/_base/config"],function(g,lang,has,win,_ec4){var _ec5=null;return {load:function(id,_ec6,load){if(_ec5&&id!="force"){load(_ec5);return;}var _ec7=_ec4.forceGfxRenderer,_ec8=!_ec7&&(lang.isString(_ec4.gfxRenderer)?_ec4.gfxRenderer:"svg,vml,canvas,silverlight").split(","),_ec9,_eca;while(!_ec7&&_ec8.length){switch(_ec8.shift()){case "svg":if("SVGAngle" in win.global){_ec7="svg";}break;case "vml":if(has("ie")){_ec7="vml";}break;case "silverlight":try{if(has("ie")){_ec9=new ActiveXObject("AgControl.AgControl");if(_ec9&&_ec9.IsVersionSupported("1.0")){_eca=true;}}else{if(navigator.plugins["Silverlight Plug-In"]){_eca=true;}}}catch(e){_eca=false;}finally{_ec9=null;}if(_eca){_ec7="silverlight";}break;case "canvas":if(win.global.CanvasRenderingContext2D){_ec7="canvas";}break;}}if(_ec7==="canvas"&&_ec4.canvasEvents!==false){_ec7="canvasWithEvents";}if(_ec4.isDebug){}function _ecb(){_ec6(["dojox/gfx/"+_ec7],function(_ecc){g.renderer=_ec7;_ec5=_ecc;load(_ecc);});};if(_ec7=="svg"&&typeof window.svgweb!="undefined"){window.svgweb.addOnLoad(_ecb);}else{_ecb();}}};});},"dojo/dnd/Target":function(){define(["../_base/declare","../dom-class","./Source"],function(_ecd,_ece,_ecf){return _ecd("dojo.dnd.Target",_ecf,{constructor:function(){this.isSource=false;_ece.remove(this.node,"dojoDndSource");}});});},"wp/data/ContainerBBoxAddOn":function(){define("wp/data/ContainerBBoxAddOn",["dijit","dojo","dojox"],function(_ed0,dojo,_ed1){dojo.provide("wp.data.ContainerBBoxAddOn");dojo.declare("wp.data.ContainerBBoxAddOn",null,{constructor:function(){},getBBox:function(id){var bbox=null;if(id){var item=this._getBBoxItem(id);if(item){if(item.type=="txtE"){return this.getBBox(item.txtGId)||null;}else{if(item.type=="group"){if(item.ids&&item.ids.length){for(var i=0;i<item.ids.length;i++){var _ed2=item.ids[i];if(_ed2===id){continue;}var _ed3=this.getBBox(_ed2);if(!bbox&&_ed3){bbox=_ed3;}else{if(bbox&&_ed3){bbox.expandByBBox(_ed3);}}}return bbox;}}else{bbox=this._getBBoxByItem(item);if(bbox){return bbox;}}}}}else{return this._itemMap.getBBox();}return null;},_getBBoxItem:function(id){if(!id||!this.containsItem(id)){return null;}var item=this.getPreviewItem(id);if(!item){item=this.getItem(id);}return item;},_getHalfLineWidth:function(item){return !item.lw?0:Math.floor(item.lw/2);},_getBBoxByItem:function(item){if(!item){return null;}var bbox;if(item.isWidget){var _ed4=this._pad.surface.registerWidget(item.id,item.type,item.subtype).getDivHeight();var _ed5=Math.ceil(_ed4/this._pad.surface.getZoomFactor());bbox=new wp.BBox(item.a,{x:item.b.x+2,y:item.a.y+_ed5+1});}else{bbox=item.getBBox();}return bbox;},_getBBoxByDojoSingleShape:function(_ed6,_ed7){if(!_ed6){return null;}var bbox=null;if(!_ed6.getTransform){var tmp=_ed6.getBoundingBox();if(tmp){bbox=new wp.BBox(this._pad.surface.convertViewport2Item({x:tmp.x1,y:tmp.y1}),this._pad.surface.convertViewport2Item({x:tmp.x2,y:tmp.y2}));}}else{var tmp=_ed6.getTransformedBoundingBox();if(tmp){var p1=this._pad.surface.convertViewport2Item({x:tmp[0].x,y:tmp[0].y});var p2=this._pad.surface.convertViewport2Item({x:tmp[2].x,y:tmp[2].y});p1.x-=_ed7;p1.y-=_ed7;p2.x+=_ed7;p2.y+=_ed7;bbox=new wp.BBox(p1,p2);}}return bbox;}});});},"wp/Point":function(){define("wp/Point",["dojo/_base/declare"],function(_ed8){var wp={};wp.Point=_ed8("wp.Point",null,{constructor:function(x,y){if(arguments.length===1&&dojo.isObject(x)){this.x=x.x;this.y=x.y;}else{this.x=1*x;this.y=1*y;}},translate:function(_ed9,_eda){return new wp.Point(this.x+_ed9,this.y+_eda);},json:function(){return {"x":this.x,"y":this.y};},toIntCoordinates:function(){return new wp.Point(Math.ceil(this.x),Math.ceil(this.y));}});wp.Point.isWpPointLike=function(o){if(o===null){return false;}if(!dojo.isObject(o)){return false;}return o.hasOwnProperty("x")&&o.hasOwnProperty("y");};wp.Point.equals=function(a,b){if(wp.Point.isWpPointLike(a)&&wp.Point.isWpPointLike(b)){return b.x===a.x&&b.y===a.y;}return false;};return wp.Point;});},"wp/surface/SurfaceShapeAddOn":function(){define("wp/surface/SurfaceShapeAddOn",["dijit","dojo","dojox"],function(_edb,dojo,_edc){dojo.provide("wp.surface.SurfaceShapeAddOn");dojo.declare("wp.surface.SurfaceShapeAddOn",null,{constructor:function(){this._shapeTrashList=[];},getRootGroup:function(){if(!this._rootGroup){this._rootGroup=this._surface.createGroup();this._rootGroup.setTransform({xx:1,yy:1});}return this._rootGroup;},createShapeGroup:function(){return this.getRootGroup().createGroup();},removeShapeGroup:function(_edd){if(_edd){this.removeShapeVisuallyAndMarkForCleanup(_edd);}},removeNodeVisuallyAndMarkForCleanup:function(node){dojo.place(node,this._padTrashNode);dojo.style(node,"display","none");},removeShapeVisuallyAndMarkForCleanup:function(_ede){this._shapeTrashList.push(_ede);if(_ede.rawNode){dojo.style(_ede.rawNode,"display","none");}},cleanupTemporarilyPreservedElements:function(){dojo.query(this._padTrashNode).children().orphan();for(var i=0;i<this._shapeTrashList.length;i++){var _edf=this._shapeTrashList[i];try{this.getRootGroup().remove(_edf);_edf.destroy();}catch(e){}}this._shapeTrashList=[];}});});},"cb/board/itemui/TxtDivTextareaWithDropDown":function(){define(["dojo","dojo/on","dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/dom-class","dojo/dom-attr","dojox/lang/functional","./TxtDivTextarea"],function(dojo,on,lang,_ee0,_ee1,_ee2,_ee3,_ee4,_ee5,_ee6){var _ee7=_ee1([_ee6],{cursorPosition:-1,atMentionStartPosition:-1,atMentionStr:null,hashtagStartPosition:-1,hashtagStr:null,postCreate:function(){this.inherited(arguments);dojo.connect(this,"onKeyUp",this,function(){this.updatePositions();});},focusInitially:function(){this.inherited(arguments);if(this.createWithAt&&this.textbox&&this.textbox.value===""){this.textbox.value="@";this.updatePositions();}},onNewAtMention:function(){},onUpdatedAtMention:function(){},onCanceledAtMention:function(){},onNewHashtag:function(){},onUpdatedHashtag:function(){},onCanceledHashtag:function(){},resetRichtextReplacement:function(){this.cursorPosition=-1;this.atMentionStartPosition=-1;this.atMentionStr=null;this.onCanceledAtMention();this.hashtagStartPosition=-1;this.hashtagStr=null;this.onCanceledHashtag();},updatePositions:function(){this.cursorPosition=this.textbox.selectionEnd;if(this.cursorPosition!==0&&(!this.cursorPosition||this.cursorPosition<0)){console.warn("No cursor found: ",this.cursorPosition);return;}var _ee8=this.textbox.value.substring(0,this.cursorPosition);var _ee9=this._isTypingRichtext(_ee8,"@");var _eea=this._isTypingRichtext(_ee8,"#");if(!_ee9&&!_eea){this.resetRichtextReplacement();}else{if(_ee9){this._updateMention(_ee8);}else{if(_eea){this._updateHashtag(_ee8);}}}},_isTypingRichtext:function(_eeb,sign){var _eec=_eeb.indexOf(sign)<0||(_eeb.lastIndexOf(sign)<_eeb.lastIndexOf("]"));return !_eec;},_updateMention:function(_eed){this.atMentionStartPosition=_eed.lastIndexOf("@")+1;var _eee=_eed.substring(this.atMentionStartPosition,this.cursorPosition);var _eef=_eee=="";var _ef0=!_eef&&this.atMentionStr!==_eee;this.atMentionStr=_eee;if(_eef){this.onNewAtMention();}else{if(_ef0){this.onUpdatedAtMention();}}},_updateHashtag:function(_ef1){this.hashtagStartPosition=_ef1.lastIndexOf("#")+1;var _ef2=_ef1.substring(this.hashtagStartPosition,this.cursorPosition);var _ef3=_ef2=="";var _ef4=!_ef3&&this.hashtagStr!==_ef2;this.hashtagStr=_ef2;if(_ef3){this.onNewHashtag();}else{if(_ef4){this.onUpdatedHashtag();}}},getCurrentAtMentionStr:function(){return this.atMentionStr;},getCurrentHashtagStr:function(){return this.hashtagStr;},replaceAtMentionAtCursorPosition:function(_ef5){this._replaceRichtextAtCursorPosition(_ef5,"@",this.atMentionStartPosition);},replaceHashtagAtCursorPosition:function(_ef6){this._replaceRichtextAtCursorPosition(_ef6,"#",this.hashtagStartPosition);},_replaceRichtextAtCursorPosition:function(_ef7,sign,_ef8){if(this.cursorPosition<0||_ef8<0){console.warn("There is no mention!",this.cursorPosition,_ef8);return;}var _ef9=sign+"["+_ef7+"]";var _efa=this.textbox.value;var _efb=_efa.substring(0,_ef8-1)+_ef9;var _efc=_efb+_efa.substring(this.cursorPosition);var _efd=_efb.length;this.textbox.value=_efc;this.textbox.setSelectionRange(_efd,_efd);this.resetRichtextReplacement();}});return _ee7;});},"wp/data/ItemFactory":function(){define("wp/data/ItemFactory",["dijit","dojo","dojox","dojo/require!wp/common/MathsHelper,wp/data/Item,wp/data/item/TxtEItem,wp/data/item/TxtGItem,wp/data/item/LineItem,wp/data/item/FreeLineItem,wp/data/item/RectangleItem,wp/data/item/EllipseItem,wp/data/item/ImageItem,wp/data/item/GroupItem,wp/data/item/NullItem,wp/data/item/TemporaryItem"],function(_efe,dojo,_eff){dojo.provide("wp.data.ItemFactory");dojo.require("wp.common.MathsHelper");dojo.require("wp.data.Item");dojo.require("wp.data.item.TxtEItem");dojo.require("wp.data.item.TxtGItem");dojo.require("wp.data.item.LineItem");dojo.require("wp.data.item.FreeLineItem");dojo.require("wp.data.item.RectangleItem");dojo.require("wp.data.item.EllipseItem");dojo.require("wp.data.item.ImageItem");dojo.require("wp.data.item.GroupItem");dojo.require("wp.data.item.NullItem");dojo.require("wp.data.item.TemporaryItem");dojo.declare("wp.data.ItemFactory",null,{constructor:function(){this._itemContructors={line:function(map){return new wp.data.item.LineItem(map);},arrow:function(map){return new wp.data.item.LineItem(map);},freeLine:function(map){return new wp.data.item.FreeLineItem(map);},rectangle:function(map){return new wp.data.item.RectangleItem(map);},ellipse:function(map){return new wp.data.item.EllipseItem(map);},txtE:function(map){return new wp.data.item.TxtEItem(map);},txtG:function(map){return new wp.data.item.TxtGItem(map);},image:function(map){return new wp.data.item.ImageItem(map,sp.info.document.document.currentLocation.fullPublicUrl+"/");},group:function(map){return new wp.data.item.GroupItem(map);},temporary:function(map){return new wp.data.item.TemporaryItem(map);},NULL:function(map){return new wp.data.item.NullItem(map);}};},getNewItem:function(_f00,map,_f01){var _f02=this._getConstructor(_f00,map,_f01);if(_f02){var item=_f02.call(this,map);if(!item.v){item.v=_f01||null;}return item;}else{throw new Error("No constructor found for '"+_f00+"'.");}},_getConstructor:function(_f03,map,_f04){return this._itemContructors[_f03];},getItemCopy:function(_f05){var _f06=dojo.toJson(_f05);var _f07=dojo.fromJson(_f06);return this.getNewItem(_f07.type,_f07);}});});},"dojo/io/script":function(){define(["../_base/connect","../_base/kernel","../_base/lang","../sniff","../_base/window","../_base/xhr","../dom","../dom-construct","../request/script"],function(_f08,_f09,lang,has,win,xhr,dom,_f0a,_f0b){_f09.deprecated("dojo/io/script","Use dojo/request/script.","2.0");var _f0c={get:function(args){var rDfd;var dfd=this._makeScriptDeferred(args,function(dfd){rDfd&&rDfd.cancel();});var _f0d=dfd.ioArgs;xhr._ioAddQueryToUrl(_f0d);xhr._ioNotifyStart(dfd);rDfd=_f0b.get(_f0d.url,{timeout:args.timeout,jsonp:_f0d.jsonp,checkString:args.checkString,ioArgs:_f0d,frameDoc:args.frameDoc,canAttach:function(rDfd){_f0d.requestId=rDfd.id;_f0d.scriptId=rDfd.scriptId;_f0d.canDelete=rDfd.canDelete;return _f0c._canAttach(_f0d);}},true);rDfd.then(function(){dfd.resolve(dfd);}).otherwise(function(_f0e){dfd.ioArgs.error=_f0e;dfd.reject(_f0e);});return dfd;},attach:_f0b._attach,remove:_f0b._remove,_makeScriptDeferred:function(args,_f0f){var dfd=xhr._ioSetArgs(args,_f0f||this._deferredCancel,this._deferredOk,this._deferredError);var _f10=dfd.ioArgs;_f10.id=_f09._scopeName+"IoScript"+(this._counter++);_f10.canDelete=false;_f10.jsonp=args.callbackParamName||args.jsonp;if(_f10.jsonp){_f10.query=_f10.query||"";if(_f10.query.length>0){_f10.query+="&";}_f10.query+=_f10.jsonp+"="+(args.frameDoc?"parent.":"")+_f09._scopeName+".io.script.jsonp_"+_f10.id+"._jsonpCallback";_f10.frameDoc=args.frameDoc;_f10.canDelete=true;dfd._jsonpCallback=this._jsonpCallback;this["jsonp_"+_f10.id]=dfd;}return dfd;},_deferredCancel:function(dfd){dfd.canceled=true;},_deferredOk:function(dfd){var _f11=dfd.ioArgs;return _f11.json||_f11.scriptLoaded||_f11;},_deferredError:function(_f12,dfd){return _f12;},_deadScripts:[],_counter:1,_addDeadScript:function(_f13){_f0c._deadScripts.push({id:_f13.id,frameDoc:_f13.frameDoc});_f13.frameDoc=null;},_validCheck:function(dfd){var _f14=_f0c._deadScripts;if(_f14&&_f14.length>0){for(var i=0;i<_f14.length;i++){_f0c.remove(_f14[i].id,_f14[i].frameDoc);_f14[i].frameDoc=null;}_f0c._deadScripts=[];}return true;},_ioCheck:function(dfd){var _f15=dfd.ioArgs;if(_f15.json||(_f15.scriptLoaded&&!_f15.args.checkString)){return true;}var _f16=_f15.args.checkString;return _f16&&eval("typeof("+_f16+") != 'undefined'");},_resHandle:function(dfd){if(_f0c._ioCheck(dfd)){dfd.callback(dfd);}else{dfd.errback(new Error("inconceivable dojo.io.script._resHandle error"));}},_canAttach:function(){return true;},_jsonpCallback:function(json){this.ioArgs.json=json;_f09.global[_f0b._callbacksProperty][this.ioArgs.requestId](json);}};lang.setObject("dojo.io.script",_f0c);return _f0c;});},"url:dijit/templates/InlineEditBox.html":"<span data-dojo-attach-point=\"editNode\" role=\"presentation\" class=\"dijitReset dijitInline dijitOffScreen\"\n\tdata-dojo-attach-event=\"onkeypress: _onKeyPress\"\n\t><span data-dojo-attach-point=\"editorPlaceholder\"></span\n\t><span data-dojo-attach-point=\"buttonContainer\"\n\t\t><button data-dojo-type=\"dijit/form/Button\" data-dojo-props=\"label: '${buttonSave}', 'class': 'saveButton'\"\n\t\t\tdata-dojo-attach-point=\"saveButton\" data-dojo-attach-event=\"onClick:save\"></button\n\t\t><button data-dojo-type=\"dijit/form/Button\"  data-dojo-props=\"label: '${buttonCancel}', 'class': 'cancelButton'\"\n\t\t\tdata-dojo-attach-point=\"cancelButton\" data-dojo-attach-event=\"onClick:cancel\"></button\n\t></span\n></span>\n","wp/surface/SurfaceScrollbarAddOn":function(){define("wp/surface/SurfaceScrollbarAddOn",["dijit","dojo","dojox"],function(_f17,dojo,_f18){dojo.provide("wp.surface.SurfaceScrollbarAddOn");dojo.declare("wp.surface.SurfaceScrollbarAddOn",null,{constructor:function(){this.latestScrollbarTDX=null;this.latestScrollbarTDY=null;this.latestScrollbarTS=null;this.scrollbarVisibleH=false;this.scrollbarVisibleV=false;this.scrollMouseMoveHandler=null;this.scrollMouseUpHandler=null;this.scrollTickInterval=null;this.scrollTickTimeout=null;this.scrollOrientation=null;this.scrollTickPos=null;},notifyScrollbarsOfMouseUp:function(){this._resetScrollHandling();},_initScrollbars:function(){this._scrollContainerH=dojo.create("div",{"class":"board-scrollbar-container-h hideBlock"},this._padUnderlayInnerNode,"last");this._scrollAreaH=dojo.create("div",{"class":"board-scrollbar-area"},this._scrollContainerH,"last");this._scrollHandleH=dojo.create("div",{"class":"board-scrollbar-handle"},this._scrollAreaH,"last");this._scrollContainerV=dojo.create("div",{"class":"board-scrollbar-container-v hideBlock"},this._padUnderlayInnerNode,"last");this._scrollAreaV=dojo.create("div",{"class":"board-scrollbar-area"},this._scrollContainerV,"last");this._scrollHandleV=dojo.create("div",{"class":"board-scrollbar-handle"},this._scrollAreaV,"last");dojo.on(this._scrollContainerH,"mousedown, touchstart",dojo.hitch(this,function(_f19){this._handleScrollbarMouseDown(_f19,"HORIZONTAL");}));dojo.on(this._scrollContainerV,"mousedown, touchstart",dojo.hitch(this,function(_f1a){this._handleScrollbarMouseDown(_f1a,"VERTICAL");}));},_handleScrollbarMouseDown:function(_f1b,_f1c){dojo.stopEvent(_f1b);if(this._isAnyAsyncScrollbarActivityHappening()){return;}this.scrollOrientation=_f1c;this.scrollTickPos=this.scrollOrientation==="HORIZONTAL"?_f1b.clientX:_f1b.clientY;if(dojo.hasClass(_f1b.target,"board-scrollbar-handle")){dojo.addClass(this.scrollOrientation==="HORIZONTAL"?this._scrollContainerH:this._scrollContainerV,"active");this.scrollMouseMoveHandler=dojo.on(dojo.doc,"mousemove, touchmove",dojo.hitch(this,function(_f1d){this._handleScrollbarMouseMoveOnHandleDrag(_f1d);dojo.stopEvent(_f1d);}));}else{this.scrollTickTimeout=setTimeout(dojo.hitch(this,function(){this.scrollTickInterval=setInterval(dojo.hitch(this,function(){this._handleScrollbarMouseTick();}),150);}),500);this._handleScrollbarMouseTick();}this.scrollMouseUpHandler=dojo.on(dojo.doc,"mouseup, touchend",dojo.hitch(this,function(_f1e){this._resetScrollHandling();}));},_handleScrollbarMouseTick:function(){var _f1f=0.6;var _f20,_f21,_f22;if(this.scrollOrientation==="HORIZONTAL"){_f20=dojo.position(this._scrollHandleH).x;_f21=dojo.getContentBox(this._scrollHandleH).w;_f22=this.getViewportWidth()*_f1f;}else{_f20=dojo.position(this._scrollHandleV).y;_f21=dojo.getContentBox(this._scrollHandleV).h;_f22=this.getViewportHeight()*_f1f;}if(this.scrollTickPos<_f20){this._scrollByScrollbarActivity(this.scrollOrientation,_f22);}else{if(this.scrollTickPos>_f20+_f21){this._scrollByScrollbarActivity(this.scrollOrientation,-_f22);}else{}}},_handleScrollbarMouseMoveOnHandleDrag:function(_f23){dojo.stopEvent(_f23);var _f24=this.scrollOrientation==="HORIZONTAL"?_f23.clientX:_f23.clientY;var _f25=(this.scrollTickPos||this.scrollTickPos===0)?(this.scrollTickPos-_f24):0;this.scrollTickPos=_f24;var _f26,_f27;if(this.scrollOrientation==="HORIZONTAL"){_f26=dojo.getContentBox(this._scrollHandleH).w;_f27=this.getViewportWidth();}else{_f26=dojo.getContentBox(this._scrollHandleV).h;_f27=this.getViewportHeight();}var _f28=_f25/_f26*_f27;this._scrollByScrollbarActivity(this.scrollOrientation,_f28);},_scrollByScrollbarActivity:function(_f29,_f2a){return _f29==="HORIZONTAL"?this.scrollBy(_f2a,0,true):this.scrollBy(0,_f2a,true);},_isAnyAsyncScrollbarActivityHappening:function(){return !!(this.scrollTickTimeout||this.scrollTickInterval||this.scrollMouseMoveHandler||this.scrollMouseUpHandler);},_resetScrollHandling:function(){if(this.scrollMouseMoveHandler){this.scrollMouseMoveHandler.remove();this.scrollMouseMoveHandler=null;}if(this.scrollMouseUpHandler){this.scrollMouseUpHandler.remove();this.scrollMouseUpHandler=null;}if(this.scrollTickInterval){clearInterval(this.scrollTickInterval);this.scrollTickInterval=null;}if(this.scrollTickTimeout){clearTimeout(this.scrollTickTimeout);this.scrollTickTimeout=null;}this.scrollOrientation=null;this.scrollTickPos=null;dojo.removeClass(this._scrollContainerH,"active");dojo.removeClass(this._scrollContainerV,"active");},_adjustScrollbars:function(){if(this.tDx!==this.latestScrollbarTDX||this.tDy!==this.latestScrollbarTDY||this.tS!==this.latestScrollbarTS){var _f2b=this._pad.container.getBBox();var _f2c=this.getViewportAsItemBBox();if(_f2c&&_f2b){this.latestScrollbarTDX=this.tDx;this.latestScrollbarTDY=this.tDy;this.latestScrollbarTS=this.tS;var _f2d=this._calculateVirtualContentBox(_f2b,_f2c);var _f2e=this._calculateHandleDimensionInPercent(_f2c.getWidth(),_f2d.getWidth());var _f2f=this._calculateHandleDimensionInPercent(_f2c.getHeight(),_f2d.getHeight());if(!this._isAnyAsyncScrollbarActivityHappening()){var _f30=_f2e<100;var _f31=_f2f<100;if(_f30!==this.scrollbarVisibleH){dojo.toggleClass(this._scrollContainerH,"hideBlock",!_f30);this.scrollbarVisibleH=_f30;}if(_f31!==this.scrollbarVisibleV){dojo.toggleClass(this._scrollContainerV,"hideBlock",!_f31);this.scrollbarVisibleV=_f31;}}if(this.scrollbarVisibleH){var _f32=this._calculateHandleOffsetInPercent(_f2e,_f2c.getCenter().x,_f2d.getTopLeft().x,_f2d.getWidth());this._scrollHandleH.style.width=_f2e+"%";this._scrollHandleH.style.left=_f32+"%";}if(this.scrollbarVisibleV){var _f33=this._calculateHandleOffsetInPercent(_f2f,_f2c.getCenter().y,_f2d.getTopLeft().y,_f2d.getHeight());this._scrollHandleV.style.height=_f2f+"%";this._scrollHandleV.style.top=_f33+"%";}}}},_calculateVirtualContentBox:function(_f34,_f35){var _f36=200;var _f37=new wp.BBox({x:_f34.p1.x-_f36,y:_f34.p1.y-_f36},{x:_f34.p2.x+_f36,y:_f34.p2.y+_f36});return _f37.expandByBBox(_f35);},_calculateHandleDimensionInPercent:function(_f38,_f39){return Math.min(10000,Math.round(_f38/_f39*10000))/100;},_calculateHandleOffsetInPercent:function(_f3a,_f3b,_f3c,_f3d){var _f3e=(_f3b-_f3c)/_f3d;var _f3f=_f3e-(_f3a/200);return Math.max(0,Math.min(10000-_f3a*100,Math.round(_f3f*10000))/100);}});});},"wp/handler/Controller":function(){define("wp/handler/Controller",["dijit","dojo","dojox","dojo/i18n!wp/handler/nls/Controller","dojo/require!dojo/date/stamp,dojo/dnd/common,dojox/lang/functional,wp/handler/ControllerConfigAddOn,wp/handler/ControllerCommandAddOn,wp/handler/ControllerEventAddOn,wp/handler/ControllerWorkflowAddOn,wp/handler/workflow/PanWorkflow,wp/handler/workflow/ZoomWorkflow,wp/handler/workflow/SelectWorkflow,wp/handler/workflow/EraseWorkflow,wp/handler/workflow/SquareWorkflow,wp/handler/workflow/FreeLineWorkflow,cb/page/pad/ToolChangedFlashMessage,sp/dialog/YesNoDialog,wp/widget/Sidebar,cb/status,sp/I18n,cb/util"],function(_f40,dojo,_f41){dojo.provide("wp.handler.Controller");dojo.require("dojo.date.stamp");dojo.require("dojo.dnd.common");dojo.require("dojox.lang.functional");dojo.require("wp.handler.ControllerConfigAddOn");dojo.require("wp.handler.ControllerCommandAddOn");dojo.require("wp.handler.ControllerEventAddOn");dojo.require("wp.handler.ControllerWorkflowAddOn");dojo.require("wp.handler.workflow.PanWorkflow");dojo.require("wp.handler.workflow.ZoomWorkflow");dojo.require("wp.handler.workflow.SelectWorkflow");dojo.require("wp.handler.workflow.EraseWorkflow");dojo.require("wp.handler.workflow.SquareWorkflow");dojo.require("wp.handler.workflow.FreeLineWorkflow");dojo.require("cb.page.pad.ToolChangedFlashMessage");dojo.require("sp.dialog.YesNoDialog");dojo.require("wp.widget.Sidebar");dojo.require("cb.status");dojo.require("sp.I18n");dojo.require("cb.util");dojo.requireLocalization("wp.handler","Controller");dojo.declare("wp.handler.Controller",[wp.handler.ControllerConfigAddOn,wp.handler.ControllerCommandAddOn,wp.handler.ControllerEventAddOn,wp.handler.ControllerWorkflowAddOn],{READONLY_TOOLS:{TOOL_HAND:true,TOOL_ZOOM:true,TOOL_NONE:true},READONLY_MODES:{BROWSE:true},constructor:function(pad){this._pad=pad;this.isBoardReadonly=false;this.status=cb.status.Util.create({documentId:pad.documentId},[cb.status.editingStatus]);this.status.getAndWatch("editing",dojo.hitch(this,function(attr,old,_f42){if(this.isBoardReadonly!==_f42.readonly&&_f42.readonly){this.resetTextEdit();}this.isBoardReadonly=_f42.readonly;}));this.currentTool="TOOL_NONE";this.currentMode="MODE_NONE";this.lastToolPerMode={"DISCUSS":"TOOL_HAND","CREATE":"TOOL_HAND"};dojo.subscribe("requests/cb/board/currenttoolchange",this,function(_f43,_f44){this.requestCurrentToolChange(_f43,_f44);});dojo.subscribe("requests/cb/board/currentmodechange",this,function(_f45){this.requestCurrentModeChange(_f45);});dojo.subscribe("/cb/board/tool/config/current",this,function(obj){this._updateToolConfig(this.currentTool,obj.key,obj.value);if(this._pad.container.isSthSelected()){if(obj.key=="action"){if(obj.value=="move-to-front"){this.moveToFront();}else{if(obj.value=="move-to-back"){this.moveToBack();}else{if(obj.value=="plus90"){this.rotateImage(90);}else{if(obj.value=="minus90"){this.rotateImage(-90);}else{if(obj.value=="group"){this.group();}else{if(obj.value=="ungroup"){this.ungroup();}else{if(obj.value=="revert-image-size"){this.resizeToOrig();}else{if(obj.value=="duplicate"){this.duplicate();}else{if(obj.value=="outline"){this.addToOutline();}}}}}}}}}}else{this._updateSelectedItemProps(obj.key,obj.value);}}});dojo.subscribe("requests/cb/board/smoothzoom",dojo.hitch(this,function(_f46){this.zoomSmoothly(_f46);}));dojo.subscribe("requests/cb/board/smoothzoomtofit",dojo.hitch(this,function(){this.zoomSmoothlyToFit();}));dojo.subscribe("requests/cb/board/zoomin",dojo.hitch(this,function(){this.zoomIn();}));dojo.subscribe("requests/cb/board/zoomout",dojo.hitch(this,function(){this.zoomOut();}));dojo.subscribe("requests/cb/board/edittextgroup",dojo.hitch(this,function(_f47){this.editItemByTextGroupId(_f47);}));dojo.subscribe("requests/cb/board/edittextentry",dojo.hitch(this,function(_f48){this.editItemByTextEntryId(_f48);}));this._zoomInMultiplier=1.125;this._zoomOutMultiplier=0.8;this.currentWorkflow=null;this.panWorkflow=new wp.handler.workflow.PanWorkflow(this._pad);this.zoomWorkflow=new wp.handler.workflow.ZoomWorkflow(this._pad);this.selectWorkflow=new wp.handler.workflow.SelectWorkflow(this._pad);this.squareWorkflow=new wp.handler.workflow.SquareWorkflow(this._pad);this.freeLineWorkflow=new wp.handler.workflow.FreeLineWorkflow(this._pad);this.eraseWorkflow=new wp.handler.workflow.EraseWorkflow(this._pad);this.currentTextGroupIdInEdit=null;this.currentTextEntryIdInEdit=null;this.currentTextEntryToCreateWithAt=false;this.initEventHandling();dojo.subscribe("/sp/ajax/connectivityStatus",this,function(_f49){var self=this;if(_f49=="FULLY-INITIATED"){var _f4a=this.tryScrollingToHashPosition();_f4a.always(function(){dojo.subscribe("/dojo/hashchange",self,"handleHashChange");});var _f4b=_f4a.then(function(_f4c){return _f4c||self.tryScrollingToFirstOutline();});var _f4d=_f4b.then(function(_f4e){return _f4e||self.tryScrollingToNaivePosition();},function(_f4f){return self.tryScrollingToNaivePosition();});}});dojo.subscribe("/sp/ajax/incoming/importedimage",this,function(item){if(item&&item.itemId&&item.page==1&&item.authorId==sp.info.user.id){var _f50=item.itemId;window.setTimeout(dojo.hitch(this,function(){this._pad.surface.smoothScrollToItemId(_f50);}),500);}});},tryScrollingToHashPosition:function(){var self=this;return cb.util.delay(1000,function(){var _f51=self.handleHashChange(dojo.hash());return _f51;});},tryScrollingToFirstOutline:function(){return cb.util.delay(250,function(){var _f52=_f40.byId("outline-container").visitNextListNode(true);return _f52;});},tryScrollingToNaivePosition:function(){var self=this;return cb.util.delay(250,function(){var bbox=self._pad.container.getBBox();var pos;if(!bbox){pos={x:self.getPositionCenter().x,y:self.getPositionCenter().y};}else{pos={x:bbox.getCenter().x,y:bbox.getCenter().y};}self._pad.surface.moveTo(pos.x,pos.y);return "naiveitemid";});},handleHashChange:function(_f53){if(!_f53){return null;}var _f54=dojo.queryToObject(_f53);var _f55=_f54.item;var _f56=_f54.tutorial;if(_f55){var _f57=this._pad.surface;cb.util.defer(function(){_f57.smoothScrollToItemId(_f55);});}if(_f56){dojo.publish("requests/cb/board/currenttutorialstep",_f56);}return _f55;},getCurrentTool:function(){return this.currentTool;},getCurrentToolConfig:function(){return this.toolConfigBuffer[this.currentTool];},getCurrentMode:function(){return this.currentMode;},requestCurrentToolChange:function(_f58,_f59){if(this.isReadonly()&&!this.isReadonlytool(_f58)){return;}if(_f58!==this.currentTool){this.currentTool=_f58;this._pad.container.abortPreview();this._pad.drawer.setCursorMode(this.getToolCursorMode(_f58));dojo.publish("updates/cb/board/currenttool",_f58);}else{dojo.publish("/sp/pad/propbar/mousedown");}if(_f59||!this.isModeAllowedForTool(this.currentMode,_f58)){if(_f59&&this.isModeAllowedForTool(_f59,this.currentTool)){}else{_f59=this.getRecommendedModeForTool(this.currentTool);}this.currentMode=_f59;dojo.publish("updates/cb/board/currentmode",_f59);}if(this.lastToolPerMode[this.currentMode]){this.lastToolPerMode[this.currentMode]=this.currentTool;}},requestCurrentModeChange:function(_f5a){if(this.isReadonly()&&!this.isReadonlymode(_f5a)){return;}var _f5b=this.lastToolPerMode[_f5a];if(_f5b&&_f5b!==this.currentTool){this.requestCurrentToolChange(_f5b,_f5a);}else{if(!_f5b&&!this.isModeAllowedForTool(_f5a,this.currentTool)){this.requestCurrentToolChange("TOOL_HAND",_f5a);}else{this.currentMode=_f5a;dojo.publish("updates/cb/board/currentmode",_f5a);}}},isReadonly:function(){return this.status.get("editing").readonly;},isReadonlytool:function(tool){return !!(tool&&this.READONLY_TOOLS[tool]);},isReadonlymode:function(mode){return !!(mode&&this.READONLY_MODES[mode]);},_chooseCorrectEditToolAndChangeModeIfNeeded:function(_f5c){var _f5d=this._pad.container.getItemSubType(_f5c);if(_f5d){if(this.currentMode==="BROWSE"){dojo.publish("requests/cb/board/currenttoolchange",["TOOL_HAND","DISCUSS"]);}else{var _f5e=this.getCorrectEditToolForSubType(_f5d);if(this.currentTool!==_f5e){dojo.publish("requests/cb/board/currenttoolchange",_f5e);}}}},changeProperty:function(key,_f5f,_f60){var _f61=_f60?this._pad.container.isIdSelected(_f60):this._pad.container.isSthSelected();if(_f61){this._pad.container.modifyPreview(key,_f5f,_f60);this._pad.container.savePreview();if(key=="del"){this._pad.container.abortPreview();}}},batchChangeProperties:function(_f62){var _f63=false;dojo.forEach(_f62,function(_f64){var key=_f64.key;var _f65=_f64.value;var _f66=_f64.shapeId;var _f67=_f66?this._pad.container.isIdSelected(_f66):this._pad.container.isSthSelected();if(_f67){this._pad.container.modifyPreview(key,_f65,_f66);if(key=="del"){_f63=true;}}},this);this._pad.container.savePreview();if(_f63){this._pad.container.abortPreview();}},isSthInEdit:function(){return !!this.currentTextGroupIdInEdit;},getTextGroupIdInEdit:function(){return this.currentTextGroupIdInEdit;},isPastingFromExternalAllowed:function(){return !this.isSthInEdit();},_setNewTextEditConfig:function(_f68,_f69,_f6a){this.currentTextGroupIdInEdit=_f68;this.currentTextEntryIdInEdit=_f69;this.currentTextEntryToCreateWithAt=!!_f6a;},resetTextEdit:function(){var _f6b=this.currentTextGroupIdInEdit;this.currentTextGroupIdInEdit=null;this.currentTextEntryIdInEdit=null;this.currentTextEntryToCreateWithAt=false;if(_f6b){this._pad.drawer.enqueueDrawing(_f6b);}this._pad.surface.fixBrowserScrolling();},saveTextEditIfChanged:function(_f6c){if(this.currentTextGroupIdInEdit){var _f6d=this.currentTextGroupIdInEdit;var _f6e=this._pad.container.getItemCopy(_f6d);var item;if(this.currentTextEntryIdInEdit){var _f6f=this.currentTextEntryIdInEdit;if(this._pad.container.containsItem(_f6f)){item=this._pad.container.getItemCopy(_f6f);if(item.text!==_f6c){if(!item.subtype||item.subtype===""){item.subtype=_f6e.subtype;}if(_f6c===""){item.del="1";}else{item.text=_f6c;}this._pad.container.addOrUpdateItems([item]);}}}else{if(_f6c&&_f6c!==""){var _f70=[];item=this._pad.factory.getNewItem("txtE",{});item.id=this._pad.generateItemId();item.txtGId=_f6d;item.text=_f6c;item.subtype=_f6e.subtype;_f70.push(item);var _f71=this._pad.container.getBBox(_f6d);if(_f71){_f6e.a={x:_f71.p1.x,y:_f71.p1.y};_f6e.b={x:_f71.p2.x,y:_f71.p2.y};_f70.push(_f6e);}this._pad.container.addOrUpdateItems(_f70);}}}this.resetTextEdit();},getZoomInPercent:function(){return Math.round(this._pad.surface.getZoomFactor()*100);},_now:function(){return (new Date()).getTime();},showToolChangedFlashMessage:function(_f72){cb.page.pad.ToolChangedFlashMessage.showMessage(_f72);}});(function(){if(Date.now){dojo.extend(wp.handler.Controller,{_now:function(){return Date.now();}});}})();});},"wp/handler/ControllerEventAddOn":function(){define("wp/handler/ControllerEventAddOn",["dijit","dojo","dojox","dojo/require!cb/mousetrap,cb/WheelSupport,cb/util"],function(_f73,dojo,_f74){dojo.provide("wp.handler.ControllerEventAddOn");dojo.require("cb.mousetrap");dojo.require("cb.WheelSupport");dojo.require("cb.util");dojo.declare("wp.handler.ControllerEventAddOn",null,{constructor:function(){this.lastClientX=null;this.lastClientY=null;this.isSpacePressed=false;this.isMouseButtonDown=false;this.lastMouseDownEvent=null;this.is2FingerDown=false;this.autoScrollInterval=null;this.autoScrollTimeInMs=100;this.autoScrollFringeInPx=50;this.lowestDelta=null;this.simpleMouseWheelZoomThrottled=cb.util.throttle(dojo.hitch(this,function(_f75,_f76){this.simpleMouseWheelZoom(_f75,_f76);}),40);},initEventHandling:function(){var _f77=this;var _f78=this._pad.surface.getNode();dojo.connect(_f78,"onmousedown",this,"filterMouseDown");dojo.connect(_f78,"ontouchstart",this,"filterMouseDown");dojo.connect(_f78,"onmouseup",this,"filterMouseUp");dojo.connect(_f78,"ontouchend",this,"filterMouseUp");dojo.connect(_f78,"ondblclick",this,"filterDoubleClick");dojo.connect(_f78,"oncontextmenu",this,"filterContextMenu");dojo.connect(_f78,"ontouchmove",this,"filterMouseMove");window.setTimeout(function(){_f78.onmousemove=function(_f79){_f79=_f79||window.event;if(dojo.isIE){_f79.target=_f79.srcElement;}_f77.filterMouseMove(_f79);};},50);var _f7a=["m","s","q","p","x","u","o","a","l","c","t","n","h","e","z","+","-","0","1","k","j","up","left","down","right","shift+up","shift+left","shift+down","shift+right","del","backspace","esc","space","shift","mod+g","mod+shift+g","mod+z","mod+y","mod+c","mod+v","mod+x","?","mod+s","mod+p","tab","mod+o","mod+shift+o"];var _f7b=dojo.hitch(this,function(_f7c,_f7d){if(this.handleShortcut(_f7c,_f7d)){dojo.stopEvent(_f7c);_f7c.keyCode=0;return false;}});cb.mousetrap.bind(_f7a,_f7b);cb.mousetrap.bind("space",_f7b,"keydown");cb.mousetrap.bind("space",_f7b,"keyup");cb.mousetrap.bind("shift",_f7b,"keydown");cb.mousetrap.bind("shift",_f7b,"keyup");cb.WheelSupport.addWheelEvent(_f78,dojo.hitch(this,"filterMouseWheel"));},filterMouseDown:function(_f7e){var _f7f=this._getEventData(_f7e);var _f80=(_f7e.touches&&_f7e.touches.length)?_f7e.touches.length:1;var _f81=this._getMouseButtonOnDown(_f7f);if(this._isTargetHandledByBrowser(_f7f)){return;}if(this.isMouseButtonDown&&_f80>1){this._resetCurrentEventProcessing();this.cancelCurrentWorkflowProcessing();}if(_f80==1){this.isMouseButtonDown=true;this.lastMouseDownEvent=_f7f;if(this._pad.isAntiTextSelection){document.onselectstart=function(){return false;};}dojo.publish("/sp/pad/controller/mousedown");var _f82=this.getEventSid(_f7f);this.handleMouseDown(_f7f.clientX,_f7f.clientY,_f81,_f82,_f7f.keys);if(this.shouldStopEventOnMouseDownEnd(_f81)){dojo.stopEvent(_f7f.originalEvent);}}else{if(_f80==2){this.is2FingerDown=true;var _f83=this._getEdgeWeightPointFrom2FingerTouch(_f7e);var _f84=this._getDistanceFrom2FingerTouch(_f7e);this.handle2FingerTouchDown(_f83.x,_f83.y,_f84);}}},filterMouseMove:function(_f85){var _f86=null;var _f87=(_f85.touches&&_f85.touches.length)?_f85.touches.length:1;if(_f87==1){var _f88=this._getEventData(_f85);var _f89=_f88.clientX;var _f8a=_f88.clientY;if(_f89!=this.lastClientX||_f8a!=this.lastClientY){this.lastClientX=_f89;this.lastClientY=_f8a;var _f8b=this.getEventSid(_f88);if(this.currentWorkflow&&this.currentWorkflow.forceSIDInvestigationOnMove){_f8b=this.getEventSidByPosition(_f8b,_f89,_f8a);}if(!this.isMouseButtonDown){}else{this.handleMouseMoveDrag(_f89,_f8a,_f88.keys,_f8b);if(this.currentWorkflow&&this.currentWorkflow.autoScrollWorkflow){var _f8c=this._pad.surface.getAutoScrollByCoos(_f89,_f8a,this.autoScrollFringeInPx);if(_f8c){var that=this;_f86=function(){that._pad.surface.scrollBy(-_f8c.x,-_f8c.y);that.handleMouseMoveDrag(_f89,_f8a,_f88.keys);};}}}}}else{if(_f87==2){var _f8d=this._getEdgeWeightPointFrom2FingerTouch(_f85);var _f8e=this._getDistanceFrom2FingerTouch(_f85);this.handle2FingerTouchMove(_f8d.x,_f8d.y,_f8e);}}if(this.autoScrollInterval&&!_f86){this.endAutoScroll();}else{if(_f86){this.startOrRecalibrateAutoScroll(_f86);}}if(sp.isTouchOnly){_f85.preventDefault();}},filterMouseUp:function(_f8f){var _f90=this._getEventData(_f8f);if(!this.lastMouseDownEvent||this.lastMouseDownEvent.currentTarget===_f90.currentTarget){if(this._isTargetHandledByBrowser(_f90)){return;}}if(this.is2FingerDown){this.handle2FingerTouchUp();}else{if(this.isMouseButtonDown){this.handleMouseUp(_f90.clientX,_f90.clientY,_f90.keys,_f90.originalEvent.target);}}this._resetCurrentEventProcessing();dojo.stopEvent(_f90.originalEvent);this._pad.surface.notifyScrollbarsOfMouseUp();this._pad.surface.cleanupTemporarilyPreservedElements();},filterDoubleClick:function(_f91){},filterContextMenu:function(_f92){if(!this._isTargetHandledByBrowser(_f92)){this._pad.propbarWidget.showContextMenu(_f92);dojo.stopEvent(_f92);}},filterMouseWheel:function(_f93){dojo.stopEvent(_f93);this.normalizeWheelDelta(_f93);if(dojo.isCopyKey(_f93)||_f93.shiftKey){this.simpleMouseWheelZoomThrottled(_f93,true);dojo.publish("updates/cb/board/currentzoom/viamousewheel");}else{var _f94=_f93.deltaFactor;this._pad.surface.scrollBy(_f93.fixedDeltaX*_f94*-1,_f93.fixedDeltaY*_f94,true);}},normalizeWheelDelta:function(_f95){var _f96=_f95||window.event,args=Array.prototype.slice.call(arguments,1),_f97=0,_f98=0,_f99=0,_f9a=0;_f95.type="mousewheel";if("detail" in _f96){_f99=_f96.detail*-1;}if("wheelDelta" in _f96){_f99=_f96.wheelDelta;}if("wheelDeltaY" in _f96){_f99=_f96.wheelDeltaY;}if("wheelDeltaX" in _f96){_f98=_f96.wheelDeltaX*-1;}if("axis" in _f96&&_f96.axis===_f96.HORIZONTAL_AXIS){_f98=_f99*-1;_f99=0;}_f97=_f99===0?_f98:_f99;if("deltaY" in _f96){_f99=_f96.deltaY*-1;_f97=_f99;}if("deltaX" in _f96){_f98=_f96.deltaX;if(_f99===0){_f97=_f98*-1;}}if(_f99===0&&_f98===0){return;}if(_f96.deltaMode===1){var _f9b=13;_f97*=_f9b;_f99*=_f9b;_f98*=_f9b;}_f9a=Math.max(Math.abs(_f99),Math.abs(_f98));if(typeof this.lowestDelta==="undefined"||this.lowestDelta===null||_f9a<this.lowestDelta){this.lowestDelta=_f9a;if(_f96.type==="mousewheel"&&_f9a%120===0){this.lowestDelta/=40;}}if(_f96.type==="mousewheel"&&_f9a%120===0){_f97/=40;_f98/=40;_f99/=40;}_f97=Math[_f97>=1?"floor":"ceil"](_f97/this.lowestDelta);_f98=Math[_f98>=1?"floor":"ceil"](_f98/this.lowestDelta);_f99=Math[_f99>=1?"floor":"ceil"](_f99/this.lowestDelta);_f95.deltaX=_f95.fixedDeltaX=_f98;_f95.deltaY=_f95.fixedDeltaY=_f99;_f95.deltaFactor=this.lowestDelta;_f95.deltaMode=0;args.unshift(_f95,_f97,_f98,_f99);if(this.nullLowestDeltaTimeout){clearTimeout(this.nullLowestDeltaTimeout);}this.nullLowestDeltaTimeout=setTimeout(dojo.hitch(this,function(){this.lowestDelta=null;},200));},simpleMouseWheelZoom:function(_f9c,_f9d){var _f9e=_f9c.delta?_f9c.delta:_f9c.deltaY;if(_f9e<0){this.zoomIn(_f9d?_f9c.clientX:null,_f9d?_f9c.clientY:null);}else{if(_f9e>0){this.zoomOut(_f9d?_f9c.clientX:null,_f9d?_f9c.clientY:null);}}},getLastMouseClientCoords:function(){return {x:this.lastClientX,y:this.lastClientY};},getEventSid:function(_f9f){var node,sid;node=_f9f.target;while(!sid&&node){sid=node.getAttribute?node.getAttribute("sid"):dojo.attr(node,"sid");node=node.parentNode;}return sid;},getEventSidByPosition:function(_fa0,_fa1,_fa2){if(dojo.isIos){return dojo.attr(document.elementFromPoint(_fa1,_fa2),"sid");}else{return _fa0;}},_getMouseButtonOnDown:function(_fa3){var _fa4=_fa3.originalEvent||_fa3;if(_fa4.changedTouches){return "LEFT";}if(dojo.mouseButtons.isLeft(_fa4)){return "LEFT";}if(!!dojo.isFF&&dojo.mouseButtons.isMiddle(_fa4)){return "MIDDLE";}if(dojo.mouseButtons.isRight(_fa4)){return "RIGHT";}return null;},_isTargetHandledByBrowser:function(_fa5){var _fa6=_fa5.originalEvent||_fa5;if(_fa6.isHandledByCb){return true;}if(_fa6.target&&_fa6.target.nodeName){var _fa7=_fa6.target.nodeName.toLowerCase();if(_fa7=="input"||_fa7=="textarea"||_fa7=="a"){return true;}else{if(_fa7=="p"){var _fa8=_fa6.target.getAttribute?_fa6.target.getAttribute("sid"):dojo.attr(_fa6.target,"sid");if(this._pad.container.isIdSelected(_fa8)&&!this.isMouseButtonDown){return true;}}}}return false;},_getEventData:function(_fa9){var _faa=this._getActiveEvent(_fa9);return {clientX:_faa.clientX,clientY:_faa.clientY,target:_faa.target,currentTarget:_faa.currentTarget||_faa.target,keys:this._getKeys(_faa),originalEvent:_fa9,identifier:_faa.identifier};},_getKeys:function(_fab){var _fac=this._getActiveEvent(_fab);return {altKey:_fac.altKey,ctrlKey:_fac.ctrlKey,metaKey:_fac.metaKey,shiftKey:_fac.shiftKey,copyKey:dojo.isCopyKey(_fac),spaceKey:this.isSpacePressed};},_getActiveEvent:function(_fad){if(!_fad.changedTouches||_fad.changedTouches.length===0){return _fad;}else{if(_fad.changedTouches.item){return _fad.changedTouches.item(0);}else{return _fad.changedTouches[0];}}},_resetCurrentEventProcessing:function(){if(this._pad.isAntiTextSelection){document.onselectstart=function(){return true;};}if(this.isSpacePressed){this.isSpacePressed=false;this._pad.drawer.setCursorMode(this.getToolCursorMode());}this.isMouseButtonDown=false;this.lastMouseDownEvent=null;this.is2FingerDown=false;this.endAutoScroll();},_getEdgeWeightPointFrom2FingerTouch:function(_fae){var e1=_fae.touches.item?_fae.touches.item(0):_fae.touches[0];var e2=_fae.touches.item?_fae.touches.item(1):_fae.touches[1];return {x:(e1.clientX+e2.clientX)/2,y:(e1.clientY+e2.clientY)/2};},_getDistanceFrom2FingerTouch:function(_faf){var e1=_faf.touches.item?_faf.touches.item(0):_faf.touches[0];var e2=_faf.touches.item?_faf.touches.item(1):_faf.touches[1];return Math.sqrt(Math.pow(e2.clientX-e1.clientX,2)+Math.pow(e2.clientY-e1.clientY,2));},startOrRecalibrateAutoScroll:function(_fb0){this.endAutoScroll();this.autoScrollInterval=window.setInterval(_fb0,this.autoScrollTimeInMs);},endAutoScroll:function(){if(this.autoScrollInterval){window.clearInterval(this.autoScrollInterval);this.autoScrollInterval=null;}},shouldStopEventOnMouseDownEnd:function(_fb1){if(_fb1==="RIGHT"){return false;}else{if(this.isSthInEdit()){return false;}else{return true;}}}});});},"cb/board/navigation/ZoomStripWidget":function(){define(["dojo","dojo/_base/declare","dojo/_base/lang","dojo/aspect","dojo/on","dojo/dom-class","dojo/dom-construct","dojo/html","dojo/query","dojo/_base/connect","dojo/dom-geometry","dijit/_Widget","cb/util","sp/I18n","dojo/i18n!../nls/Messages"],function(dojo,_fb2,lang,_fb3,on,_fb4,_fb5,_fb6,_fb7,_fb8,_fb9,_fba,_fbb,_fbc,i18n){var _fbd=_fbc.wrap(i18n);return _fb2([_fba],{baseClass:"zoom-strip-container",eqA:3.6,eqB:0,eqC:0.1,postCreate:function(){this.inherited(arguments);this.eqAlpha=this.eqB/(2*this.eqA);this.eqOmega=this.eqC/this.eqA+this.eqB*this.eqB/(4*this.eqA);this._zoomAreaContainer=_fb5.create("div",{"class":"zoom-area-container"},this.domNode);this._zoomArea=_fb5.create("div",{"class":"zoom-area"},this._zoomAreaContainer);this._zoomPointer=_fb5.create("div",{"class":"zoom-pointer","innerHTML":"<div class=\"v-beam\"></div>"},this._zoomArea);this._zoomOutButton=_fb5.create("div",{"class":"zoom-button zoom-out-button","innerHTML":"<div class=\"h-beam\"></div>"},this.domNode);this._zoomInButton=_fb5.create("div",{"class":"zoom-button zoom-in-button","innerHTML":"<div class=\"v-beam\"></div><div class=\"h-beam\"></div>"},this.domNode);this.own(on(this._zoomOutButton,"click",lang.hitch(this,function(e){_fb8.publish("requests/cb/board/zoomout");})));this.own(on(this._zoomInButton,"click",lang.hitch(this,function(e){_fb8.publish("requests/cb/board/zoomin");})));this.own(on(this._zoomAreaContainer,"click",lang.hitch(this,function(e){var _fbe=_fb9.position(this._zoomAreaContainer);var _fbf=e.clientX-_fbe.x;var _fc0=Math.max(0,Math.min(1,_fbf/_fbe.w));var _fc1=this.getZoomLevelByPosition(_fc0);_fb8.publish("requests/cb/board/smoothzoom",[_fc1]);})));_fb8.subscribe("/surface/update/zoom",lang.hitch(this,function(_fc2){var _fc3=this.getPositionByZoomLevel(_fc2);this._zoomPointer.style.left=Math.round(_fc3*100)+"%";}));},getZoomLevelByPosition:function(_fc4){var _fc5=this.eqA*_fc4*_fc4+this.eqB*_fc4+this.eqC;return Math.max(0.03,Math.min(30,_fc5));},getPositionByZoomLevel:function(_fc6){var _fc7=_fc6/this.eqA-this.eqOmega;if(_fc7<0){return 0;}else{var _fc8=Math.sqrt(_fc7)-this.eqAlpha;return Math.max(0,Math.min(1,_fc8));}}});});},"dojox/html/entities":function(){define("dojox/html/entities",["dojo/_base/lang"],function(lang){var dhe=lang.getObject("dojox.html.entities",true);var _fc9=function(str,map){var _fca,_fcb;if(map._encCache&&map._encCache.regexp&&map._encCache.mapper&&map.length==map._encCache.length){_fca=map._encCache.mapper;_fcb=map._encCache.regexp;}else{_fca={};_fcb=["["];var i;for(i=0;i<map.length;i++){_fca[map[i][0]]="&"+map[i][1]+";";_fcb.push(map[i][0]);}_fcb.push("]");_fcb=new RegExp(_fcb.join(""),"g");map._encCache={mapper:_fca,regexp:_fcb,length:map.length};}str=str.replace(_fcb,function(c){return _fca[c];});return str;};var _fcc=function(str,map){var _fcd,_fce;if(map._decCache&&map._decCache.regexp&&map._decCache.mapper&&map.length==map._decCache.length){_fcd=map._decCache.mapper;_fce=map._decCache.regexp;}else{_fcd={};_fce=["("];var i;for(i=0;i<map.length;i++){var e="&"+map[i][1]+";";if(i){_fce.push("|");}_fcd[e]=map[i][0];_fce.push(e);}_fce.push(")");_fce=new RegExp(_fce.join(""),"g");map._decCache={mapper:_fcd,regexp:_fce,length:map.length};}str=str.replace(_fce,function(c){return _fcd[c];});return str;};dhe.html=[["&","amp"],["\"","quot"],["<","lt"],[">","gt"],[" ","nbsp"]];dhe.latin=[["¡","iexcl"],["¢","cent"],["£","pound"],["€","euro"],["¤","curren"],["¥","yen"],["¦","brvbar"],["§","sect"],["¨","uml"],["©","copy"],["ª","ordf"],["«","laquo"],["¬","not"],["­","shy"],["®","reg"],["¯","macr"],["°","deg"],["±","plusmn"],["²","sup2"],["³","sup3"],["´","acute"],["µ","micro"],["¶","para"],["·","middot"],["¸","cedil"],["¹","sup1"],["º","ordm"],["»","raquo"],["¼","frac14"],["½","frac12"],["¾","frac34"],["¿","iquest"],["À","Agrave"],["Á","Aacute"],["Â","Acirc"],["Ã","Atilde"],["Ä","Auml"],["Å","Aring"],["Æ","AElig"],["Ç","Ccedil"],["È","Egrave"],["É","Eacute"],["Ê","Ecirc"],["Ë","Euml"],["Ì","Igrave"],["Í","Iacute"],["Î","Icirc"],["Ï","Iuml"],["Ð","ETH"],["Ñ","Ntilde"],["Ò","Ograve"],["Ó","Oacute"],["Ô","Ocirc"],["Õ","Otilde"],["Ö","Ouml"],["×","times"],["Ø","Oslash"],["Ù","Ugrave"],["Ú","Uacute"],["Û","Ucirc"],["Ü","Uuml"],["Ý","Yacute"],["Þ","THORN"],["ß","szlig"],["à","agrave"],["á","aacute"],["â","acirc"],["ã","atilde"],["ä","auml"],["å","aring"],["æ","aelig"],["ç","ccedil"],["è","egrave"],["é","eacute"],["ê","ecirc"],["ë","euml"],["ì","igrave"],["í","iacute"],["î","icirc"],["ï","iuml"],["ð","eth"],["ñ","ntilde"],["ò","ograve"],["ó","oacute"],["ô","ocirc"],["õ","otilde"],["ö","ouml"],["÷","divide"],["ø","oslash"],["ù","ugrave"],["ú","uacute"],["û","ucirc"],["ü","uuml"],["ý","yacute"],["þ","thorn"],["ÿ","yuml"],["ƒ","fnof"],["Α","Alpha"],["Β","Beta"],["Γ","Gamma"],["Δ","Delta"],["Ε","Epsilon"],["Ζ","Zeta"],["Η","Eta"],["Θ","Theta"],["Ι","Iota"],["Κ","Kappa"],["Λ","Lambda"],["Μ","Mu"],["Ν","Nu"],["Ξ","Xi"],["Ο","Omicron"],["Π","Pi"],["Ρ","Rho"],["Σ","Sigma"],["Τ","Tau"],["Υ","Upsilon"],["Φ","Phi"],["Χ","Chi"],["Ψ","Psi"],["Ω","Omega"],["α","alpha"],["β","beta"],["γ","gamma"],["δ","delta"],["ε","epsilon"],["ζ","zeta"],["η","eta"],["θ","theta"],["ι","iota"],["κ","kappa"],["λ","lambda"],["μ","mu"],["ν","nu"],["ξ","xi"],["ο","omicron"],["π","pi"],["ρ","rho"],["ς","sigmaf"],["σ","sigma"],["τ","tau"],["υ","upsilon"],["φ","phi"],["χ","chi"],["ψ","psi"],["ω","omega"],["ϑ","thetasym"],["ϒ","upsih"],["ϖ","piv"],["•","bull"],["…","hellip"],["′","prime"],["″","Prime"],["‾","oline"],["⁄","frasl"],["℘","weierp"],["ℑ","image"],["ℜ","real"],["™","trade"],["ℵ","alefsym"],["←","larr"],["↑","uarr"],["→","rarr"],["↓","darr"],["↔","harr"],["↵","crarr"],["⇐","lArr"],["⇑","uArr"],["⇒","rArr"],["⇓","dArr"],["⇔","hArr"],["∀","forall"],["∂","part"],["∃","exist"],["∅","empty"],["∇","nabla"],["∈","isin"],["∉","notin"],["∋","ni"],["∏","prod"],["∑","sum"],["−","minus"],["∗","lowast"],["√","radic"],["∝","prop"],["∞","infin"],["∠","ang"],["∧","and"],["∨","or"],["∩","cap"],["∪","cup"],["∫","int"],["∴","there4"],["∼","sim"],["≅","cong"],["≈","asymp"],["≠","ne"],["≡","equiv"],["≤","le"],["≥","ge"],["⊂","sub"],["⊃","sup"],["⊄","nsub"],["⊆","sube"],["⊇","supe"],["⊕","oplus"],["⊗","otimes"],["⊥","perp"],["⋅","sdot"],["⌈","lceil"],["⌉","rceil"],["⌊","lfloor"],["⌋","rfloor"],["〈","lang"],["〉","rang"],["◊","loz"],["♠","spades"],["♣","clubs"],["♥","hearts"],["♦","diams"],["Œ","Elig"],["œ","oelig"],["Š","Scaron"],["š","scaron"],["Ÿ","Yuml"],["ˆ","circ"],["˜","tilde"],[" ","ensp"],[" ","emsp"],[" ","thinsp"],["‌","zwnj"],["‍","zwj"],["‎","lrm"],["‏","rlm"],["–","ndash"],["—","mdash"],["‘","lsquo"],["’","rsquo"],["‚","sbquo"],["“","ldquo"],["”","rdquo"],["„","bdquo"],["†","dagger"],["‡","Dagger"],["‰","permil"],["‹","lsaquo"],["›","rsaquo"]];dhe.encode=function(str,m){if(str){if(!m){str=_fc9(str,dhe.html);str=_fc9(str,dhe.latin);}else{str=_fc9(str,m);}}return str;};dhe.decode=function(str,m){if(str){if(!m){str=_fcc(str,dhe.html);str=_fcc(str,dhe.latin);}else{str=_fcc(str,m);}}return str;};return dhe;});},"cb/board/toolbar/ChooseAttributeDialog":function(){define(["dojo","dojo/_base/declare","dojo/_base/lang","dojo/on","dojo/aspect","dojo/dom-class","dojo/dom-construct","dojo/html","dojo/keys","sp/dialog/TooltipDialog","sp/dialog/DialogContent","sp/I18n","dojo/i18n!../nls/Messages"],function(dojo,_fcf,lang,on,_fd0,_fd1,_fd2,_fd3,keys,_fd4,_fd5,_fd6,i18n){var _fd7=_fd6.wrap(i18n);return dojo.declare([_fd4],{complexOrient:{"BL":"TL","BR":"TR"},integratedDesign:true,integratedDesignOffset:11,closeSubscriptions:null,dropdownSections:null,postCreate:function(){this.inherited(arguments);this.content=new _fd5({i18n:i18n,templateString:"<div class=\"dialog-content\"><div dojoAttachPoint=\"_menuNode\"></div><div>",dialog:this,buildRendering:function(){this.inherited("buildRendering",arguments);if(!this.dialog.dropdownSections||!this.dialog.dropdownSections.length){console.error("Dropdown sections not provided. Aborting dialog render...");return;}for(var k=0;k<this.dialog.dropdownSections.length;k++){var _fd8=this.dialog.dropdownSections[k];if(!_fd8.allValues||!_fd8.renderFunction){console.error("Section information not complete. Aborting dialog render...",_fd8.currentValue,_fd8.allValues,_fd8.renderFunction);return;}var _fd9=_fd2.create("ul",{"class":"simple-app-menu attribute-app-menu "+(_fd8.menuClass?_fd8.menuClass:"")},this._menuNode);for(var i=0;i<_fd8.allValues.length;i++){var _fda=_fd8.allValues[i];_fd8.renderFunction(_fd9,_fd8.currentValue,_fda);}}}});},createAndConnectCloseHandler:function(){this.closeSubscriptions=[dojo.subscribe("/sp/pad/controller/mousedown",this,function(args){this.hide();}),dojo.subscribe("/sp/pad/propbar/mousedown",this,function(args){this.hide();}),dojo.subscribe("updates/cb/board/currenttool",this,function(args){this.hide();}),dojo.subscribe("/cb/board/tool/config/current",this,function(args){this.hide();})];},hide:function(){this.inherited("hide",arguments);if(this.closeSubscriptions){for(var i=0;i<this.closeSubscriptions.length;i++){dojo.unsubscribe(this.closeSubscriptions[i]);}}}});});},"wp/data/Container":function(){define("wp/data/Container",["dijit","dojo","dojox","dojo/require!wp/SimpleObjects,wp/data/ItemMap,wp/data/ContainerPreviewAddOn,wp/data/ContainerShapeAddOn,wp/data/ContainerBBoxAddOn,wp/data/ContainerHistoryAddOn,wp/data/ContainerCopyAddOn,wp/data/SequenceHelper,dojox/lang/functional"],function(_fdb,dojo,_fdc){dojo.provide("wp.data.Container");dojo.require("wp.SimpleObjects");dojo.require("wp.data.ItemMap");dojo.require("wp.data.ContainerPreviewAddOn");dojo.require("wp.data.ContainerShapeAddOn");dojo.require("wp.data.ContainerBBoxAddOn");dojo.require("wp.data.ContainerHistoryAddOn");dojo.require("wp.data.ContainerCopyAddOn");dojo.require("wp.data.SequenceHelper");dojo.require("dojox.lang.functional");dojo.declare("wp.data.Container",[wp.data.ContainerPreviewAddOn,wp.data.ContainerShapeAddOn,wp.data.ContainerBBoxAddOn,wp.data.ContainerHistoryAddOn,wp.data.ContainerCopyAddOn],{documentId:null,pad:null,constructor:function(_fdd){dojo.mixin(this,_fdd);this._pad=this.pad;delete this.pad;this._itemMap=new wp.data.ItemMap();this._publishList=[];this._idBufferPrevGen={};this._idBufferGenPrev={};this.forwardIncomingItemsTimeout=null;this.forwardIncomingItemsBuffer=[];dojo.subscribe("/sp/ajax/incoming/dedicatedPadItems",this,"addOrUpdateItemsFromServer");this.txtEntriesCompareBound=dojo.hitch(this,this.txtEntriesCompareBound);},sendFullyInitiatedOnNextEmptyRun:function(){this._sendFullyInitiatedPollOne();},_sendFullyInitiatedPollOne:function(){window.setTimeout(dojo.hitch(this,function(){if(this.forwardIncomingItemsBuffer.length>0){this._sendFullyInitiatedPollOne();}else{this._sendFullyInitiatedPollTwo();}}),250);},_sendFullyInitiatedPollTwo:function(){window.setTimeout(dojo.hitch(this,function(){if(this.forwardIncomingItemsBuffer.length>0){this._sendFullyInitiatedPollTwo();}else{dojo.publish("/sp/ajax/connectivityStatus",["CONTAINER-FULLY-INITIATED"]);}}),250);},getLastModifiedAt:function(){return this._itemMap.getLastModifiedAt();},containsItem:function(id){return this._itemMap.contains(id);},getItem:function(id){return this._itemMap.getItemById(id);},getItemType:function(id){return this._itemMap.getItemType(id);},getItemSubType:function(id){return this._itemMap.getItemSubType(id);},getItemCopy:function(id,_fde){var _fdf=this._itemMap.getItemDataCopyById(id,_fde);return this._pad.factory.getNewItem(_fdf.type,_fdf);},getItemIdsByBBox:function(bbox){return this._itemMap.getIdsByBBox(bbox,this);},getItemIdsByTouchedBBox:function(bbox){return this._itemMap.getIdsByTouchedBBox(bbox,this);},getItemAlignByBBoxAndSearchBox:function(_fe0,_fe1){return this._itemMap.getItemAlignByBBoxAndSearchBox(_fe0,_fe1,this);},addOrUpdateItemsFromServer:function(_fe2){if(this.forwardIncomingItemsTimeout){window.clearTimeout(this.forwardIncomingItemsTimeout);}this.forwardIncomingItemsBuffer=this.forwardIncomingItemsBuffer.concat(_fe2);this.forwardIncomingItemsTimeout=window.setTimeout(dojo.hitch(this,function(){this._addOrUpdateItems(this.forwardIncomingItemsBuffer.splice(0,this.forwardIncomingItemsBuffer.length),false);}),250);},addOrUpdateItems:function(_fe3){this._addOrUpdateItems(_fe3,true);},_addOrUpdateItems:function(_fe4,_fe5,_fe6,_fe7){var _fe8=this._itemMap,_fe9=this._pad.drawer,_fea=this._pad.surface;var _feb=_fe4;if(!_fe7){_feb=this._backwardCompatibilityConversion(_fe4);}var _fec=null;var _fed=null;var _fee={};this._resetPublishList();this._historyActionOnce(_fe6,_fe5,_feb.length);for(var i=0,_fef=_feb.length;i<_fef;i++){var _ff0=this._checkItemConstruction(_feb[i]);_ff0.id=this._checkItemId(_ff0);_fec=_ff0.id;_fee[_fec]=true;_ff0.z=this._checkItemZ(_ff0.z);this._historyActionEach(_fe6,_fe5,_ff0);_ff0.isTextEscaped=!_fe5;_fed=_fe8.addOrUpdateItem(_ff0);if(!_fed){delete _fee[_fec];}else{if(_ff0.del){_fe9.removeDrawing(_fec);}if(_ff0.type==="txtE"||_ff0.type==="txtG"||_ff0.type==="image"){dojo.publish("/sp/items/newOrUpdatedTxtOrImageItemId",[_ff0.id]);}dojo.publish("/sp/items/newOrUpdatedVisibleItem",[_ff0]);if(_fe5){this._addToPublishList(_ff0.json());}}}if(_fe5){this.resetPrevItemTransformators();sp.ajax.getInstance().publishItemString(this._getPublishString(),this.documentId).then(dojo.hitch(this,function(_ff1){var _ff2=dojo.filter(_ff1.rejectedItems||[],function(i){return i!==null;});if(_ff2.length>0){dojo.forEach(_ff2,function(id){this.removePreviewItemById(id);});this.refreshPreview(false,false);}window.setTimeout(function(){dojo.publish("/sp/ajax/savingSuccessful");},10);}));}else{var _ff3=_fdc.lang.functional.keys(_fee);if(_ff3.length>0){_fe9.enqueueDrawings(_ff3);this.refreshPreview(false,true);}}return _fec;},_backwardCompatibilityConversion:function(_ff4){var _ff5=[];var _ff6=[];for(var i=0;i<_ff4.length;i++){var item=_ff4[i];if(!item.authorid&&item.usr){item.authorid=item.usr;}if(item.type=="text"||item.type=="headline"){var _ff7=this._pad.generateItemId();var _ff8=this._pad.factory.getNewItem("txtG",item);_ff8.id=_ff7;_ff8.seq=null;_ff6.push(_ff8);var _ff9=this._pad.generateItemId();var _ffa=this._pad.factory.getNewItem("txtE",item);_ffa.id=_ff9;_ffa.txtGId=_ff7;_ffa.seq=null;_ff6.push(_ffa);item.del="1";item.type="line";_ff6.push(item);}else{_ff5.push(item);}}if(_ff6.length>0){this._addOrUpdateItems(_ff6,true,false,true);}return _ff5;},getPrevIdByGenId:function(_ffb){return this._idBufferGenPrev[_ffb];},getTextEntryItems:function(_ffc){var ret=[];var ids=this._itemMap.getTextEntryIds(_ffc);for(var i=0;i<ids.length;i++){if(this.containsItem(ids[i])){var _ffd=this.getItem(ids[i]);if(!_ffd.del){ret.push(_ffd);}}}return ret;},txtEntriesCompare:function(){return this._itemMap.txtEntriesCompare.apply(this._itemMap,arguments);},txtEntriesCompareBound:function(){throw "this method has to be replaced in the constructor";},getInvisibleTextGroupIds:function(){return this._itemMap.getInvisibleTextGroupIds();},getZListSuccessorId:function(id){var idx=this._itemMap._zListIndexOf(id);if(idx===-1){return null;}var _ffe=this._itemMap._getIdAtZListIndex(idx+1);if(_ffe){return _ffe.id;}else{return null;}},getZListIndex:function(id){return this._itemMap._zListIndexOf(id);},_resetPublishList:function(){this._publishList=[];},_addToPublishList:function(_fff){if(!this._publishList){this._publishList=[];}this._publishList.push(_fff);},_getPublishString:function(){return dojo.toJson(this._publishList);},_checkItemConstruction:function(_1000){if(_1000.IS_CONSTRUCTED){return _1000;}else{return this._pad.factory.getNewItem(_1000.type,_1000);}},_checkItemId:function(item){var id=item.id;if(!id){throw new Error("STORING ITEM WITHOUT ID !!!!");}else{if(id=="_TMP"){throw new Error("STORING ITEM WITH ID _TMP !!!!");}}return id;},_checkItemZ:function(z){if(z!==0&&!z){return this._itemMap.getNextMaxZ()+"";}else{return z+"";}},_historyActionOnce:function(_1001,_1002,_1003){if(!_1001&&_1002&&_1003>0){this._nextHistoryEntry();}},_historyActionEach:function(_1004,_1005,_1006){if(!_1004&&_1005){if(this._itemMap.contains(_1006.id)){var _1007=this.getItemCopy(_1006.id,"_historyActionEach");var _1008=this._pad.factory.getItemCopy(_1006);this._addToHistory(_1007,_1008);}else{var _1007=this._pad.factory.getItemCopy(_1006);_1007.del="1";var _1008=this._pad.factory.getItemCopy(_1006);this._addToHistory(_1007,_1008);}}}});});},"wp/widget/EditDialog":function(){define("wp/widget/EditDialog",["dijit","dojo","dojox","dojo/i18n!wp/widget/nls/EditDialog","dojo/require!sp/dialog/TooltipDialog,sp/dialog/ShowDownloadsDialog"],function(dijit,dojo,dojox){dojo.provide("wp.widget.EditDialog");dojo.requireLocalization("wp.widget","EditDialog");dojo.require("sp.dialog.TooltipDialog");dojo.require("sp.dialog.ShowDownloadsDialog");dojo.declare("wp.widget.EditDialog",[sp.dialog.TooltipDialog],{baseClass:"edit-dialog",controller:null,container:null,showSwitchModeMenu:false,complexOrient:["below"],closeSubscriptions:null,constructor:function(_1009){this.controller=_1009.controller;this.container=_1009.container;this.showSwitchModeMenu=_1009.showSwitchModeMenu;},postCreate:function(){this.inherited(arguments);this.content=new sp.dialog.DialogContent({templateString:"<div class=\"dialog-content\">\r\n    <ul class=\"simple-app-menu hideBlock\" dojoAttachPoint=\"defaultMenu\">\r\n        <li dojoAttachPoint=\"undoNode\"        dojoAttachEvent=\"onclick: undoClick\"          >${!i18n.undo}</li>\r\n        <li dojoAttachPoint=\"redoNode\"        dojoAttachEvent=\"onclick: redoClick\"          >${!i18n.redo}</li>\r\n        <li class=\"separator\"></li>\r\n        <li dojoAttachPoint=\"copyNode\"        dojoAttachEvent=\"onclick: copyClick\"          >${!i18n.copy}</li>\r\n        <li dojoAttachPoint=\"pasteNode\"       dojoAttachEvent=\"onclick: pasteClick\"         >${!i18n.paste}</li>\r\n        <li class=\"separator\"></li>\r\n        <li dojoAttachPoint=\"deleteNode\"      dojoAttachEvent=\"onclick: deleteClick\"        >${!i18n.delete}</li>\r\n        <li class=\"separator\"></li>\r\n        <li dojoAttachPoint=\"moveToFrontNode\" dojoAttachEvent=\"onclick: moveToFrontClick\"   >${!i18n.tofront}</li>\r\n        <li dojoAttachPoint=\"moveToBackNode\"  dojoAttachEvent=\"onclick: moveToBackClick\"    >${!i18n.toback}</li>\r\n        <li class=\"separator\"></li>\r\n        <li dojoAttachPoint=\"groupNode\"       dojoAttachEvent=\"onclick: groupClick\"         >${!i18n.group}</li>\r\n        <li dojoAttachPoint=\"ungroupNode\"     dojoAttachEvent=\"onclick: ungroupClick\"       >${!i18n.ungroup}</li>\r\n        <li class=\"separator\"></li>\r\n        <li dojoAttachPoint=\"downloadNode\"    dojoAttachEvent=\"onclick:_closeDialog\" class=\"with-link\"><a target=\"_blank\" download dojoAttachPoint=\"downloadLink\">${!i18n.download}</a></li>\r\n        <li dojoAttachPoint=\"originalNode\"    dojoAttachEvent=\"onclick:originalClick\"       >${!i18n.original}</li>\r\n    </ul>\r\n    <ul class=\"simple-app-menu hideBlock\" dojoAttachPoint=\"switchModeMenu\">\r\n        <li                                   dojoAttachEvent=\"onclick: switchToDiscuss\"    >${!i18n.switchToDiscuss}</li>\r\n        <li                                   dojoAttachEvent=\"onclick: switchToCreate\"     >${!i18n.switchToCreate}</li>\r\n    </ul>\r\n    <div class=\"clearer\"></div>\r\n</div>",dialog:this,i18n:sp.I18n.bundle("wp.widget","EditDialog"),postCreate:function(){this.inherited("postCreate",arguments);if(this.dialog.showSwitchModeMenu){dojo.toggleClass(this.switchModeMenu,"hideBlock",false);}else{var _100a=this.setupImageDownloadLink();dojo.toggleClass(this.defaultMenu,"hideBlock",false);dojo.toggleClass(this.undoNode,"disabled",!this.dialog.container.isUndoPossible());dojo.toggleClass(this.redoNode,"disabled",!this.dialog.container.isRedoPossible());dojo.toggleClass(this.copyNode,"disabled",!this.dialog.container.isSthSelected());dojo.toggleClass(this.pasteNode,"disabled",!this.dialog.container.isClipboardFilled());dojo.toggleClass(this.deleteNode,"disabled",!this.dialog.container.isSthSelected());dojo.toggleClass(this.moveToFrontNode,"disabled",!this.dialog.container.isSthSelected());dojo.toggleClass(this.moveToBackNode,"disabled",!this.dialog.container.isSthSelected());dojo.toggleClass(this.groupNode,"disabled",!this.dialog.container.isMultipleSelected());dojo.toggleClass(this.ungroupNode,"disabled",!this.dialog.container.getSingleSelectedGroupItemId());dojo.toggleClass(this.downloadNode,"disabled",!_100a);dojo.toggleClass(this.originalNode,"disabled",!_100a);}},setupImageDownloadLink:function(){var _100b=this.dialog.container.getSingleSelectedImageItemId();if(_100b){var _100c=this.dialog.container.getItem(_100b);var _100d=_100c.imgPrefix+_100c.src+".snap.png";dojo.attr(this.downloadLink,"href",_100d);return true;}},switchToDiscuss:dojo.hitch(this,function(e){this.hide();dijit.byId("propbar")._discussButtonClick();}),switchToCreate:dojo.hitch(this,function(e){this.hide();dijit.byId("propbar")._createButtonClick();}),undoClick:dojo.hitch(this,function(e){this.hide();this.controller.undo();}),redoClick:dojo.hitch(this,function(e){this.hide();this.controller.redo();}),copyClick:dojo.hitch(this,function(e){this.hide();this.controller.copy();}),pasteClick:dojo.hitch(this,function(e){this.hide();this.controller.paste();}),deleteClick:dojo.hitch(this,function(e){this.hide();this.controller.deleteItem();}),moveToFrontClick:dojo.hitch(this,function(e){this.hide();this.controller.moveToFront();}),moveToBackClick:dojo.hitch(this,function(e){this.hide();this.controller.moveToBack();}),groupClick:dojo.hitch(this,function(e){this.hide();this.controller.group();}),ungroupClick:dojo.hitch(this,function(e){this.hide();this.controller.ungroup();}),originalClick:dojo.hitch(this,function(e){this.hide();(new sp.dialog.ShowDownloadsDialog({documentId:sp.info.document.id,docTitle:sp.info.document.title})).show();}),_closeDialog:dojo.hitch(this,function(e){this.hide();})});},onHide:function(){this.inherited(arguments);if(this.currentContext){dijit.byNode(this.currentContext.parentNode).setActiveIconState(false);}},onShow:function(){this.inherited(arguments);if(this.currentContext){dijit.byNode(this.currentContext.parentNode).setActiveIconState(true);}},createAndConnectCloseHandler:function(){this.closeSubscriptions=[dojo.subscribe("/sp/pad/controller/mousedown",this,function(args){this.hide();}),dojo.subscribe("/sp/pad/propbar/mousedown",this,function(args){this.hide();})];},hide:function(){this.inherited("hide",arguments);if(this.closeSubscriptions){for(var i=0;i<this.closeSubscriptions.length;i++){dojo.unsubscribe(this.closeSubscriptions[i]);}}}});});},"cb/page/pad/UserColorTracker":function(){define(["dojo","dojo/_base/array","dojo/Stateful","dojox/lang/functional","./SequenceOrderingHelper"],function(dojo,arr,_100e,_100f,_1010){var _1011="#FFFFFF";var _1012=dojo.declare([],{constructor:function(){this._data=new _100e({});this._sequenceOrderingHelper=new _1010(function(msg){return msg.user.id;});dojo.subscribe("/sp/ajax/incoming/usercolorchanged",this,"_onUserColorChangedMessage");},watch:function(_1013,_1014){if(_1014){_1014(_1013,undefined,this._data.get(_1013)||_1011);}else{_100f.forIn(this._data,function(id,value){_1013(id,undefined,value||_1011);});}return this._data.watch(_1013,function(id,_1015,_1016){_1014(id,_1015,_1016||_1011);});},get:function(_1017){return this._data.get(_1017)||_1011;},_onUserColorChangedMessage:function(msg){if(this._sequenceOrderingHelper.isLatestMessage(msg)){this._data.set(msg.user.id,msg.newColor);}}});return new _1012();});},"cb/widget/ShortcutsDialog":function(){define(["dojo","dijit/_WidgetsInTemplateMixin","dojo/has","sp/dialog/Dialog","sp/dialog/DialogContent","sp/I18n","dojo/text!./ShortcutsDialog.html","dojo/i18n!./nls/ShortcutsDialog","dojo/_base/sniff"],function(dojo,_1018,has,_1019,_101a,_101b,_101c,i18n){var _101d=dojo.declare([_101a,_1018],{templateString:_101c,widgetsInTemplate:true,i18n:i18n,postMixInProperties:function(){this.inherited(arguments);this.cmdOrCtrl=has("mac")?_101b.wrap(i18n)("cmd_key"):_101b.wrap(i18n)("ctrl_key");},postCreate:function(){this.inherited(arguments);},_handleCloseButtonClick:function(){this.dialog.hide();}});return dojo.declare([_1019],{baseClass:"shortcuts-dialog",destroyOnHide:true,postCreate:function(){this.inherited(arguments);new _101d({dialog:this});}});});},"wp/UniqueArray":function(){define("wp/UniqueArray",["dojo"],function(dojo){var wp={};wp.UniqueArray=dojo.declare("wp.UniqueArray",null,{constructor:function(arg){this._o=[];this._xMap={};if(arg){this.pushArray(arg);}},contains:function(obj){return this._xMap.hasOwnProperty(obj);},getLength:function(){return this.toArray().length;},push:function(obj){if(!this._xMap[obj]&&this._xMap[obj]!==0){this._xMap[obj]=this._o.push(obj)-1;}},pushArray:function(_101e){var len=_101e.length;if(len){for(var i=0;i<len;i++){this.push(_101e[i]);}}},del:function(obj){this._o[this._xMap[obj]]=null;this._xMap[obj]=null;},toArray:function(){return wp.UniqueArray.makeUnique(this._o);},toArrayReversed:function(){return wp.UniqueArray.makeUniqueReversed(this._o);}});wp.UniqueArray.makeUniqueReversed=function(arr){if(!arr){return [];}var ret=[],hash={},o;for(var i=arr.length;i--;){var o=arr[i];if(!o){continue;}if(!hash.hasOwnProperty(o)){ret.push(o);hash[o]=true;}}return ret;};wp.UniqueArray.makeUnique=function(arr){if(!arr){return [];}var ret=[],hash={},o;for(var i=arr.length;i--;){var o=arr[i];if(!o){continue;}if(!hash.hasOwnProperty(o)){ret.unshift(o);hash[o]=true;}}return ret;};return wp.UniqueArray;});},"cb/board/toolbar/ChooseZoomDialog":function(){define(["dojo","dojo/_base/declare","dojo/_base/lang","dojo/on","dojo/aspect","dojo/dom-class","dojo/dom-construct","dojo/html","dojo/keys","dojo/query","dojo/dom-attr","sp/dialog/TooltipDialog","sp/dialog/DialogContent","sp/I18n","dojo/i18n!../nls/Messages"],function(dojo,_101f,lang,on,_1020,_1021,_1022,dHtml,keys,query,_1023,_1024,_1025,_1026,i18n){var _1027=_1026.wrap(i18n);return dojo.declare([_1024],{complexOrient:{"BL":"TL"},integratedDesign:true,integratedDesignOffset:11,closeSubscriptions:null,postCreate:function(){this.inherited(arguments);this.content=new _1025({i18n:i18n,templateString:"<div class=\"dialog-content\"><ul class=\"simple-app-menu zoom-app-menu\" dojoAttachPoint=\"_menuNode\"></ul><div>",dialog:this,buildRendering:function(){this.inherited("buildRendering",arguments);_1022.create("li",{"innerHTML":"Fit","spzoom":"fit"},this._menuNode);_1022.create("li",{"innerHTML":"10%","spzoom":"0.1"},this._menuNode);_1022.create("li",{"innerHTML":"25%","spzoom":"0.25"},this._menuNode);_1022.create("li",{"innerHTML":"50%","spzoom":"0.5"},this._menuNode);_1022.create("li",{"innerHTML":"75%","spzoom":"0.75"},this._menuNode);_1022.create("li",{"innerHTML":"100%","spzoom":"1.0"},this._menuNode);_1022.create("li",{"innerHTML":"200%","spzoom":"2.0"},this._menuNode);_1022.create("li",{"innerHTML":"400%","spzoom":"4.0"},this._menuNode);query("li[spzoom]",this.domNode).connect("onclick",lang.hitch(this,function(event){var _1028=_1023.get(event.currentTarget,"spzoom");if(_1028==="fit"){dojo.publish("requests/cb/board/smoothzoomtofit",[]);}else{dojo.publish("requests/cb/board/smoothzoom",[1*_1028]);}}));}});},createAndConnectCloseHandler:function(){this.closeSubscriptions=[dojo.subscribe("/sp/pad/controller/mousedown",this,function(args){this.hide();}),dojo.subscribe("/sp/pad/propbar/mousedown",this,function(args){this.hide();}),dojo.subscribe("updates/cb/board/currenttool",this,function(args){this.hide();})];},hide:function(){this.inherited("hide",arguments);if(this.closeSubscriptions){for(var i=0;i<this.closeSubscriptions.length;i++){dojo.unsubscribe(this.closeSubscriptions[i]);}}}});});},"wp/widget/SidebarEditBox":function(){define("wp/widget/SidebarEditBox",["dijit","dojo","dojox","dojo/require!dijit/InlineEditBox,cb/widget/_OnDijitClickToDblClickMixin,dijit/InlineEditBox"],function(dijit,dojo,dojox){dojo.provide("wp.widget.SidebarEditBox");dojo.require("dijit.InlineEditBox");dojo.require("cb.widget._OnDijitClickToDblClickMixin");dojo.declare("wp.widget.SidebarEditBox",[dijit.InlineEditBox,cb.widget._OnDijitClickToDblClickMixin],{editorWrapper:"wp.widget._SidebarEditBoxInlineEditor",postCreate:function(){this.inherited(arguments);dojo.addClass(this.domNode,"sidebar-editbox");},edit:function(){dojo.query(".index-list",dijit.byId("outline-container").domNode).removeClass("edit-enabled");this.inherited("edit",arguments);},onChange:function(){this.inherited("onChange",arguments);},_setValueAttr:function(val,_1029){val=dojo.trim(val);var _102a=this.renderAsHtml?val:sp.I18n.esc(val).replace(/\n/g,"<br>");this.displayNode.innerHTML=_102a||this.noValueIndicator;this._set("value",val);if(this._started&&!_1029){setTimeout(dojo.hitch(this,"onChange",val),0);}if(this.textDir=="auto"){this.applyTextDir(this.displayNode,this.displayNode.innerText);}}});dojo.provide("wp.widget._SidebarEditBoxInlineEditor");dojo.require("dijit.InlineEditBox");dojo.declare("wp.widget._SidebarEditBoxInlineEditor",[dijit._InlineEditor],{postCreate:function(){this.inherited(arguments);dojo.addClass(this.domNode,"sidebar-editbox-inlineeditor");}});});},"cb/board/OuterFooterToggler":function(){define(["dojo","dojo/_base/declare","dojo/_base/lang","dojo/on","dojo/dom-class","dojo/dom-construct","dojo/html","dijit/_Widget","dijit/layout/ContentPane","sp/I18n","dojo/i18n!./nls/Messages"],function(dojo,_102b,lang,on,_102c,_102d,dHtml,_102e,_102f,_1030,i18n){var _1031=_1030.wrap(i18n);return _102b([_102f],{postCreate:function(){this.inherited(arguments);this._footerToggler=_102d.create("div",{"innerHTML":"<span class=\"fonticon-triangle-right\"></span><span class=\"fonticon-triangle-right\"></span>","title":_1031("open_footer"),"class":"footer-toggler open"},this.domNode);this.own(on(this._footerToggler,"click",lang.hitch(this,function(e){dojo.publish("/cb/board/panes/footer/open");})));dojo.subscribe("/cb/board/panes/footer/open",lang.hitch(this,function(){dojo.addClass(this._footerToggler,"hideBlock");}));dojo.subscribe("/cb/board/panes/footer/close",lang.hitch(this,function(){dojo.removeClass(this._footerToggler,"hideBlock");}));}});});},"cb/board/participants/ParticipantListDisplay":function(){define(["dojo","dojo/dom-class","dojo/dom-construct","dojo/on","sp/dialog/ShowParticipantsDialog","cb/page/pad/PadParticipantManager","cb/widget/UserList","cb/widget/_ParticipantsNumberReduceMixin","cb/page/pad/ParticipantTracker","./ParticipantWidget"],function(dojo,_1032,_1033,on,_1034,_1035,_1036,_1037,_1038,_1039){return dojo.declare([_1036,_1037],{withShareButton:false,postMixInProperties:function(){this.inherited(arguments);},postCreate:function(){this.inherited(arguments);this.connect(_1038,"onUserAdded","_handleUserAdded");this.connect(_1038,"onUserRemoved","_handleUserRemoved");_1032.add(this.domNode,"currently-online");if(this.withShareButton){this._addShareButton();}},_onUserColorChangedMessage:function(_103a){var w=this.getEntryWidget(_103a.user.id);if(w&&w.updateUserColor){w.updateUserColor(_103a.newColor);}},_handleUserRemoved:function(_103b,_103c){this.removeUser(_103b);},_handleUserAdded:function(_103d,_103e){this.addUser(_103d,_103e);},_getWidget:function(_103f){return this.getEntryWidget[_103f];},_addShareButton:function(){this.shareButton=_1033.create("span",{"class":"share-button",innerHTML:"<i class=\"icon fonticon-participants-small fonticon-large\"></i>"},this.domNode,"last");on(this.shareButton,"click",this._handleShareButtonClick);},_handleShareButtonClick:function(){sp.global.analytics.trackEvent("openShareDialog","share button participants",sp.info.user.info.accountType.asString);(new _1034({documentId:sp.info.document.id,participantManager:_1035})).show();},createEntryWidget:function(id,entry,node){var _1040=new _1039({entry:entry,loginEnabled:true,logoutEnabled:true},node);return _1040;}});});},"wp/data/SequenceHelper":function(){define("wp/data/SequenceHelper",["dojo"],function(dojo){var _1041=-1;function _1042(seq){if(typeof seq==="number"){return {hi:_1041,low:seq};}else{return seq;}};function _1043(_1044,_1045){var seq1=_1042(_1044)||null;var seq2=_1042(_1045)||null;if(seq1===seq2){return 0;}else{if(seq1&&seq2){if(seq1.hi===seq2.hi){return seq1.low-seq2.low;}else{return seq1.hi-seq2.hi;}}else{return seq1?1:-1;}}};return {comparater:_1043,comparator:_1043,isEqual:function(seq1,seq2){return _1043(seq1,seq2)===0;},isGreaterThan:function(seq1,seq2){return _1043(seq1,seq2)>0;}};});},"wp/widget/Propbar":function(){define("wp/widget/Propbar",["dijit","dojo","dojox","dojo/i18n!wp/widget/nls/Propbar","dojo/require!plupload/plupload,plupload/plupload-html4,plupload/plupload-html5,dijit/_Widget,cb/widget/_Templated,dojo/html,dojo/NodeList-html,dojo/fx,dojo/date/locale,dojo/on,wp/widget/EditDialog,wp/common/TextHelper,wp/widget/ScreenshotDialog,cb/widget/HelpDialog,sp/dialog/ShowParticipantsDialog,cb/page/pad/PadParticipantManager,dijit/layout/StackContainer,sp/I18n,sp/I18nWidget,sp/Tooltip,dojox/lang/functional,cb/Capabilities,cb/WheelSupport"],function(dijit,dojo,dojox){dojo.provide("wp.widget.Propbar");dojo.require("plupload.plupload");dojo.require("plupload.plupload-html4");dojo.require("plupload.plupload-html5");dojo.require("dijit._Widget");dojo.require("cb.widget._Templated");dojo.require("dojo.html");dojo.require("dojo.NodeList-html");dojo.require("dojo.fx");dojo.require("dojo.date.locale");dojo.require("dojo.on");dojo.require("wp.widget.EditDialog");dojo.require("wp.common.TextHelper");dojo.require("wp.widget.ScreenshotDialog");dojo.require("cb.widget.HelpDialog");dojo.require("sp.dialog.ShowParticipantsDialog");dojo.require("cb.page.pad.PadParticipantManager");dojo.require("dijit.layout.StackContainer");dojo.require("sp.I18n");dojo.require("sp.I18nWidget");dojo.require("sp.Tooltip");dojo.require("dojox.lang.functional");dojo.require("cb.Capabilities");dojo.require("cb.WheelSupport");dojo.requireLocalization("wp.widget","Propbar");dojo.declare("wp.widget.Propbar",[dijit._Widget,cb.widget._Templated,sp.I18nWidget],{templateString:"<div class=\"propbar\">\r\n\r\n    <span class=\"tool-container\"><span \r\n        class=\"app-button large-app-button\" dojoAttachEvent=\"onclick:_browseButtonClick\" dojoAttachPoint=\"_browseButton\" title=\"${!i18n.hand_title}\"><i class=\"fonticon-hand\"></i>${!i18n.hand_label}</span><span\r\n        class=\"app-button large-app-button\" style=\"position:relative;\" dojoAttachEvent=\"onclick:_discussButtonClick\" dojoAttachPoint=\"_discussButton\" id=\"tutorial-button-comment\" title=\"${!i18n.discuss_title}\"><i class=\"fonticon-discuss\"></i>${!i18n.discuss_label}</span><span \r\n        class=\"app-button large-app-button\" dojoAttachEvent=\"onclick:_createButtonClick\" dojoAttachPoint=\"_createButton\" title=\"${!i18n.create_title}\"><i class=\"fonticon-shapes-text\"></i>${!i18n.create_label}</span><span \r\n        class=\"app-button large-app-button\" dojoAttachEvent=\"onclick:_importButtonClick\" dojoAttachPoint=\"_importButton\" title=\"${!i18n.import_title}\"><i class=\"fonticon-upload\"></i>${!i18n.import_label}</span>\r\n    </span>\r\n\r\n    <div class=\"hideBlock propbar__banner\" data-dojo-attach-point=\"_readOnlyDisplay\">${!i18n.readonly}<i id=\"${id}_readonly_hint\" class=\"fonticon-question fonticon-large\"></i></div>\r\n    <div class=\"hideBlock propbar__banner\" data-dojo-attach-point=\"_nofreesqmBannerDisplay\"></div>\r\n\r\n</div>\r\n",widgetsInTemplate:true,documentId:null,controller:null,container:null,constructor:function(args){dojo.mixin(this,args);},buildRendering:function(){this.inherited("buildRendering",arguments);this.subscribe("updates/cb/board/currentmode",this._setActiveToolCategory);},postCreate:function(){this.inherited(arguments);new sp.Tooltip({connectId:this.id+"_readonly_hint",label:"<span class=\"tooltip-hint-content\">"+this.i18n.readonly_hint+"</span>",position:["below"],showDelay:50});this._changeAccessControlState();},startup:function(){this.domNode.style.display="inline-block";this.connect(this.domNode,"onmousedown",function(e){dojo.publish("/sp/pad/propbar/mousedown",[e]);});},_browseButtonClick:function(){dojo.publish("requests/cb/board/currenttoolchange",["TOOL_HAND","BROWSE"]);},_discussButtonClick:function(){dojo.publish("requests/cb/board/currentmodechange","DISCUSS");},_createButtonClick:function(){dojo.publish("requests/cb/board/currentmodechange","CREATE");},_importButtonClick:function(){dojo.publish("requests/cb/board/currentmodechange","IMPORT");dijit.byId("secondarytoolbar")._importContainer.showDropOverlay();},_setActiveToolCategory:function(_1046){dojo.query(".app-button",this.domNode).removeClass("active");switch(_1046){case "BROWSE":dojo.addClass(this._browseButton,"active");break;case "DISCUSS":dojo.addClass(this._discussButton,"active");break;case "CREATE":dojo.addClass(this._createButton,"active");break;case "IMPORT":dojo.addClass(this._importButton,"active");break;default:undefined;}},_setPropbarModeAttr:function(_1047){var _1048=this.get("propbarMode");if(_1048===_1047){return;}this._set("propbarMode",_1047);dojo.publish("/cb/board/toolbar/dialogs/close");switch(_1047){case "readonly":dojo.removeClass(dojo.doc.body,"any-editing");dojo.addClass(this._discussButton,"hideBlock");dojo.addClass(this._createButton,"hideBlock");dojo.addClass(this._importButton,"hideBlock");this._browseButtonClick();break;default:dojo.addClass(dojo.doc.body,"any-editing");dojo.removeClass(this._discussButton,"hideBlock");dojo.removeClass(this._createButton,"hideBlock");dojo.removeClass(this._importButton,"hideBlock");}},_changeAccessControlState:function(){this.controller.status.getAndWatch("editing",dojo.hitch(this,function(attr,old,_1049){this._editable=!_1049.readonly;this.set("propbarMode",_1049.readonly?"readonly":"edit");if(_1049.readonly){switch(_1049.reason){case "nofreesqm":this.set("banner","nofreesqm");break;case "collaborationmode":this.set("banner","collaborationmode");break;}}else{if(_1049.reason==="collaborationmode"){this.set("banner","collaborationmode");}else{this.set("banner",null);}}}));},showContextMenu:function(event){var _104a=new wp.widget.EditDialog({controller:this.controller,container:this.container,baseClass:"edit-dialog-context",showSwitchModeMenu:this.controller.currentMode==="BROWSE"});_104a.showAt(event.clientX,event.clientY);},_showFullscreenMessage:function(_104b){sp.global.err.handle(sp.global.err.getNewMessageObject("success",sp.I18n.get("wp.widget","Propbar")("fullscreen_keys_msg",[_104b]),sp.I18n.get("wp.widget","Propbar")("fullscreen_keys_title")));},_headerToggleButtonClick:function(event){var _104c=dojo.query(".hd-container.header")[0];if(dojo.hasClass(_104c,"hideBlock")){dojo.removeClass(_104c,"hideBlock");this._headerToggleButton.setActiveIconState(false);}else{var _104d=null;if(dojo.isMac){if(dojo.isFF||dojo.isChrome){_104d="⌘&nbsp;+&nbsp;⇧&nbsp;+&nbsp;F";this._showFullscreenMessage(_104d);}}else{if(dojo.isFF||dojo.isChrome||dojo.isIE){_104d="F11";this._showFullscreenMessage(_104d);}}this.goIntoFullscreen();}},goIntoFullscreen:function(){dojo.publish("/window/resize");this._stealFocus();},handleShareButtonClicked:function(){this.openShareDialog();sp.global.analytics.trackEvent("openShareDialog","share button header",sp.info.user.info.accountType.asString);},openShareDialog:function(){var _104e=new sp.dialog.ShowParticipantsDialog({documentId:sp.info.document.id,participantManager:cb.page.pad.PadParticipantManager});_104e.show();},openHelpDialog:function(_104f){new cb.widget.HelpDialog({}).show(_104f);},_setBannerAttr:function(_1050){dojo.toggleClass(this._readOnlyDisplay,"hideBlock",_1050!=="collaborationmode");dojo.toggleClass(this._nofreesqmBannerDisplay,"hideBlock",_1050!=="nofreesqm");this._set("banner",_1050);}});});},"cb/board/itemui/TxtDivHelper":function(){define(["dojo","dojo/DeferredList","dojo/on","dojo/when","dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/dom-class","dojo/dom-attr","dojox/lang/functional"],function(dojo,_1051,on,when,lang,array,_1052,_1053,_1054,_1055,_1056){return {createActionLink:function(_1057,_1058,_1059,title,_105a,_105b,_105c){var _105d=dojo.create("div",{"sid":"__NOFLOW","class":_1058,"innerHTML":_1059,"title":title?title:""},_1057);dojo.connect(_105d,"ontouchstart",function(event){event.isHandledByCb=true;});dojo.connect(_105d,"ontouchmove",function(event){event.isHandledByCb=true;});dojo.connect(_105d,"ontouchend",function(event){event.isHandledByCb=true;});if(_105a){_105c=(typeof _105c==="undefined"||_105c===""||typeof _105c!=="string")?"click":_105c;dojo.connect(_105d,_105c,function(event){dojo.stopEvent(event);event.stopPropagation();event.cancelBubble=true;_105a.apply(_105b,arguments);});}return _105d;},prepareEntryNode:function(_105e,_105f,eItem,_1060,_1061){if(_105f){_1054.remove(_105f,"delete-me-later");}if(_105f){var _1062=_1054.contains(_105f,"contains-textarea");if(_1062&&_1061){return {entryNode:_105f,contentChanged:false};}else{if(!_1062&&!_1061&&eItem){var _1063=_1055.get(_105f,"seqasstring");if(_1063&&_1063===eItem.getSeqAsString()){return {entryNode:_105f,contentChanged:false};}}}}if(!_105f){_105f=_1053.create("li",{"class":"clearfix","sid":_1060},_105e);}else{_1053.empty(_105f);}_1055.set(_105f,"eid",eItem?eItem.id:"__UNSAVED");_1054.toggle(_105f,"contains-textarea",_1061);if(eItem&&eItem.getFixedAuthorId()){_1055.set(_105f,"authorid",eItem.getFixedAuthorId());}if(eItem&&eItem.seq){_1055.set(_105f,"seqasstring",eItem.getSeqAsString());}return {entryNode:_105f,contentChanged:true};},moveEntryNode:function(_1064,eNode,_1065){if(_1065){dojo.place(eNode,_1065,"after");}else{dojo.place(eNode,_1064,"first");}},markAllEntriesForLaterDeletion:function(_1066){dojo.query(_1066).children().addClass("delete-me-later");},deleteAllEntriesStillMarked:function(_1067){dojo.query(".delete-me-later",_1067).orphan();}};});},"cb/board/toolbar/BoardTitleDialog":function(){define(["dojo","dojo/_base/declare","dojo/_base/lang","dojo/on","dojo/aspect","dojo/dom-class","dojo/dom-construct","dojo/html","dojo/keys","sp/dialog/TooltipDialog","sp/dialog/DialogContent","sp/infos/InfoManager","cb/Capabilities","cb/page/boards/DocumentSettingsDialog","sp/dialog/ShowDownloadsDialog","sp/dialog/GoogleDriveExportDialog","sp/dialog/ChatterExportDialog","sp/I18n","dojo/i18n!../nls/Messages"],function(dojo,_1068,lang,on,_1069,_106a,_106b,dHtml,keys,_106c,_106d,_106e,_106f,_1070,_1071,_1072,_1073,_1074,i18n){var _1075=_1074.wrap(i18n);return dojo.declare([_106c],{complexOrient:{"BL":"TL"},integratedDesign:true,integratedDesignOffset:11,invisibleMilk:true,postCreate:function(){this.inherited(arguments);this.content=new _106d({i18n:i18n,templateString:"<div class=\"dialog-content\" dojoAttachPoint=\"_menuContainer\"><div>",dialog:this,buildRendering:function(){this.inherited("buildRendering",arguments);var _1076=_106b.create("ul",{"class":"simple-app-menu title-app-menu stand-out-menu"},this._menuContainer);var _1077=_106b.create("li",{"innerHTML":"<i class=\"fonticon-participants-small\"></i> "+_1075("header_menu_invite")},_1076);this.own(on(_1077,"click",lang.hitch(this,function(e){sp.global.analytics.trackEvent("openShareDialog","board name",sp.info.user.info.accountType.asString);dijit.byId("propbar").openShareDialog();})));var _1078=_106b.create("ul",{"class":"simple-app-menu title-app-menu stand-out-menu-follower"},this._menuContainer);var _1079=_106b.create("li",{"innerHTML":"<i class=\"fonticon-cog\"></i> "+_1075("header_menu_settings")},_1078);this.own(on(_1079,"click",lang.hitch(this,function(event){_106e.getById({type:"document",id:sp.info.document.id}).then(function(_107a){return _106e.getById({type:"portfolio",id:_107a.document.projectId}).then(function(_107b){return {documentResult:_107a,portfolioResult:_107b};});}).then(function(_107c){new _1070({portfolioResult:_107c.portfolioResult,documentResult:_107c.documentResult}).show();});})));var _107d=_106b.create("li",{"innerHTML":"<i class=\"fonticon-download\"></i> "+_1075("header_menu_attachments")},_1078);this.own(on(_107d,"click",lang.hitch(this,function(e){(new _1071({documentId:sp.info.document.id,docTitle:sp.info.document.title})).show();})));_106f.checkGoogleDrive().then(lang.hitch(this,function(_107e){if(_107e==="enabled"){var _107f=_106b.create("li",{"innerHTML":"<i class=\"fonticon-dummy google-drive\">&nbsp;</i> "+_1075("header_menu_drive")},_1078);this.own(on(_107f,"click",lang.hitch(this,function(event){new _1072({documentId:sp.info.document.id}).show();})));}}));_106f.checkForcedotcomChatter().then(dojo.hitch(this,function(_1080){if(_1080==="enabled"){var _1081=_106b.create("li",{"innerHTML":"<i class=\"fonticon-dummy salesforce-chatter\">&nbsp;</i> "+_1075("header_menu_chatter")},_1078);this.own(on(_1081,"click",lang.hitch(this,function(event){new _1073({documentId:sp.info.document.id}).show();})));}}));}});}});});},"cb/board/participants/ParticipantWidget":function(){define(["dojo","dojo/_base/lang","dojo/dom-construct","dojo/dom-prop","dojo/dom-class","dojo/query","sp/infos/InfoManager","cb/page/pad/FollowAndPresentationManager","cb/page/pad/UserColorTracker","cb/widget/UserIconListEntry","cb/util"],function(dojo,lang,_1082,_1083,_1084,_1085,_1086,_1087,_1088,_1089,_108a){return dojo.declare([_1089],{userColor:null,constructor:function(){},postMixInProperties:function(){this.inherited(arguments);this.userid=this.entry.id;this.isMyself=this.userid===sp.info.user.info.id;this.update=_108a.debounce(this.update,50);this.entryDialogConstructor=dojo.declare([this.entryDialogConstructor],{loginEnabled:this.loginEnabled,logoutEnabled:this.logoutEnabled});},buildRendering:function(){this.inherited(arguments);var _108b=this._sendingIcon=_1082.create("div",{"class":"sending-icon hideBlock"},this.domNode,"last");_1082.create("div",{"class":"sending_1 hideBlock",innerHTML:"&nbsp;"},_108b,"last");_1082.create("div",{"class":"sending_2 hideBlock"},_108b,"last");_1082.create("div",{"class":"sending_3 hideBlock"},_108b,"last");},postCreate:function(){this.inherited("postCreate",arguments);dojo.connect(_1087,"onAnyModerationStarted",this,"_updateViewportSendingDisplayOnStart");dojo.connect(_1087,"onAnyModerationStopped",this,"_updateViewportSendingDisplayOnStop");this._sendingAnimStepTimer=new dojox.timing.Timer(500);this.connect(this._sendingAnimStepTimer,"onStart",this._sendingAnimOnStart);this.connect(this._sendingAnimStepTimer,"onTick",this._sendingAnimOnTick);this.connect(this._sendingAnimStepTimer,"onStop",this._sendingAnimOnStop);this.own(_1088.watch(this.userid,lang.hitch(this,function(_108c,_108d,_108e){this.updateUserColor(_108e);})));},update:function(entry){this.inherited(arguments);if(this._destroyed){return;}},updateUserColor:function(_108f){this.inherited(arguments);this.userColor=_108f;_1085("> div.sending_1",this._sendingIcon).style("backgroundColor",_108f);_1085(".sending_2, .sending_3",this._sendingIcon).style("borderColor",_108f);},_enableTrackingAnimation:function(){if(!this._sendingAnimStepTimer.isRunning){this._sendingAnimStepTimer.start();}},_disableTrackingAnimation:function(){this._sendingAnimStepTimer.stop();},_updateViewportSendingDisplayOnStart:function(){this._updateViewportSendingDisplay();},_updateViewportSendingDisplayOnStop:function(_1090){this._updateViewportSendingDisplay();},_updateViewportSendingDisplay:function(){if(this._destroyed){return;}var _1091=(this.userid===_1087.getCurrentModeratorId());if(_1091){this._enableTrackingAnimation();}else{this._disableTrackingAnimation();}dojo.toggleClass(this.domNode,"currently-sending-viewports",_1091);},_sendingAnimOnTick:function(){if(this._sendingAnimCurrentStep===3){this._sendingAnimCurrentStep=-1;}this._sendingAnimCurrentStep++;switch(this._sendingAnimCurrentStep){case 0:dojo.query("> div",this._sendingIcon).addClass("hideBlock");break;case 1:dojo.query("> div",this._sendingIcon).addClass("hideBlock").filter(".sending_1").removeClass("hideBlock");break;case 2:dojo.query("> div",this._sendingIcon).addClass("hideBlock").filter(".sending_1, .sending_2").removeClass("hideBlock");break;case 3:dojo.query("> div",this._sendingIcon).addClass("hideBlock").filter(".sending_1, .sending_2, .sending_3").removeClass("hideBlock");break;}},_sendingAnimOnStop:function(){dojo.query(this._sendingIcon).children().andSelf().addClass("hideBlock");},_sendingAnimOnStart:function(){dojo.query(this._sendingIcon).removeClass("hideBlock");this._sendingAnimCurrentStep=-1;}});});},"wp/BayeuxConnector":function(){define("wp/BayeuxConnector",["dijit","dojo","dojox","dojo/require!dojox/cometd,dojox/cometd/ack,dojox/lang/functional,cb/util"],function(dijit,dojo,dojox){dojo.provide("wp.BayeuxConnector");dojo.require("dojox.cometd");dojo.require("dojox.cometd.ack");dojo.require("dojox.lang.functional");dojo.require("cb.util");dojo.declare("wp.BayeuxConnector",null,{constructor:function(args){this.documenteditkey=args.documenteditkey;this._bayeuxBaseUrl=sp.info.app.serverUrlsCurrent.https+args.bayeuxurl;this._isFullyInitiated=false;this._isConnected=false;this._channel=null;this._subscriptionHandler=null;dojox.cometd.registerExtension("documenteditkey",{outgoing:dojo.hitch(this,function(m){if(!m){return;}if(!m.ext){m.ext={};}m.ext.documenteditkey=this.documenteditkey;})});dojox.cometd.unregisterTransport("websocket");dojo.addOnUnload(function(){dojox.cometd.disconnect();});dojo.subscribe("/sp/ajax/connectivity",dojo.hitch(this,function(_1092){if(!_1092.success&&_1092.permanent){dojox.cometd.disconnect();}}));},setSubscriptionHandler:function(_1093,_1094){this._channel=_1093;this._subscriptionHandler=_1094;},startup:function(){if(!this._channel||!this._subscriptionHandler){console.error("Breaking bayeux startup! No channel or handler defined!",this._channel,this._subscriptionHandler);return;}dojox.cometd.configure({url:this._bayeuxBaseUrl,maxNetworkDelay:30000,requestHeaders:{"X-is-ajax-call":"true","X-CB-CSRF":sp.info.user.nonce}});dojox.cometd.addListener("/meta/handshake",this,this._subscribeOnHandshake);dojox.cometd.addListener("/meta/connect",this,this._updateConnectivityStatusOnConnect);dojox.cometd.addListener("/meta/subscribe",this,this._updateConnectivityStatusOnSubscribe);dojox.cometd.handshake();},_subscribeOnHandshake:function(_1095){if(_1095.successful===true){dojox.cometd.subscribe(this._channel,this._subscriptionHandler);}},_updateConnectivityStatusOnConnect:function(_1096){if(dojox.cometd.isDisconnected()||!_1096.successful){dojo.publish("/sp/ajax/connectivityStatus",["DISCONNECTED"]);this._isConnected=false;return;}var _1097=this._isConnected;this._isConnected=_1096.successful===true;if(!this._isFullyInitiated&&this._isConnected){this._isFullyInitiated=true;dojo.publish("/sp/ajax/connectivityStatus",["BAYEUX-FULLY-INITIATED"]);}if(!_1097&&this._isConnected){dojo.publish("/sp/ajax/connectivityStatus",["RECONNECTED"]);}else{if(_1097&&!this._isConnected){dojo.publish("/sp/ajax/connectivityStatus",["DISCONNECTED"]);}}},_updateConnectivityStatusOnSubscribe:function(_1098){if(_1098.successful){return;}dojo.publish("/sp/ajax/connectivityStatus",["SUBSCRIPTION_ERROR"]);},publish:function(_1099,msg){dojox.cometd.publish(_1099,msg);},getBayeuxClientId:function(){return dojox.cometd.clientId;}});});},"cb/util-http":function(){define(["dojo/when"],function(when){var ret={};function _109a(url){if(url.search(/[&?]$/)!==-1){return url;}else{if(url.lastIndexOf("?")===-1){return url+"?";}else{return url+"&";}}};function _109b(url,name,value){url=_109a(url);url=url+encodeURIComponent(name)+"="+((value===undefined||value===null)?"":encodeURIComponent(value));return url;};return {addParamToUrl:_109b};});},"org/cometd/AckExtension":function(){(function(){function bind(_109c){return _109c.AckExtension=function(){var _109d;var _109e=false;var _109f=-1;function _10a0(text,args){_109d._debug(text,args);};this.registered=function(name,_10a1){_109d=_10a1;_10a0("AckExtension: executing registration callback");};this.unregistered=function(){_10a0("AckExtension: executing unregistration callback");_109d=null;};this.incoming=function(_10a2){var _10a3=_10a2.channel;if(_10a3=="/meta/handshake"){_109e=_10a2.ext&&_10a2.ext.ack;_10a0("AckExtension: server supports acks",_109e);}else{if(_109e&&_10a3=="/meta/connect"&&_10a2.successful){var ext=_10a2.ext;if(ext&&typeof ext.ack==="number"){_109f=ext.ack;_10a0("AckExtension: server sent ack id",_109f);}}}return _10a2;};this.outgoing=function(_10a4){var _10a5=_10a4.channel;if(_10a5=="/meta/handshake"){if(!_10a4.ext){_10a4.ext={};}_10a4.ext.ack=_109d&&_109d.ackEnabled!==false;_109f=-1;}else{if(_109e&&_10a5=="/meta/connect"){if(!_10a4.ext){_10a4.ext={};}_10a4.ext.ack=_109f;_10a0("AckExtension: client sending ack id",_109f);}}return _10a4;};};};if(typeof define==="function"&&define.amd){define("org/cometd/AckExtension",["org/cometd"],bind);}else{bind(org.cometd);}})();},"cb/SecureStorage":function(){define(["dojo/on","dojo/json","dojo/_base/array","cb/ext/sjcl","cb/util","./SafeLocalStorage"],function(on,json,arr,sjcl,util,_10a6){function _10a7(_10a8){return function(s){return sjcl.encrypt(_10a8,s);};};function _10a9(_10aa){return function(s){return sjcl.decrypt(_10aa,s);};};function _10ab(_10ac){var hmac=new sjcl.misc.hmac(_10ac);return function(s){return sjcl.codec.hex.fromBits(hmac.encrypt(s));};};return function SecureStorage(_10ad){var _10ae=new _10a6(_10ad.storage),_10af=_10a7(_10ad.secret),_10b0=_10a9(_10ad.secret),hash=_10ab(_10ad.secret),_10b1=_10ad.storeName||"default",_10b2=hash(_10ad.secret),_10b3=new RegExp("^secure:"+util.regExpEscape(_10b1)+":"+util.regExpEscape(_10b2)+":"+".*$"),_10b4="secure:"+_10b1+":"+_10b2+":",dirty=true,_10b5=_10ad.callback,self=this;_10ae.setItem(_10b4+":id",_10b2);function _10b6(_10b7){return _10b7===_10ad.storage||(_10b7&&new _10a6(_10b7).getItem(_10b4+":id")===_10b2);};if(!_10ae||!_10af||!_10b0){throw "provide storage object, encrypt and decrypt methods";}function _10b8(k){return _10b4+hash(k);};function _10b9(k){return _10b3.test(k);};function _10ba(_10bb){if(_10bb===null||_10bb===""){return null;}var _10bc=json.parse(_10b0(_10bb),true);return _10bc;};function _10bd(){var _10be=0;var index=_10ae.length();while(index--){if(_10b9(_10ae.key(index))){_10be++;}}self.length=_10be;dirty=false;};this.getLength=function getLength(){if(dirty){_10bd();}return this.length;};this.key=function(n){var index=0,max=_10ae.length(),curr=0;while(index<max){if(_10b9(_10ae.key(index))){curr++;}if(curr===n){return _10ba(_10ae.getItem(_10ae.key(index))).key;}}return null;};this.removeItem=function removeItem(key){if(key===null){return;}var k=_10b8(key);_10ae.remove(k);dirty=true;return;};this.getObj=this.getItem=function getObj(key){if(key===null){return null;}var k=_10b8(key);var vObj=_10ba(_10ae.getItem(k));return vObj===null?null:vObj.v;};this.setObj=this.setItem=function setObj(key,value){if(key===null){return undefined;}var k=_10b8(key);var vObj={key:key,v:value};var v=_10af(json.stringify(vObj));_10ae.setItem(k,v);return undefined;};this.clear=function clear(){var index=_10ae.length(),_10bf=[];while(index--){if(_10b9(_10ae.key(index))){_10bf.push(_10ae.key(index));}}arr.forEach(_10bf,function(key){_10ae.remove(key);});dirty=true;return undefined;};if(_10b5){on(window,"storage",function(ev){if(_10b6(ev.storageArea)&&_10b9(ev.key)){var _10c0=_10ba(ev.oldValue);var _10c1=_10ba(ev.newValue);_10b5({key:_10c1.key,oldValue:_10c0.v,newValue:_10c1.v,url:ev.url});}});}};});},"cb/SafeLocalStorage":function(){define([],function(){return function(_10c2){this.originalStorage=_10c2;this.setItem=function setItem(key,data){try{_10c2.setItem(key,data);return true;}catch(e){if(this.removeItem(key)){try{_10c2.setItem(key,data);return true;}catch(e2){}}}return false;};this.getItem=function getItem(key){try{return _10c2.getItem(key);}catch(e){}return null;};this.clear=function clear(){try{_10c2.clear();return true;}catch(e){}return false;};this.removeItem=function removeItem(key){try{_10c2.removeItem(key);return true;}catch(e){}return false;};this.length=function length(){try{return _10c2.length;}catch(e){}return 0;};this.key=function key(index){try{return _10c2.key(index);}catch(e){}return "";};};});},"wp/data/item/BaseImageItem":function(){define("wp/data/item/BaseImageItem",["dijit","dojo","dojox","dojo/require!wp/data/Item,cb/common/ImageLoaderQueue,dojox/gfx"],function(dijit,dojo,dojox){dojo.provide("wp.data.item.BaseImageItem");dojo.require("wp.data.Item");dojo.require("cb.common.ImageLoaderQueue");dojo.require("dojox.gfx");dojo.declare("wp.data.item.BaseImageItem",wp.data.Item,{constructor:function(map,_10c3){this.type="baseimage";this.imgPrefix=_10c3;if(!this.origSize){this.origSize={w:Math.abs(this.b.x-this.a.x),h:Math.abs(this.b.y-this.a.y)};}},draw:function(group){if(this.del){return;}var _10c4=this.ls.toLowerCase()!="none"?this.lw:"0";var _10c5=this.ls.toLowerCase()!="none"?this.ls:"solid";var _10c6=this.ls.toLowerCase()!="none"?this.lo:"0";var _10c7=wp.common.ColorHelper.convertHexAndPercentToDojoColor(this.lc,_10c6);var _10c8={color:_10c7,width:_10c4,style:_10c5,cap:"butt",join:"miter"};var x;var y;var w;var h;if(this.a&&this.b){x=Math.min(this.a.x,this.b.x);y=Math.min(this.a.y,this.b.y);w=Math.abs(this.a.x-this.b.x);h=Math.abs(this.a.y-this.b.y);}var _10c9=x;var _10ca=y;var _10cb=w;var _10cc=h;var _10cd;var _10ce=window.setTimeout(dojo.hitch(this,function(){_10cd=group.createGroup();if(!_10cd){return;}var _10cf=_10cd.createRect({x:_10c9,y:_10ca,width:_10cb,height:_10cc,r:0}).setFill("#f4f4f4").setStroke({color:"#dddddd",width:1,style:"solid"});this.rotateShapeIfNeeded(_10cf,_10c9,_10ca,_10cb,_10cc);var _10d0=Math.min(_10cb,_10cc);var _10d1=_10d0>160?128:(_10d0>80?64:(_10d0>40?32:16));var _10d2="/_/images/ajax-loader-image_"+_10d1+".gif";var _10d3=dojox.gfx.matrix.multiplyPoint(dojox.gfx.matrix.invert(group.getTransform()),_10d1,0).x;_10cd.createImage({x:_10c9+(_10cb/2)-(_10d3/2),y:_10ca+(_10cc/2)-(_10d3/2),width:_10d3,height:_10d3,src:_10d2});}),500);cb.common.ImageLoaderQueue.waitForImageLoad(this.getImageUrl(),dojo.hitch(this,function(){window.clearTimeout(_10ce);if(_10cd){group.remove(_10cd);try{_10cd.destroy(true);}catch(e){}}var image=group.createImage({x:_10c9,y:_10ca,width:_10cb,height:_10cc,src:this.getImageUrl()});if(!image){return;}this.clipShapeIfNeeded(image,_10c9,_10ca,_10cb,_10cc);this.rotateShapeIfNeeded(image,_10c9,_10ca,_10cb,_10cc);var _10d4=image.getEventSource();if(_10d4){if(this.title){_10d4.setAttribute("title",this.title);}_10d4.removeAttribute("fill");}this.onObjectDrawn(image,group);}));},rotateShapeIfNeeded:function(shape,_10d5,_10d6,_10d7,_10d8){if(this.rotate){var _10d9=this.getFixedRotateDegree();if(_10d9>0){var _10da={x:_10d5+_10d7/2,y:_10d6+_10d8/2};shape.applyTransform(dojox.gfx.matrix.rotategAt(_10d9,_10da.x,_10da.y));}}},clipShapeIfNeeded:function(shape,_10db,_10dc,_10dd,_10de){if(this.clip){var _10df={x:_10db+Math.round(_10dd*this.clip.x1),y:_10dc+Math.round(_10de*this.clip.y1),width:Math.round(_10dd*(this.clip.x2-this.clip.x1)),height:Math.round(_10de*(this.clip.y2-this.clip.y1))};shape.setClip(_10df);}},onObjectDrawn:function(_10e0,group){},json:function(){return {"type":this.type,"del":this.del,"id":this.id,"seq":this.seq,"z":this.z,"lc":this.lc,"lo":this.lo,"lw":this.lw,"ls":this.ls,"src":this.src,"dims":this.dims,"a":this.a,"b":this.b,"clip":this.clip,"authorid":this.authorid,"origAuthorid":this.origAuthorid,"origSeq":this.origSeq,"origDte":this.origDte,"dte":this.dte,"title":this.title,"outline":this.outline,"orderingKey":this.orderingKey,"origSize":this.origSize,"rotate":this.rotate};}});});},"wp/widget/BorderContainer":function(){define("wp/widget/BorderContainer",["dijit","dojo","dojox","dojo/require!dijit/layout/BorderContainer"],function(dijit,dojo,dojox){dojo.provide("wp.widget.BorderContainer");dojo.provide("wp.widget._Splitter");dojo.require("dijit.layout.BorderContainer");dojo.declare("wp.widget.BorderContainer",dijit.layout.BorderContainer,{_splitterClass:"wp.widget._Splitter",orientation:"horizontal",gutters:false,design:"sidebar",liveSplitters:true,_setupChild:function(_10e1){this.inherited("_setupChild",arguments);if(_10e1.setup){_10e1.setup();}}});dojo.declare("wp.widget._Splitter",dijit.layout._Splitter,{_computeMaxSize:function(){return dijit.getViewport().w-580;}});});},"dojo/dnd/Container":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/kernel","../_base/lang","../_base/window","../dom","../dom-class","../dom-construct","../Evented","../has","../on","../query","../ready","../touch","./common"],function(array,_10e2,event,_10e3,lang,win,dom,_10e4,_10e5,_10e6,has,on,query,ready,touch,dnd){var _10e7=_10e2("dojo.dnd.Container",_10e6,{skipForm:false,allowNested:false,constructor:function(node,_10e8){this.node=dom.byId(node);if(!_10e8){_10e8={};}this.creator=_10e8.creator||null;this.skipForm=_10e8.skipForm;this.parent=_10e8.dropParent&&dom.byId(_10e8.dropParent);this.map={};this.current=null;this.containerState="";_10e4.add(this.node,"dojoDndContainer");if(!(_10e8&&_10e8._skipStartup)){this.startup();}this.events=[on(this.node,touch.over,lang.hitch(this,"onMouseOver")),on(this.node,touch.out,lang.hitch(this,"onMouseOut")),on(this.node,"dragstart",lang.hitch(this,"onSelectStart")),on(this.node,"selectstart",lang.hitch(this,"onSelectStart"))];},creator:function(){},getItem:function(key){return this.map[key];},setItem:function(key,data){this.map[key]=data;},delItem:function(key){delete this.map[key];},forInItems:function(f,o){o=o||_10e3.global;var m=this.map,e=dnd._empty;for(var i in m){if(i in e){continue;}f.call(o,m[i],i,this);}return o;},clearItems:function(){this.map={};},getAllNodes:function(){return query((this.allowNested?"":"> ")+".dojoDndItem",this.parent);},sync:function(){var map={};this.getAllNodes().forEach(function(node){if(node.id){var item=this.getItem(node.id);if(item){map[node.id]=item;return;}}else{node.id=dnd.getUniqueId();}var type=node.getAttribute("dndType"),data=node.getAttribute("dndData");map[node.id]={data:data||node.innerHTML,type:type?type.split(/\s*,\s*/):["text"]};},this);this.map=map;return this;},insertNodes:function(data,_10e9,_10ea){if(!this.parent.firstChild){_10ea=null;}else{if(_10e9){if(!_10ea){_10ea=this.parent.firstChild;}}else{if(_10ea){_10ea=_10ea.nextSibling;}}}var i,t;if(_10ea){for(i=0;i<data.length;++i){t=this._normalizedCreator(data[i]);this.setItem(t.node.id,{data:t.data,type:t.type});_10ea.parentNode.insertBefore(t.node,_10ea);}}else{for(i=0;i<data.length;++i){t=this._normalizedCreator(data[i]);this.setItem(t.node.id,{data:t.data,type:t.type});this.parent.appendChild(t.node);}}return this;},destroy:function(){array.forEach(this.events,function(_10eb){_10eb.remove();});this.clearItems();this.node=this.parent=this.current=null;},markupFactory:function(_10ec,node,Ctor){_10ec._skipStartup=true;return new Ctor(node,_10ec);},startup:function(){if(!this.parent){this.parent=this.node;if(this.parent.tagName.toLowerCase()=="table"){var c=this.parent.getElementsByTagName("tbody");if(c&&c.length){this.parent=c[0];}}}this.defaultCreator=dnd._defaultCreator(this.parent);this.sync();},onMouseOver:function(e){var n=e.relatedTarget;while(n){if(n==this.node){break;}try{n=n.parentNode;}catch(x){n=null;}}if(!n){this._changeState("Container","Over");this.onOverEvent();}n=this._getChildByEvent(e);if(this.current==n){return;}if(this.current){this._removeItemClass(this.current,"Over");}if(n){this._addItemClass(n,"Over");}this.current=n;},onMouseOut:function(e){for(var n=e.relatedTarget;n;){if(n==this.node){return;}try{n=n.parentNode;}catch(x){n=null;}}if(this.current){this._removeItemClass(this.current,"Over");this.current=null;}this._changeState("Container","");this.onOutEvent();},onSelectStart:function(e){if(!this.skipForm||!dnd.isFormElement(e)){event.stop(e);}},onOverEvent:function(){},onOutEvent:function(){},_changeState:function(type,_10ed){var _10ee="dojoDnd"+type;var state=type.toLowerCase()+"State";_10e4.replace(this.node,_10ee+_10ed,_10ee+this[state]);this[state]=_10ed;},_addItemClass:function(node,type){_10e4.add(node,"dojoDndItem"+type);},_removeItemClass:function(node,type){_10e4.remove(node,"dojoDndItem"+type);},_getChildByEvent:function(e){var node=e.target;if(node){for(var _10ef=node.parentNode;_10ef;node=_10ef,_10ef=node.parentNode){if((_10ef==this.parent||this.allowNested)&&_10e4.contains(node,"dojoDndItem")){return node;}}}return null;},_normalizedCreator:function(item,hint){var t=(this.creator||this.defaultCreator).call(this,item,hint);if(!lang.isArray(t.type)){t.type=["text"];}if(!t.node.id){t.node.id=dnd.getUniqueId();}_10e4.add(t.node,"dojoDndItem");return t;}});dnd._createNode=function(tag){if(!tag){return dnd._createSpan;}return function(text){return _10e5.create(tag,{innerHTML:text});};};dnd._createTrTd=function(text){var tr=_10e5.create("tr");_10e5.create("td",{innerHTML:text},tr);return tr;};dnd._createSpan=function(text){return _10e5.create("span",{innerHTML:text});};dnd._defaultCreatorNodes={ul:"li",ol:"li",div:"div",p:"div"};dnd._defaultCreator=function(node){var tag=node.tagName.toLowerCase();var c=tag=="tbody"||tag=="thead"?dnd._createTrTd:dnd._createNode(dnd._defaultCreatorNodes[tag]);return function(item,hint){var isObj=item&&lang.isObject(item),data,type,n;if(isObj&&item.tagName&&item.nodeType&&item.getAttribute){data=item.getAttribute("dndData")||item.innerHTML;type=item.getAttribute("dndType");type=type?type.split(/\s*,\s*/):["text"];n=item;}else{data=(isObj&&item.data)?item.data:item;type=(isObj&&item.type)?item.type:["text"];n=(hint=="avatar"?dnd._createSpan:c)(String(data));}if(!n.id){n.id=dnd.getUniqueId();}return {node:n,data:data,type:type};};};return _10e7;});},"wp/surface/SurfaceUserMouseCursorAddOn":function(){define("wp/surface/SurfaceUserMouseCursorAddOn",["dijit","dojo","dojox","dojo/i18n!wp/surface/nls/SurfaceUserMouseCursorAddOn","dojo/require!dojox/lang/functional,sp/infos/InfoManager,sp/I18n,cb/page/pad/UserColorTracker"],function(dijit,dojo,dojox){dojo.provide("wp.surface.SurfaceUserMouseCursorAddOn");dojo.require("dojox.lang.functional");dojo.require("sp.infos.InfoManager");dojo.require("sp.I18n");dojo.require("cb.page.pad.UserColorTracker");dojo.requireLocalization("wp.surface","SurfaceUserMouseCursorAddOn");dojo.declare("wp.surface.SurfaceUserMouseCursorAddOn",null,{_userCursors:null,_userViewports:null,constructor:function(){this._userCursors={};this._userViewports={};dojo.subscribe("/user/viewport/show",this,function(_10f0){if(_10f0.mousePos){this._addOrUpdateUserCursor(_10f0.id,_10f0.mousePos);}if(_10f0.id!=sp.info.user.id){this._addOrUpdateUserViewport(_10f0.id,_10f0.bbox);}});dojo.subscribe("/user/viewport/hide",this,function(_10f1){this._hideUserCursor(_10f1.id);this._hideUserViewport(_10f1.id);});dojo.subscribe("/user/viewport/hideallexcept",this,function(_10f2){dojox.lang.functional.forIn(dojox.lang.functional.keys(this._userCursors),function(id){if(id!=_10f2.id){this._hideUserCursor(id);}},this);dojo.forEach(dojox.lang.functional.keys(this._userViewports),function(id){if(id!=_10f2.id){this._hideUserViewport(id);}},this);});cb.page.pad.UserColorTracker.watch(dojo.hitch(this,function(id,_10f3,_10f4){this._updateUserColor(id,_10f4);}));},_updateUserColor:function(id,color){if(this._userCursors[id]!=null){dojo.query(".arrow",this._userCursors[id].node).style("borderColor",color);dojo.query(".arrowlabel",this._userCursors[id].node).style("color",color);}if(this._userViewports[id]!=null){new dojo.NodeList(this._userViewports[id].nodes).style("borderColor",color);}},_addOrUpdateUserCursor:function(id,_10f5){if(this._userCursors[id]==null){var node=dojo.create("span",{"class":"user-mouse-cursor"},this._surfaceUserCursors);if(id===sp.info.user.info.id){dojo.addClass(node,"user-mouse-cursor-self");}sp.infos.getInstance().getById({type:"user",id:id}).then(function(_10f6){var name=sp.I18n.esc(_10f6.user.displayname);var color=cb.page.pad.UserColorTracker.get(id);node.innerHTML="<span class=\"arrowlabel\" style=\"color:"+color+"\">"+name+"</span><span class=\"arrow arrow1\" style=\"border-color:"+color+"\"></span><span class=\"arrow arrow2\" style=\"border-color:"+color+"\"></span>";dojo.attr(node,"title",sp.I18n.get("wp.surface","SurfaceUserMouseCursorAddOn")("cursor_title",[name]));});this._userCursors[id]={node:node,lastMousePos:null};}if(this._userCursors[id].lastMousePos!=null){var lastX=this._userCursors[id].lastMousePos.x;var lastY=this._userCursors[id].lastMousePos.y;var distX=_10f5.x-lastX;var distY=_10f5.y-lastY;var anim=new dojo._Animation({curve:[0,1],rate:50,duration:300});dojo.connect(anim,"onAnimate",dojo.hitch(this,function(value){if(this._userCursors[id]&&this._userCursors[id].node){dojo.style(this._userCursors[id].node,{"left":((lastX+(distX*value))/100)+"em","top":((lastY+(distY*value))/100)+"em"});}}));anim.play();}else{dojo.style(this._userCursors[id].node,{"left":(_10f5.x/100)+"em","top":(_10f5.y/100)+"em"});}this._userCursors[id].lastMousePos=_10f5;},_addOrUpdateUserViewport:function(id,bbox){if(this._userViewports[id]==null){var nodes=[dojo.create("span",{"class":"user-viewport top"},this._surfaceUserCursors),dojo.create("span",{"class":"user-viewport right"},this._surfaceUserCursors),dojo.create("span",{"class":"user-viewport bottom"},this._surfaceUserCursors),dojo.create("span",{"class":"user-viewport left"},this._surfaceUserCursors)];new dojo.NodeList(nodes).style("borderColor",cb.page.pad.UserColorTracker.get(id));this._userViewports[id]={nodes:nodes};}this._assignUserViewportBox(this._userViewports[id].nodes[0],bbox,"top");this._assignUserViewportBox(this._userViewports[id].nodes[1],bbox,"right");this._assignUserViewportBox(this._userViewports[id].nodes[2],bbox,"bottom");this._assignUserViewportBox(this._userViewports[id].nodes[3],bbox,"left");},_assignUserViewportBox:function(node,bbox,_10f7){var top,left,width,_10f8;switch(_10f7){case "top":top=bbox.p1.y/100;left=bbox.p1.x/100;width=bbox.getWidth()/100;_10f8=0;break;case "right":top=bbox.p1.y/100;left=bbox.p2.x/100;width=0;_10f8=bbox.getHeight()/100;break;case "bottom":top=bbox.p2.y/100;left=bbox.p1.x/100;width=bbox.getWidth()/100;_10f8=0;break;case "left":top=bbox.p1.y/100;left=bbox.p1.x/100;width=0;_10f8=bbox.getHeight()/100;break;default:return null;}dojo.style(node,{"top":top+"em","left":left+"em","width":width+"em","height":_10f8+"em"});},_hideUserCursor:function(id){if(this._userCursors[id]){dojo.destroy(this._userCursors[id].node);delete this._userCursors[id];}},_hideUserViewport:function(id){if(this._userViewports[id]){dojo.forEach(this._userViewports[id].nodes,function(n){dojo.destroy(n);});delete this._userViewports[id];}}});});},"wp/data/ContainerShapeAddOn":function(){define("wp/data/ContainerShapeAddOn",["dijit","dojo","dojox"],function(dijit,dojo,dojox){dojo.provide("wp.data.ContainerShapeAddOn");dojo.declare("wp.data.ContainerShapeAddOn",null,{constructor:function(){this._drawShapes={};this._previewShapes={};},getDrawShapes:function(){return this._drawShapes;},getDrawShape:function(id){return this._drawShapes[id];},setDrawShape:function(id,shape){this._drawShapes[id]=shape;if(shape===null){this.deleteDrawShape(id);}},deleteDrawShape:function(id){delete this._drawShapes[id];},getPreviewShapes:function(){return this._previewShapes;},getPreviewShape:function(id){return this._previewShapes[id];},setPreviewShape:function(id,shape){this._previewShapes[id]=shape;if(shape===null){this.deletePreviewShape(id);}},deletePreviewShape:function(id){delete this._previewShapes[id];}});});},"wp/widget/TemporaryDiv":function(){define("wp/widget/TemporaryDiv",["dijit","dojo","dojox"],function(dijit,dojo,dojox){dojo.provide("wp.widget.TemporaryDiv");dojo.declare("wp.widget.TemporaryDiv",[dijit._Widget],{constructor:function(){},_fixTouch:function(node){dojo.connect(node,"ontouchstart",function(event){event.isHandledByCb=true;});dojo.connect(node,"ontouchmove",function(event){event.isHandledByCb=true;});dojo.connect(node,"ontouchend",function(event){event.isHandledByCb=true;});},startup:function(_10f9,type,_10fa){this.controller=_10f9;this.inherited("startup",arguments);},showWidget:function(){dojo.removeClass(this.domNode,"hideBlock");},hideWidget:function(){dojo.addClass(this.domNode,"hideBlock");},markAsSelected:function(){},markAsUnselected:function(){},render:function(item){dojo.query(this.domNode).children().orphan();if(item.subtype==="rubberband"){this._positionNodeInEm(this.domNode,item.a,item.b);this.domNode.innerHTML="<div class=\"rubberband-outer\"><div class=\"rubberband-inner\"></div></div>";}else{if(item.subtype==="alignment"){if(item.pa&&item.pa.points){if(item.pa.points.length>1){this._positionNodeInEm(dojo.create("div",{"class":"alignment-line"},this.domNode),item.pa.points[0],item.pa.points[1]);}if(item.pa.points.length>3){this._positionNodeInEm(dojo.create("div",{"class":"alignment-line"},this.domNode),item.pa.points[2],item.pa.points[3]);}}}else{if(item.subtype==="slicearea"){if(item.ids&&item.ids.length>0){var _10fb=item.ids[0];var _10fc=new wp.BBox(item.a,item.b);var _10fd=this._positionNodeInEm(this.domNode,item.a,item.b);if(_10fd.height<=0.5){dojo.addClass(this.domNode,"slicearea--small");}var _10fe="duplicate image selection";var _10ff="<div class=\"slicearea-inner\" sid=\"__NOFLOW\"><span sid=\"__NOFLOW\"><button class=\"clean\"><i class=\"fonticon-scissors\" sid=\"__NOFLOW\"></i>&nbsp;"+_10fe+"</button></span></div>";var _1100="<div class=\"anim-b anim-b-left\" sid=\"__NOFLOW\"></div><div class=\"anim-b anim-b-top\" sid=\"__NOFLOW\"></div><div class=\"anim-b anim-b-right\" sid=\"__NOFLOW\"></div><div class=\"anim-b anim-b-bottom\" sid=\"__NOFLOW\"></div>";this.domNode.innerHTML="<div class=\"slicearea-outer\" sid=\"__NOFLOW\">"+_1100+_10ff+"</div>";this._fixTouch(this.domNode);this.own(dojo.connect(this.domNode,"click",this,function(event){if(event.target.tagName==="BUTTON"){this.controller.sliceImage(_10fb,_10fc);}else{this.controller._pad.container.abortPreview();}}));}}else{console.warn("Unknown temporary item: ",item);}}}},_positionNodeInEm:function(node,a,b){var x=Math.min(a.x,b.x)/100;var y=Math.min(a.y,b.y)/100;var w=Math.abs(a.x-b.x)/100;var h=Math.abs(a.y-b.y)/100;var _1101={position:"absolute",left:x+"em",top:y+"em",width:w+"em",height:h+"em",zIndex:99999999};dojo.style(node,_1101);return {left:x,top:y,width:w,height:h};},getDivHeight:function(){return 1;}});});},"wp/handler/workflow/SquareWorkflow":function(){define("wp/handler/workflow/SquareWorkflow",["dijit","dojo","dojox"],function(dijit,dojo,dojox){dojo.provide("wp.handler.workflow.SquareWorkflow");dojo.declare("wp.handler.workflow.SquareWorkflow",null,{constructor:function(pad){this.type="SQUARE";this._pad=pad;},localReset:function(){this.previewId=null;this.preventNormalProcessingButSelectIdOnEnd=null;},terminateWorkflow:function(){this._pad.drawer.resetCursorMode();return !!this.previewId;},startWorkflow:function(iCS){this.localReset();if(this._pad.controller.isSthInEdit()){this.preventNormalProcessingButSelectIdOnEnd=this._pad.controller.getTextGroupIdInEdit();}else{if(iCS.eventSID&&this._pad.container.getItemType(iCS.eventSID)==="txtG"&&iCS.currentTool.indexOf("TOOL_TEXT")===0){this.preventNormalProcessingButSelectIdOnEnd=iCS.eventSID;}else{this.previewId=this._pad.generateItemId();}}},processWorkflow:function(iCS,iCSOM){var _1102={x:iCS.positionX,y:iCS.positionY};var _1103={x:iCSOM.positionX,y:iCSOM.positionY};if(!this.preventNormalProcessingButSelectIdOnEnd&&this._processingNeeded(iCS,_1102,_1103)){var tool=this._pad.controller.getCurrentTool();var props=this._pad.controller.getPreviewPropsByTool(tool);var item=this._pad.factory.getNewItem(props.type,props);item.id=this.previewId;item.a=_1102;item.b=_1103;this._processFixAlignmentIfNeeded(props,item);this._processFixedHeightIfNeeded(props,item);this._processMinWidthIfNeeded(props,item);this._pad.controller.previewNewItems([item]);}},endWorkflow:function(iCS,iCSOM){var _1104={x:iCS.positionX,y:iCS.positionY};var _1105={x:iCSOM.positionX,y:iCSOM.positionY};if(this.preventNormalProcessingButSelectIdOnEnd||!this._processingNeeded(iCS,_1104,_1105)){if(this.preventNormalProcessingButSelectIdOnEnd){this._pad.controller.selectItemsByIds([this.preventNormalProcessingButSelectIdOnEnd]);}else{this._pad.container.abortPreview();}this.localReset();this.terminateWorkflow();return;}var tool=this._pad.controller.getCurrentTool();var _1106=this._pad.controller.getFinalPropArrayByTool(tool);var _1107=[];var _1108=null;var _1109=this._pad.generateItemId();for(var i=0;i<_1106.length;i++){var props=_1106[i];var _110a=props.defaultWidth?props.defaultWidth:100;var item=this._pad.factory.getNewItem(props.type,props);if(_1106.length===1){item.id=this.previewId;item.a=_1104;item.b=_1105;}else{if(i===0){item.id=this.previewId;item.a=_1104;item.b=_1105;item.conn=[{"id":_1109,"att":"source"}];item.previewTransformMode="SOURCE";}else{if(i===1){item.id=_1109;item.a={x:_1105.x-3,y:_1105.y-3};item.b={x:_1105.x-3+_110a*1,y:_1105.y+5};if(_1104.x>_1105.x){item.a.x=item.a.x-_110a*1-2;item.b.x=item.b.x-_110a*1-2;}}}}this._processFixedHeightIfNeeded(props,item);this._processMinWidthIfNeeded(props,item);this._processFixAlignmentIfNeeded(props,item);this._processFixTxtGFlippingBeforeSaveIfNeeded(item);if(item.outline){item.orderingKey=dijit.byId("sidebar-widget-outline").newOrderingKeyAtEnd();}if(item.type=="txtG"){_1108=item.id;}_1107.push(item);}if(_1108){this._pad.controller.saveNewItemsAndEditByTextGroupId(_1107,_1108);}else{if(iCS.currentToolConfig.onDrawEndDoSelect){this._pad.controller.saveAndSelectNewItems(_1107);}else{this._pad.controller.saveNewItems(_1107);}}this.localReset();this.terminateWorkflow();},_processingNeeded:function(iCS,a,b){if(iCS.currentToolConfig&&iCS.currentToolConfig.onClickNOP&&this._pointDistanceEqualsClick(a,b)){return false;}else{return true;}},_pointDistanceEqualsClick:function(a,b){if(!a||!b){return true;}else{return Math.sqrt(Math.pow(a.x-b.x,2)+Math.pow(a.y-b.y,2))<16;}},_processFixTxtGFlippingBeforeSaveIfNeeded:function(item){if(item.type=="txtG"){var box=new wp.BBox(item.a,item.b);item.a=box.p1;item.b=box.p2;}},_processFixAlignmentIfNeeded:function(props,item){if(props.fixAlignment){var _110b=wp.common.MathsHelper.fixSingleAlignment([item.a,item.b]);if(_110b){item.a=_110b[0];item.b=_110b[1];}}},_processFixedHeightIfNeeded:function(props,item){if(props.fixedHeight){if(item.a.y<=item.b.y){item.b.y=item.a.y+props.fixedHeight*1;}else{item.b.y=item.a.y-props.fixedHeight*1;}}},_processMinWidthIfNeeded:function(props,item){if(props.minWidth&&Math.abs(item.b.x-item.a.x)<props.minWidth*1){if(item.a.x<=item.b.x){item.b.x=item.a.x+props.minWidth*1;}else{item.b.x=item.a.x-props.minWidth*1;}}}});});},"wp/handler/workflow/PanWorkflow":function(){define("wp/handler/workflow/PanWorkflow",["dijit","dojo","dojox"],function(dijit,dojo,dojox){dojo.provide("wp.handler.workflow.PanWorkflow");dojo.declare("wp.handler.workflow.PanWorkflow",null,{constructor:function(pad){this.type="PAN";this._pad=pad;},localReset:function(){this._scrollStraightXOn=sp.isTouchOnly;this._scrollStraightXCounter=0;this._scrollStraightXTreshold=75;},terminateWorkflow:function(){this._pad.drawer.resetCursorMode();return false;},startWorkflow:function(iCS){this.localReset();this._pad.controller.selectItemsByIds([]);this._pad.drawer.overwriteCursorMode("cur_hand_2");},processWorkflow:function(iCS,iCSOM){var diffX=iCSOM.screenPositionX-iCSOM.lastScreenPositionX;var diffY=iCSOM.screenPositionY-iCSOM.lastScreenPositionY;this.scrollStraightBy(diffX,diffY);},endWorkflow:function(iCS,iCSOM){if(iCS.spaceKey){dojo.publish("updates/cb/board/currentscroll/viaspacepan");}var diffX=iCSOM.screenPositionX-iCSOM.lastScreenPositionX;var diffY=iCSOM.screenPositionY-iCSOM.lastScreenPositionY;this.scrollStraightBy(diffX,diffY);this.localReset();this.terminateWorkflow();},scrollStraightBy:function(diffX,diffY){if(this._scrollStraightXOn){this._scrollStraightXCounter+=diffX;if(Math.abs(this._scrollStraightXCounter)<this._scrollStraightXTreshold){this._pad.surface.scrollBy(0,diffY,true);}else{this._pad.surface.scrollBy(this._scrollStraightXCounter,diffY,true);this._scrollStraightXOn=false;}}else{this._pad.surface.scrollBy(diffX,diffY,true);}}});});},"url:cb/widget/BoardCheatSheetDialog.html":"<div class=\"margin\">\r\n    <div class=\"headline\">\r\n        <div class=\"button-line\">\r\n            <div data-dojo-attach-point=\"_dontShowAgainContainer\">\r\n                <input type=\"checkbox\" id=\"do-not-show-again\" data-dojo-attach-point='_dontShowAgainBox' data-dojo-attach-event=\"change:_handleDontShowAgainChange\"/>\r\n                <label for=\"do-not-show-again\">${!i18n.do_not_show_again}</label>\r\n            </div>\r\n            <span class=\"button single-color\" data-dojo-attach-event=\"click:_handleCloseButtonClick\"><i class=\"fonticon-cross\"></i></span>\r\n        </div>\r\n        ${!i18n.dialog_title}\r\n    </div>\r\n\r\n    <div class=\"browser-wrapper\">\r\n        <div class=\"browser-chrome wrap-with-browser\" data-dojo-attach-point=\"_browserHoverTrigger\">\r\n            <img src=\"/_/images/cheat-sheet-content.png\" class=\"full-board-ui\" height=\"430px\" width=\"700px\"/>\r\n        </div>\r\n    \r\n        <div class=\"action-layer\" id=\"actionLayer\">\r\n            <div class=\"pointers\">\r\n                <div class=\"pointer minimap\" id=\"pointerMinimap\">\r\n                    <span class=\"number\">4</span>\r\n                    <div class=\"zoom-shot\">\r\n                        <img src=\"/_/images/feature_full-board-ui_content_zoom-minimap.png\"/>\r\n                    </div>\r\n                    <div class=\"tooltip\"><strong>${!i18n.feature_navigation_title}</strong><p>${!i18n.feature_navigation_text}</p></div>\r\n                </div>\r\n                <div class=\"pointer integration\">\r\n                    <span class=\"number\">1</span>\r\n                    <div class=\"zoom-shot\">\r\n                        <img src=\"/_/images/feature_full-board-ui_content_zoom-start.png\"/>\r\n                    </div>\r\n                    <div class=\"tooltip bottom\"><strong>${!i18n.feature_integration_title}</strong><p>${!i18n.feature_integration_text}</p></div>\r\n                </div>\r\n                <div class=\"pointer annotate\">\r\n                    <span class=\"number\">2</span>\r\n                    <div class=\"zoom-shot\">\r\n                        <img src=\"/_/images/feature_full-board-ui_content_zoom-tools.png\"/>\r\n                    </div>\r\n                    <div class=\"tooltip bottom\"><strong>${!i18n.feature_tools_title}</strong><p>${!i18n.feature_tools_text}</p></div>\r\n                </div>\r\n                <div class=\"pointer share\">\r\n                    <span class=\"number\">3</span>\r\n                    <div class=\"zoom-shot\">\r\n                        <img src=\"/_/images/feature_full-board-ui_content_zoom-share.png\"/>\r\n                    </div>\r\n                    <div class=\"tooltip bottom\"><strong>${!i18n.feature_participants_title}</strong><p>${!i18n.feature_participants_text}</p></div>\r\n                </div>\r\n                <div class=\"pointer simplified-timeline\">\r\n                    <span class=\"number\">7</span>\r\n                    <div class=\"zoom-shot\">\r\n                        <img src=\"/_/images/feature_full-board-ui_content_zoom-simplifiedtimeline.png\"/>\r\n                    </div>\r\n                    <div class=\"tooltip\"><strong>${!i18n.feature_notifications_title}</strong><p>${!i18n.feature_notifications_text}</p></div>\r\n                </div>\r\n                <div class=\"pointer tasks\">\r\n                    <span class=\"number\">6</span>\r\n                    <div class=\"zoom-shot\">\r\n                        <img src=\"/_/images/feature_full-board-ui_content_zoom-tasks.png\"/>\r\n                    </div>\r\n                    <div class=\"tooltip\"><strong>${!i18n.feature_tasks_title}</strong><p>${!i18n.feature_tasks_text}</p></div>\r\n                </div>\r\n                 <div class=\"pointer video\">\r\n                    <span class=\"number\">5</span>\r\n                    <div class=\"zoom-shot\">\r\n                        <img src=\"/_/images/feature_full-board-ui_content_zoom-video.png\"/>\r\n                    </div>\r\n                    <div class=\"tooltip\"><strong>${!i18n.feature_conference_title}</strong><p>${!i18n.feature_conference_text}</p></div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        \r\n    </div>\r\n</div>","wp/widget/TaskStatusDialog":function(){define("wp/widget/TaskStatusDialog",["dijit","dojo","dojox","dojo/i18n!wp/widget/nls/TaskStatusDialog","dojo/require!sp/dialog/TooltipDialog,sp/I18n"],function(dijit,dojo,dojox){dojo.provide("wp.widget.TaskStatusDialog");dojo.require("sp.dialog.TooltipDialog");dojo.require("sp.I18n");dojo.requireLocalization("wp.widget","TaskStatusDialog");dojo.declare("wp.widget.TaskStatusDialog",[sp.dialog.TooltipDialog],{baseClass:"task-status-dialog",controller:null,complexOrient:["below","above"],itemId:null,constructor:function(_110c){},postCreate:function(){this.inherited(arguments);this.content=new sp.dialog.DialogContent({templateString:"<div class=\"dialog-content\">\r\n    <ul dojoAttachPoint=\"taskstatusLink\" class=\"task-status\">\r\n        <li data-dojo-attach-point=\"_taskCreate\" spStatusKey=\"open\" class=\"button call-to-action full-width\" ><i class=\"fonticon-task-round-open\"></i> ${!i18n.status_link_open}</li>\r\n        <li data-dojo-attach-point=\"_taskDone\"   spStatusKey=\"closed\" class=\"button confirm full-width\"><i class=\"fonticon-task-round-done\"></i> ${!i18n.status_link_closed}</li>\r\n        <li data-dojo-attach-point=\"_taskAssign\" spStatusKey=\"assign\" class=\"link\">${!i18n.status_link_assign}</li>\r\n        <li data-dojo-attach-point=\"_taskRemove\" spStatusKey=\"none\" class=\"link remove\">${!i18n.status_link_remove}</li>\r\n        <li data-dojo-attach-point=\"_reopenHint\" class=\"small light\">${!i18n.reopen_hint}</li>\r\n        <li data-dojo-attach-point=\"_assignHint\" class=\"small light\">${!i18n.assign_hint}</li>\r\n    </ul>\r\n</div>",dialog:this,i18n:sp.I18n.bundle("wp.widget","TaskStatusDialog")});var _110d=sp.global.pad.container.getItem(this.itemId);if(_110d.taskStatus==="open"||_110d.taskStatus==="onhold"){dojo.destroy(this.content._taskCreate);dojo.destroy(this.content._reopenHint);dojo.destroy(this.content._assignHint);}else{if(_110d.taskStatus==="closed"){dojo.destroy(this.content._taskCreate);dojo.destroy(this.content._taskDone);dojo.destroy(this.content._taskAssign);dojo.destroy(this.content._taskRemove);dojo.destroy(this.content._assignHint);}else{dojo.destroy(this.content._taskDone);dojo.destroy(this.content._taskAssign);dojo.destroy(this.content._taskRemove);dojo.destroy(this.content._reopenHint);}}dojo.connect(this.content.taskstatusLink,"click",this,function(event){var node=event.target;if(node){var _110e=dojo.attr(node,"spStatusKey")||dojo.attr(node.parentNode,"spStatusKey");if(_110e){if(_110e==="assign"){this.controller.editItemAndOpenAtMentionByTextGroupId(this.itemId);}else{this.controller.changeTextGroupTaskstatus(_110e,this.itemId);}}}this.hide();});},createAndConnectCloseHandler:function(){this.closeSubscriptions=[dojo.subscribe("/sp/pad/controller/mousedown",this,function(args){this.hide();}),dojo.subscribe("/sp/pad/propbar/mousedown",this,function(args){this.hide();})];},hide:function(){this.inherited("hide",arguments);if(this.closeSubscriptions){for(var i=0;i<this.closeSubscriptions.length;i++){dojo.unsubscribe(this.closeSubscriptions[i]);}}}});});},"wp/handler/ControllerCommandAddOn":function(){define("wp/handler/ControllerCommandAddOn",["dijit","dojo","dojox"],function(dijit,dojo,dojox){dojo.provide("wp.handler.ControllerCommandAddOn");dojo.declare("wp.handler.ControllerCommandAddOn",null,{selectItemsByIds:function(_110f){this._pad.container.newPreviewByIds(_110f,true,true);this._smoothScrollToCurrentPreviewIfNeeded();return true;},selectAdditionalItemsByIds:function(_1110){this._pad.container.newPreviewByAdditionalIds(_1110,true);this._smoothScrollToCurrentPreviewIfNeeded();return true;},unselectSingleItemById:function(id){this._pad.container.newPreviewBySubstractedSingleId(id,true);return true;},editItemByTextGroupId:function(_1111){this._chooseCorrectEditToolAndChangeModeIfNeeded(_1111);this._setNewTextEditConfig(_1111);this._pad.container.newPreviewByIds([_1111],true,true);this._smoothScrollToItemForTextEditAsync(_1111);return true;},editItemAndOpenAtMentionByTextGroupId:function(_1112){this._chooseCorrectEditToolAndChangeModeIfNeeded(_1112);this._setNewTextEditConfig(_1112,null,true);this._pad.container.newPreviewByIds([_1112],true,true);this._smoothScrollToItemForTextEditAsync(_1112);return true;},editItemByTextEntryId:function(_1113){var _1114=this._pad.container.getItem(_1113);var _1115=_1114.txtGId;this._chooseCorrectEditToolAndChangeModeIfNeeded(_1115);this._setNewTextEditConfig(_1115,_1113);this._pad.container.newPreviewByIds([_1115],true,true);this._smoothScrollToItemForTextEditAsync(_1115);return true;},saveNewItems:function(_1116){this._pad.container.newPreview(_1116,false,false);this._pad.container.savePreview();return true;},saveAndSelectNewItems:function(_1117){this._pad.container.newPreview(_1117,true,false);this._pad.container.savePreview();return true;},saveNewItemsAndEditByTextGroupId:function(_1118,_1119){this._setNewTextEditConfig(_1119);this._pad.container.newPreview(_1118,true,true);this._pad.container.savePreview();this._smoothScrollToItemForTextEditAsync(_1119);return true;},previewNewItems:function(_111a){this._pad.container.newPreview(_111a,false,false);return true;},previewModifiedItemsByIds:function(_111b,key,value){this._pad.container.newPreviewByIds(_111b,false,false);this._pad.container.modifyPreview(key,value);return true;},saveModifiedItemsByIds:function(_111c,key,value){this._pad.container.newPreviewByIds(_111c,false,true);this._pad.container.modifyPreview(key,value);this._pad.container.savePreview();return true;},deleteItem:function(){if(this._pad.container.isSthSelected()){this.changeProperty("del",1);this._pad.container.savePreview();return true;}},undo:function(){if(this._pad.container.isUndoPossible()){this._pad.container.undo();return true;}},redo:function(){if(this._pad.container.isRedoPossible()){this._pad.container.redo();return true;}},copy:function(){if(this._pad.container.isSthSelected()){this._pad.container.copy();return true;}else{this._pad.container.clearClipboard();}},paste:function(){if(this._pad.container.isClipboardFilled()){this._pad.container.paste();return true;}},duplicate:function(){if(this._pad.container.isSthSelected()){this._pad.container.copy();this._pad.container.paste();return true;}},cut:function(){if(this._pad.container.isSthSelected()){this._pad.container.copy();this.deleteItem();return true;}},group:function(){if(this._pad.container.isMultipleSelected()){this._pad.container.groupPreview();this._pad.container.savePreview();return true;}},ungroup:function(){if(this._pad.container.getSingleSelectedGroupItemId()){this._pad.container.ungroupPreview();this._pad.container.savePreview();return true;}},moveItemAround:function(_111d,_111e){if(this._pad.container.isSthSelected()){var _111f={x:0,y:0};var _1120=this.lastShortCutMove={x:(_111d==="left"?-1*_111e:(_111d==="right"?_111e:0)),y:(_111d==="up"?-1*_111e:(_111d==="down"?_111e:0))};this._pad.container.saveTransformedPreview(_111f,_1120);return true;}},moveToFront:function(){if(this._pad.container.isSthSelected()){this.changeProperty("z","max");return true;}},moveToBack:function(){if(this._pad.container.isSthSelected()){this.changeProperty("z","min");return true;}},toggleOutlineEntry:function(){if(this._pad.container.isSthSelected()){dojo.publish("/sp/outline/toggle",[this._pad.container.getPreviewItems()]);return true;}},addToOutline:function(){if(this._pad.container.isSthSelected()){this.changeProperty("outline",true);this._pad.container.savePreview();return true;}},changeTextGroupTaskstatus:function(_1121,_1122){if(_1121&&_1122&&this._pad.container.containsItem(_1122)){var item=this._pad.container.getItemCopy(_1122);if(item.taskStatus!=_1121&&(_1121==="none"||_1121==="open"||_1121==="onhold"||_1121==="closed")){item.taskStatus=_1121;this._pad.container.addOrUpdateItems([item]);}}},toggleTextGroupCollapse:function(_1123){if(_1123&&this._pad.container.containsItem(_1123)){var item=this._pad.container.getItemCopy(_1123);item.collapse=!item.collapse;this._pad.container.addOrUpdateItems([item]);}},toggleFillOpacity:function(){var item=this._pad.container.getSingleSelectedItem();if(item){if(!item.fo||item.fo===0||item.fo==="0"){item.fo="100";}else{item.fo="0";}this._pad.container.addOrUpdateItems([item]);}},rotateImage:function(_1124){if(!this._pad.container.isSthSelected()||!this._pad.container.getCommonProperty({"image":"type"})){return;}var _1125=[];var _1126=this._pad.container.getPreviewItems();dojo.forEach(_1126,function(item){var _1127=(item.rotate?1*item.rotate:0)+1*_1124;if(_1127<0){_1127+=360;}else{if(_1127>=360){_1127-=360;}}if(_1127>=45&&_1127<135){_1127=90;}else{if(_1127>=135&&_1127<225){_1127=180;}else{if(_1127>=225&&_1127<315){_1127=270;}else{_1127=0;}}}_1125.push({key:"rotate",value:_1127,shapeId:item.id});},this);this.batchChangeProperties(_1125);return true;},resizeToOrig:function(){if(!this._pad.container.isSthSelected()){return;}var _1128=dojo.filter(this._pad.container.getPreviewItems(),function(item){return item.type==="image";});dojo.forEach(_1128,function(item){if(item.origSize){var _1129=Math.abs(item.b.x-item.a.x);var _112a=Math.abs(item.b.y-item.a.y);var _112b=item.origSize.w;var _112c=item.origSize.h;var _112d=_1129-_112b;var _112e=_112a-_112c;var a={x:Math.min(item.a.x,item.b.x),y:Math.min(item.a.y,item.b.y)};var newA={x:Math.round(a.x+_112d/2),y:Math.round(a.y+_112e/2)};var newB={x:newA.x+Math.round(item.origSize.w),y:newA.y+Math.round(item.origSize.h)};this.batchChangeProperties([{key:"a",value:newA,shapeId:item.id},{key:"b",value:newB,shapeId:item.id}]);}},this);return true;},sliceImage:function(_112f,_1130){if(this._pad.container.containsItem(_112f)){var _1131=this._pad.container.getItemCopy(_112f);var _1132=_1130.shrinkToIntersection(_1131.getBBox());var _1133=_1131.getUnclippedUnrotatedBBox();if(_1131.rotate){var _1134=_1131.getFixedRotateDegree();if(_1134!==0){_1132.rotate(_1134*-1,_1133.getCenter());}}var _1135={x1:Math.round(Math.abs(_1132.p1.x-_1133.p1.x))/_1133.getWidth(),y1:Math.round(Math.abs(_1132.p1.y-_1133.p1.y))/_1133.getHeight(),x2:1-(Math.round(Math.abs(_1132.p2.x-_1133.p2.x))/_1133.getWidth()),y2:1-(Math.round(Math.abs(_1132.p2.y-_1133.p2.y))/_1133.getHeight())};_1131.clip=_1135;_1131.id=this._pad.generateItemId();this.saveAndSelectNewItems([_1131]);}},insertStringAsDefaultStickyNote:function(str){var p=this._pad.surface.getPositionCenter();var _1136=this._pad.factory.getNewItem("txtG",this.getFinalPropArrayByTool("TOOL_TEXT_NOTE")[0]);_1136.id=this._pad.generateItemId();_1136.a={x:p.x-100,y:p.y-50};_1136.b={x:p.x+100,y:p.y+50};var item=this._pad.factory.getNewItem("txtE",{});item.id=this._pad.generateItemId();item.txtGId=_1136.id;item.subtype=_1136.subtype;item.text=str;this._pad.container.addOrUpdateItems([_1136,item]);},zoomIn:function(_1137,_1138,_1139){this._pad.surface.multiplyZoom(this._zoomInMultiplier,_1137,_1138,_1139);return true;},zoomOut:function(_113a,_113b,_113c){this._pad.surface.multiplyZoom(this._zoomOutMultiplier,_113a,_113b,_113c);return true;},zoom100:function(){this._pad.surface.setZoom(1);return true;},zoomSmoothly:function(_113d){this._pad.surface.smoothScrollToItemPos(this._pad.surface.getPositionCenter(),_113d);return true;},zoomSmoothlyToFit:function(){this._pad.surface.smoothScrollToBBox(this._pad.container.getBBox());return true;},_smoothScrollToItemForTextEditAsync:function(_113e){var self=this;cb.util.defer(function(){self._smoothScrollToItemForTextEdit(_113e);});},_smoothScrollToItemForTextEdit:function(id){var _113f=this._pad.container.getBBox(id);if(!_113f){return;}var _1140=new wp.BBox({x:_113f.p1.x-20,y:_113f.p1.y-20},{x:_113f.p2.x+100,y:_113f.p2.y+100});var _1141=0.75;var _1142=2;this._pad.surface.smoothScrollToBoxIfNeededWithZoomThresholds(_1140,_1141,_1142);},_smoothScrollToCurrentPreviewIfNeeded:function(){var _1143=this._pad.container.getPrevBBox();if(!_1143){return;}var _1144=new wp.BBox({x:_1143.p1.x-40,y:_1143.p1.y-40},{x:_1143.p2.x+40,y:_1143.p2.y+40});this._pad.surface.smoothScrollToBoxIfNeeded(_1144);},smoothScrollToItemPosition:function(x,y,_1145){if(_1145){this._pad.surface.smoothScrollToItemPos({x:x,y:y},_1145);}else{this._pad.surface.smoothScrollToItemPos({x:x,y:y},this._pad.surface.getZoomFactor());}},scrollToItemPosition:function(x,y){this._pad.surface.moveTo(x,y);}});});},"url:cb/videochat/VideoChatPanel.html":"<div class=\"video-chat-container\" data-dojo-attach-point=\"_containerNode\">\n    <span class=\"video-chat-toggle-button hideBlock\" data-dojo-attach-point=\"_videoToggleButton\" data-dojo-attach-event=\"click:_handleToggleButtonClick\">${!i18n.video_button_activate}</span>\n</div>","wp/widget/Minimap":function(){define("wp/widget/Minimap",["dijit","dojo","dojox","dojo/require!dojo/dnd/move,cb/WheelSupport,cb/page/pad/UserColorTracker,cb/board/navigation/ZoomStripWidget"],function(dijit,dojo,dojox){dojo.provide("wp.widget.Minimap");dojo.require("dojo.dnd.move");dojo.require("cb.WheelSupport");dojo.require("cb.page.pad.UserColorTracker");dojo.require("cb.board.navigation.ZoomStripWidget");dojo.declare("wp.widget.Minimap",[dijit._Widget,cb.widget._Templated],{templateString:"<div class=\"minimap-container minimized\"><div class=\"minimap\" data-dojo-attach-point=\"_minimap\"><div class=\"minimap-viewport\" data-dojo-attach-point=\"_minimapViewport\"><div class=\"minimap-surface\" data-dojo-attach-point=\"_minimapSurface\"></div></div></div></div>",_minimap:null,_minimapViewport:null,_minimapSurface:null,_controller:null,_currentScale:null,_currentLeft:null,_currentTop:null,_registeredOutlines:null,_registeredUserFrames:null,_registeredUserFrameBBoxes:null,_containerBBox:null,_minimapViewportWidth:null,_minimapViewportHeight:null,_moveable:null,constructor:function(_1146){this._controller=_1146.controller;this._currentScale=1;this._registeredOutlines={};this._registeredUserFrames={};this._registeredUserFrameBBoxes={};this._containerBBox=null;},postCreate:function(){this.inherited(arguments);this.subscribe("/user/viewport/show",function(_1147){this._addOrUpdateUserFrame(_1147.id,_1147.bbox);});this.subscribe("/user/viewport/hide",function(_1148){this._deleteUserFrame(_1148.id);});this.subscribe("/user/viewport/hideallexcept",function(_1149){dojox.lang.functional.forIn(dojox.lang.functional.keys(this._registeredUserFrames),function(id){if(id!=_1149.id){this._deleteUserFrame(id);}},this);});this.own(cb.page.pad.UserColorTracker.watch(dojo.hitch(this,function(_114a,_114b,_114c){this._updateUserColor(_114a,_114c);})));this._minimapViewportWidth=dojo.coords(this._minimapViewport).w;this._minimapViewportHeight=dojo.coords(this._minimapViewport).h;cb.WheelSupport.connectWidget(this,this._minimapViewport,dojo.hitch(this._controller,"simpleMouseWheelZoom"));this.connect(this._minimapViewport,"onclick",function(event){var _114d=dojo.coords(this._minimapViewport);var _114e={x:(event.clientX-1-_114d.x-this._currentLeft)/this._currentScale*100,y:(event.clientY-1-_114d.y-this._currentTop)/this._currentScale*100};var _114f=new wp.BBox({x:_114e.x-1000,y:_114e.y-1000},{x:_114e.x+1000,y:_114e.y+1000});if(_114f.collides(this._containerBBox)){this._controller.scrollToItemPosition(_114e.x,_114e.y);}});this._minimizer=dojo.create("div",{"class":"minimizer"},this.domNode,"last");this.connect(this._minimizer,"onclick",function(){if(dojo.hasClass(this.domNode,"minimized")){this.show();}else{this.hide();}});this._zoomStrip=new cb.board.navigation.ZoomStripWidget({horizontalLayout:true},dojo.create("div",{},this.domNode));},show:function(){dojo.removeClass(this.domNode,"minimized");dojo.addClass(dojo.body(),"minimap-visible");dojo.publish("/cb/board/panes/footer/layout");},hide:function(){dojo.addClass(this.domNode,"minimized");dojo.removeClass(dojo.body(),"minimap-visible");dojo.publish("/cb/board/panes/footer/layout");},refreshWithContainerBox:function(bbox){this._containerBBox=bbox?bbox.getACopy():null;this._adjustPositionAndScale();},addOrUpdateBox:function(id,bbox){if(this._registeredOutlines[id]){dojo.style(this._registeredOutlines[id],this._getStyleObjFromBBox(bbox));}else{this._registeredOutlines[id]=dojo.create("div",{style:this._getStyleObjFromBBox(bbox)},this._minimapSurface,"last");}},deleteBox:function(id){if(this._registeredOutlines[id]){dojo.destroy(this._registeredOutlines[id]);delete this._registeredOutlines[id];}},_addOrUpdateUserFrame:function(id,bbox){if(this._registeredUserFrames[id]){dojo.style(this._registeredUserFrames[id],this._getStyleObjFromBBox(bbox));dojo.style(this._registeredUserFrames[id],{borderColor:cb.page.pad.UserColorTracker.get(id)});if(id==sp.info.user.id){dojo.style(this._registeredUserFrames[id],{left:bbox.p1.x*this._currentScale/100+"px",top:bbox.p1.y*this._currentScale/100+"px"});}}else{this._registeredUserFrames[id]=dojo.create("span",{style:this._getStyleObjFromBBox(bbox)},this._minimapSurface,"last");dojo.style(this._registeredUserFrames[id],{borderColor:cb.page.pad.UserColorTracker.get(id)});if(id==sp.info.user.id){this._moveable=new dojo.dnd.move.constrainedMoveable(this._registeredUserFrames[id],{constraints:dojo.hitch(this,function(){return {l:-this._currentLeft-2,t:-this._currentTop-2,w:this._minimapViewportWidth+6,h:this._minimapViewportHeight+6};}),within:true});dojo.addClass(this._registeredUserFrames[id],"moveable");dojo.connect(this._moveable,"onMoveStop",this,function(){var _1150=dojo.coords(this._moveable.node);this._controller.scrollToItemPosition((_1150.l-1+_1150.w/2)/this._currentScale*100,(_1150.t-1+_1150.h/2)/this._currentScale*100);});dojo.connect(this._moveable.node,"onclick",this,function(event){event.cancelBubble=true;});}}this._registeredUserFrameBBoxes[id]=bbox.getACopy();this._adjustPositionAndScale();},_updateUserColor:function(id,color){if(this._registeredUserFrames[id]){dojo.style(this._registeredUserFrames[id],{borderColor:color});}},_deleteUserFrame:function(id){if(this._registeredUserFrames[id]&&id!=sp.info.user.id){dojo.destroy(this._registeredUserFrames[id]);delete this._registeredUserFrames[id];delete this._registeredUserFrameBBoxes[id];}},_getUserFramesBBox:function(){var bbox=new wp.BBox({x:-1000,y:-1000},{x:3000,y:2000});dojo.forEach(dojox.lang.functional.keys(this._registeredUserFrameBBoxes),function(id){if(bbox){bbox.expandByBBox(this._registeredUserFrameBBoxes[id]);}else{bbox=this._registeredUserFrameBBoxes[id].getACopy();}},this);return bbox;},_adjustPositionAndScale:function(){var bbox=this._getUserFramesBBox();if(this._containerBBox!==null){bbox.expandByBBox(this._containerBBox);}this._currentScale=Math.min(Math.min(this._minimapViewportWidth/bbox.getWidth()*100,this._minimapViewportHeight/bbox.getHeight()*100),100).toFixed(9)*1;this._currentLeft=(this._minimapViewportWidth/2)-(bbox.p1.x*this._currentScale/100)-(bbox.getWidth()*this._currentScale/200);this._currentTop=(this._minimapViewportHeight/2)-(bbox.p1.y*this._currentScale/100)-(bbox.getHeight()*this._currentScale/200);dojo.style(this._minimapSurface,{fontSize:this._currentScale+"px",left:this._currentLeft+"px",top:this._currentTop+"px"});},_getStyleObjFromBBox:function(bbox){return {"left":(bbox.p1.x/100)+"em","top":(bbox.p1.y/100)+"em","width":(bbox.getWidth()/100)+"em","height":(bbox.getHeight()/100)+"em"};}});});},"cb/page/pad/PadParticipantManager":function(){define(["dojo","cb/api","cb/user/ParticipantManager"],function(dojo,Api,_1151){var _1152=dojo.declare([_1151],{documentId:sp.info.document.document.id,constructor:function(){dojo.subscribe("/sp/ajax/incoming/editsession",this,"_onEditSessionMessage");dojo.subscribe("/sp/ajax/incoming/invitation",this,"_onInvitationMessage");},_onEditSessionMessage:function(_1153){switch(_1153.action){case "left":this._editSessionLeft(_1153);break;case "hasSeen":break;case "joined":this._editSessionJoined(_1153);Api.Invalidate.contacts.get();break;}},_onInvitationMessage:function(_1154){switch(_1154.action){case "addInvitation":this._invitationAddInvitation(_1154);break;}},_editSessionLeft:function(_1155){var user=this._findUserById(_1155.user.id);if(user){this.updateUser(user,{state:"offline",lastAccessedAt:new Date()});}},_editSessionHasSeen:function(_1156){var user=this._findUserById(_1156.user.id);if(user){return;}var _1157=this.createUser(_1156.user);_1157.state="offline";_1157.isInvitation=false;this.addUser(_1157);this.updateUser(_1157,{state:"offline"});},_invitationAddInvitation:function(_1158){if(_1158.action=="addInvitation"){this._addInvitation(_1158.invitation);}}});return new _1152();});},"*now":function(r){r(["dojo/i18n!*preload*layer/nls/sp-lvl-2*[\"en\",\"de\",\"fr\",\"ROOT\"]"]);}}});define("layer/sp-lvl-2",["dijit","dojo","dojox","dojo/require!cb/WindowResizeSupport,cb/page/pad/AndroidOrientationFix,cb/page/pad/ToolChangedFlashMessage,wp/widget/WelcomeDialog,wp/Pad,wp/ConnectivityDialogManager,wp/BayeuxConnector,wp/widget/Sidebar,wp/widget/Minimap,wp/widget/BorderContainer,cb/board/FooterContentPane,cb/board/toolbar/BoardTitle,cb/widget/HelpDialog,cb/board/toolbar/SecondaryToolbar,cb/board/timeline/SimplifiedTimeline,cb/videochat/VideoChatPanel,cb/page/pad/SaveStateDisplay,cb/widget/SecuritySettingsDisplay"],function(dijit,dojo,dojox){dojo.provide("layer.sp-lvl-2");dojo.require("cb.WindowResizeSupport");dojo.require("cb.page.pad.AndroidOrientationFix");dojo.require("cb.page.pad.ToolChangedFlashMessage");dojo.require("wp.widget.WelcomeDialog");dojo.require("wp.Pad");dojo.require("wp.ConnectivityDialogManager");dojo.require("wp.BayeuxConnector");dojo.require("wp.widget.Sidebar");dojo.require("wp.widget.Minimap");dojo.require("wp.widget.BorderContainer");dojo.require("cb.board.FooterContentPane");dojo.require("cb.board.toolbar.BoardTitle");dojo.require("cb.widget.HelpDialog");dojo.require("cb.board.toolbar.SecondaryToolbar");dojo.require("cb.board.timeline.SimplifiedTimeline");dojo.require("cb.videochat.VideoChatPanel");dojo.require("cb.page.pad.SaveStateDisplay");dojo.require("cb.widget.SecuritySettingsDisplay");});
////@ sourceURL=/_/js-master-REL-153/layer/sp-lvl-2.js