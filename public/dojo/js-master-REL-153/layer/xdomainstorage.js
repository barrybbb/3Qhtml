//>>built
require({cache:{"dojo/string":function(){define(["./_base/kernel","./_base/lang"],function(_1,_2){var _3={};_2.setObject("dojo.string",_3);_3.rep=function(_4,_5){if(_5<=0||!_4){return "";}var _6=[];for(;;){if(_5&1){_6.push(_4);}if(!(_5>>=1)){break;}_4+=_4;}return _6.join("");};_3.pad=function(_7,_8,ch,_9){if(!ch){ch="0";}var _a=String(_7),_b=_3.rep(ch,Math.ceil((_8-_a.length)/ch.length));return _9?_a+_b:_b+_a;};_3.substitute=function(_c,_d,_e,_f){_f=_f||_1.global;_e=_e?_2.hitch(_f,_e):function(v){return v;};return _c.replace(/\$\{([^\s\:\}]+)(?:\:([^\s\:\}]+))?\}/g,function(_10,key,_11){var _12=_2.getObject(key,false,_d);if(_11){_12=_2.getObject(_11,false,_f).call(_f,_12,key);}return _e(_12,key).toString();});};_3.trim=String.prototype.trim?_2.trim:function(str){str=str.replace(/^\s+/,"");for(var i=str.length-1;i>=0;i--){if(/\S/.test(str.charAt(i))){str=str.substring(0,i+1);break;}}return str;};return _3;});},"cb/xdomain/storage/StorageIframeServer":function(){define(["dojo/on","dojo/json","dojo/when","dojo/_base/array","cb/xdomain/Communicator"],function(on,_13,_14,arr,_15){return function StorageIframeServer(_16,_17,_18){var _19={};var _1a={};function _1b(_1c){if(!_19[_1c]){_19[_1c]=[];}return _19[_1c];};var _1d=function _1d(_1e){if(!_1a[_1e]){_1a[_1e]=_14(_18(_1e,function(_1f){arr.forEach(_1b(_1e),function(l){l(_1f);});}));}return _1a[_1e];};var _20=new _15(_16,{get:function get(_21){if(!_21.storeName||!_21.key){return;}return _1d(_21.storeName).then(function(_22){return _22.getObj(_21.key);});},set:function set(_23){if(!_23.storeName||!_23.key){return;}return _1d(_23.storeName).then(function(_24){return _24.setObj(_23.key,_23.value);});},clear:function clear(_25){if(!_25.storeName){return;}return _1d(_25.storeName).then(function(_26){return _26.clear();});},listen:function(_27,_28,_29){if(!_27.storeName){return;}_1d(_27.storeName);_1b(_27.storeName).push(function(_2a){_20.send(window.parent,_17,"storageevent",{event:_2a,storeName:_27.storeName});});},reply:function(){}});_20.send(window.parent,_17,"loaded",{});};});},"dojox/lang/functional/array":function(){define("dojox/lang/functional/array",["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array","./lambda"],function(_2b,_2c,arr,df){var _2d={};_2c.mixin(df,{filter:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||_2b.global;f=df.lambda(f);var t=[],v,i,n;if(_2c.isArray(a)){for(i=0,n=a.length;i<n;++i){v=a[i];if(f.call(o,v,i,a)){t.push(v);}}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){for(i=0;a.hasNext();){v=a.next();if(f.call(o,v,i++,a)){t.push(v);}}}else{for(i in a){if(!(i in _2d)){v=a[i];if(f.call(o,v,i,a)){t.push(v);}}}}}return t;},forEach:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||_2b.global;f=df.lambda(f);var i,n;if(_2c.isArray(a)){for(i=0,n=a.length;i<n;f.call(o,a[i],i,a),++i){}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){for(i=0;a.hasNext();f.call(o,a.next(),i++,a)){}}else{for(i in a){if(!(i in _2d)){f.call(o,a[i],i,a);}}}}return o;},map:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||_2b.global;f=df.lambda(f);var t,n,i;if(_2c.isArray(a)){t=new Array(n=a.length);for(i=0;i<n;t[i]=f.call(o,a[i],i,a),++i){}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){t=[];for(i=0;a.hasNext();t.push(f.call(o,a.next(),i++,a))){}}else{t=[];for(i in a){if(!(i in _2d)){t.push(f.call(o,a[i],i,a));}}}}return t;},every:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||_2b.global;f=df.lambda(f);var i,n;if(_2c.isArray(a)){for(i=0,n=a.length;i<n;++i){if(!f.call(o,a[i],i,a)){return false;}}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){for(i=0;a.hasNext();){if(!f.call(o,a.next(),i++,a)){return false;}}}else{for(i in a){if(!(i in _2d)){if(!f.call(o,a[i],i,a)){return false;}}}}}return true;},some:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||_2b.global;f=df.lambda(f);var i,n;if(_2c.isArray(a)){for(i=0,n=a.length;i<n;++i){if(f.call(o,a[i],i,a)){return true;}}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){for(i=0;a.hasNext();){if(f.call(o,a.next(),i++,a)){return true;}}}else{for(i in a){if(!(i in _2d)){if(f.call(o,a[i],i,a)){return true;}}}}}return false;}});return df;});},"sp/err":function(){define(["dijit","dojo","dojox","dojo/require!cb/messaging/ErrContainerReceiver,dojo/window,dojo/NodeList-traverse,dojo/date/stamp"],function(_2e,_2f,_30){_2f.provide("sp.err");_2f.provide("sp.err.FormFieldErrorHandler");_2f.provide("sp.ErrNoErrors");_2f.provide("sp.err.Fatal");_2f.provide("sp.err.Error");_2f.provide("sp.err.Warning");_2f.provide("sp.err.Info");_2f.provide("sp.err.Success");_2f.provide("sp.err.EditSession");_2f.require("cb.messaging.ErrContainerReceiver");_2f.require("dojo.window");_2f.require("dojo.NodeList-traverse");_2f.require("dojo.date.stamp");_2f.global.sm_err=null;_2f.global.err=null;(function(){var _31=function(){_2f.global.sm_err=new sp.err();_2f.global.err=_2f.global.sm_err;sp.global.err=_2f.global.sm_err;};_2f.declare("sp.err",null,{container:null,constructor:function(_32){_2f.mixin(this,_32);},handleMessage:function(msg){if(!msg){console.warn("ignoring non-message ",msg);return false;}if(!msg.type){console.warn("ignoring message without type ",msg);return false;}if(msg.type==="msg"){this.handle(this.getNewMessageObject(msg.severity,msg.detail,msg.message,null,msg.timestamp?_2f.date.stamp.fromISOString(msg.timestamp).getTime():new Date().getTime()));}else{_2f.publish("/sp/ajax/incoming/"+msg.type,[msg]);}},handle:function(_33,_34){if(!_33){console.error("smErrObj is missing");return;}return cb.messaging.ErrContainerReceiver._handle(_33,_34);},showMessage:function(_35,_36,_37,_38){var msg=this.getNewMessageObject.apply(this,arguments);return this.handle(msg);},getNewMessageObject:function(_39,msg,_3a,_3b,_3c){if(_39==="fatal"){return new sp.err.Fatal(msg,_3a,_3b,_3c);}else{if(_39==="error"){return new sp.err.Error(msg,_3a,_3b,_3c);}else{if(_39==="warning"){return new sp.err.Warning(msg,_3a,_3b,_3c);}else{if(_39==="info"){return new sp.err.Info(msg,_3a,_3b,_3c);}else{if(_39==="success"){return new sp.err.Success(msg,_3a,_3b,_3c);}else{if(_39==="invitation"){return new sp.err.Invitation(msg,_3a,_3b,_3c);}else{if(_39==="uploadprogress"){return new sp.err.UploadProgress(msg,_3a,_3b,_3c);}else{if(_39==="editsession"){return new sp.err.EditSession(msg,_3a,_3b,_3c);}else{if(_39==="permanent_editsession"){return new sp.err.PermanentEditSession(msg,_3a,_3b,_3c);}else{console.error("Unknown message object (",_39,"): ",msg,_3b);}}}}}}}}}},clear:function(){_2f.query(".closeContainer",this.container).forEach(function(_3d){cb.messaging.ErrContainerReceiver._closeMessage(_3d);},this);}});_2f.declare("sp.ErrNoErrors",[sp.err],{handle:function(msg,_3e){if(msg){if(msg.type){if(msg.type=="fatal"||msg.type=="error"||msg.type=="warning"){return;}}}this.inherited(arguments);}});_2f.declare("sp.err.Fatal",null,{constructor:function(msg,_3f,_40,_41){this.type="fatal";this.msg=msg;this.title=_3f;this.userId=_40;this.removable=false;this.fadeDelay=0;this.separator="colon";this.timestamp=_41;}});_2f.declare("sp.err.Error",sp.err.Fatal,{constructor:function(msg,_42){this.type="error";this.msg=msg;this.title=_42;this.removable=true;}});_2f.declare("sp.err.Warning",sp.err.Error,{constructor:function(){this.type="warning";this.fadeDelay=10000;}});_2f.declare("sp.err.Info",sp.err.Warning,{constructor:function(){this.type="info";}});_2f.declare("sp.err.Success",sp.err.Info,{constructor:function(){this.type="success";}});_2f.declare("sp.err.Invitation",sp.err.Info,{constructor:function(){this.type="invitation";}});_2f.declare("sp.err.UploadProgress",sp.err.Info,{constructor:function(){this.type="upload";this.fadeDelay=0;}});_2f.declare("sp.err.EditSession",sp.err.Info,{constructor:function(){this.type="editsession";this.additionalClasses="info";this.separator="break";}});_2f.declare("sp.err.PermanentEditSession",sp.err.EditSession,{constructor:function(){this.fadeDelay=0;}});_31();_2f.declare("sp.err.FormFieldErrorHandler",null,{errorNodeType:"span",constructor:function(_43){_2f.mixin(this,_43);this.smErr=this.smErr||_2f.global.err;},handleMessage:function(msg){if(msg.pathCss===undefined){this.smErr.handleMessage(msg);return;}var _44=_2f.query(".errors.field-"+msg.pathCss+", .field-"+msg.pathCss+" .errors",this.formNode)[0];if(_44){_2f.empty(_44);_2f.create(this.errorNodeType,{"class":"error","innerHTML":msg.detail},_44,"last");}else{_44=_2f.query(".errors",this.formNode)[0];if(_44){_2f.empty(_44);var _45=_2f.create(this.errorNodeType,{},_44,"last");if(msg.message){_2f.create("span",{"class":"error",innerHTML:msg.message+": "},_45,"last");}if(msg.detail){_2f.create("span",{innerHTML:msg.detail},_45,"last");}}else{this.smErr.handleMessage(msg);}}_2f.window.scrollIntoView(_2f.query(this.formNode).children()[0]);}});})();});},"dojo/date":function(){define(["./has","./_base/lang"],function(has,_46){var _47={};_47.getDaysInMonth=function(_48){var _49=_48.getMonth();var _4a=[31,28,31,30,31,30,31,31,30,31,30,31];if(_49==1&&_47.isLeapYear(_48)){return 29;}return _4a[_49];};_47.isLeapYear=function(_4b){var _4c=_4b.getFullYear();return !(_4c%400)||(!(_4c%4)&&!!(_4c%100));};_47.getTimezoneName=function(_4d){var str=_4d.toString();var tz="";var _4e;var pos=str.indexOf("(");if(pos>-1){tz=str.substring(++pos,str.indexOf(")"));}else{var pat=/([A-Z\/]+) \d{4}$/;if((_4e=str.match(pat))){tz=_4e[1];}else{str=_4d.toLocaleString();pat=/ ([A-Z\/]+)$/;if((_4e=str.match(pat))){tz=_4e[1];}}}return (tz=="AM"||tz=="PM")?"":tz;};_47.compare=function(_4f,_50,_51){_4f=new Date(+_4f);_50=new Date(+(_50||new Date()));if(_51=="date"){_4f.setHours(0,0,0,0);_50.setHours(0,0,0,0);}else{if(_51=="time"){_4f.setFullYear(0,0,0);_50.setFullYear(0,0,0);}}if(_4f>_50){return 1;}if(_4f<_50){return -1;}return 0;};_47.add=function(_52,_53,_54){var sum=new Date(+_52);var _55=false;var _56="Date";switch(_53){case "day":break;case "weekday":var _57,_58;var mod=_54%5;if(!mod){_57=(_54>0)?5:-5;_58=(_54>0)?((_54-5)/5):((_54+5)/5);}else{_57=mod;_58=parseInt(_54/5);}var _59=_52.getDay();var adj=0;if(_59==6&&_54>0){adj=1;}else{if(_59==0&&_54<0){adj=-1;}}var _5a=_59+_57;if(_5a==0||_5a==6){adj=(_54>0)?2:-2;}_54=(7*_58)+_57+adj;break;case "year":_56="FullYear";_55=true;break;case "week":_54*=7;break;case "quarter":_54*=3;case "month":_55=true;_56="Month";break;default:_56="UTC"+_53.charAt(0).toUpperCase()+_53.substring(1)+"s";}if(_56){sum["set"+_56](sum["get"+_56]()+_54);}if(_55&&(sum.getDate()<_52.getDate())){sum.setDate(0);}return sum;};_47.difference=function(_5b,_5c,_5d){_5c=_5c||new Date();_5d=_5d||"day";var _5e=_5c.getFullYear()-_5b.getFullYear();var _5f=1;switch(_5d){case "quarter":var m1=_5b.getMonth();var m2=_5c.getMonth();var q1=Math.floor(m1/3)+1;var q2=Math.floor(m2/3)+1;q2+=(_5e*4);_5f=q2-q1;break;case "weekday":var _60=Math.round(_47.difference(_5b,_5c,"day"));var _61=parseInt(_47.difference(_5b,_5c,"week"));var mod=_60%7;if(mod==0){_60=_61*5;}else{var adj=0;var _62=_5b.getDay();var _63=_5c.getDay();_61=parseInt(_60/7);mod=_60%7;var _64=new Date(_5b);_64.setDate(_64.getDate()+(_61*7));var _65=_64.getDay();if(_60>0){switch(true){case _62==6:adj=-1;break;case _62==0:adj=0;break;case _63==6:adj=-1;break;case _63==0:adj=-2;break;case (_65+mod)>5:adj=-2;}}else{if(_60<0){switch(true){case _62==6:adj=0;break;case _62==0:adj=1;break;case _63==6:adj=2;break;case _63==0:adj=1;break;case (_65+mod)<0:adj=2;}}}_60+=adj;_60-=(_61*2);}_5f=_60;break;case "year":_5f=_5e;break;case "month":_5f=(_5c.getMonth()-_5b.getMonth())+(_5e*12);break;case "week":_5f=parseInt(_47.difference(_5b,_5c,"day")/7);break;case "day":_5f/=24;case "hour":_5f/=60;case "minute":_5f/=60;case "second":_5f/=1000;case "millisecond":_5f*=_5c.getTime()-_5b.getTime();}return Math.round(_5f);};1&&_46.mixin(_46.getObject("dojo.date",true),_47);return _47;});},"dojo/io/iframe":function(){define(["../_base/config","../_base/json","../_base/kernel","../_base/lang","../_base/xhr","../sniff","../_base/window","../dom","../dom-construct","../query","require","../aspect","../request/iframe"],function(_66,_67,_68,_69,xhr,has,win,dom,_6a,_6b,_6c,_6d,_6e){_68.deprecated("dojo/io/iframe","Use dojo/request/iframe.","2.0");var mid=_6e._iframeName;mid=mid.substring(0,mid.lastIndexOf("_"));var _6f=_69.delegate(_6e,{create:function(){return _6f._frame=_6e.create.apply(_6e,arguments);},get:null,post:null,send:function(_70){var _71;var dfd=xhr._ioSetArgs(_70,function(dfd){_71&&_71.cancel();},function(dfd){var _72=null,_73=dfd.ioArgs;try{var _74=_73.handleAs;if(_74==="xml"||_74==="html"){_72=_71.response.data;}else{_72=_71.response.text;if(_74==="json"){_72=_67.fromJson(_72);}else{if(_74==="javascript"){_72=_68.eval(_72);}}}}catch(e){_72=e;}return _72;},function(_75,dfd){dfd.ioArgs._hasError=true;return _75;});var _76=dfd.ioArgs;var _77="GET",_78=dom.byId(_70.form);if(_70.method&&_70.method.toUpperCase()==="POST"&&_78){_77="POST";}var _79={method:_77,handleAs:_70.handleAs==="json"||_70.handleAs==="javascript"?"text":_70.handleAs,form:_70.form,query:_78?null:_70.content,data:_78?_70.content:null,timeout:_70.timeout,ioArgs:_76};if(_79.method){_79.method=_79.method.toUpperCase();}if(_66.ioPublish&&_68.publish&&_76.args.ioPublish!==false){var _7a=_6d.after(_6e,"_notifyStart",function(_7b){if(_7b.options.ioArgs===_76){_7a.remove();xhr._ioNotifyStart(dfd);}},true);}_71=_6e(_76.url,_79,true);_76._callNext=_71._callNext;_71.then(function(){dfd.resolve(dfd);}).otherwise(function(_7c){dfd.ioArgs.error=_7c;dfd.reject(_7c);});return dfd;},_iframeOnload:win.global[mid+"_onload"]});_69.setObject("dojo.io.iframe",_6f);return _6f;});},"sp/ajax/AjaxEngine":function(){define(["dijit","dojo","dojox","dojo/require!sp/ajax/AjaxEngineStub,dojo/io/iframe,cb/util"],function(_7d,_7e,_7f){_7e.provide("sp.ajax.AjaxEngine");_7e.provide("sp.ajax");_7e.require("sp.ajax.AjaxEngineStub");_7e.require("dojo.io.iframe");_7e.require("cb.util");(function(){var _80;if(!sp.ajax.getInstance){sp.ajax.getInstance=function(){return sp.ajax.AjaxEngine;};}})();var _81=_7e.declare([sp.ajax.AjaxEngineStub],{QUERY_LIST_UNLIMITED:10000,createDocument:function(_82){var ret=this._xhrPost(_7e.delegate(_82,{url:this._baseUrl+"new",content:{portfolioId:_82.portfolioId,portfolioTitle:_82.portfolioTitle,documentTitle:_82.documentTitle}}));return ret;},claimDocument:function(_83){var ret=this._xhrPost(_7e.delegate(_83,{url:this._baseUrl+"claim",content:{documentId:_83.documentId,portfolioId:_83.portfolioId}}));return ret;},deleteDocument:function(_84){var ret=this._xhrPost(_7e.delegate(_84,{url:this._baseUrl+"delete",content:{documentId:_84.documentId}}));return ret;},copyDocument:function(_85){var ret=this._xhrPost(_7e.delegate(_85,{url:this._baseUrl+"copy",content:{documentId:_85.documentId}}));return ret;},deletePortfolio:function(_86){var ret=this._xhrPost(_7e.delegate(_86,{url:this._baseUrl+"portfolio/"+_86.portfolioId+"/delete"}));return ret;},addPortfolioParticipant:function(_87){return this._xhrPost(_7e.delegate(_87,{url:this._baseUrl+"portfolio/"+_87.portfolioId+"/settings/participant",content:{userId:_87.userId}}));},removePortfolioParticipant:function(_88){return this._xhrDelete(_7e.delegate(_88,{url:this._baseUrl+"portfolio/"+_88.portfolioId+"/settings/participant",content:{userId:_88.userId}}));},uploadSnap:function(_89){var ret=this._xhrIframe(_7e.delegate(_89,{url:this._baseUrl+"inbox",method:"IFRAME",timeout:20*60*1000}));ret.then(function(_8a){return _8a;},function(_8b){return _8b;},function(_8c){return _8c;});return ret;},uploadByUrl:function(_8d,_8e){return this._xhrPost(_7e.delegate({url:this._baseUrl+"inbox",content:_8d},_8e));},publishItem:function(_8f,_90){if(!_8f){throw new Error("publishItem called without item");}return this.publishItemString(_7e.toJson([_8f]),_90);},publishItemString:function(_91,_92){if(!_91){throw new Error("publishItemString called without itemString");}if(!_92){throw new Error("publishItemString called without documentId");}var _93=this._xhrPost({url:this._baseUrl+"publish/"+_92,postData:_91,contentType:"application/json"});return _93;},addToPortfolio:function(_94){var ret=this._xhrPost(_7e.delegate(_94,{url:this._baseUrl+"addToPortfolio",content:{documentId:_94.documentId,portfolioId:_94.portfolioId}}));return ret;},changeDocumentSettings:function(_95){var ret=this._xhrPost(_7e.delegate(_95,{url:this._baseUrl+"changeDocumentSettings"}));return ret;},sendEmailInvitation:function(_96){var ret=this._xhrPost(_7e.delegate(_96,{url:this._baseUrl+"sendEmailInvitation"}));return ret;},getInfo:function(_97){var ret=this._xhrPost({url:this._baseUrl+"info",postData:_7e.toJson(_7e.isArray(_97)?_97:[_97]),contentType:"application/json"});return ret;},createPortfolio:function(_98){var _98=_98||{};var ret=this._xhrPost(_7e.delegate(_98,{url:this._baseUrl+"newproject",content:{portfolioTitle:_98.portfolioTitle}}));return ret;},removeCompanyUser:function(_99){if(!_99.companyId){throw "companyId is required";}if(!_99.userId){throw "userId is required";}var ret=this._xhrPost(_7e.delegate(_99,{url:this._baseUrl+"company",content:{action:"deleteuser",companyId:_99.companyId,userId:_99.userId}}));return ret;},removeDocument:function(_9a){if(!_9a.portfolioId){throw "portfolioId is required";}if(!_9a.documentId){throw "documentId is required";}var ret=this._xhrPost(_7e.delegate(_9a,{url:this._baseUrl+"portfolio/"+_9a.portfolioId+"/removedocument",content:{documentId:_9a.documentId}}));return ret;},changeStatus:function(_9b){if(!_9b.id){throw "id is required";}if(!_9b.subject){throw "subject is required";}if(_9b.statustext===undefined){_9b.statustext=null;}var ret=this._xhrPost(_7e.delegate(_9b,{url:this._baseUrl+"status/"+_9b.subject,content:{id:_9b.id,statustext:_9b.statustext}}));return ret;},changeDocumentAccessControl:function(_9c){if(!_9c.documentId){throw "documentId is required";}if(!_9c.hasOwnProperty("collaboration")){throw "collaboration is required";}var ret=this._xhrPost({url:this._baseUrl+"document/"+_9c.documentId+"/settings/accesscontrol",content:{collaboration:_9c.collaboration}});return ret;},changeDocumentTitle:function(_9d){if(!_9d.documentId){throw "documentId is required";}if(!_9d.title){throw "title is required";}var ret=this._xhrPost({url:this._baseUrl+"document/"+_9d.documentId+"/settings/title",content:{title:_9d.title}});return ret;},removeDocumentParticipant:function(_9e){if(!_9e.documentId){throw "documentId is required";}if(!_9e.userId){throw "userId is required";}return this._xhrDelete(_7e.delegate(_9e,{url:this._baseUrl+"document/"+_9e.documentId+"/settings/participant",content:{userId:_9e.userId}}));},changeDocumentNotifyViaEmail:function(_9f){if(!_9f.documentId){throw "documentId is required";}return this._xhrPost(_7e.delegate(_9f,{url:this._baseUrl+"document/"+_9f.documentId+"/settings/notification",content:{notifyViaEmail:_9f.notifyViaEmail}}));},changePortfolioAccessControl:function(_a0){if(!_a0.portfolioId){throw "portfolioId is required";}if(!_a0.hasOwnProperty("token")){throw "token is required";}var ret=this._xhrPost({url:this._baseUrl+"portfolio/"+_a0.portfolioId+"/settings/accesscontrol",content:{token:_a0.token}});return ret;},changePortfolioTitle:function(_a1){if(!_a1.portfolioId){throw "portfolioId is required";}if(!_a1.title){throw "title is required";}var ret=this._xhrPost({url:this._baseUrl+"portfolio/"+_a1.portfolioId+"/settings/title",content:{title:_a1.title}});return ret;},queryBoardList:function(_a2){if(!_a2.searchText){_a2.searchText="";}var ret=this._xhrPost({url:this._baseUrl+"ajax/query/list",content:{limit:_a2.limit,ownerType:_a2.ownerType,sortType:_a2.sortType,searchText:_a2.searchText,displayType:_a2.displayType,portfolioId:_a2.portfolioId}});return ret;},removeContact:function(_a3){if(!_a3.contactid){throw "contactid is missing";}var ret=this._xhrDelete({url:this._baseUrl+"contacts",content:{id:_a3.contactid}});return ret;},addContact:function(_a4){if(!_a4.email){throw "email is missing";}var ret=this._xhrPost({url:this._baseUrl+"contacts",content:{email:_a4.email}});return ret;},submitForm:function(_a5){if(!_a5.form){throw "form missing";}if(!_a5.smErr){_a5.smErr=new sp.err.FormFieldErrorHandler({form:_a5.form});}if((/post/i).test(_7e.attr(_a5.form,"method"))){return sp.ajax.getInstance()._xhrPost(_a5);}else{return sp.ajax.getInstance()._xhrGet(_a5);}},getTokboxToken:function(_a6){if(!_a6.documentId){throw "documentId missing";}return this._xhrPost({url:this._baseUrl+"tokbox/token",content:{documentId:_a6.documentId}});},removeAttachment:function(_a7){if(!_a7.documentId){throw "documentId missing";}if(!_a7.attachmentId){throw "attachmentId missing";}return this._xhrDelete({url:this._baseUrl+"inbox/"+_a7.documentId+"/"+_a7.attachmentId});},addDocumentConnectionWithChatterGroup:function(_a8){if(!_a8.documentId){throw "documentId missing";}if(!_a8.chatterGroupId){throw "chatterGroupId missing";}return this._xhrPost({url:this._baseUrl+"chatter/"+_a8.chatterGroupId+"/documentconnections",content:{documentId:_a8.documentId}});},removeDocumentConnectionWithChatterGroup:function(_a9){if(!_a9.documentId){throw "documentId missing";}if(!_a9.chatterGroupId){throw "chatterGroupId missing";}return this._xhrDelete({url:this._baseUrl+"chatter/"+_a9.chatterGroupId+"/documentconnections",content:{documentId:_a9.documentId}});},changeUserSettingShowTutorial:function(_aa){if(!_aa.userId){throw "userId missing";}if(!_aa.hasOwnProperty("state")){throw "state missing";}return this._xhrPost({url:this._baseUrl+"user/"+_aa.userId+"/settings/showtutorial",content:{state:!!_aa.state}});},changeUserSettingShowUseCaseIntro:function(_ab){if(!_ab.userId){throw "userId missing";}if(!_ab.hasOwnProperty("state")){throw "state missing";}return this._xhrPost({url:this._baseUrl+"user/"+_ab.userId+"/settings/showusecaseintro",content:{state:!!_ab.state}});},changeUserSettingShowOnboardingtasks:function(_ac){if(!_ac.userId){throw "userId missing";}if(!_ac.hasOwnProperty("state")){throw "state missing";}return this._xhrPost({url:this._baseUrl+"user/"+_ac.userId+"/settings/showonboardingtasks",content:{state:!!_ac.state}});},deleteSocialConnection:function(_ad){if(!_ad.userId){throw "userId missing";}if(!_ad.providerId){throw "providerId missing";}if(!_ad.providerUserId){throw "providerUserId missing";}return this._xhrDelete({url:this._baseUrl+"user/"+_ad.userId+"/settings/socialconnection",content:{providerId:_ad.providerId,providerUserId:_ad.providerUserId}});},deleteCompanyUser:function(_ae){if(!_ae.id){throw "id missing";}return this._xhrDelete({url:this._baseUrl+"company/users/"+_ae.id});},inviteCompanyUser:function(_af){return this._xhrPost(_7e.delegate(_af,{url:this._baseUrl+"company/users",content:{invitedUserProvider:_af.invitedUserProvider,invitedUserId:_af.invitedUserId,invitedUserDisplay:_af.invitedUserDisplayname}}));},reinviteCompanyUser:function(_b0){if(!_b0.id){throw "id missing";}return this._xhrPost({url:this._baseUrl+"company/users/"+_b0.id+"/reinvite"});},setOnboardingtaskStatus:function(_b1){if(!_b1.key){throw "key missing";}if(!_b1.userId){throw "userId missing";}if(!_b1.hasOwnProperty("status")){throw "status missing";}return this._xhrPost({url:this._baseUrl+"user/"+_b1.userId+"/onboardingtasks/"+_b1.key,content:{status:_b1.status}});},saveDocumentToGoogleDrive:function(_b2){if(!_b2.documentId){throw "documentId missing";}return this._xhrPost({url:this._baseUrl+"googledrive/save",content:{documentId:_b2.documentId,parentId:_b2.parentId||null}});},updateCompanyUserRoles:cb.util.asPromise(function(_b3){this.checkForRequiredFields(_b3,["companyId","companyUserId","roles"]);return this._xhrPut({url:this._baseUrl+"api/v0_1/company/"+_b3.companyId+"/user/"+_b3.companyUserId+"/roles",putData:_7e.toJson(_b3.roles),contentType:"application/json"});}),checkForRequiredFields:function(_b4,_b5){_7e.forEach(_b5,function(_b6){var _b7=_b4[_b6];if(_b7===undefined){throw _b6+" is missing";}});},getUserSecret:cb.util.asPromise(function(_b8){if(!_b8){throw "userId missing";}return this._xhrGet({url:sp.info.app.serverUrlHttps+"/__/api/v0_1/user/"+_b8+"/secret",contentType:"application/json"});}),copyImageAssociations:cb.util.asPromise(function(_b9){this.checkForRequiredFields(_b9,["imageids","source","target"]);return this._xhrPost({url:this._baseUrl+"api/v0_1/document/"+_b9.target+"/imageassociations",postData:_7e.toJson({source:_b9.source,imageids:_b9.imageids}),contentType:"application/json"});}),getContacts:cb.util.asPromise(function(){return this._xhrGet({url:this._baseUrl+"api/v0_1/contacts",contentType:"application/json"});}),postContacts:cb.util.asPromise(function(_ba){this.checkForRequiredFields(_ba,["identifiers","contactType"]);return this._xhrPost({url:this._baseUrl+"api/v0_1/contacts",contentType:"application/json",postData:_7e.toJson(_ba)});}),deleteContacts:cb.util.asPromise(function(_bb){this.checkForRequiredFields(_bb,["contactId","contactType"]);return this._xhrDelete({url:this._baseUrl+"api/v0_1/contacts/"+_bb.contactType+"/"+_bb.contactId,contentType:"application/json"});}),getReferralstatus:cb.util.asPromise(function(){return this._xhrGet({url:this._baseUrl+"api/v0_1/referralstatus",contentType:"application/json"});})});sp.ajax.AjaxEngine=new _81(sp.info.app.baseUrl+"__/");});},"dojo/hash":function(){define(["./_base/kernel","require","./_base/config","./_base/connect","./_base/lang","./ready","./sniff"],function(_bc,_bd,_be,_bf,_c0,_c1,has){_bc.hash=function(_c2,_c3){if(!arguments.length){return _c4();}if(_c2.charAt(0)=="#"){_c2=_c2.substring(1);}if(_c3){_c5(_c2);}else{location.href="#"+_c2;}return _c2;};var _c6,_c7,_c8,_c9=_be.hashPollFrequency||100;function _ca(str,_cb){var i=str.indexOf(_cb);return (i>=0)?str.substring(i+1):"";};function _c4(){return _ca(location.href,"#");};function _cc(){_bf.publish("/dojo/hashchange",[_c4()]);};function _cd(){if(_c4()===_c6){return;}_c6=_c4();_cc();};function _c5(_ce){if(_c7){if(_c7.isTransitioning()){setTimeout(_c0.hitch(null,_c5,_ce),_c9);return;}var _cf=_c7.iframe.location.href;var _d0=_cf.indexOf("?");_c7.iframe.location.replace(_cf.substring(0,_d0)+"?"+_ce);return;}location.replace("#"+_ce);!_c8&&_cd();};function _d1(){var ifr=document.createElement("iframe"),_d2="dojo-hash-iframe",_d3=_be.dojoBlankHtmlUrl||_bd.toUrl("./resources/blank.html");if(_be.useXDomain&&!_be.dojoBlankHtmlUrl){console.warn("dojo.hash: When using cross-domain Dojo builds,"+" please save dojo/resources/blank.html to your domain and set djConfig.dojoBlankHtmlUrl"+" to the path on your domain to blank.html");}ifr.id=_d2;ifr.src=_d3+"?"+_c4();ifr.style.display="none";document.body.appendChild(ifr);this.iframe=_bc.global[_d2];var _d4,_d5,_d6,_d7,_d8,_d9=this.iframe.location;function _da(){_c6=_c4();_d4=_d8?_c6:_ca(_d9.href,"?");_d5=false;_d6=null;};this.isTransitioning=function(){return _d5;};this.pollLocation=function(){if(!_d8){try{var _db=_ca(_d9.href,"?");if(document.title!=_d7){_d7=this.iframe.document.title=document.title;}}catch(e){_d8=true;console.error("dojo.hash: Error adding history entry. Server unreachable.");}}var _dc=_c4();if(_d5&&_c6===_dc){if(_d8||_db===_d6){_da();_cc();}else{setTimeout(_c0.hitch(this,this.pollLocation),0);return;}}else{if(_c6===_dc&&(_d8||_d4===_db)){}else{if(_c6!==_dc){_c6=_dc;_d5=true;_d6=_dc;ifr.src=_d3+"?"+_d6;_d8=false;setTimeout(_c0.hitch(this,this.pollLocation),0);return;}else{if(!_d8){location.href="#"+_d9.search.substring(1);_da();_cc();}}}}setTimeout(_c0.hitch(this,this.pollLocation),_c9);};_da();setTimeout(_c0.hitch(this,this.pollLocation),_c9);};_c1(function(){if("onhashchange" in _bc.global&&(!has("ie")||(has("ie")>=8&&document.compatMode!="BackCompat"))){_c8=_bf.connect(_bc.global,"onhashchange",_cc);}else{if(document.addEventListener){_c6=_c4();setInterval(_cd,_c9);}else{if(document.attachEvent){_c7=new _d1();}}}});return _bc.hash;});},"dojo/cldr/supplemental":function(){define(["../_base/lang","../i18n"],function(_dd,_de){var _df={};_dd.setObject("dojo.cldr.supplemental",_df);_df.getFirstDayOfWeek=function(_e0){var _e1={bd:5,mv:5,ae:6,af:6,bh:6,dj:6,dz:6,eg:6,iq:6,ir:6,jo:6,kw:6,ly:6,ma:6,om:6,qa:6,sa:6,sd:6,sy:6,ye:6,ag:0,ar:0,as:0,au:0,br:0,bs:0,bt:0,bw:0,by:0,bz:0,ca:0,cn:0,co:0,dm:0,"do":0,et:0,gt:0,gu:0,hk:0,hn:0,id:0,ie:0,il:0,"in":0,jm:0,jp:0,ke:0,kh:0,kr:0,la:0,mh:0,mm:0,mo:0,mt:0,mx:0,mz:0,ni:0,np:0,nz:0,pa:0,pe:0,ph:0,pk:0,pr:0,py:0,sg:0,sv:0,th:0,tn:0,tt:0,tw:0,um:0,us:0,ve:0,vi:0,ws:0,za:0,zw:0};var _e2=_df._region(_e0);var dow=_e1[_e2];return (dow===undefined)?1:dow;};_df._region=function(_e3){_e3=_de.normalizeLocale(_e3);var _e4=_e3.split("-");var _e5=_e4[1];if(!_e5){_e5={de:"de",en:"us",es:"es",fi:"fi",fr:"fr",he:"il",hu:"hu",it:"it",ja:"jp",ko:"kr",nl:"nl",pt:"br",sv:"se",zh:"cn"}[_e4[0]];}else{if(_e5.length==4){_e5=_e4[2];}}return _e5;};_df.getWeekend=function(_e6){var _e7={"in":0,af:4,dz:4,ir:4,om:4,sa:4,ye:4,ae:5,bh:5,eg:5,il:5,iq:5,jo:5,kw:5,ly:5,ma:5,qa:5,sd:5,sy:5,tn:5},_e8={af:5,dz:5,ir:5,om:5,sa:5,ye:5,ae:6,bh:5,eg:6,il:6,iq:6,jo:6,kw:6,ly:6,ma:6,qa:6,sd:6,sy:6,tn:6},_e9=_df._region(_e6),_ea=_e7[_e9],end=_e8[_e9];if(_ea===undefined){_ea=6;}if(end===undefined){end=0;}return {start:_ea,end:end};};return _df;});},"dojox/main":function(){define("dojox/main",["dojo/_base/kernel"],function(_eb){return _eb.dojox;});},"cb/messaging/ErrContainerReceiver":function(){define(["dojo","dojo/dom-construct","cb/common/escapeHtmlAttr","./ErrorMessage"],function(_ec,_ed,_ee,_ef){var _f0=_ec.declare(null,{handle:function(msg){if(msg&&msg.isInstanceOf&&msg.isInstanceOf(_ef)){return this._handle(msg.smErrObj,msg.targetContainer);}else{return this._handle(sp.global.err.getNewMessageObject("info",msg.text,null,msg.userid));}},_handle:function(_f1,_f2){var _f3=this._findOrCreateContainer(_f2);var _f4=false;if(_f3.innerHTML!==""){_f3.innerHTML="";_f4=true;}this._fixSmErrObj(_f1);var _f5=document.createElement("div");if(_f1.userId){_ec.addClass(_f5,"withuserid");_f5.innerHTML="<img src=\""+_ee("/__/photo/"+_f1.userId+".small.png")+"\" />";}else{if(_f1.type==="invitation"){_f5.innerHTML="<i class=\"fonticon-message\"></i>";}}var _f6=document.createElement("div");_ec.addClass(_f6,"closeContainer");if(_f1.removable){var _f7=_ed.create("i",{"class":"close fonticon-cross"},_f6,"last");_ec.connect(_f7,"onclick",this,function(){this._closeMessage(_f6);});}var _f8=document.createElement("div");_ec.addClass(_f8,"contentContainer");_f8.innerHTML=_f1.titleFixed+_f1.msgFixed;var _f9=document.createElement("div");_ec.addClass(_f9,"clearer");_ec.addClass(_f5,"message");_ec.addClass(_f5,_f1.type);if(_f1.additionalClasses){_ec.addClass(_f5,_f1.additionalClasses);}_ec.place(_f6,_f5,"last");_ec.place(_f8,_f5,"last");_ec.place(_f9,_f5,"last");if(_f4){_ec.place(_f5,_f3,"last");if(_f1.fadeDelay>0){setTimeout(_ec.hitch(this,function(){try{this._closeMessage(_f6);}catch(e){}}),_f1.fadeDelay);}}else{_ec.style(_f5,"opacity",0);_ec.place(_f5,_f3,"last");_ec.fadeIn({end:1,node:_f5,duration:500,onEnd:_ec.hitch(this,function(){if(_f1.fadeDelay>0){setTimeout(_ec.hitch(this,function(){try{this._closeMessage(_f6);}catch(e){}}),_f1.fadeDelay);}})}).play();}return _ec.hitch(this,function(){this._closeMessage(_f6);});},_findOrCreateContainer:function(_fa){var _fb=_fa;if(!_fb){_fb=this.container;}if(!_fb){_fb=_ec.byId("errContainer");}if(!_fb){_fb=_ec.query(".errContainer").filter(function(_fc){return !_ec.hasClass(_fc,"notValidForErr");})[0];}if(!_fb){_fb=_ec.create("div",{id:"errContainer"},_ec.body());}_ec.addClass(_fb,"errContainer");return _fb;},_closeMessage:function(_fd){var _fe=200;var _ff=_fd.parentNode;var _100=_ff.parentNode;_ec.animateProperty({node:_ff,properties:{left:-(_ec.style(_ff,"width"))},onBegin:function(){},duration:_fe,onEnd:function(){_ed.destroy(_ff);}}).play();},_fixSmErrObj:function(_101){var _102=_101.msg;var _103=_101.title;if(_103&&_103.length>0&&(!_102||!_102.length||_102.length<1)){_102=_103;_103="";}var _104=_101.separator=="break"?"<br/>":" ";var _105=(_102&&_102.length>0)?_104:"";var _106=(_103&&_103.length>0)?"<span class='msgTitle'>"+_103+_105+"</span>":"";var msg=(_102&&_102.length>0)?"<span class='msgDetail'>"+_102+"</span>":"";_101.msgFixed=msg;_101.titleFixed=_106;return _101;}});return new _f0();});},"cb/SafeLocalStorage":function(){define([],function(){return function(_107){this.originalStorage=_107;this.setItem=function setItem(key,data){try{_107.setItem(key,data);return true;}catch(e){if(this.removeItem(key)){try{_107.setItem(key,data);return true;}catch(e2){}}}return false;};this.getItem=function getItem(key){try{return _107.getItem(key);}catch(e){}return null;};this.clear=function clear(){try{_107.clear();return true;}catch(e){}return false;};this.removeItem=function removeItem(key){try{_107.removeItem(key);return true;}catch(e){}return false;};this.length=function length(){try{return _107.length;}catch(e){}return 0;};this.key=function key(_108){try{return _107.key(_108);}catch(e){}return "";};};});},"cb/xdomain/Communicator":function(){define(["dojo/on","dojo/Deferred","dojo/when","dojo/json","cb/util","dojox/lang/functional"],function(on,_109,when,json,util,_10a){return function Communicator(_10b,_10c){var _10d={};if(!_10c.reply){_10c.reply=function(_10e,_10f,_110){if(!_10e){return;}if(!_10e.replyId){return;}if(_10d[_10e.replyId]){_10d[_10e.replyId].resolve(_10e.reply);delete _10d[_10e.replyId];}else{}};}_10c=_10a.mapIn(_10c,function(_111,type){return function(){return _111.apply(this,arguments);};});var send=this.send=function send(_112,_113,type,_114,_115){var _116=util.randomString(5);var _117={type:type,value:_114};if(_115){_117.replyId=_116;_10d[_116]=new _109();_10d[_116].then(function(_118){_115(_118);});}_112.postMessage(json.stringify(_117),_113);return function(){delete _10d[_116];};};on(window,"message",function(_119){var _11a=_10b;var _11b=_119.origin;if(!_10b.test(_119.origin)){return;}var data=json.parse(_119.data,true);if(data===null||!data){}else{if(!data.type){}else{if(_10c.hasOwnProperty(data.type)){var _11c=_10c[data.type].call(null,data.value,_119.source,_119.origin);if(data.replyId){when(_11c).then(function(v){if(v!==undefined){send(_119.source,_119.origin,"reply",{replyId:data.replyId,reply:v});}});}}else{}}}});};});},"dojo/date/stamp":function(){define(["../_base/lang","../_base/array"],function(lang,_11d){var _11e={};lang.setObject("dojo.date.stamp",_11e);_11e.fromISOString=function(_11f,_120){if(!_11e._isoRegExp){_11e._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):?(\d{2}))|Z)?)?$/;}var _121=_11e._isoRegExp.exec(_11f),_122=null;if(_121){_121.shift();if(_121[1]){_121[1]--;}if(_121[6]){_121[6]*=1000;}if(_120){_120=new Date(_120);_11d.forEach(_11d.map(["FullYear","Month","Date","Hours","Minutes","Seconds","Milliseconds"],function(prop){return _120["get"+prop]();}),function(_123,_124){_121[_124]=_121[_124]||_123;});}_122=new Date(_121[0]||1970,_121[1]||0,_121[2]||1,_121[3]||0,_121[4]||0,_121[5]||0,_121[6]||0);if(_121[0]<100){_122.setFullYear(_121[0]||1970);}var _125=0,_126=_121[7]&&_121[7].charAt(0);if(_126!="Z"){_125=((_121[8]||0)*60)+(Number(_121[9])||0);if(_126!="-"){_125*=-1;}}if(_126){_125-=_122.getTimezoneOffset();}if(_125){_122.setTime(_122.getTime()+_125*60000);}}return _122;};_11e.toISOString=function(_127,_128){var _129=function(n){return (n<10)?"0"+n:n;};_128=_128||{};var _12a=[],_12b=_128.zulu?"getUTC":"get",date="";if(_128.selector!="time"){var year=_127[_12b+"FullYear"]();date=["0000".substr((year+"").length)+year,_129(_127[_12b+"Month"]()+1),_129(_127[_12b+"Date"]())].join("-");}_12a.push(date);if(_128.selector!="date"){var time=[_129(_127[_12b+"Hours"]()),_129(_127[_12b+"Minutes"]()),_129(_127[_12b+"Seconds"]())].join(":");var _12c=_127[_12b+"Milliseconds"]();if(_128.milliseconds){time+="."+(_12c<100?"0":"")+_129(_12c);}if(_128.zulu){time+="Z";}else{if(_128.selector!="time"){var _12d=_127.getTimezoneOffset();var _12e=Math.abs(_12d);time+=(_12d>0?"-":"+")+_129(Math.floor(_12e/60))+":"+_129(_12e%60);}}_12a.push(time);}return _12a.join("T");};return _11e;});},"dojo/request/iframe":function(){define(["module","require","./watch","./util","./handlers","../_base/lang","../io-query","../query","../has","../dom","../dom-construct","../_base/window"],function(_12f,_130,_131,util,_132,lang,_133,_134,has,dom,_135,win){var mid=_12f.id.replace(/[\/\.\-]/g,"_"),_136=mid+"_onload";if(!win.global[_136]){win.global[_136]=function(){var dfd=_137._currentDfd;if(!dfd){_137._fireNextRequest();return;}var _138=dfd.response,_139=_138.options,_13a=dom.byId(_139.form)||dfd._tmpForm;if(_13a){var _13b=dfd._contentToClean;for(var i=0;i<_13b.length;i++){var key=_13b[i];for(var j=0;j<_13a.childNodes.length;j++){var _13c=_13a.childNodes[j];if(_13c.name===key){_135.destroy(_13c);break;}}}dfd._originalAction&&_13a.setAttribute("action",dfd._originalAction);if(dfd._originalMethod){_13a.setAttribute("method",dfd._originalMethod);_13a.method=dfd._originalMethod;}if(dfd._originalTarget){_13a.setAttribute("target",dfd._originalTarget);_13a.target=dfd._originalTarget;}}if(dfd._tmpForm){_135.destroy(dfd._tmpForm);delete dfd._tmpForm;}dfd._finished=true;};}function _13d(name,_13e,uri){if(win.global[name]){return win.global[name];}if(win.global.frames[name]){return win.global.frames[name];}if(!uri){if(has("config-useXDomain")&&!has("config-dojoBlankHtmlUrl")){console.warn("dojo/request/iframe: When using cross-domain Dojo builds,"+" please save dojo/resources/blank.html to your domain and set dojoConfig.dojoBlankHtmlUrl"+" to the path on your domain to blank.html");}uri=(has("config-dojoBlankHtmlUrl")||_130.toUrl("dojo/resources/blank.html"));}var _13f=_135.place("<iframe id=\""+name+"\" name=\""+name+"\" src=\""+uri+"\" onload=\""+_13e+"\" style=\"position: absolute; left: 1px; top: 1px; height: 1px; width: 1px; visibility: hidden\">",win.body());win.global[name]=_13f;return _13f;};function _140(_141,src,_142){var _143=win.global.frames[_141.name];if(_143.contentWindow){_143=_143.contentWindow;}try{if(!_142){_143.location=src;}else{_143.location.replace(src);}}catch(e){}};function doc(_144){if(_144.contentDocument){return _144.contentDocument;}var name=_144.name;if(name){var _145=win.doc.getElementsByTagName("iframe");if(_144.document&&_145[name].contentWindow&&_145[name].contentWindow.document){return _145[name].contentWindow.document;}else{if(win.doc.frames[name]&&win.doc.frames[name].document){return win.doc.frames[name].document;}}}return null;};function _146(){return _135.create("form",{name:mid+"_form",style:{position:"absolute",top:"-1000px",left:"-1000px"}},win.body());};function _147(){var dfd;try{if(_137._currentDfd||!_137._dfdQueue.length){return;}do{dfd=_137._currentDfd=_137._dfdQueue.shift();}while(dfd&&(dfd.canceled||(dfd.isCanceled&&dfd.isCanceled()))&&_137._dfdQueue.length);if(!dfd||dfd.canceled||(dfd.isCanceled&&dfd.isCanceled())){_137._currentDfd=null;return;}var _148=dfd.response,_149=_148.options,c2c=dfd._contentToClean=[],_14a=dom.byId(_149.form),_14b=util.notify,data=_149.data||null,_14c;if(!dfd._legacy&&_149.method==="POST"&&!_14a){_14a=dfd._tmpForm=_146();}else{if(_149.method==="GET"&&_14a&&_148.url.indexOf("?")>-1){_14c=_148.url.slice(_148.url.indexOf("?")+1);data=lang.mixin(_133.queryToObject(_14c),data);}}if(_14a){if(!dfd._legacy){var _14d=_14a;do{_14d=_14d.parentNode;}while(_14d!==win.doc.documentElement);if(!_14d){_14a.style.position="absolute";_14a.style.left="-1000px";_14a.style.top="-1000px";win.body().appendChild(_14a);}if(!_14a.name){_14a.name=mid+"_form";}}if(data){var _14e=function(name,_14f){_135.create("input",{type:"hidden",name:name,value:_14f},_14a);c2c.push(name);};for(var x in data){var val=data[x];if(lang.isArray(val)&&val.length>1){for(var i=0;i<val.length;i++){_14e(x,val[i]);}}else{if(!_14a[x]){_14e(x,val);}else{_14a[x].value=val;}}}}var _150=_14a.getAttributeNode("action"),_151=_14a.getAttributeNode("method"),_152=_14a.getAttributeNode("target");if(_148.url){dfd._originalAction=_150?_150.value:null;if(_150){_150.value=_148.url;}else{_14a.setAttribute("action",_148.url);}}if(!dfd._legacy){dfd._originalMethod=_151?_151.value:null;if(_151){_151.value=_149.method;}else{_14a.setAttribute("method",_149.method);}}else{if(!_151||!_151.value){if(mthdNode){mthdNode.value=_149.method;}else{fn.setAttribute("method",_149.method);}}}dfd._originalTarget=_152?_152.value:null;if(_152){_152.value=_137._iframeName;}else{_14a.setAttribute("target",_137._iframeName);}_14a.target=_137._iframeName;_14b&&_14b.emit("send",_148,dfd.promise.cancel);_137._notifyStart(_148);_14a.submit();}else{var _153="";if(_148.options.data){_153=_148.options.data;if(typeof _153!=="string"){_153=_133.objectToQuery(_153);}}var _154=_148.url+(_148.url.indexOf("?")>-1?"&":"?")+_153;_14b&&_14b.emit("send",_148,dfd.promise.cancel);_137._notifyStart(_148);_137.setSrc(_137._frame,_154,true);}}catch(e){dfd.reject(e);}};function _155(_156){return !this.isFulfilled();};function _157(_158){return !!this._finished;};function _159(_15a,_15b){if(!_15b){try{var _15c=_15a.options,doc=_137.doc(_137._frame),_15d=_15c.handleAs;if(_15d!=="html"){if(_15d==="xml"){if(doc.documentElement.tagName.toLowerCase()==="html"){_134("a",doc.documentElement).orphan();var _15e=doc.documentElement.innerText;_15e=_15e.replace(/>\s+</g,"><");_15a.text=lang.trim(_15e);}else{_15a.data=doc;}}else{_15a.text=doc.getElementsByTagName("textarea")[0].value;}_132(_15a);}else{_15a.data=doc;}}catch(e){_15b=e;}}if(_15b){this.reject(_15b);}else{if(this._finished){this.resolve(_15a);}else{this.reject(new Error("Invalid dojo/request/iframe request state"));}}};function last(_15f){this._callNext();};var _160={method:"POST"};function _137(url,_161,_162){var _163=util.parseArgs(url,util.deepCreate(_160,_161),true);url=_163.url;_161=_163.options;if(_161.method!=="GET"&&_161.method!=="POST"){throw new Error(_161.method+" not supported by dojo/request/iframe");}if(!_137._frame){_137._frame=_137.create(_137._iframeName,_136+"();");}var dfd=util.deferred(_163,null,_155,_157,_159,last);dfd._callNext=function(){if(!this._calledNext){this._calledNext=true;_137._currentDfd=null;_137._fireNextRequest();}};dfd._legacy=_162;_137._dfdQueue.push(dfd);_137._fireNextRequest();_131(dfd);return _162?dfd:dfd.promise;};_137.create=_13d;_137.doc=doc;_137.setSrc=_140;_137._iframeName=mid+"_IoIframe";_137._notifyStart=function(){};_137._dfdQueue=[];_137._currentDfd=null;_137._fireNextRequest=_147;util.addCommonMethods(_137,["GET","POST"]);return _137;});},"cb/SecureStorage":function(){define(["dojo/on","dojo/json","dojo/_base/array","cb/ext/sjcl","cb/util","./SafeLocalStorage"],function(on,json,arr,sjcl,util,_164){function _165(_166){return function(s){return sjcl.encrypt(_166,s);};};function _167(_168){return function(s){return sjcl.decrypt(_168,s);};};function _169(_16a){var hmac=new sjcl.misc.hmac(_16a);return function(s){return sjcl.codec.hex.fromBits(hmac.encrypt(s));};};return function SecureStorage(_16b){var _16c=new _164(_16b.storage),_16d=_165(_16b.secret),_16e=_167(_16b.secret),hash=_169(_16b.secret),_16f=_16b.storeName||"default",_170=hash(_16b.secret),_171=new RegExp("^secure:"+util.regExpEscape(_16f)+":"+util.regExpEscape(_170)+":"+".*$"),_172="secure:"+_16f+":"+_170+":",_173=true,_174=_16b.callback,self=this;_16c.setItem(_172+":id",_170);function _175(_176){return _176===_16b.storage||(_176&&new _164(_176).getItem(_172+":id")===_170);};if(!_16c||!_16d||!_16e){throw "provide storage object, encrypt and decrypt methods";}function _177(k){return _172+hash(k);};function _178(k){return _171.test(k);};function _179(_17a){if(_17a===null||_17a===""){return null;}var _17b=json.parse(_16e(_17a),true);return _17b;};function _17c(){var _17d=0;var _17e=_16c.length();while(_17e--){if(_178(_16c.key(_17e))){_17d++;}}self.length=_17d;_173=false;};this.getLength=function getLength(){if(_173){_17c();}return this.length;};this.key=function(n){var _17f=0,max=_16c.length(),curr=0;while(_17f<max){if(_178(_16c.key(_17f))){curr++;}if(curr===n){return _179(_16c.getItem(_16c.key(_17f))).key;}}return null;};this.removeItem=function removeItem(key){if(key===null){return;}var k=_177(key);_16c.remove(k);_173=true;return;};this.getObj=this.getItem=function getObj(key){if(key===null){return null;}var k=_177(key);var vObj=_179(_16c.getItem(k));return vObj===null?null:vObj.v;};this.setObj=this.setItem=function setObj(key,_180){if(key===null){return undefined;}var k=_177(key);var vObj={key:key,v:_180};var v=_16d(json.stringify(vObj));_16c.setItem(k,v);return undefined;};this.clear=function clear(){var _181=_16c.length(),_182=[];while(_181--){if(_178(_16c.key(_181))){_182.push(_16c.key(_181));}}arr.forEach(_182,function(key){_16c.remove(key);});_173=true;return undefined;};if(_174){on(window,"storage",function(ev){if(_175(ev.storageArea)&&_178(ev.key)){var _183=_179(ev.oldValue);var _184=_179(ev.newValue);_174({key:_184.key,oldValue:_183.v,newValue:_184.v,url:ev.url});}});}};});},"dojo/NodeList-traverse":function(){define(["./query","./_base/lang","./_base/array"],function(_185,lang,_186){var _187=_185.NodeList;lang.extend(_187,{_buildArrayFromCallback:function(_188){var ary=[];for(var i=0;i<this.length;i++){var _189=_188.call(this[i],this[i],ary);if(_189){ary=ary.concat(_189);}}return ary;},_getUniqueAsNodeList:function(_18a){var ary=[];for(var i=0,node;node=_18a[i];i++){if(node.nodeType==1&&_186.indexOf(ary,node)==-1){ary.push(node);}}return this._wrap(ary,null,this._NodeListCtor);},_getUniqueNodeListWithParent:function(_18b,_18c){var ary=this._getUniqueAsNodeList(_18b);ary=(_18c?_185._filterResult(ary,_18c):ary);return ary._stash(this);},_getRelatedUniqueNodes:function(_18d,_18e){return this._getUniqueNodeListWithParent(this._buildArrayFromCallback(_18e),_18d);},children:function(_18f){return this._getRelatedUniqueNodes(_18f,function(node,ary){return lang._toArray(node.childNodes);});},closest:function(_190,root){return this._getRelatedUniqueNodes(null,function(node,ary){do{if(_185._filterResult([node],_190,root).length){return node;}}while(node!=root&&(node=node.parentNode)&&node.nodeType==1);return null;});},parent:function(_191){return this._getRelatedUniqueNodes(_191,function(node,ary){return node.parentNode;});},parents:function(_192){return this._getRelatedUniqueNodes(_192,function(node,ary){var pary=[];while(node.parentNode){node=node.parentNode;pary.push(node);}return pary;});},siblings:function(_193){return this._getRelatedUniqueNodes(_193,function(node,ary){var pary=[];var _194=(node.parentNode&&node.parentNode.childNodes);for(var i=0;i<_194.length;i++){if(_194[i]!=node){pary.push(_194[i]);}}return pary;});},next:function(_195){return this._getRelatedUniqueNodes(_195,function(node,ary){var next=node.nextSibling;while(next&&next.nodeType!=1){next=next.nextSibling;}return next;});},nextAll:function(_196){return this._getRelatedUniqueNodes(_196,function(node,ary){var pary=[];var next=node;while((next=next.nextSibling)){if(next.nodeType==1){pary.push(next);}}return pary;});},prev:function(_197){return this._getRelatedUniqueNodes(_197,function(node,ary){var prev=node.previousSibling;while(prev&&prev.nodeType!=1){prev=prev.previousSibling;}return prev;});},prevAll:function(_198){return this._getRelatedUniqueNodes(_198,function(node,ary){var pary=[];var prev=node;while((prev=prev.previousSibling)){if(prev.nodeType==1){pary.push(prev);}}return pary;});},andSelf:function(){return this.concat(this._parent);},first:function(){return this._wrap(((this[0]&&[this[0]])||[]),this);},last:function(){return this._wrap((this.length?[this[this.length-1]]:[]),this);},even:function(){return this.filter(function(item,i){return i%2!=0;});},odd:function(){return this.filter(function(item,i){return i%2==0;});}});return _187;});},"cb/common/escapeHtmlAttr":function(){define(["./escapeHtml"],function(_199){return _199;});},"dojo/window":function(){define(["./_base/lang","./sniff","./_base/window","./dom","./dom-geometry","./dom-style"],function(lang,has,_19a,dom,geom,_19b){var _19c={getBox:function(doc){doc=doc||_19a.doc;var _19d=(doc.compatMode=="BackCompat")?_19a.body(doc):doc.documentElement,_19e=geom.docScroll(doc),w,h;if(has("touch")){var _19f=_19c.get(doc);w=_19f.innerWidth||_19d.clientWidth;h=_19f.innerHeight||_19d.clientHeight;}else{w=_19d.clientWidth;h=_19d.clientHeight;}return {l:_19e.x,t:_19e.y,w:w,h:h};},get:function(doc){if(has("ie")&&_19c!==document.parentWindow){doc.parentWindow.execScript("document._parentWindow = window;","Javascript");var win=doc._parentWindow;doc._parentWindow=null;return win;}return doc.parentWindow||doc.defaultView;},scrollIntoView:function(node,pos){try{node=dom.byId(node);var doc=node.ownerDocument||_19a.doc,body=_19a.body(doc),html=doc.documentElement||body.parentNode,isIE=has("ie"),isWK=has("webkit");if((!(has("mozilla")||isIE||isWK||has("opera"))||node==body||node==html)&&(typeof node.scrollIntoView!="undefined")){node.scrollIntoView(false);return;}var _1a0=doc.compatMode=="BackCompat",_1a1=(isIE>=9&&"frameElement" in node.ownerDocument.parentWindow)?((html.clientHeight>0&&html.clientWidth>0&&(body.clientHeight==0||body.clientWidth==0||body.clientHeight>html.clientHeight||body.clientWidth>html.clientWidth))?html:body):(_1a0?body:html),_1a2=isWK?body:_1a1,_1a3=_1a1.clientWidth,_1a4=_1a1.clientHeight,rtl=!geom.isBodyLtr(doc),_1a5=pos||geom.position(node),el=node.parentNode,_1a6=function(el){return ((isIE<=6||(isIE&&_1a0))?false:(_19b.get(el,"position").toLowerCase()=="fixed"));};if(_1a6(node)){return;}while(el){if(el==body){el=_1a2;}var _1a7=geom.position(el),_1a8=_1a6(el);if(el==_1a2){_1a7.w=_1a3;_1a7.h=_1a4;if(_1a2==html&&isIE&&rtl){_1a7.x+=_1a2.offsetWidth-_1a7.w;}if(_1a7.x<0||!isIE){_1a7.x=0;}if(_1a7.y<0||!isIE){_1a7.y=0;}}else{var pb=geom.getPadBorderExtents(el);_1a7.w-=pb.w;_1a7.h-=pb.h;_1a7.x+=pb.l;_1a7.y+=pb.t;var _1a9=el.clientWidth,_1aa=_1a7.w-_1a9;if(_1a9>0&&_1aa>0){_1a7.w=_1a9;_1a7.x+=(rtl&&(isIE||el.clientLeft>pb.l))?_1aa:0;}_1a9=el.clientHeight;_1aa=_1a7.h-_1a9;if(_1a9>0&&_1aa>0){_1a7.h=_1a9;}}if(_1a8){if(_1a7.y<0){_1a7.h+=_1a7.y;_1a7.y=0;}if(_1a7.x<0){_1a7.w+=_1a7.x;_1a7.x=0;}if(_1a7.y+_1a7.h>_1a4){_1a7.h=_1a4-_1a7.y;}if(_1a7.x+_1a7.w>_1a3){_1a7.w=_1a3-_1a7.x;}}var l=_1a5.x-_1a7.x,t=_1a5.y-Math.max(_1a7.y,0),r=l+_1a5.w-_1a7.w,bot=t+_1a5.h-_1a7.h;if(r*l>0){var s=Math[l<0?"max":"min"](l,r);if(rtl&&((isIE==8&&!_1a0)||isIE>=9)){s=-s;}_1a5.x+=el.scrollLeft;el.scrollLeft+=s;_1a5.x-=el.scrollLeft;}if(bot*t>0){_1a5.y+=el.scrollTop;el.scrollTop+=Math[t<0?"max":"min"](t,bot);_1a5.y-=el.scrollTop;}el=(el!=_1a2)&&!_1a8&&el.parentNode;}}catch(error){console.error("scrollIntoView: "+error);node.scrollIntoView(false);}}};1&&lang.setObject("dojo.window",_19c);return _19c;});},"cb/ext/sjcl":function(){define(["./sjcl/sjcl"],function(sjcl){return sjcl;});},"dojox/lang/functional/lambda":function(){define("dojox/lang/functional/lambda",["../..","dojo/_base/kernel","dojo/_base/lang","dojo/_base/array"],function(_1ab,dojo,lang,arr){var df=lang.getObject("lang.functional",true,_1ab);var _1ac={};var _1ad="ab".split(/a*/).length>1?String.prototype.split:function(sep){var r=this.split.call(this,sep),m=sep.exec(this);if(m&&m.index==0){r.unshift("");}return r;};var _1ae=function(s){var args=[],_1af=_1ad.call(s,/\s*->\s*/m);if(_1af.length>1){while(_1af.length){s=_1af.pop();args=_1af.pop().split(/\s*,\s*|\s+/m);if(_1af.length){_1af.push("(function("+args+"){return ("+s+")})");}}}else{if(s.match(/\b_\b/)){args=["_"];}else{var l=s.match(/^\s*(?:[+*\/%&|\^\.=<>]|!=)/m),r=s.match(/[+\-*\/%&|\^\.=<>!]\s*$/m);if(l||r){if(l){args.push("$1");s="$1"+s;}if(r){args.push("$2");s=s+"$2";}}else{var vars=s.replace(/(?:\b[A-Z]|\.[a-zA-Z_$])[a-zA-Z_$\d]*|[a-zA-Z_$][a-zA-Z_$\d]*:|this|true|false|null|undefined|typeof|instanceof|in|delete|new|void|arguments|decodeURI|decodeURIComponent|encodeURI|encodeURIComponent|escape|eval|isFinite|isNaN|parseFloat|parseInt|unescape|dojo|dijit|dojox|window|document|'(?:[^'\\]|\\.)*'|"(?:[^"\\]|\\.)*"/g,"").match(/([a-z_$][a-z_$\d]*)/gi)||[],t={};arr.forEach(vars,function(v){if(!(v in t)){args.push(v);t[v]=1;}});}}}return {args:args,body:s};};var _1b0=function(a){return a.length?function(){var i=a.length-1,x=df.lambda(a[i]).apply(this,arguments);for(--i;i>=0;--i){x=df.lambda(a[i]).call(this,x);}return x;}:function(x){return x;};};lang.mixin(df,{rawLambda:function(s){return _1ae(s);},buildLambda:function(s){s=_1ae(s);return "function("+s.args.join(",")+"){return ("+s.body+");}";},lambda:function(s){if(typeof s=="function"){return s;}if(s instanceof Array){return _1b0(s);}if(s in _1ac){return _1ac[s];}s=_1ae(s);return _1ac[s]=new Function(s.args,"return ("+s.body+");");},clearLambdaCache:function(){_1ac={};}});return df;});},"cb/xdomain/storage/ServerPage":function(){define(["dojo/on","dojo/hash","cb/xdomain/storage/StorageIframeServer","cb/util","cb/SecureStorage","sp/ajax/AjaxEngine"],function(on,hash,_1b1,util,_1b2,_1b3){var init=util.wrapDefer(function(){on(window,"storage",function(){});var _1b4=new RegExp("^https?:\\/\\/(?:[^/]*\\.)?"+util.regExpEscape(sp.info.app.serverhost));var _1b5=hash();new _1b1(_1b4,_1b5,function(_1b6,_1b7){return _1b3.getUserSecret(sp.info.user.id).then(function(_1b8){return new _1b2({storeName:_1b6,secret:_1b8.secret,storage:window.localStorage,callback:_1b7});});});});return {init:init};});},"sp/ajax/AjaxEngineStub":function(){define(["dijit","dojo","dojox","dojo/i18n!sp/ajax/nls/AjaxEngine","dojo/require!sp/I18n,sp/err"],function(_1b9,dojo,_1ba){dojo.provide("sp.ajax.AjaxEngineStub");dojo.require("sp.I18n");dojo.require("sp.err");dojo.requireLocalization("sp.ajax","AjaxEngine");(function(){sp.ajax.DEFAULT_HEADERS={"X-is-ajax-call":"true","X-CB-CSRF":sp.info.user.nonce};})();dojo.declare("sp.ajax.AjaxEngineStub",null,{constructor:function(_1bb){if(!_1bb){throw new Error("AjaxDocumentEngine constructor called without baseUrl.");}this._baseUrl=_1bb;this._requestTimeout=5*60*1000;this.contentType="application/x-www-form-urlencoded; charset=utf-8";},ERROR_STATUS_MESSAGES:{"403":{type:"msg",severity:"error",message:sp.I18n.get("sp.ajax","AjaxEngine")("error_403_message"),detail:sp.I18n.get("sp.ajax","AjaxEngine")("error_403_detail")},"405":{type:"msg",severity:"error",message:sp.I18n.get("sp.ajax","AjaxEngine")("error_405_message"),detail:sp.I18n.get("sp.ajax","AjaxEngine")("error_405_detail")},"500":{type:"msg",severity:"error",message:sp.I18n.get("sp.ajax","AjaxEngine")("error_500_message"),detail:sp.I18n.get("sp.ajax","AjaxEngine")("error_500_detail")}},ERROR_DEFAULT_MESSAGE:{type:"msg",severity:"error",message:sp.I18n.get("sp.ajax","AjaxEngine")("error_default_message"),detail:sp.I18n.get("sp.ajax","AjaxEngine")("error_default_detail")},ERROR_TIMEOUT_MESSAGE:{type:"msg",severity:"error",message:sp.I18n.get("sp.ajax","AjaxEngine")("error_timeout_message"),detail:sp.I18n.get("sp.ajax","AjaxEngine")("error_timeout_detail")},ERROR_UNKNOWN_MESSAGE:{type:"msg",severity:"error",message:sp.I18n.get("sp.ajax","AjaxEngine")("error_unknown_message"),detail:sp.I18n.get("sp.ajax","AjaxEngine")("error_unknown_detail")},_xhr:function(_1bc,_1bd){if(!_1bd.timeout){_1bd.timeout=this._requestTimeout;}if(!_1bd.contentType){_1bd.contentType=this.contentType;}if(!_1bd.handleAs){_1bd.handleAs="json";}if(!_1bd.content&&!_1bd.form&&!_1bd.postData&&!_1bd.putData){_1bd.content={};}if(!_1bd.headers){_1bd.headers={};}dojo.mixin(_1bd.headers,sp.ajax.DEFAULT_HEADERS);var _1be=new dojo.Deferred();var _1bf=this._getDefaultDeferred(_1bc,_1bd);var _1c0;switch(_1bc){case "GET":_1c0=dojo.xhrGet(_1bd);break;case "POST":_1c0=dojo.xhrPost(_1bd);break;case "DELETE":_1c0=dojo.xhrDelete(_1bd);break;case "PUT":_1c0=dojo.xhrPut(_1bd);break;case "IFRAME":_1c0=dojo.io.iframe.send(_1bd);break;default:console.warn("unknown method",_1bc,"falling back to GET");_1c0=dojo.xhrGet(_1bd);break;}_1c0.addBoth(function(res){_1bf.callback(res);});_1c0.addBoth(function(){return _1bf;});_1c0.addCallbacks(function(res){_1be.callback(res);},function(res){_1be.errback(res);});_1c0.addBoth(function(){return _1be;});_1c0.addErrback(function(_1c1){if(_1c1.handledByMsgsHandler){}else{console.warn("error handling the result",_1c1,"of an ajaxCall with ioArgs",_1c0.ioArgs);}});_1be.ioArgs=_1c0.ioArgs;return _1be;},_xhrPost:function(_1c2){return this._xhr("POST",_1c2);},_xhrPut:function(_1c3){return this._xhr("PUT",_1c3);},_xhrGet:function(_1c4){return this._xhr("GET",_1c4);},_xhrDelete:function(_1c5){return this._xhr("DELETE",_1c5);},_xhrIframe:function(_1c6){return this._xhr("IFRAME",_1c6);},_getDefaultDeferred:function(_1c7,_1c8){var err=_1c8.smErr||dojo.global.err;var _1c9=new dojo.Deferred();var _1ca=dojo.hitch(this,function(_1cb){var _1cc=this._fixResponseObjMsgs(_1cb);if(this._containsErrorMessages(_1cc)){var _1cd=new Error("valid ajax response contained error message");_1cd.result=_1cc;_1cd.msgs=_1cc.msgs;throw _1cd;}return _1cc;});var _1ce=dojo.hitch(this,function(_1cf){if(_1cf instanceof Error){var _1d0=[];var _1d1={};if(dojo.isString(_1cf.dojoType)&&_1cf.dojoType=="timeout"){_1d0.push(this.ERROR_TIMEOUT_MESSAGE);}else{if(_1cf.status&&_1cf.responseText){var _1d2=_1cf.status;_1d1=this._extractResponseObj(_1cf);if(!this._containsErrorMessages(_1d1)){_1d0.push(this.ERROR_STATUS_MESSAGES[_1d2]||this.ERROR_DEFAULT_MESSAGE);}if(_1d0.length>0){_1d1.msgs=(_1d1.msgs&&dojo.isArrayLike(_1d1.msgs))?_1d1.msgs:[];for(var _1d3=0;_1d3<_1d0.length;_1d3++){_1d1.msgs.push(_1d0[_1d3]);}}}}var _1d4=new Error("msgs from errback level 1");_1d4.msgs=_1d1.msgs;_1d4.result=_1d1;throw _1d4;}else{var _1d5=new Error("msgs from errback level 1 - unknown error");_1d5.msgs=[this.ERROR_UNKNOWN_MESSAGE];_1d5.result=_1cf;throw _1d5;}});var _1d6=dojo.hitch(this,function(_1d7){if(!_1d7){return _1d7;}this._fixResponseObjMsgs(_1d7);dojo.forEach(_1d7.msgs,dojo.hitch(err,err.handleMessage));_1d7.handledByMsgsHandler=true;return _1d7;});_1c9.addCallbacks(_1ca,_1ce);_1c9.addBoth(_1d6);return _1c9;},_containsErrorMessages:function(_1d8){var msgs=_1d8.msgs;return dojo.some(msgs,this._isErrorMessage,this);},_isErrorMessage:function(msg){if(!msg){console.warn("_isErrorMessage ignoring non-message",msg);return false;}if(!msg.type){console.warn("_isErrorMessage ignoring message without type",msg);return false;}if(msg.type!=="msg"){console.warn("_isErrorMessage ignoring message with wrong type "+msg.type,msg);return false;}if(!msg.severity){console.warn("_isErrorMessage ignoring message without severity",msg);return false;}return (msg.severity==="error"||msg.severity==="fatal");},_extractResponseObj:function(_1d9){if(_1d9.responseObj){return _1d9.responseObj;}var _1da;var _1db=_1d9.responseText;if(dojo.isString(_1db)){try{_1da=dojo.fromJson(_1db);}catch(e){_1da={errorParsingResponse:e};}}if(_1da&&!dojo.isObject(_1da)||_1da===null){_1da={originalResponseObj:_1da};}if(!this._msgsArrayPresent(_1da)){_1da.msgs=[];}_1d9.responseObj=_1da;return _1da;},_fixResponseObjMsgs:function(obj){if(obj&&!dojo.isObject(obj)){throw "obj has to be an object";}if(obj===null){obj={};}if(!this._msgsArrayPresent(obj)){obj.msgs=[];}return obj;},_msgsArrayPresent:function(obj){if(obj&&!dojo.isObject(obj)||obj===null){throw "obj has to be an object";}return obj.msgs&&dojo.isArrayLike(obj.msgs);}});});},"dojox/lang/functional":function(){define("dojox/lang/functional",["./functional/lambda","./functional/array","./functional/object"],function(df){return df;});},"cb/messaging/SimpleMessage":function(){define(["dojo"],function(dojo){return dojo.declare(null,{userid:null,system:null,text:null,constructor:function(_1dc,_1dd,text){this.userid=_1dc;this.system=_1dd;this.text=text;}});});},"cb/util":function(){define(["dojo/Deferred","dojo/when","dojox/lang/functional","dojo/aspect","dojo/_base/lang","dojo/_base/array"],function(_1de,when,_1df,_1e0,lang,arr){var ret={};ret.defer=function defer(func,arg){var args=Array.prototype.slice.call(arguments,1);var that=this;window.setTimeout(function(){func.apply(that,args);},0);};ret.delay=function(_1e1,func,args){var ret=new _1de();var args=Array.prototype.slice.call(arguments,2);var that=this;window.setTimeout(function(){try{ret.resolve(func.apply(that,args));}catch(e){ret.reject(e);}},_1e1);return ret.promise;};ret.wrapDefer=function wrapDefer(func){return function(){var args=Array.prototype.slice.call(arguments,0);ret.defer.apply(this,[func].concat(args));};};ret.throttle=function throttle(func,wait){var _1e2,args,_1e3,_1e4;var _1e5=0;var _1e6=function(){_1e5=new Date();_1e3=null;_1e4=func.apply(_1e2,args);};return function(){var now=new Date;var _1e7=wait-(now-_1e5);_1e2=this;args=arguments;if(_1e7<=0){clearTimeout(_1e3);_1e3=null;_1e5=now;_1e4=func.apply(_1e2,args);}else{if(!_1e3){_1e3=window.setTimeout(_1e6,_1e7);}}return _1e4;};};ret.debounce=function debounce(func,wait,_1e8){var _1e9,_1ea;return function(){var _1eb=this,args=arguments;var _1ec=function(){_1e9=null;if(!_1e8){try{_1ea=func.apply(_1eb,args);}catch(e){}}};var _1ed=_1e8&&!_1e9;clearTimeout(_1e9);_1e9=setTimeout(_1ec,wait);if(_1ed){_1ea=func.apply(_1eb,args);}return _1ea;};};ret.once=function once(func){var ran=false,memo;return function(){if(ran){return memo;}ran=true;memo=func.apply(this,arguments);func=null;return memo;};};ret.asPromise=function asPromise(_1ee){return function(){try{return when(_1ee.apply(this,arguments));}catch(e){return new _1de().reject(e);}};};ret.regExpEscape=function regExpEscape(s){return s.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");};ret.randomString=(function(){var _1ef=Array.prototype.slice.apply("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789");return function randomString(_1f0,_1f1){_1f0=_1f0||5;_1f1=_1f1||_1ef;if(dojo.isString(_1f1)){_1f1=Array.prototype.slice.apply(_1f1);}var s="";while(_1f0--){s+=_1f1[Math.floor(Math.random()*_1f1.length)];}return s;};})();ret.logExceptions=function(fn){return function(){try{fn.apply(this,arguments);}catch(e){console.warn("exception catched and rethrown",e,e.stack);throw e;}};};ret.arrayToObj=function(arr,_1f2){var _1f3;if(null===_1f2||undefined===_1f2){_1f3=function(o){return o;};}else{if(lang.isString(_1f2)){_1f3=function(o){return o[_1f2];};}else{if(lang.isFunction(_1f2)){_1f3=_1f2;}else{throw "keyExtractor has to either be a string or a function";}}}return _1df.foldl(arr,function(ret,o){var key=_1f3(o);if(key!==undefined&&key!==null){ret[key]=o;}else{}return ret;},{});};ret.relayMethodInvocation=function relayMethodInvocation(_1f4,_1f5,_1f6){var _1f7=_1e0.after(_1f4,_1f6,function(){_1f5[_1f6].apply(arguments);});if(_1f4.own){_1f4.own(_1f7);}if(_1f5.own){_1f5.own(_1f7);}return _1f7;};ret.watchAndGetImmediately=function watchAndGetImmediately(_1f8,attr,_1f9){var _1fa=_1f8.watch(attr,_1f9);_1f9(attr,undefined,_1f8.get(attr));return _1fa;};ret.equal=function equal(a,b,_1fb){var _1fc,aKey,bKey,_1fd,_1fe;if(a===undefined||b===undefined){return false;}if(a===b){return true;}else{if(typeof (a)!==typeof (b)){return false;}else{if(lang.isObject(a)){if(!lang.isObject(b)){return false;}_1fd=[];_1fe=[];for(aKey in a){_1fd.push(aKey);}for(bKey in b){_1fe.push(bKey);}if(_1fd.length!==_1fe.length){return false;}for(_1fc=0;_1fc<_1fd.length;_1fc++){aKey=_1fd[_1fc];if(!aKey in b){return false;}if(!ret.equal(a[aKey],b[aKey])){return false;}}for(_1fc=0;_1fc<_1fe.length;_1fc++){bKey=_1fe[_1fc];if(!bKey in a){return false;}if(!ret.equal(a[bKey],b[bKey])){return false;}}return true;}else{if(lang.isArray(a)){if(!lang.isArray(a)){return false;}if(a.length!==b.length){return false;}for(_1fc=0;_1fc<a.length;_1fc++){if(!ret.equal(a[_1fc],b[_1fc])){return false;}}return true;}else{return false;}}}}};ret.equalSets=function equalSets(a,b){a=a||[];b=b||[];return ret.equal(ret.arrayToObj(a),ret.arrayToObj(b));};ret.uniqueValues=function uniqueValues(_1ff){var _200={};return arr.filter(_1ff,function(v){var key=v+"";var ret=_200.hasOwnProperty(key);_200[key]=true;return !ret;});};return ret;});},"dijit/main":function(){define(["dojo/_base/kernel"],function(dojo){return dojo.dijit;});},"dojo/regexp":function(){define(["./_base/kernel","./_base/lang"],function(dojo,lang){var _201={};lang.setObject("dojo.regexp",_201);_201.escapeString=function(str,_202){return str.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,function(ch){if(_202&&_202.indexOf(ch)!=-1){return ch;}return "\\"+ch;});};_201.buildGroupRE=function(arr,re,_203){if(!(arr instanceof Array)){return re(arr);}var b=[];for(var i=0;i<arr.length;i++){b.push(re(arr[i]));}return _201.group(b.join("|"),_203);};_201.group=function(_204,_205){return "("+(_205?"?:":"")+_204+")";};return _201;});},"dojo/date/locale":function(){define(["../_base/lang","../_base/array","../date","../cldr/supplemental","../i18n","../regexp","../string","../i18n!../cldr/nls/gregorian","module"],function(lang,_206,date,_207,i18n,_208,_209,_20a,_20b){var _20c={};lang.setObject(_20b.id.replace(/\//g,"."),_20c);function _20d(_20e,_20f,_210,_211){return _211.replace(/([a-z])\1*/ig,function(_212){var s,pad,c=_212.charAt(0),l=_212.length,_213=["abbr","wide","narrow"];switch(c){case "G":s=_20f[(l<4)?"eraAbbr":"eraNames"][_20e.getFullYear()<0?0:1];break;case "y":s=_20e.getFullYear();switch(l){case 1:break;case 2:if(!_210.fullYear){s=String(s);s=s.substr(s.length-2);break;}default:pad=true;}break;case "Q":case "q":s=Math.ceil((_20e.getMonth()+1)/3);pad=true;break;case "M":case "L":var m=_20e.getMonth();if(l<3){s=m+1;pad=true;}else{var _214=["months",c=="L"?"standAlone":"format",_213[l-3]].join("-");s=_20f[_214][m];}break;case "w":var _215=0;s=_20c._getWeekOfYear(_20e,_215);pad=true;break;case "d":s=_20e.getDate();pad=true;break;case "D":s=_20c._getDayOfYear(_20e);pad=true;break;case "e":case "c":var d=_20e.getDay();if(l<2){s=(d-_207.getFirstDayOfWeek(_210.locale)+8)%7;break;}case "E":d=_20e.getDay();if(l<3){s=d+1;pad=true;}else{var _216=["days",c=="c"?"standAlone":"format",_213[l-3]].join("-");s=_20f[_216][d];}break;case "a":var _217=_20e.getHours()<12?"am":"pm";s=_210[_217]||_20f["dayPeriods-format-wide-"+_217];break;case "h":case "H":case "K":case "k":var h=_20e.getHours();switch(c){case "h":s=(h%12)||12;break;case "H":s=h;break;case "K":s=(h%12);break;case "k":s=h||24;break;}pad=true;break;case "m":s=_20e.getMinutes();pad=true;break;case "s":s=_20e.getSeconds();pad=true;break;case "S":s=Math.round(_20e.getMilliseconds()*Math.pow(10,l-3));pad=true;break;case "v":case "z":s=_20c._getZone(_20e,true,_210);if(s){break;}l=4;case "Z":var _218=_20c._getZone(_20e,false,_210);var tz=[(_218<=0?"+":"-"),_209.pad(Math.floor(Math.abs(_218)/60),2),_209.pad(Math.abs(_218)%60,2)];if(l==4){tz.splice(0,0,"GMT");tz.splice(3,0,":");}s=tz.join("");break;default:throw new Error("dojo.date.locale.format: invalid pattern char: "+_211);}if(pad){s=_209.pad(s,l);}return s;});};_20c._getZone=function(_219,_21a,_21b){if(_21a){return date.getTimezoneName(_219);}else{return _219.getTimezoneOffset();}};_20c.format=function(_21c,_21d){_21d=_21d||{};var _21e=i18n.normalizeLocale(_21d.locale),_21f=_21d.formatLength||"short",_220=_20c._getGregorianBundle(_21e),str=[],_221=lang.hitch(this,_20d,_21c,_220,_21d);if(_21d.selector=="year"){return _222(_220["dateFormatItem-yyyy"]||"yyyy",_221);}var _223;if(_21d.selector!="date"){_223=_21d.timePattern||_220["timeFormat-"+_21f];if(_223){str.push(_222(_223,_221));}}if(_21d.selector!="time"){_223=_21d.datePattern||_220["dateFormat-"+_21f];if(_223){str.push(_222(_223,_221));}}return str.length==1?str[0]:_220["dateTimeFormat-"+_21f].replace(/\'/g,"").replace(/\{(\d+)\}/g,function(_224,key){return str[key];});};_20c.regexp=function(_225){return _20c._parseInfo(_225).regexp;};_20c._parseInfo=function(_226){_226=_226||{};var _227=i18n.normalizeLocale(_226.locale),_228=_20c._getGregorianBundle(_227),_229=_226.formatLength||"short",_22a=_226.datePattern||_228["dateFormat-"+_229],_22b=_226.timePattern||_228["timeFormat-"+_229],_22c;if(_226.selector=="date"){_22c=_22a;}else{if(_226.selector=="time"){_22c=_22b;}else{_22c=_228["dateTimeFormat-"+_229].replace(/\{(\d+)\}/g,function(_22d,key){return [_22b,_22a][key];});}}var _22e=[],re=_222(_22c,lang.hitch(this,_22f,_22e,_228,_226));return {regexp:re,tokens:_22e,bundle:_228};};_20c.parse=function(_230,_231){var _232=/[\u200E\u200F\u202A\u202E]/g,info=_20c._parseInfo(_231),_233=info.tokens,_234=info.bundle,re=new RegExp("^"+info.regexp.replace(_232,"")+"$",info.strict?"":"i"),_235=re.exec(_230&&_230.replace(_232,""));if(!_235){return null;}var _236=["abbr","wide","narrow"],_237=[1970,0,1,0,0,0,0],amPm="",_238=_206.every(_235,function(v,i){if(!i){return true;}var _239=_233[i-1],l=_239.length,c=_239.charAt(0);switch(c){case "y":if(l!=2&&_231.strict){_237[0]=v;}else{if(v<100){v=Number(v);var year=""+new Date().getFullYear(),_23a=year.substring(0,2)*100,_23b=Math.min(Number(year.substring(2,4))+20,99);_237[0]=(v<_23b)?_23a+v:_23a-100+v;}else{if(_231.strict){return false;}_237[0]=v;}}break;case "M":case "L":if(l>2){var _23c=_234["months-"+(c=="L"?"standAlone":"format")+"-"+_236[l-3]].concat();if(!_231.strict){v=v.replace(".","").toLowerCase();_23c=_206.map(_23c,function(s){return s.replace(".","").toLowerCase();});}v=_206.indexOf(_23c,v);if(v==-1){return false;}}else{v--;}_237[1]=v;break;case "E":case "e":case "c":var days=_234["days-"+(c=="c"?"standAlone":"format")+"-"+_236[l-3]].concat();if(!_231.strict){v=v.toLowerCase();days=_206.map(days,function(d){return d.toLowerCase();});}v=_206.indexOf(days,v);if(v==-1){return false;}break;case "D":_237[1]=0;case "d":_237[2]=v;break;case "a":var am=_231.am||_234["dayPeriods-format-wide-am"],pm=_231.pm||_234["dayPeriods-format-wide-pm"];if(!_231.strict){var _23d=/\./g;v=v.replace(_23d,"").toLowerCase();am=am.replace(_23d,"").toLowerCase();pm=pm.replace(_23d,"").toLowerCase();}if(_231.strict&&v!=am&&v!=pm){return false;}amPm=(v==pm)?"p":(v==am)?"a":"";break;case "K":if(v==24){v=0;}case "h":case "H":case "k":if(v>23){return false;}_237[3]=v;break;case "m":_237[4]=v;break;case "s":_237[5]=v;break;case "S":_237[6]=v;}return true;});var _23e=+_237[3];if(amPm==="p"&&_23e<12){_237[3]=_23e+12;}else{if(amPm==="a"&&_23e==12){_237[3]=0;}}var _23f=new Date(_237[0],_237[1],_237[2],_237[3],_237[4],_237[5],_237[6]);if(_231.strict){_23f.setFullYear(_237[0]);}var _240=_233.join(""),_241=_240.indexOf("d")!=-1,_242=_240.indexOf("M")!=-1;if(!_238||(_242&&_23f.getMonth()>_237[1])||(_241&&_23f.getDate()>_237[2])){return null;}if((_242&&_23f.getMonth()<_237[1])||(_241&&_23f.getDate()<_237[2])){_23f=date.add(_23f,"hour",1);}return _23f;};function _222(_243,_244,_245,_246){var _247=function(x){return x;};_244=_244||_247;_245=_245||_247;_246=_246||_247;var _248=_243.match(/(''|[^'])+/g),_249=_243.charAt(0)=="'";_206.forEach(_248,function(_24a,i){if(!_24a){_248[i]="";}else{_248[i]=(_249?_245:_244)(_24a.replace(/''/g,"'"));_249=!_249;}});return _246(_248.join(""));};function _22f(_24b,_24c,_24d,_24e){_24e=_208.escapeString(_24e);if(!_24d.strict){_24e=_24e.replace(" a"," ?a");}return _24e.replace(/([a-z])\1*/ig,function(_24f){var s,c=_24f.charAt(0),l=_24f.length,p2="",p3="";if(_24d.strict){if(l>1){p2="0"+"{"+(l-1)+"}";}if(l>2){p3="0"+"{"+(l-2)+"}";}}else{p2="0?";p3="0{0,2}";}switch(c){case "y":s="\\d{2,4}";break;case "M":case "L":s=(l>2)?"\\S+?":"1[0-2]|"+p2+"[1-9]";break;case "D":s="[12][0-9][0-9]|3[0-5][0-9]|36[0-6]|"+p2+"[1-9][0-9]|"+p3+"[1-9]";break;case "d":s="3[01]|[12]\\d|"+p2+"[1-9]";break;case "w":s="[1-4][0-9]|5[0-3]|"+p2+"[1-9]";break;case "E":case "e":case "c":s="\\S+";break;case "h":s="1[0-2]|"+p2+"[1-9]";break;case "k":s="1[01]|"+p2+"\\d";break;case "H":s="1\\d|2[0-3]|"+p2+"\\d";break;case "K":s="1\\d|2[0-4]|"+p2+"[1-9]";break;case "m":case "s":s="[0-5]\\d";break;case "S":s="\\d{"+l+"}";break;case "a":var am=_24d.am||_24c["dayPeriods-format-wide-am"],pm=_24d.pm||_24c["dayPeriods-format-wide-pm"];s=am+"|"+pm;if(!_24d.strict){if(am!=am.toLowerCase()){s+="|"+am.toLowerCase();}if(pm!=pm.toLowerCase()){s+="|"+pm.toLowerCase();}if(s.indexOf(".")!=-1){s+="|"+s.replace(/\./g,"");}}s=s.replace(/\./g,"\\.");break;default:s=".*";}if(_24b){_24b.push(_24f);}return "("+s+")";}).replace(/[\xa0 ]/g,"[\\s\\xa0]");};var _250=[];_20c.addCustomFormats=function(_251,_252){_250.push({pkg:_251,name:_252});};_20c._getGregorianBundle=function(_253){var _254={};_206.forEach(_250,function(desc){var _255=i18n.getLocalization(desc.pkg,desc.name,_253);_254=lang.mixin(_254,_255);},this);return _254;};_20c.addCustomFormats(_20b.id.replace(/\/date\/locale$/,".cldr"),"gregorian");_20c.getNames=function(item,type,_256,_257){var _258,_259=_20c._getGregorianBundle(_257),_25a=[item,_256,type];if(_256=="standAlone"){var key=_25a.join("-");_258=_259[key];if(_258[0]==1){_258=undefined;}}_25a[1]="format";return (_258||_259[_25a.join("-")]).concat();};_20c.isWeekend=function(_25b,_25c){var _25d=_207.getWeekend(_25c),day=(_25b||new Date()).getDay();if(_25d.end<_25d.start){_25d.end+=7;if(day<_25d.start){day+=7;}}return day>=_25d.start&&day<=_25d.end;};_20c._getDayOfYear=function(_25e){return date.difference(new Date(_25e.getFullYear(),0,1,_25e.getHours()),_25e)+1;};_20c._getWeekOfYear=function(_25f,_260){if(arguments.length==1){_260=0;}var _261=new Date(_25f.getFullYear(),0,1).getDay(),adj=(_261-_260+7)%7,week=Math.floor((_20c._getDayOfYear(_25f)+adj-1)/7);if(_261==_260){week++;}return week;};return _20c;});},"cb/messaging/ErrorMessage":function(){define(["dojo","./SimpleMessage"],function(dojo,_262){return dojo.declare([_262],{smErrObj:null,targetContainer:null,constructor:function(_263,_264){this.smErrObj=_263;this.targetContainer=_264;this.system=true;this.userid=_263.userId;this.inValidForChatAndMessaging=!_263.removable;var _265=_263.titleText?_263.titleText:(_263.title?_263.title:"");var msg=_263.msgText?_263.msgText:(_263.msg?_263.msg:"");this.timestamp=this.smErrObj.timestamp;this.text=(_265?_265+" ":_265)+msg;}});});},"cb/common/escapeHtml":function(){define(function(){var _266={"&":"&amp;",">":"&gt;","<":"&lt;","\"":"&quot;","'":"&#x27;","/":"&#x2f;","`":"&#x60;"},_267=/[&><"'\/`]/g;function _268(c){return _266[c];};return function escapeHtml(text){return (""+text).replace(_267,_268);};});},"cb/ext/sjcl/sjcl":function(){define(function(_269,_26a,_26b){"use strict";function q(a){throw a;};var t=void 0,u=!1;var sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(a){this.toString=function(){return "CORRUPT: "+this.message;};this.message=a;},invalid:function(a){this.toString=function(){return "INVALID: "+this.message;};this.message=a;},bug:function(a){this.toString=function(){return "BUG: "+this.message;};this.message=a;},notReady:function(a){this.toString=function(){return "NOT READY: "+this.message;};this.message=a;}}};"undefined"!==typeof _26b&&_26b.exports&&(_26b.exports=sjcl);sjcl.cipher.aes=function(a){this.k[0][0][0]||this.D();var b,c,d,e,f=this.k[0][4],g=this.k[1];b=a.length;var h=1;4!==b&&(6!==b&&8!==b)&&q(new sjcl.exception.invalid("invalid aes key size"));this.b=[d=a.slice(0),e=[]];for(a=b;a<4*b+28;a++){c=d[a-1];if(0===a%b||8===b&&4===a%b){c=f[c>>>24]<<24^f[c>>16&255]<<16^f[c>>8&255]<<8^f[c&255],0===a%b&&(c=c<<8^c>>>24^h<<24,h=h<<1^283*(h>>7));}d[a]=d[a-b]^c;}for(b=0;a;b++,a--){c=d[b&3?a:a-4],e[b]=4>=a||4>b?c:g[0][f[c>>>24]]^g[1][f[c>>16&255]]^g[2][f[c>>8&255]]^g[3][f[c&255]];}};sjcl.cipher.aes.prototype={encrypt:function(a){return y(this,a,0);},decrypt:function(a){return y(this,a,1);},k:[[[],[],[],[],[]],[[],[],[],[],[]]],D:function(){var a=this.k[0],b=this.k[1],c=a[4],d=b[4],e,f,g,h=[],l=[],k,n,m,p;for(e=0;256>e;e++){l[(h[e]=e<<1^283*(e>>7))^e]=e;}for(f=g=0;!c[f];f^=k||1,g=l[g]||1){m=g^g<<1^g<<2^g<<3^g<<4;m=m>>8^m&255^99;c[f]=m;d[m]=f;n=h[e=h[k=h[f]]];p=16843009*n^65537*e^257*k^16843008*f;n=257*h[m]^16843008*m;for(e=0;4>e;e++){a[e][f]=n=n<<24^n>>>8,b[e][m]=p=p<<24^p>>>8;}}for(e=0;5>e;e++){a[e]=a[e].slice(0),b[e]=b[e].slice(0);}}};function y(a,b,c){4!==b.length&&q(new sjcl.exception.invalid("invalid aes block size"));var d=a.b[c],e=b[0]^d[0],f=b[c?3:1]^d[1],g=b[2]^d[2];b=b[c?1:3]^d[3];var h,l,k,n=d.length/4-2,m,p=4,s=[0,0,0,0];h=a.k[c];a=h[0];var r=h[1],v=h[2],w=h[3],x=h[4];for(m=0;m<n;m++){h=a[e>>>24]^r[f>>16&255]^v[g>>8&255]^w[b&255]^d[p],l=a[f>>>24]^r[g>>16&255]^v[b>>8&255]^w[e&255]^d[p+1],k=a[g>>>24]^r[b>>16&255]^v[e>>8&255]^w[f&255]^d[p+2],b=a[b>>>24]^r[e>>16&255]^v[f>>8&255]^w[g&255]^d[p+3],p+=4,e=h,f=l,g=k;}for(m=0;4>m;m++){s[c?3&-m:m]=x[e>>>24]<<24^x[f>>16&255]<<16^x[g>>8&255]<<8^x[b&255]^d[p++],h=e,e=f,f=g,g=b,b=h;}return s;};sjcl.bitArray={bitSlice:function(a,b,c){a=sjcl.bitArray.P(a.slice(b/32),32-(b&31)).slice(1);return c===t?a:sjcl.bitArray.clamp(a,c-b);},extract:function(a,b,c){var d=Math.floor(-b-c&31);return ((b+c-1^b)&-32?a[b/32|0]<<32-d^a[b/32+1|0]>>>d:a[b/32|0]>>>d)&(1<<c)-1;},concat:function(a,b){if(0===a.length||0===b.length){return a.concat(b);}var c=a[a.length-1],d=sjcl.bitArray.getPartial(c);return 32===d?a.concat(b):sjcl.bitArray.P(b,d,c|0,a.slice(0,a.length-1));},bitLength:function(a){var b=a.length;return 0===b?0:32*(b-1)+sjcl.bitArray.getPartial(a[b-1]);},clamp:function(a,b){if(32*a.length<b){return a;}a=a.slice(0,Math.ceil(b/32));var c=a.length;b&=31;0<c&&b&&(a[c-1]=sjcl.bitArray.partial(b,a[c-1]&2147483648>>b-1,1));return a;},partial:function(a,b,c){return 32===a?b:(c?b|0:b<<32-a)+1099511627776*a;},getPartial:function(a){return Math.round(a/1099511627776)||32;},equal:function(a,b){if(sjcl.bitArray.bitLength(a)!==sjcl.bitArray.bitLength(b)){return u;}var c=0,d;for(d=0;d<a.length;d++){c|=a[d]^b[d];}return 0===c;},P:function(a,b,c,d){var e;e=0;for(d===t&&(d=[]);32<=b;b-=32){d.push(c),c=0;}if(0===b){return d.concat(a);}for(e=0;e<a.length;e++){d.push(c|a[e]>>>b),c=a[e]<<32-b;}e=a.length?a[a.length-1]:0;a=sjcl.bitArray.getPartial(e);d.push(sjcl.bitArray.partial(b+a&31,32<b+a?c:d.pop(),1));return d;},l:function(a,b){return [a[0]^b[0],a[1]^b[1],a[2]^b[2],a[3]^b[3]];}};sjcl.codec.utf8String={fromBits:function(a){var b="",c=sjcl.bitArray.bitLength(a),d,e;for(d=0;d<c/8;d++){0===(d&3)&&(e=a[d/4]),b+=String.fromCharCode(e>>>24),e<<=8;}return decodeURIComponent(escape(b));},toBits:function(a){a=unescape(encodeURIComponent(a));var b=[],c,d=0;for(c=0;c<a.length;c++){d=d<<8|a.charCodeAt(c),3===(c&3)&&(b.push(d),d=0);}c&3&&b.push(sjcl.bitArray.partial(8*(c&3),d));return b;}};sjcl.codec.hex={fromBits:function(a){var b="",c;for(c=0;c<a.length;c++){b+=((a[c]|0)+263882790666240).toString(16).substr(4);}return b.substr(0,sjcl.bitArray.bitLength(a)/4);},toBits:function(a){var b,c=[],d;a=a.replace(/\s|0x/g,"");d=a.length;a+="00000000";for(b=0;b<a.length;b+=8){c.push(parseInt(a.substr(b,8),16)^0);}return sjcl.bitArray.clamp(c,4*d);}};sjcl.codec.base64={J:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(a,b,c){var d="",e=0,f=sjcl.codec.base64.J,g=0,h=sjcl.bitArray.bitLength(a);c&&(f=f.substr(0,62)+"-_");for(c=0;6*d.length<=h;){d+=f.charAt((g^a[c]>>>e)>>>26),6>e?(g=a[c]<<6-e,e+=26,c++):(g<<=6,e-=6);}for(;d.length&3&&!b;){d+="=";}return d;},toBits:function(a,b){a=a.replace(/\s|=/g,"");var c=[],d,e=0,f=sjcl.codec.base64.J,g=0,h;b&&(f=f.substr(0,62)+"-_");for(d=0;d<a.length;d++){h=f.indexOf(a.charAt(d)),0>h&&q(new sjcl.exception.invalid("this isn't base64!")),26<e?(e-=26,c.push(g^h>>>e),g=h<<32-e):(e+=6,g^=h<<32-e);}e&56&&c.push(sjcl.bitArray.partial(e&56,g,1));return c;}};sjcl.codec.base64url={fromBits:function(a){return sjcl.codec.base64.fromBits(a,1,1);},toBits:function(a){return sjcl.codec.base64.toBits(a,1);}};sjcl.hash.sha256=function(a){this.b[0]||this.D();a?(this.r=a.r.slice(0),this.o=a.o.slice(0),this.h=a.h):this.reset();};sjcl.hash.sha256.hash=function(a){return (new sjcl.hash.sha256).update(a).finalize();};sjcl.hash.sha256.prototype={blockSize:512,reset:function(){this.r=this.N.slice(0);this.o=[];this.h=0;return this;},update:function(a){"string"===typeof a&&(a=sjcl.codec.utf8String.toBits(a));var b,c=this.o=sjcl.bitArray.concat(this.o,a);b=this.h;a=this.h=b+sjcl.bitArray.bitLength(a);for(b=512+b&-512;b<=a;b+=512){z(this,c.splice(0,16));}return this;},finalize:function(){var a,b=this.o,c=this.r,b=sjcl.bitArray.concat(b,[sjcl.bitArray.partial(1,1)]);for(a=b.length+2;a&15;a++){b.push(0);}b.push(Math.floor(this.h/4294967296));for(b.push(this.h|0);b.length;){z(this,b.splice(0,16));}this.reset();return c;},N:[],b:[],D:function(){function a(a){return 4294967296*(a-Math.floor(a))|0;};var b=0,c=2,d;a:for(;64>b;c++){for(d=2;d*d<=c;d++){if(0===c%d){continue a;}}8>b&&(this.N[b]=a(Math.pow(c,0.5)));this.b[b]=a(Math.pow(c,1/3));b++;}}};function z(a,b){var c,d,e,f=b.slice(0),g=a.r,h=a.b,l=g[0],k=g[1],n=g[2],m=g[3],p=g[4],s=g[5],r=g[6],v=g[7];for(c=0;64>c;c++){16>c?d=f[c]:(d=f[c+1&15],e=f[c+14&15],d=f[c&15]=(d>>>7^d>>>18^d>>>3^d<<25^d<<14)+(e>>>17^e>>>19^e>>>10^e<<15^e<<13)+f[c&15]+f[c+9&15]|0),d=d+v+(p>>>6^p>>>11^p>>>25^p<<26^p<<21^p<<7)+(r^p&(s^r))+h[c],v=r,r=s,s=p,p=m+d|0,m=n,n=k,k=l,l=d+(k&n^m&(k^n))+(k>>>2^k>>>13^k>>>22^k<<30^k<<19^k<<10)|0;}g[0]=g[0]+l|0;g[1]=g[1]+k|0;g[2]=g[2]+n|0;g[3]=g[3]+m|0;g[4]=g[4]+p|0;g[5]=g[5]+s|0;g[6]=g[6]+r|0;g[7]=g[7]+v|0;};sjcl.mode.ccm={name:"ccm",encrypt:function(a,b,c,d,e){var f,g=b.slice(0),h=sjcl.bitArray,l=h.bitLength(c)/8,k=h.bitLength(g)/8;e=e||64;d=d||[];7>l&&q(new sjcl.exception.invalid("ccm: iv must be at least 7 bytes"));for(f=2;4>f&&k>>>8*f;f++){}f<15-l&&(f=15-l);c=h.clamp(c,8*(15-f));b=sjcl.mode.ccm.L(a,b,c,d,e,f);g=sjcl.mode.ccm.p(a,g,c,b,e,f);return h.concat(g.data,g.tag);},decrypt:function(a,b,c,d,e){e=e||64;d=d||[];var f=sjcl.bitArray,g=f.bitLength(c)/8,h=f.bitLength(b),l=f.clamp(b,h-e),k=f.bitSlice(b,h-e),h=(h-e)/8;7>g&&q(new sjcl.exception.invalid("ccm: iv must be at least 7 bytes"));for(b=2;4>b&&h>>>8*b;b++){}b<15-g&&(b=15-g);c=f.clamp(c,8*(15-b));l=sjcl.mode.ccm.p(a,l,c,k,e,b);a=sjcl.mode.ccm.L(a,l.data,c,d,e,b);f.equal(l.tag,a)||q(new sjcl.exception.corrupt("ccm: tag doesn't match"));return l.data;},L:function(a,b,c,d,e,f){var g=[],h=sjcl.bitArray,l=h.l;e/=8;(e%2||4>e||16<e)&&q(new sjcl.exception.invalid("ccm: invalid tag length"));(4294967295<d.length||4294967295<b.length)&&q(new sjcl.exception.bug("ccm: can't deal with 4GiB or more data"));f=[h.partial(8,(d.length?64:0)|e-2<<2|f-1)];f=h.concat(f,c);f[3]|=h.bitLength(b)/8;f=a.encrypt(f);if(d.length){c=h.bitLength(d)/8;65279>=c?g=[h.partial(16,c)]:4294967295>=c&&(g=h.concat([h.partial(16,65534)],[c]));g=h.concat(g,d);for(d=0;d<g.length;d+=4){f=a.encrypt(l(f,g.slice(d,d+4).concat([0,0,0])));}}for(d=0;d<b.length;d+=4){f=a.encrypt(l(f,b.slice(d,d+4).concat([0,0,0])));}return h.clamp(f,8*e);},p:function(a,b,c,d,e,f){var g,h=sjcl.bitArray;g=h.l;var l=b.length,k=h.bitLength(b);c=h.concat([h.partial(8,f-1)],c).concat([0,0,0]).slice(0,4);d=h.bitSlice(g(d,a.encrypt(c)),0,e);if(!l){return {tag:d,data:[]};}for(g=0;g<l;g+=4){c[3]++,e=a.encrypt(c),b[g]^=e[0],b[g+1]^=e[1],b[g+2]^=e[2],b[g+3]^=e[3];}return {tag:d,data:h.clamp(b,k)};}};sjcl.mode.ocb2={name:"ocb2",encrypt:function(a,b,c,d,e,f){128!==sjcl.bitArray.bitLength(c)&&q(new sjcl.exception.invalid("ocb iv must be 128 bits"));var g,h=sjcl.mode.ocb2.H,l=sjcl.bitArray,k=l.l,n=[0,0,0,0];c=h(a.encrypt(c));var m,p=[];d=d||[];e=e||64;for(g=0;g+4<b.length;g+=4){m=b.slice(g,g+4),n=k(n,m),p=p.concat(k(c,a.encrypt(k(c,m)))),c=h(c);}m=b.slice(g);b=l.bitLength(m);g=a.encrypt(k(c,[0,0,0,b]));m=l.clamp(k(m.concat([0,0,0]),g),b);n=k(n,k(m.concat([0,0,0]),g));n=a.encrypt(k(n,k(c,h(c))));d.length&&(n=k(n,f?d:sjcl.mode.ocb2.pmac(a,d)));return p.concat(l.concat(m,l.clamp(n,e)));},decrypt:function(a,b,c,d,e,f){128!==sjcl.bitArray.bitLength(c)&&q(new sjcl.exception.invalid("ocb iv must be 128 bits"));e=e||64;var g=sjcl.mode.ocb2.H,h=sjcl.bitArray,l=h.l,k=[0,0,0,0],n=g(a.encrypt(c)),m,p,s=sjcl.bitArray.bitLength(b)-e,r=[];d=d||[];for(c=0;c+4<s/32;c+=4){m=l(n,a.decrypt(l(n,b.slice(c,c+4)))),k=l(k,m),r=r.concat(m),n=g(n);}p=s-32*c;m=a.encrypt(l(n,[0,0,0,p]));m=l(m,h.clamp(b.slice(c),p).concat([0,0,0]));k=l(k,m);k=a.encrypt(l(k,l(n,g(n))));d.length&&(k=l(k,f?d:sjcl.mode.ocb2.pmac(a,d)));h.equal(h.clamp(k,e),h.bitSlice(b,s))||q(new sjcl.exception.corrupt("ocb: tag doesn't match"));return r.concat(h.clamp(m,p));},pmac:function(a,b){var c,d=sjcl.mode.ocb2.H,e=sjcl.bitArray,f=e.l,g=[0,0,0,0],h=a.encrypt([0,0,0,0]),h=f(h,d(d(h)));for(c=0;c+4<b.length;c+=4){h=d(h),g=f(g,a.encrypt(f(h,b.slice(c,c+4))));}c=b.slice(c);128>e.bitLength(c)&&(h=f(h,d(h)),c=e.concat(c,[-2147483648,0,0,0]));g=f(g,c);return a.encrypt(f(d(f(h,d(h))),g));},H:function(a){return [a[0]<<1^a[1]>>>31,a[1]<<1^a[2]>>>31,a[2]<<1^a[3]>>>31,a[3]<<1^135*(a[0]>>>31)];}};sjcl.mode.gcm={name:"gcm",encrypt:function(a,b,c,d,e){var f=b.slice(0);b=sjcl.bitArray;d=d||[];a=sjcl.mode.gcm.p(!0,a,f,d,c,e||128);return b.concat(a.data,a.tag);},decrypt:function(a,b,c,d,e){var f=b.slice(0),g=sjcl.bitArray,h=g.bitLength(f);e=e||128;d=d||[];e<=h?(b=g.bitSlice(f,h-e),f=g.bitSlice(f,0,h-e)):(b=f,f=[]);a=sjcl.mode.gcm.p(u,a,f,d,c,e);g.equal(a.tag,b)||q(new sjcl.exception.corrupt("gcm: tag doesn't match"));return a.data;},Z:function(a,b){var c,d,e,f,g,h=sjcl.bitArray.l;e=[0,0,0,0];f=b.slice(0);for(c=0;128>c;c++){(d=0!==(a[Math.floor(c/32)]&1<<31-c%32))&&(e=h(e,f));g=0!==(f[3]&1);for(d=3;0<d;d--){f[d]=f[d]>>>1|(f[d-1]&1)<<31;}f[0]>>>=1;g&&(f[0]^=-520093696);}return e;},g:function(a,b,c){var d,e=c.length;b=b.slice(0);for(d=0;d<e;d+=4){b[0]^=4294967295&c[d],b[1]^=4294967295&c[d+1],b[2]^=4294967295&c[d+2],b[3]^=4294967295&c[d+3],b=sjcl.mode.gcm.Z(b,a);}return b;},p:function(a,b,c,d,e,f){var g,h,l,k,n,m,p,s,r=sjcl.bitArray;m=c.length;p=r.bitLength(c);s=r.bitLength(d);h=r.bitLength(e);g=b.encrypt([0,0,0,0]);96===h?(e=e.slice(0),e=r.concat(e,[1])):(e=sjcl.mode.gcm.g(g,[0,0,0,0],e),e=sjcl.mode.gcm.g(g,e,[0,0,Math.floor(h/4294967296),h&4294967295]));h=sjcl.mode.gcm.g(g,[0,0,0,0],d);n=e.slice(0);d=h.slice(0);a||(d=sjcl.mode.gcm.g(g,h,c));for(k=0;k<m;k+=4){n[3]++,l=b.encrypt(n),c[k]^=l[0],c[k+1]^=l[1],c[k+2]^=l[2],c[k+3]^=l[3];}c=r.clamp(c,p);a&&(d=sjcl.mode.gcm.g(g,h,c));a=[Math.floor(s/4294967296),s&4294967295,Math.floor(p/4294967296),p&4294967295];d=sjcl.mode.gcm.g(g,d,a);l=b.encrypt(e);d[0]^=l[0];d[1]^=l[1];d[2]^=l[2];d[3]^=l[3];return {tag:r.bitSlice(d,0,f),data:c};}};sjcl.misc.hmac=function(a,b){this.M=b=b||sjcl.hash.sha256;var c=[[],[]],d,e=b.prototype.blockSize/32;this.n=[new b,new b];a.length>e&&(a=b.hash(a));for(d=0;d<e;d++){c[0][d]=a[d]^909522486,c[1][d]=a[d]^1549556828;}this.n[0].update(c[0]);this.n[1].update(c[1]);this.G=new b(this.n[0]);};sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(a){this.Q&&q(new sjcl.exception.invalid("encrypt on already updated hmac called!"));this.update(a);return this.digest(a);};sjcl.misc.hmac.prototype.reset=function(){this.G=new this.M(this.n[0]);this.Q=u;};sjcl.misc.hmac.prototype.update=function(a){this.Q=!0;this.G.update(a);};sjcl.misc.hmac.prototype.digest=function(){var a=this.G.finalize(),a=(new this.M(this.n[1])).update(a).finalize();this.reset();return a;};sjcl.misc.pbkdf2=function(a,b,c,d,e){c=c||1000;(0>d||0>c)&&q(sjcl.exception.invalid("invalid params to pbkdf2"));"string"===typeof a&&(a=sjcl.codec.utf8String.toBits(a));"string"===typeof b&&(b=sjcl.codec.utf8String.toBits(b));e=e||sjcl.misc.hmac;a=new e(a);var f,g,h,l,k=[],n=sjcl.bitArray;for(l=1;32*k.length<(d||1);l++){e=f=a.encrypt(n.concat(b,[l]));for(g=1;g<c;g++){f=a.encrypt(f);for(h=0;h<f.length;h++){e[h]^=f[h];}}k=k.concat(e);}d&&(k=n.clamp(k,d));return k;};sjcl.prng=function(a){this.c=[new sjcl.hash.sha256];this.i=[0];this.F=0;this.s={};this.C=0;this.K={};this.O=this.d=this.j=this.W=0;this.b=[0,0,0,0,0,0,0,0];this.f=[0,0,0,0];this.A=t;this.B=a;this.q=u;this.w={progress:{},seeded:{}};this.m=this.V=0;this.t=1;this.u=2;this.S=65536;this.I=[0,48,64,96,128,192,256,384,512,768,1024];this.T=30000;this.R=80;};sjcl.prng.prototype={randomWords:function(a,b){var c=[],d;d=this.isReady(b);var e;d===this.m&&q(new sjcl.exception.notReady("generator isn't seeded"));if(d&this.u){d=!(d&this.t);e=[];var f=0,g;this.O=e[0]=(new Date).valueOf()+this.T;for(g=0;16>g;g++){e.push(4294967296*Math.random()|0);}for(g=0;g<this.c.length&&!(e=e.concat(this.c[g].finalize()),f+=this.i[g],this.i[g]=0,!d&&this.F&1<<g);g++){}this.F>=1<<this.c.length&&(this.c.push(new sjcl.hash.sha256),this.i.push(0));this.d-=f;f>this.j&&(this.j=f);this.F++;this.b=sjcl.hash.sha256.hash(this.b.concat(e));this.A=new sjcl.cipher.aes(this.b);for(d=0;4>d&&!(this.f[d]=this.f[d]+1|0,this.f[d]);d++){}}for(d=0;d<a;d+=4){0===(d+1)%this.S&&A(this),e=B(this),c.push(e[0],e[1],e[2],e[3]);}A(this);return c.slice(0,a);},setDefaultParanoia:function(a,b){0===a&&"Setting paranoia=0 will ruin your security; use it only for testing"!==b&&q("Setting paranoia=0 will ruin your security; use it only for testing");this.B=a;},addEntropy:function(a,b,c){c=c||"user";var d,e,f=(new Date).valueOf(),g=this.s[c],h=this.isReady(),l=0;d=this.K[c];d===t&&(d=this.K[c]=this.W++);g===t&&(g=this.s[c]=0);this.s[c]=(this.s[c]+1)%this.c.length;switch(typeof a){case "number":b===t&&(b=1);this.c[g].update([d,this.C++,1,b,f,1,a|0]);break;case "object":c=Object.prototype.toString.call(a);if("[object Uint32Array]"===c){e=[];for(c=0;c<a.length;c++){e.push(a[c]);}a=e;}else{"[object Array]"!==c&&(l=1);for(c=0;c<a.length&&!l;c++){"number"!==typeof a[c]&&(l=1);}}if(!l){if(b===t){for(c=b=0;c<a.length;c++){for(e=a[c];0<e;){b++,e>>>=1;}}}this.c[g].update([d,this.C++,2,b,f,a.length].concat(a));}break;case "string":b===t&&(b=a.length);this.c[g].update([d,this.C++,3,b,f,a.length]);this.c[g].update(a);break;default:l=1;}l&&q(new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string"));this.i[g]+=b;this.d+=b;h===this.m&&(this.isReady()!==this.m&&C("seeded",Math.max(this.j,this.d)),C("progress",this.getProgress()));},isReady:function(a){a=this.I[a!==t?a:this.B];return this.j&&this.j>=a?this.i[0]>this.R&&(new Date).valueOf()>this.O?this.u|this.t:this.t:this.d>=a?this.u|this.m:this.m;},getProgress:function(a){a=this.I[a?a:this.B];return this.j>=a?1:this.d>a?1:this.d/a;},startCollectors:function(){this.q||(this.a={loadTimeCollector:D(this,this.aa),mouseCollector:D(this,this.ba),keyboardCollector:D(this,this.$),accelerometerCollector:D(this,this.U)},window.addEventListener?(window.addEventListener("load",this.a.loadTimeCollector,u),window.addEventListener("mousemove",this.a.mouseCollector,u),window.addEventListener("keypress",this.a.keyboardCollector,u),window.addEventListener("devicemotion",this.a.accelerometerCollector,u)):document.attachEvent?(document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector)):q(new sjcl.exception.bug("can't attach event")),this.q=!0);},stopCollectors:function(){this.q&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,u),window.removeEventListener("mousemove",this.a.mouseCollector,u),window.removeEventListener("keypress",this.a.keyboardCollector,u),window.removeEventListener("devicemotion",this.a.accelerometerCollector,u)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.q=u);},addEventListener:function(a,b){this.w[a][this.V++]=b;},removeEventListener:function(a,b){var c,d,e=this.w[a],f=[];for(d in e){e.hasOwnProperty(d)&&e[d]===b&&f.push(d);}for(c=0;c<f.length;c++){d=f[c],delete e[d];}},$:function(){E(1);},ba:function(a){sjcl.random.addEntropy([a.x||a.clientX||a.offsetX||0,a.y||a.clientY||a.offsetY||0],2,"mouse");E(0);},aa:function(){E(2);},U:function(a){a=a.accelerationIncludingGravity.x||a.accelerationIncludingGravity.y||a.accelerationIncludingGravity.z;if(window.orientation){var b=window.orientation;"number"===typeof b&&sjcl.random.addEntropy(b,1,"accelerometer");}a&&sjcl.random.addEntropy(a,2,"accelerometer");E(0);}};function C(a,b){var c,d=sjcl.random.w[a],e=[];for(c in d){d.hasOwnProperty(c)&&e.push(d[c]);}for(c=0;c<e.length;c++){e[c](b);}};function E(a){window&&window.performance&&"function"===typeof window.performance.now?sjcl.random.addEntropy(window.performance.now(),a,"loadtime"):sjcl.random.addEntropy((new Date).valueOf(),a,"loadtime");};function A(a){a.b=B(a).concat(B(a));a.A=new sjcl.cipher.aes(a.b);};function B(a){for(var b=0;4>b&&!(a.f[b]=a.f[b]+1|0,a.f[b]);b++){}return a.A.encrypt(a.f);};function D(a,b){return function(){b.apply(a,arguments);};};sjcl.random=new sjcl.prng(6);a:try{var F,G,H,I;if(I="undefined"!==typeof _26b){var J;if(J=_26b.exports){var K;try{K=_269("crypto");}catch(L){K=null;}J=(G=K)&&G.randomBytes;}I=J;}if(I){F=G.randomBytes(128),F=new Uint32Array((new Uint8Array(F)).buffer),sjcl.random.addEntropy(F,1024,"crypto['randomBytes']");}else{if(window&&Uint32Array){H=new Uint32Array(32);if(window.crypto&&window.crypto.getRandomValues){window.crypto.getRandomValues(H);}else{if(window.msCrypto&&window.msCrypto.getRandomValues){window.msCrypto.getRandomValues(H);}else{break a;}}sjcl.random.addEntropy(H,1024,"crypto['getRandomValues']");}}}catch(M){"undefined"!==typeof window&&window.console&&(undefined,undefined);}sjcl.json={defaults:{v:1,iter:1000,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},Y:function(a,b,c,d){c=c||{};d=d||{};var e=sjcl.json,f=e.e({iv:sjcl.random.randomWords(4,0)},e.defaults),g;e.e(f,c);c=f.adata;"string"===typeof f.salt&&(f.salt=sjcl.codec.base64.toBits(f.salt));"string"===typeof f.iv&&(f.iv=sjcl.codec.base64.toBits(f.iv));(!sjcl.mode[f.mode]||!sjcl.cipher[f.cipher]||"string"===typeof a&&100>=f.iter||64!==f.ts&&96!==f.ts&&128!==f.ts||128!==f.ks&&192!==f.ks&&256!==f.ks||2>f.iv.length||4<f.iv.length)&&q(new sjcl.exception.invalid("json encrypt: invalid parameters"));"string"===typeof a?(g=sjcl.misc.cachedPbkdf2(a,f),a=g.key.slice(0,f.ks/32),f.salt=g.salt):sjcl.ecc&&a instanceof sjcl.ecc.elGamal.publicKey&&(g=a.kem(),f.kemtag=g.tag,a=g.key.slice(0,f.ks/32));"string"===typeof b&&(b=sjcl.codec.utf8String.toBits(b));"string"===typeof c&&(c=sjcl.codec.utf8String.toBits(c));g=new sjcl.cipher[f.cipher](a);e.e(d,f);d.key=a;f.ct=sjcl.mode[f.mode].encrypt(g,b,f.iv,c,f.ts);return f;},encrypt:function(a,b,c,d){var e=sjcl.json,f=e.Y.apply(e,arguments);return e.encode(f);},X:function(a,b,c,d){c=c||{};d=d||{};var e=sjcl.json;b=e.e(e.e(e.e({},e.defaults),b),c,!0);var f;c=b.adata;"string"===typeof b.salt&&(b.salt=sjcl.codec.base64.toBits(b.salt));"string"===typeof b.iv&&(b.iv=sjcl.codec.base64.toBits(b.iv));(!sjcl.mode[b.mode]||!sjcl.cipher[b.cipher]||"string"===typeof a&&100>=b.iter||64!==b.ts&&96!==b.ts&&128!==b.ts||128!==b.ks&&192!==b.ks&&256!==b.ks||!b.iv||2>b.iv.length||4<b.iv.length)&&q(new sjcl.exception.invalid("json decrypt: invalid parameters"));"string"===typeof a?(f=sjcl.misc.cachedPbkdf2(a,b),a=f.key.slice(0,b.ks/32),b.salt=f.salt):sjcl.ecc&&a instanceof sjcl.ecc.elGamal.secretKey&&(a=a.unkem(sjcl.codec.base64.toBits(b.kemtag)).slice(0,b.ks/32));"string"===typeof c&&(c=sjcl.codec.utf8String.toBits(c));f=new sjcl.cipher[b.cipher](a);c=sjcl.mode[b.mode].decrypt(f,b.ct,b.iv,c,b.ts);e.e(d,b);d.key=a;return sjcl.codec.utf8String.fromBits(c);},decrypt:function(a,b,c,d){var e=sjcl.json;return e.X(a,e.decode(b),c,d);},encode:function(a){var b,c="{",d="";for(b in a){if(a.hasOwnProperty(b)){switch(b.match(/^[a-z0-9]+$/i)||q(new sjcl.exception.invalid("json encode: invalid property name")),c+=d+"\""+b+"\":",d=",",typeof a[b]){case "number":case "boolean":c+=a[b];break;case "string":c+="\""+escape(a[b])+"\"";break;case "object":c+="\""+sjcl.codec.base64.fromBits(a[b],0)+"\"";break;default:q(new sjcl.exception.bug("json encode: unsupported type"));}}}return c+"}";},decode:function(a){a=a.replace(/\s/g,"");a.match(/^\{.*\}$/)||q(new sjcl.exception.invalid("json decode: this isn't json!"));a=a.replace(/^\{|\}$/g,"").split(/,/);var b={},c,d;for(c=0;c<a.length;c++){(d=a[c].match(/^(?:(["']?)([a-z][a-z0-9]*)\1):(?:(\d+)|"([a-z0-9+\/%*_.@=\-]*)")$/i))||q(new sjcl.exception.invalid("json decode: this isn't json!")),b[d[2]]=d[3]?parseInt(d[3],10):d[2].match(/^(ct|salt|iv)$/)?sjcl.codec.base64.toBits(d[4]):unescape(d[4]);}return b;},e:function(a,b,c){a===t&&(a={});if(b===t){return a;}for(var d in b){b.hasOwnProperty(d)&&(c&&(a[d]!==t&&a[d]!==b[d])&&q(new sjcl.exception.invalid("required parameter overridden")),a[d]=b[d]);}return a;},ea:function(a,b){var c={},d;for(d in a){a.hasOwnProperty(d)&&a[d]!==b[d]&&(c[d]=a[d]);}return c;},da:function(a,b){var c={},d;for(d=0;d<b.length;d++){a[b[d]]!==t&&(c[b[d]]=a[b[d]]);}return c;}};sjcl.encrypt=sjcl.json.encrypt;sjcl.decrypt=sjcl.json.decrypt;sjcl.misc.ca={};sjcl.misc.cachedPbkdf2=function(a,b){var c=sjcl.misc.ca,d;b=b||{};d=b.iter||1000;c=c[a]=c[a]||{};d=c[d]=c[d]||{firstSalt:b.salt&&b.salt.length?b.salt.slice(0):sjcl.random.randomWords(2,0)};c=b.salt===t?d.firstSalt:b.salt;d[c]=d[c]||sjcl.misc.pbkdf2(a,c,b.iter);return {key:d[c].slice(0),salt:c.slice(0)};};});},"sp/I18n":function(){define(["dijit","dojo","dojox","dojo/i18n!sp/nls/I18n","dojo/require!dojo/i18n,dojo/string,dojo/date/locale,cb/common/escapeHtml,cb/common/escapeHtmlAttr"],function(_26c,dojo,_26d){dojo.provide("sp.I18n");dojo.require("dojo.i18n");dojo.require("dojo.string");dojo.require("dojo.date.locale");dojo.require("cb.common.escapeHtml");dojo.require("cb.common.escapeHtmlAttr");dojo.requireLocalization("sp","I18n");dojo.mixin(sp.I18n,{require:function(){return dojo.requireLocalization.apply(this,arguments);},get:function(){var _26e=Array.prototype.slice.call(arguments,0);if(_26e.length===0){_26e.push("sp");_26e.push("I18n");}sp.I18n.require.apply(this,_26e);return function(key,_26f,_270,_271){var _272=dojo.i18n.getLocalization.apply(this,_26e);return sp.I18n._resolve(_272,key,_26f,_270,_271);};},esc:function(v){return (v===null||v===undefined)?"":cb.common.escapeHtml(v);},escAttr:function(v){return (v===null||v===undefined)?"":cb.common.escapeHtmlAttr(v);},wrap:function(_273){return function(key,_274,_275,_276){try{return sp.I18n._resolve(_273,key,_274,_275,_276);}catch(error){return "";}};},wrapToEmpty:function(_277){return function(key){var ret=sp.I18n.wrap(_277).apply(null,arguments);if(ret===key||!ret){return "";}return ret;};},_createDefaultTransform:function(map){return function transform(_278,key){_278=(_278===undefined||_278===null)?"":_278;if(key.charAt(0)==="!"){_278=dojo.getObject(key.substr(1),false,map);return _278;}else{return cb.common.escapeHtml(_278);}};},_resolve:function(_279,key,_27a,_27b,_27c){var ret=_279[key];if(!ret&&ret!==""){return key;}var _27d=Array.prototype.slice.call(arguments,1);_27d[0]=ret;_27d[1]=_27d[1]||{};_27d[2]=_27d[2]||sp.I18n._createDefaultTransform(_27d[1]);_27d[3]=dojo.mixin({},sp.I18n.defaultTransforms,_27d[3]||{});return dojo.string.substitute.apply(this,_27d);},bundle:function(){sp.I18n.require.apply(this,arguments);return dojo.i18n.getLocalization.apply(this,arguments);},defaultTransforms:{date:function(_27e){var _27f;if(dojo.isString(_27e)){_27f=dojo.date.stamp.fromISOString(_27e);}else{_27f=_27e;}if(!_27f){return _27e;}return dojo.date.locale.format(_27f,{selector:"date"});},datelong:function(_280){var _281;if(dojo.isString(_280)){_281=dojo.date.stamp.fromISOString(_280);}else{_281=_280;}if(!_281){return _280;}return dojo.date.locale.format(_281,{selector:"date",formatLength:"long"});},datetime:function(_282){var _283;if(dojo.isString(_282)){_283=dojo.date.stamp.fromISOString(_282);}else{_283=_282;}if(!_283){return _282;}return dojo.date.locale.format(_283);},time:function(_284){var _285;if(dojo.isString(_284)){_285=dojo.date.stamp.fromISOString(_284);}else{_285=_284;}if(!_285){return _284;}return dojo.date.locale.format(_285,{selector:"time"});},customtime:function(_286){var _287;var _288=_286.splice(0,1);var _289=_286.splice(0,1);if(dojo.isString(_288)){_287=dojo.date.stamp.fromISOString(_288);}else{_287=_288;}if(!_287){return _288;}return dojo.date.locale.format(_288,{timePattern:_289,selector:"time"});},customdate:function(_28a){var _28b;var _28c=_28a.splice(0,1);var _28d=_28a.splice(0,1);if(dojo.isString(_28c)){_28b=dojo.date.stamp.fromISOString(_28c);}else{_28b=_28c;}if(!_28b){return _28c;}return dojo.date.locale.format(_28b,{timePattern:_28d,selector:"date"});},join:function(_28e){var _28f=_28e.splice(0,1);return dojo.filter(_28e,function(v){return !!v;}).join(_28f);},joinLanguageAnd:function(_290){var _291=dojo.filter(_290,function(v){return !!v;});if(_291.length===1){return _291[0];}var _292=sp.I18n.BASE_BUNDLE("language_joiner");var _293=sp.I18n.BASE_BUNDLE("language_joiner_last_and");return _291.splice(0,_291.length-1).join(_292)+_293+_291[0];},encodeURIComponent:function(_294){return encodeURIComponent(_294);},escapeHtml:cb.common.escapeHtml}});sp.I18n.BASE_BUNDLE=sp.I18n.get("sp","I18n");});},"dojox/lang/functional/object":function(){define("dojox/lang/functional/object",["dojo/_base/kernel","dojo/_base/lang","./lambda"],function(_295,lang,df){var _296={};lang.mixin(df,{keys:function(obj){var t=[];for(var i in obj){if(!(i in _296)){t.push(i);}}return t;},values:function(obj){var t=[];for(var i in obj){if(!(i in _296)){t.push(obj[i]);}}return t;},filterIn:function(obj,f,o){o=o||_295.global;f=df.lambda(f);var t={},v,i;for(i in obj){if(!(i in _296)){v=obj[i];if(f.call(o,v,i,obj)){t[i]=v;}}}return t;},forIn:function(obj,f,o){o=o||_295.global;f=df.lambda(f);for(var i in obj){if(!(i in _296)){f.call(o,obj[i],i,obj);}}return o;},mapIn:function(obj,f,o){o=o||_295.global;f=df.lambda(f);var t={},i;for(i in obj){if(!(i in _296)){t[i]=f.call(o,obj[i],i,obj);}}return t;}});return df;});},"*now":function(r){r(["dojo/i18n!*preload*layer/nls/xdomainstorage*[\"en\",\"de\",\"fr\",\"ROOT\"]"]);}}});define("layer/xdomainstorage",["cb/xdomain/storage/ServerPage"],function(){return true;});
////@ sourceURL=/_/js-master-REL-153/layer/xdomainstorage.js