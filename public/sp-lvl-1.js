//>>built
require({cache:{"dojox/data/AndOrReadStore":function(){define("dojox/data/AndOrReadStore",["dojo/_base/declare","dojo/_base/lang","dojo/data/ItemFileReadStore","dojo/data/util/filter","dojo/_base/array","dojo/_base/json"],function(_1,_2,_3,_4,_5,_6){return _1("dojox.data.AndOrReadStore",[_3],{_containsValue:function(_7,_8,_9,_a){return _5.some(this.getValues(_7,_8),function(_b){if(_2.isString(_a)){return eval(_a);}else{if(_b!==null&&!_2.isObject(_b)&&_a){if(_b.toString().match(_a)){return true;}}else{if(_9===_b){return true;}else{return false;}}}});},filter:function(_c,_d,_e){var _f=[];if(_c.query){var _10=_6.fromJson(_6.toJson(_c.query));if(typeof _10=="object"){var _11=0;var p;for(p in _10){_11++;}if(_11>1&&_10.complexQuery){var cq=_10.complexQuery;var _12=false;for(p in _10){if(p!=="complexQuery"){if(!_12){cq="( "+cq+" )";_12=true;}var v=_c.query[p];if(_2.isString(v)){v="'"+v+"'";}cq+=" AND "+p+":"+v;delete _10[p];}}_10.complexQuery=cq;}}var _13=_c.queryOptions?_c.queryOptions.ignoreCase:false;if(typeof _10!="string"){_10=_6.toJson(_10);_10=_10.replace(/\\\\/g,"\\");}_10=_10.replace(/\\"/g,"\"");var _14=_2.trim(_10.replace(/{|}/g,""));var _15,i;if(_14.match(/"? *complexQuery *"?:/)){_14=_2.trim(_14.replace(/"?\s*complexQuery\s*"?:/,""));var _16=["'","\""];var _17,_18;var _19=false;for(i=0;i<_16.length;i++){_17=_14.indexOf(_16[i]);_15=_14.indexOf(_16[i],1);_18=_14.indexOf(":",1);if(_17===0&&_15!=-1&&_18<_15){_19=true;break;}}if(_19){_14=_14.replace(/^\"|^\'|\"$|\'$/g,"");}}var _1a=_14;var _1b=/^>=|^<=|^<|^>|^,|^NOT |^AND |^OR |^\(|^\)|^!|^&&|^\|\|/i;var _1c="";var op="";var val="";var pos=-1;var err=false;var key="";var _1d="";var tok="";_15=-1;for(i=0;i<_d.length;++i){var _1e=true;var _1f=_d[i];if(_1f===null){_1e=false;}else{_14=_1a;_1c="";while(_14.length>0&&!err){op=_14.match(_1b);while(op&&!err){_14=_2.trim(_14.replace(op[0],""));op=_2.trim(op[0]).toUpperCase();op=op=="NOT"?"!":op=="AND"||op==","?"&&":op=="OR"?"||":op;op=" "+op+" ";_1c+=op;op=_14.match(_1b);}if(_14.length>0){var _20=/:|>=|<=|>|</g,_21=_14.match(_20),_1e=_21&&_21.shift(),_22;pos=_14.indexOf(_1e);if(pos==-1){err=true;break;}else{key=_2.trim(_14.substring(0,pos).replace(/\"|\'/g,""));_14=_2.trim(_14.substring(pos+_1e.length));tok=_14.match(/^\'|^\"/);if(tok){tok=tok[0];pos=_14.indexOf(tok);_15=_14.indexOf(tok,pos+1);if(_15==-1){err=true;break;}_1d=_14.substring(pos+_1e.length,_15);if(_15==_14.length-1){_14="";}else{_14=_2.trim(_14.substring(_15+1));}if(_1e!=":"){_22=this.getValue(_1f,key)+_1e+_1d;}else{_22=_4.patternToRegExp(_1d,_13);}_1c+=this._containsValue(_1f,key,_1d,_22);}else{tok=_14.match(/\s|\)|,/);if(tok){var _23=new Array(tok.length);for(var j=0;j<tok.length;j++){_23[j]=_14.indexOf(tok[j]);}pos=_23[0];if(_23.length>1){for(var j=1;j<_23.length;j++){pos=Math.min(pos,_23[j]);}}_1d=_2.trim(_14.substring(0,pos));_14=_2.trim(_14.substring(pos));}else{_1d=_2.trim(_14);_14="";}if(_1e!=":"){_22=this.getValue(_1f,key)+_1e+_1d;}else{_22=_4.patternToRegExp(_1d,_13);}_1c+=this._containsValue(_1f,key,_1d,_22);}}}}_1e=eval(_1c);}if(_1e){_f.push(_1f);}}if(err){_f=[];}}else{for(var i=0;i<_d.length;++i){var _24=_d[i];if(_24!==null){_f.push(_24);}}}_e(_f,_c);}});});},"cb/widget/CreateBoard":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/dom-construct","dojo/dom-class","dojo/dom-attr","dojo/html","dojo/topic","dojo/promise/all","dijit/_Widget","cb/util","sp/dialog/NewBoardDialog","cb/Capabilities","sp/I18n","sp/ajax/AjaxEngine","sp/infos/InfoManager","dojo/i18n!./nls/CreateBoard"],function(_25,_26,_27,_28,_29,_2a,_2b,_2c,_2d,_2e,_2f,_30,_31,_32,_33,_34){var _35="<i class=\"icon\">+</i>"+_31.wrap(_34)("anonymous_new_board");var _36="<i class=\"icon\">+</i><span class=\"label\">"+_31.wrap(_34)("new_board")+"</span>";var _37="– "+_31.wrap(_34)("no_free_space")+" –";return _25([_2d],{baseClass:"new-board",fullWidth:false,callToAction:false,secondary:false,demoBoardsLabel:false,portfolioId:null,redirectOnSuccess:true,postMixInProperties:function(){this.inherited(arguments);if(this.portfolioId===null&&sp.info.document&&sp.info.document.document){this.portfolioId=sp.info.document.document.projectId;}},buildRendering:function(){this.domNode=_27.create("a",{"class":"button new-board-button"},this.domNode);this.connect(this.domNode,"click","_handleClick");_28.toggle(this.domNode,"full-width",this.fullWidth);this.inherited(arguments);},postCreate:function(){this.inherited(arguments);_2c({state:_30.checkCreateBoard(),featureRegistrationSelfsignup:_30.checkFeature("registration.selfsignup").then(function(_38){return _38==="enabled";})}).then(_26.hitch(this,function(_39){this._updateState(_39.state,_39.featureRegistrationSelfsignup);}));_2b.subscribe("/cb/page/boards/displaySettings/changed/portfolioId",dojo.hitch(this,function(_3a){this.set("portfolioId",_3a);}));this.watch("portfolioId",_2e.debounce(_26.hitch(this,function(){this._updateLinkTarget();}),250));},onCreateSuccess:function(_3b){},onCreateError:function(_3c){},_updateState:function(_3d,_3e){switch(_3d){case "nofreesqm":_28.remove(this.domNode,"disabled");_28.remove(this.domNode,"call-to-action");_28.remove(this.domNode,"secondary");_28.add(this.domNode,"delete");_28.add(this.domNode,"new-board-nofreesqm");_2a.set(this.domNode,_37);if(_3e){_29.set(this.domNode,"href","/upgrade");}else{_29.set(this.domNode,"href","/");}break;case "disabled":_28.add(this.domNode,"disabled");_28.remove(this.domNode,"call-to-action");_28.remove(this.domNode,"secondary");_28.remove(this.domNode,"delete");_28.remove(this.domNode,"new-board-nofreesqm");_2a.set(this.domNode,_36);_29.set(this.domNode,"href","/");break;case "enabled":default:_28.remove(this.domNode,"disabled");_28.toggle(this.domNode,"call-to-action",this.callToAction);_28.toggle(this.domNode,"secondary",this.secondary);_28.remove(this.domNode,"delete");_28.remove(this.domNode,"new-board-nofreesqm");if(sp.info.user.isAnonymous){_2a.set(this.domNode,_35);}else{_2a.set(this.domNode,_36);}_29.set(this.domNode,"href","/new"+(this.portfolioId?"?portfolioId="+this.portfolioId:""));_27.create("span",{"class":"demo-board-label-container",innerHTML:_31.wrap(_34)("demo_board_labeltext")},this.domNode);break;}this._state=_3d;},_updateLinkTarget:function(){var _3f=this._state;switch(_3f){case "nofreesqm":_30.checkFeature("registration.selfsignup").then(function(_40){return _40==="enabled";}).then(_26.hitch(this,function(_41){if(_41){_29.set(this.domNode,"href","/upgrade");}else{_29.set(this.domNode,"href","/");}}));break;case "disabled":_29.set(this.domNode,"href","/");break;case "enabled":default:_29.set(this.domNode,"href","/new"+(this.portfolioId?"?portfolioId="+this.portfolioId:""));break;}},_setDemoBoardsLabelAttr:function(_42){_28.toggle(this.domNode,"with-demo-board-label",_42);this._set("demoBoardsLabel",_42);},_handleClick:function(_43){var _44=this;switch(this._state){case "nofreesqm":break;case "disabled":dojo.stopEvent(_43);break;case "enabled":default:dojo.stopEvent(_43);var _45=new _2f({portfolioId:this.portfolioId});_45.show();}},_cleanup:function(){window.setTimeout(_26.hitch(this,function(){_33.invalidateById({type:"portfolios",id:sp.info.user.info.id});if(this.portfolioId){_33.invalidateById({type:"portfolio",id:this.portfolioId});}}),1);}});});},"cb/util-text":function(){define(["dojo/when","cb/util-mentions","cb/util-hashtags","cb/util-url","cb/ext/sjcl"],function(_46,_47,_48,_49,_4a){var _4b=/(?:\s|^)\b(?:((?:https?):\/\/)|(www\.|ftp\.))([-A-Z0-9+&@#\/%=~_|$?!:,.;]*[A-Z0-9+&@#\/%=~_|$;])(?![<>'"])(?:\s|$)/gi;var _4c=40;var ret={};function _4d(url){var _4e=_4a.codec.utf8String.toBits(sp.info.user.nonce);var _4f=new _4a.misc.hmac(_4e,_4a.hash.sha256).encrypt(url);var _50=_4a.codec.base64.fromBits(_4f,false,true);var ret="/__/exit";ret=_49.addParamToUrl(ret,"url",url);ret=_49.addParamToUrl(ret,"signature",_50);return ret;};ret.convertTextToMarkupWithBreaksAndLinks=function convertTextToMarkupWithBreaksAndLinks(_51,_52,_53){if(!_51||_51.length<1){return "";}var _54=_51.split("\n");var _55=[];for(var i=0;i<_54.length;i++){var _56=_54[i];var _57=ret.insertLinkMarkup(_56,_52,_53);var _58=ret.maskDoubleSpacesWithMarkup(_57);_55.push(_58);}return _55.join("<br/>");};ret.insertLinkMarkup=function insertLinkMarkup(_59,_5a,_5b){return _59.replace(_4b,function(_5c,_5d,_5e,_5f){var _60=_5d||"http://";var _61=_5e||"";var url=_5f||"";var _62=_60+_61+url;_62=dojo.string.trim(_62);var _63=ret.abbreviate(_62,_4c);var _64=_4d(_62);if(_5b){return " <a rel=\"noreferrer nofollow\" target=\"_blank\" href=\""+_64+"\" "+(_5a?_5a:"")+">"+_63+"</a> ";}else{return " "+_63+" ";}});};ret.abbreviate=function abbreviate(str,_65,_66){var _67=_66||0;if(!str){return null;}if(str.length<=_65){return str;}if(_67>str.length){_67=str.length;}if((str.length-_67)<(_65-1)){_67=str.length-(_65-1);}if(_67<=2){return str.substring(0,_65-1)+"&hellip;";}if((_67+(_65-1))<str.length){return "&hellip;"+ret.abbreviate(str.substring(_67),_65-1);}return "&hellip;"+str.substring(str.length-(_65-1));};ret.maskDoubleSpacesWithMarkup=function maskDoubleSpacesWithMarkup(_68){var _69=_68.replace(/^ /,"&nbsp;");return _69.replace(/ {2}/g," &nbsp;");};ret.convertTextToFullyEnrichedMarkup=function convertTextToFullyEnrichedMarkup(_6a,_6b,_6c){return _46(_6a).then(function(_6d){return ret.convertTextToMarkupWithBreaksAndLinks(_6d,_6b,_6c);}).then(function(_6e){return _47.convertTextToFullyEnrichedMarkup(_6e,_6b,_6c);}).then(function(_6f){return _48.convertTextToFullyEnrichedMarkup(_6f,_6b,_6c);}).otherwise(function(_70){return _6a;});};return ret;});},"dijit/form/TextBox":function(){define(["dojo/_base/declare","dojo/dom-construct","dojo/dom-style","dojo/_base/kernel","dojo/_base/lang","dojo/sniff","./_FormValueWidget","./_TextBoxMixin","dojo/text!./templates/TextBox.html","../main"],function(_71,_72,_73,_74,_75,has,_76,_77,_78,_79){var _7a=_71("dijit.form.TextBox",[_76,_77],{templateString:_78,_singleNodeTemplate:"<input class=\"dijit dijitReset dijitLeft dijitInputField\" data-dojo-attach-point=\"textbox,focusNode\" autocomplete=\"off\" type=\"${type}\" ${!nameAttrSetting} />",_buttonInputDisabled:has("ie")?"disabled":"",baseClass:"dijitTextBox",postMixInProperties:function(){var _7b=this.type.toLowerCase();if(this.templateString&&this.templateString.toLowerCase()=="input"||((_7b=="hidden"||_7b=="file")&&this.templateString==this.constructor.prototype.templateString)){this.templateString=this._singleNodeTemplate;}this.inherited(arguments);},postCreate:function(){this.inherited(arguments);if(has("ie")<9){this.defer(function(){try{var s=_73.getComputedStyle(this.domNode);if(s){var ff=s.fontFamily;if(ff){var _7c=this.domNode.getElementsByTagName("INPUT");if(_7c){for(var i=0;i<_7c.length;i++){_7c[i].style.fontFamily=ff;}}}}}catch(e){}});}},_onInput:function(e){this.inherited(arguments);if(this.intermediateChanges){this.defer(function(){this._handleOnChange(this.get("value"),false);});}},_setPlaceHolderAttr:function(v){this._set("placeHolder",v);if(!this._phspan){this._attachPoints.push("_phspan");this._phspan=_72.create("span",{onmousedown:function(e){e.preventDefault();},className:"dijitPlaceHolder dijitInputField"},this.textbox,"after");}this._phspan.innerHTML="";this._phspan.appendChild(this._phspan.ownerDocument.createTextNode(v));this._updatePlaceHolder();},_updatePlaceHolder:function(){if(this._phspan){this._phspan.style.display=(this.placeHolder&&!this.focused&&!this.textbox.value)?"":"none";}},_setValueAttr:function(_7d,_7e,_7f){this.inherited(arguments);this._updatePlaceHolder();},getDisplayedValue:function(){_74.deprecated(this.declaredClass+"::getDisplayedValue() is deprecated. Use get('displayedValue') instead.","","2.0");return this.get("displayedValue");},setDisplayedValue:function(_80){_74.deprecated(this.declaredClass+"::setDisplayedValue() is deprecated. Use set('displayedValue', ...) instead.","","2.0");this.set("displayedValue",_80);},_onBlur:function(e){if(this.disabled){return;}this.inherited(arguments);this._updatePlaceHolder();if(has("mozilla")){if(this.selectOnClick){this.textbox.selectionStart=this.textbox.selectionEnd=undefined;}}},_onFocus:function(by){if(this.disabled||this.readOnly){return;}this.inherited(arguments);this._updatePlaceHolder();}});if(has("ie")){_7a.prototype._isTextSelected=function(){var _81=this.ownerDocument.selection.createRange();var _82=_81.parentElement();return _82==this.textbox&&_81.text.length>0;};_79._setSelectionRange=_77._setSelectionRange=function(_83,_84,_85){if(_83.createTextRange){var r=_83.createTextRange();r.collapse(true);r.moveStart("character",-99999);r.moveStart("character",_84);r.moveEnd("character",_85-_84);r.select();}};}return _7a;});},"url:cb/freezing/FreezeOverlay.html":"<div class=\"${bemBaseClass} dijitDialog\">\r\n    <h1 class=\"dialog-title\">${!i18n.title}</h1>\r\n    <div class=\"margin\">\r\n      <div data-dojo-attach-point=\"_adminMessageNode\" class=\"hideBlock\">\r\n          <p>${!i18n.adminMessage}</p>\r\n          <p><a class=\"button full-width\" href=\"/__/company/reactivation\">${!i18n.reactivate_button}</a></p>\r\n          <p class=\"small light\">${!i18n.adminSupporthint}</p>\r\n      </div>\r\n      <div data-dojo-attach-point=\"_userMessageNode\" class=\"hideBlock\">\r\n          <p>${!i18n.userMessage}</p>\r\n          <p>${!i18n.userCalltoaction}</p>\r\n      </div>\r\n    </div>\r\n</div>","dijit/DialogUnderlay":function(){define(["dojo/_base/declare","dojo/dom-attr","dojo/window","./_Widget","./_TemplatedMixin","./BackgroundIframe"],function(_86,_87,_88,_89,_8a,_8b){return _86("dijit.DialogUnderlay",[_89,_8a],{templateString:"<div class='dijitDialogUnderlayWrapper'><div class='dijitDialogUnderlay' data-dojo-attach-point='node'></div></div>",dialogId:"","class":"",_setDialogIdAttr:function(id){_87.set(this.node,"id",id+"_underlay");this._set("dialogId",id);},_setClassAttr:function(_8c){this.node.className="dijitDialogUnderlay "+_8c;this._set("class",_8c);},postCreate:function(){this.ownerDocumentBody.appendChild(this.domNode);},layout:function(){var is=this.node.style,os=this.domNode.style;os.display="none";var _8d=_88.getBox(this.ownerDocument);os.top=_8d.t+"px";os.left=_8d.l+"px";is.width=_8d.w+"px";is.height=_8d.h+"px";os.display="block";},show:function(){this.domNode.style.display="block";this.layout();this.bgIframe=new _8b(this.domNode);},hide:function(){this.bgIframe.destroy();delete this.bgIframe;this.domNode.style.display="none";}});});},"cb/page/boards/PortfolioSettingsDialog":function(){define(["dojo","dojo/dom-class","dojo/dom-attr","dojo/dom-construct","dojo/date/stamp","dojo/promise/all","dojo/when","dojo/on","dojo/_base/lang","sp/dialog/TooltipDialog","sp/dialog/DialogContent","sp/ajax/AjaxEngine","sp/infos/InfoManager","sp/dialog/YesNoDialog","cb/widget/UserDialog","sp/I18n","cb/widget/UpgradeButton","cb/Capabilities","dojo/text!./PortfolioSettings.html","dojo/i18n!./nls/PortfolioSettings","cb/widget/BigSwitch"],function(_8e,_8f,_90,_91,_92,_93,_94,on,_95,_96,_97,_98,_99,_9a,_9b,_9c,_9d,_9e,_9f,_a0){var _a1=_8e.declare([_97],{i18n:_a0,templateString:_9f,portfolioResult:null,widgetsInTemplate:true,postMixInProperties:function(){this.inherited(arguments);this.projectDeletable=this.portfolioResult.project.ownerId===sp.info.user.info.id;this.projectDeletableSoft=this.projectDeletable&&this.portfolioResult.project.documents.length===0;this.projectLeavable=this.portfolioResult.project.ownerId!==sp.info.user.info.id&&!this.portfolioResult.readOnly;this.passphraseEditable=this.portfolioResult.project.ownerId===sp.info.user.info.id;this.ownerId=this.portfolioResult.project.ownerId;this.createdAt=_92.fromISOString(this.portfolioResult.project.createdAt);this.modifiedAt=_92.fromISOString(this.portfolioResult.project.lastModifiedAt);},postCreate:function(){this.inherited(arguments);this._changeAccessControlState();this._passphraseSwitch.set("disabled",!this.passphraseEditable);this._changePassphraseEditable();this._changeTitleEntry(!this.portfolioResult.readOnly);this._showMetaData();_8f.toggle(this._deleteButton,"hideBlock",!this.projectDeletable);_8f.toggle(this._deleteButton,"disabled",!this.projectDeletableSoft);_8f.toggle(this._deleteSoftHint,"hideBlock",!(this.projectDeletable&&!this.projectDeletableSoft));_8f.toggle(this._leaveButton,"hideBlock",!this.projectLeavable);_8f.toggle(this._portfolioActions,"hideBlock",!this.projectDeletable&&!this.projectLeavable);},_handleUserLinkClick:function(evt,_a2){var _a3=new _9b({user:_a2});_a3.show(evt.target);},_changePassphraseEditable:function(){_94(false).then(_95.hitch(this,function(_a4){if(_a4){return _a4;}if(!sp.info.user.info.accountType.hasPassphrase){return _99.getById({type:"companyuser",id:this.portfolioResult.project.ownerId}).then(_95.hitch(this,function(_a5){if(_a5.companyuser){return "disabled";}else{return "pro_only";}}));}else{return _a4;}})).then(_95.hitch(this,function(_a6){if(_a6){return _a6;}return (this.portfolioResult.project.ownerId===sp.info.user.info.id)?"enabled":"disabled";})).otherwise(function(){return false;}).then(_95.hitch(this,function(_a7){this.set("passphraseEditableStatus",_a7||"unknown");}));},_setPassphraseEditableStatusAttr:function(_a8){if(this._destroyed){return;}var _a9,_aa,_ab=false;switch(_a8){case "enabled":_aa=null;_a9=true;break;case "wrong_team":_aa=_99.byId({type:"companyuser",id:this.portfolioResult.project.userId}).then(function(_ac){return _99.byId({type:"company",id:_ac.companyuser.companyId}).then(function(_ad){return _ad.company.name;});}).then(function(_ae){return _9c.wrap(_a0)("passphrase_edit_wrong_team",[_ae]);});_a9=false;break;case "pro_only":_aa=_9c.wrap(_a0)("passphrase_edit_pro_only");_a9=false;_ab=_9e.checkFeature("registration.selfsignup").then(function(_af){return _af==="enabled";});break;case "disabled":_aa=null;_a9=false;break;default:_aa=null;_a9=true;}_93({title:_94(_aa),enabled:_94(_a9),showUpgradeButton:_94(_ab)}).then(_95.hitch(this,function(_b0){if(_b0.showUpgradeButton){this._passphraseUpgradeButton=new _9d({upgradeDialogContent:"security"},_91.create("span",null,this._passphraseSwitch.titleNode,"after"));_8f.add(this._passphraseSwitch.titleNode,"hideBlock");}else{if(this._passphraseUpgradeButton){this._passphraseUpgradeButton.destroyRecursive();}_8f.remove(this._passphraseSwitch.titleNode,"hideBlock");}this.set("passphraseInputVisible",!_b0.enabled&&!this.portfolioResult.project.accessControlState.controlled);this._passphraseSwitch.set("disabled",!_b0.enabled);_8f.toggle(this._passphraseSubmit,"disabled",!_b0.enabled);_90.set(this._passphraseSubmit,"disabled",!_b0.enabled);_90.set(this._passphraseInput,"disabled",!_b0.enabled);_90.set(this._passphraseInput,"title",_b0.title||"");}));this._set("passphraseEditableStatus",_a8);},_handlePassphraseSwitchChange:function(_b1){if(!_b1&&_b1!==this.portfolioResult.project.accessControlState.controlled){this._postPortfolioAccessControlChange("");}this.set("accessControlled",_b1);},_setPassphraseInputVisibleAttr:function(_b2){if(this._destroyed){return;}_8f.toggle(this._inputWithButton,"hideBlock",!_b2);this._set("passphraseInputVisible",_b2);},_changeAccessControlState:function(){this.set("accessControlled",this.portfolioResult.project.accessControlState.controlled);this.set("accessControlPassphrase",this.portfolioResult.project.accessControlState.accessControlToken);},_setAccessControlledAttr:function(_b3){if(this._destroyed){return;}this._passphraseSwitch.set("checked",_b3);this.set("passphraseInputVisible",_b3);this._set("accessControlled",_b3);},_setAccessControllPassphraseAttr:function(_b4){if(this._destroyed){return;}this._passphraseInput.innerHTML=_9c.esc(_b4||"");this._set("accessControlPassphrase",_b4);},_changeTitleEntry:function(_b5){_8f.toggle(this._nameSubmit,"disabled",!_b5);_90.set(this._nameSubmit,"disabled",!_b5);_90.set(this._nameInput,"disabled",!_b5);},_showMetaData:function(){_99.getById({type:"user",id:this.portfolioResult.project.lastModifiedBy}).then(_8e.hitch(this,function(_b6){var _b7=_91.create("li",{"class":"modified",innerHTML:_9c.wrap(_a0)("modified_at",[this.modifiedAt])+" "+_9c.wrap(_a0)("modified_by")+" "},this._metaData,"first");var _b8=_91.create("span",{"class":"link",innerHTML:_9c.esc(_b6.user.displayname)},_b7,"last");on(_b8,"click",_8e.hitch(this,function(evt){this._handleUserLinkClick(evt,_b6.user);}));}));_91.create("li",{"class":"created",innerHTML:_9c.wrap(_a0)("created_at",[this.createdAt])},this._metaData,"first");_99.getById({type:"user",id:this.ownerId}).then(_8e.hitch(this,function(_b9){var _ba=_91.create("li",{"class":"owner",innerHTML:_9c.wrap(_a0)("owner")+" "},this._metaData,"first");var _bb=_91.create("span",{"class":"link",innerHTML:_9c.esc(_b9.user.displayname)},_ba,"last");on(_bb,"click",_8e.hitch(this,function(evt){this._handleUserLinkClick(evt,_b9.user);}));}));},_handlePassphraseSubmitClick:function(_bc){_8e.stopEvent(_bc);var _bd=_90.get(this._passphraseInput,"value");this._postPortfolioAccessControlChange(_bd);},_handleNameSubmitClick:function(_be){_8e.stopEvent(_be);_98.changePortfolioTitle({portfolioId:this.portfolioResult.project.id,title:_90.get(this._nameInput,"value")}).then(_8e.hitch(this,function(){_99.invalidateById({type:"portfolio",id:this.portfolioResult.project.id});this.dialog.hide();}));},_postPortfolioAccessControlChange:function(_bf){_98.changePortfolioAccessControl({portfolioId:this.portfolioResult.project.id,token:_bf}).then(_8e.hitch(this,function(){_99.invalidateById({type:"portfolio",id:this.portfolioResult.project.id});this.dialog.hide();}));},_handleDeleteClick:function(_c0){if(!this.projectDeletable||!this.projectDeletableSoft){return;}var _c1=new _9a({title:_9c.wrap(_a0)("delete_portfolio_confirm_title"),questionText:_9c.wrap(_a0)("delete_portfolio_confirm_question"),okButtonText:_9c.wrap(_a0)("delete_portfolio_confirm_button"),onYes:_8e.hitch(this,function(){_98.deletePortfolio({portfolioId:this.portfolioResult.project.id}).then(_8e.hitch(this,function(){_99.invalidateById({type:"portfolio",id:this.portfolioResult.project.id});_99.invalidateById({type:"portfolios",id:sp.info.user.info.id});_8e.publish("/cb/page/boards/displaySettings/set/portfolioId",null);_c1.hide();this.dialog.hide();}));})});_c1.show(_c0.currentTarget);},_handleCloseButtonClick:function(){this.dialog.hide();},_handleLeaveClick:function(){if(!this.projectLeavable){return;}var _c2=new _9a({title:_9c.wrap(_a0)("leave_portfolio_confirm_title"),questionText:_9c.wrap(_a0)("leave_portfolio_confirm_question"),okButtonText:_9c.wrap(_a0)("leave_portfolio_confirm_button"),onYes:_8e.hitch(this,function(){_98.removePortfolioParticipant({portfolioId:this.portfolioResult.project.id,userId:sp.info.user.info.id}).then(_8e.hitch(this,function(){_99.invalidateById({type:"portfolio",id:this.portfolioResult.project.id});_99.invalidateById({type:"portfolios",id:sp.info.user.info.id});_8e.publish("/cb/page/boards/displaySettings/set/portfolioId",null);_c2.hide();this.dialog.hide();}));})});_c2.show(event.currentTarget);}});return _8e.declare([_96],{portfolioResult:null,baseClass:"portfolio-settings-dialog with-title",postCreate:function(){this.inherited(arguments);this.content=new _a1({dialog:this,portfolioResult:this.portfolioResult});}});});},"cb/notifications/AlertsButton":function(){define(["dojo","dojo/_base/declare","dojo/_base/lang","dojo/dom-class","dojo/dom-construct","dojo/_base/array","dojo/date/stamp","dojo/on","dojo/when","dojo/topic","dojo/aspect","dojo/store/Memory","dojo/store/Observable","dojox/timing","dijit/_WidgetBase","cb/util","cb/api/Api","sp/I18n","dojo/i18n!./nls/Messages","./NotificationsDialog"],function(_c3,_c4,_c5,_c6,_c7,_c8,_c9,on,_ca,_cb,_cc,_cd,_ce,_cf,_d0,_d1,Api,_d2,_d3,_d4){var _d5=_d2.wrap(_d3);return _c4([_d0],{count:0,alertsLastReadAt:null,query:null,queryCount:null,constructor:function(_d6){this.isBoardMode=_d6?!!_d6.isBoardMode:false;this.alertsLastReadAt=_c9.fromISOString(sp.info.user.info.alertsLastReadAt)||new Date(0);this._store=_ce(new _cd());this._pollingTimer=new _cf.Timer(0.5*60*1000);_cc.after(this._pollingTimer,"onTick",_c5.hitch(this,this._poll));},buildRendering:function(){this.inherited(arguments);_c6.add(this.domNode,"notifications-widget");this.buttonNode=_c7.create("span",{"class":""+(this.isBoardMode?"":"notifications-widget__button button quiet"),"innerHTML":"<i class=\"fonticon-notification\"></i>"+(this.isBoardMode?"":" "+_d5("alerts_button_label"))},this.domNode);this._countNode=_c7.create("span",{"class":"notifications-widget__count-badge","innerHTML":""},this.buttonNode);on(this.buttonNode,"click",_c5.hitch(this,"_handleButtonClick"));this.watch("alertsLastReadAt",_c5.hitch(this,function(_d7,_d8,_d9){this._updateCountFromStore();}));},postCreate:function(){this.inherited(arguments);this._store.query(this.getQuery(),{sort:[{attribute:"createdAt",descending:true}]}).observe(_d1.debounce(_c5.hitch(this,"_updateCountFromStore"),50));this._loadStore();this._setupCacheInvalidationHelper();this._updateCountFromStore();this._pollingTimer.start();},_setupCacheInvalidationHelper:function(){this._store.query(this.getQuery(),{sort:[{attribute:"createdAt",descending:true}],limit:1}).observe(_d1.debounce(_c5.hitch(this,function(){Api.Invalidate.users_me_notifications.get(this._getUserNotificationParams());}),50));},getQuery:function(){return function(n){return n.hasSubscription===true;};},getQueryForCount:function(){var _da=this.get("alertsLastReadAt"),_db=this.getQuery();return function(n){return _db(n)&&n.createdAt>_da;};},_setCountAttr:function(_dc){this._countNode.innerHTML=_d2.esc(_dc||"");_c6.toggle(this._countNode,"hideBlock",_dc===0);this._set("count",_dc);},_updateCountFromStore:function(){this.set("count",this._store.query(this.getQueryForCount()).length);},_handleButtonClick:function(e){if(_c3.query(".notifications-dialogPopup").length<1){new _d4({storeLoadPredicate:_c5.hitch(this,this.storeLoadPredicate),position:(this.isBoardMode)?["after"]:["below-centered","below"],isBoardMode:this.isBoardMode,query:this.getQuery()}).show((this.isBoardMode)?this.domNode:this.buttonNode);this._saveAlertsRead().then(_c5.hitch(this,function(d){this.set("alertsLastReadAt",d||new Date());}));sp.global.analytics.trackEvent("alertsDialog","opened");}else{_cb.publish("/window/resize");}},_saveAlertsRead:function(){return Api.users_me_alertslastreadat.post(new Date()).then(function(_dd){return _c9.fromISOString(_dd.data);}).otherwise(function(){return new Date();}).always(function(v){Api.Invalidate.users_me_alertslastreadat.get();return v;});},storeLoadPredicate:function(_de){if(_de.query(this.getQuery()).length<5){return true;}var _df=_de.query(function(n){return n&&!n.isLive;},{sort:[{attribute:"createdAt",descending:false}],count:1})[0];return !_df||_df.createdAt>this.get("alertsLastReadAt");},_loadStore:function(){var _e0=this.isBoardMode?{documentid:sp.info.document.id}:{};return Api.Util.consumeAndPage(Api.Caching,Api.Caching.users_me_notifications.get(_e0),_c5.hitch(this,function(_e1){this._addNotificationsToStore(_e1.data);return this.storeLoadPredicate(this._store);}));},_getYoungestNotificationAttr:function(_e2){return this._store.query(function(n){return n&&!n.isLive;},{sort:[{attribute:"createdAt",descending:true}],count:1})[0]||null;},_getLastPollAttr:function(){var _e3=this.lastPoll;if(!_e3){var _e4=this.get("youngestNotification");if(_e4){_e3=new Date(_e4.createdAt.getTime()+1000);}}if(!_e3){_e3=this.get("alertsLastReadAt");}if(!_e3){_e3=new Date();}return _e3;},_poll:function(){var _e5=this._getUserNotificationParams();_e5.timelimit=_c9.toISOString(this.get("lastPoll"));this.set("lastPoll",new Date());return Api.Util.consumeAndPage(Api.Caching,Api.Caching.users_me_notifications.get(_e5),_c5.hitch(this,function(_e6){var _e7=_e6.data;this._addNotificationsToStore(_e6.data);return true;}));},_getUserNotificationParams:function(){return this.isBoardMode?{documentid:sp.info.document.id}:{};},_addNotificationsToStore:function(_e8){_c8.forEach(_e8,function(n){n.createdAt=_c9.fromISOString(n.createdAt);this._store.put(n);},this);}});});},"cb/widget/_Templated":function(){define(["dijit/_WidgetBase","./_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/_base/kernel"],function(_e9,_ea,_eb,_ec,_ed,_ee,_ef){_ee.extend(_e9,{waiRole:"",waiState:""});return _ed("cb.widget._Templated",[_ea,_eb],{widgetsInTemplate:false,constructor:function(){_ef.deprecated(this.declaredClass+": cb.widget._Templated deprecated, use cb.widget._TemplatedMixin and if necessary cb.widget._WidgetsInTemplateMixin","","2.0");},_attachTemplateNodes:function(_f0,_f1){this.inherited(arguments);var _f2=_ee.isArray(_f0)?_f0:(_f0.all||_f0.getElementsByTagName("*"));var x=_ee.isArray(_f0)?0:-1;for(;x<_f2.length;x++){var _f3=(x==-1)?_f0:_f2[x];var _f4=_f1(_f3,"waiRole");if(_f4){_f3.setAttribute("role",_f4);}var _f5=_f1(_f3,"waiState");if(_f5){_ec.forEach(_f5.split(/\s*,\s*/),function(_f6){if(_f6.indexOf("-")!=-1){var _f7=_f6.split("-");_f3.setAttribute("aria-"+_f7[0],_f7[1]);}});}}}});});},"cb/infobanner/RequestTeamJoinBanner":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/dom-construct","dojo/dom-attr","dojo/on","dojo/dom-class","dojo/query","dojo/html","dojo/Deferred","cb/infobanner/Banner","sp/infos/InfoManager","sp/ajax/AjaxEngine","cb/api/Api","sp/I18n","dojo/i18n!./nls/BannerMessages"],function(_f8,_f9,_fa,_fb,on,_fc,_fd,_fe,_ff,_100,_101,_102,Api,_103,i18n){var _104="requestTeamJoinBanner";var _105=_f8([_100],{bannerId:_104,isCloseable:true,boardOwner:null,company:null,buildRendering:function(){this.analyticsBannerId="request team join";this.defaultIconClass="fonticon-participants";this.defaultMessage=_103.wrap(i18n)("request_team_join_message",[this.company.name]);this.inherited(arguments);},postCreate:function(){this.inherited(arguments);_fd(".js-join",this.domNode).on("click",_f9.hitch(this,function(){sp.global.analytics.trackEvent(this.analyticsCategory,"click request team join");_101.getById({type:"companyuser",id:this.boardOwner.id}).then(function(_106){Api.companyjoinrequests.post({identifier:{providerId:"conceptboard",providerUserId:sp.info.user.id},companyId:_106.companyuser.companyId,source:"banner"});});this.messageNode.innerHTML="<i class=\"fonticon-task-round-done\"></i> "+_103.wrap(i18n)("request_team_join_success");}));}});_105.addToContainerIfNecessary=function addToContainerIfNecessary(_107){return _107.addIfNotPresent(_104,function(){var _108;if(sp.info.document){_108=_101.getById({type:"user",id:sp.info.document.document.ownerId}).then(function(_109){return _109.user;});}else{_108=new _ff();_108.resolve(null);}return _101.getById({type:"user",id:sp.info.user.id}).then(function(_10a){return _108.then(function(_10b){if(_10b&&_10b.id!=="captaincb"&&_10b.accountType.hasUserRoles&&(_10a.user.accountType.asString==="basic")){return new _105({boardOwner:_10b,company:sp.info.pageBrandCompany});}else{return null;}});});});};return _105;});},"cb/ext/sjcl/sjcl":function(){define(function(_10c,_10d,_10e){"use strict";function q(a){throw a;};var t=void 0,u=!1;var sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(a){this.toString=function(){return "CORRUPT: "+this.message;};this.message=a;},invalid:function(a){this.toString=function(){return "INVALID: "+this.message;};this.message=a;},bug:function(a){this.toString=function(){return "BUG: "+this.message;};this.message=a;},notReady:function(a){this.toString=function(){return "NOT READY: "+this.message;};this.message=a;}}};"undefined"!==typeof _10e&&_10e.exports&&(_10e.exports=sjcl);sjcl.cipher.aes=function(a){this.k[0][0][0]||this.D();var b,c,d,e,f=this.k[0][4],g=this.k[1];b=a.length;var h=1;4!==b&&(6!==b&&8!==b)&&q(new sjcl.exception.invalid("invalid aes key size"));this.b=[d=a.slice(0),e=[]];for(a=b;a<4*b+28;a++){c=d[a-1];if(0===a%b||8===b&&4===a%b){c=f[c>>>24]<<24^f[c>>16&255]<<16^f[c>>8&255]<<8^f[c&255],0===a%b&&(c=c<<8^c>>>24^h<<24,h=h<<1^283*(h>>7));}d[a]=d[a-b]^c;}for(b=0;a;b++,a--){c=d[b&3?a:a-4],e[b]=4>=a||4>b?c:g[0][f[c>>>24]]^g[1][f[c>>16&255]]^g[2][f[c>>8&255]]^g[3][f[c&255]];}};sjcl.cipher.aes.prototype={encrypt:function(a){return y(this,a,0);},decrypt:function(a){return y(this,a,1);},k:[[[],[],[],[],[]],[[],[],[],[],[]]],D:function(){var a=this.k[0],b=this.k[1],c=a[4],d=b[4],e,f,g,h=[],l=[],k,n,m,p;for(e=0;256>e;e++){l[(h[e]=e<<1^283*(e>>7))^e]=e;}for(f=g=0;!c[f];f^=k||1,g=l[g]||1){m=g^g<<1^g<<2^g<<3^g<<4;m=m>>8^m&255^99;c[f]=m;d[m]=f;n=h[e=h[k=h[f]]];p=16843009*n^65537*e^257*k^16843008*f;n=257*h[m]^16843008*m;for(e=0;4>e;e++){a[e][f]=n=n<<24^n>>>8,b[e][m]=p=p<<24^p>>>8;}}for(e=0;5>e;e++){a[e]=a[e].slice(0),b[e]=b[e].slice(0);}}};function y(a,b,c){4!==b.length&&q(new sjcl.exception.invalid("invalid aes block size"));var d=a.b[c],e=b[0]^d[0],f=b[c?3:1]^d[1],g=b[2]^d[2];b=b[c?1:3]^d[3];var h,l,k,n=d.length/4-2,m,p=4,s=[0,0,0,0];h=a.k[c];a=h[0];var r=h[1],v=h[2],w=h[3],x=h[4];for(m=0;m<n;m++){h=a[e>>>24]^r[f>>16&255]^v[g>>8&255]^w[b&255]^d[p],l=a[f>>>24]^r[g>>16&255]^v[b>>8&255]^w[e&255]^d[p+1],k=a[g>>>24]^r[b>>16&255]^v[e>>8&255]^w[f&255]^d[p+2],b=a[b>>>24]^r[e>>16&255]^v[f>>8&255]^w[g&255]^d[p+3],p+=4,e=h,f=l,g=k;}for(m=0;4>m;m++){s[c?3&-m:m]=x[e>>>24]<<24^x[f>>16&255]<<16^x[g>>8&255]<<8^x[b&255]^d[p++],h=e,e=f,f=g,g=b,b=h;}return s;};sjcl.bitArray={bitSlice:function(a,b,c){a=sjcl.bitArray.P(a.slice(b/32),32-(b&31)).slice(1);return c===t?a:sjcl.bitArray.clamp(a,c-b);},extract:function(a,b,c){var d=Math.floor(-b-c&31);return ((b+c-1^b)&-32?a[b/32|0]<<32-d^a[b/32+1|0]>>>d:a[b/32|0]>>>d)&(1<<c)-1;},concat:function(a,b){if(0===a.length||0===b.length){return a.concat(b);}var c=a[a.length-1],d=sjcl.bitArray.getPartial(c);return 32===d?a.concat(b):sjcl.bitArray.P(b,d,c|0,a.slice(0,a.length-1));},bitLength:function(a){var b=a.length;return 0===b?0:32*(b-1)+sjcl.bitArray.getPartial(a[b-1]);},clamp:function(a,b){if(32*a.length<b){return a;}a=a.slice(0,Math.ceil(b/32));var c=a.length;b&=31;0<c&&b&&(a[c-1]=sjcl.bitArray.partial(b,a[c-1]&2147483648>>b-1,1));return a;},partial:function(a,b,c){return 32===a?b:(c?b|0:b<<32-a)+1099511627776*a;},getPartial:function(a){return Math.round(a/1099511627776)||32;},equal:function(a,b){if(sjcl.bitArray.bitLength(a)!==sjcl.bitArray.bitLength(b)){return u;}var c=0,d;for(d=0;d<a.length;d++){c|=a[d]^b[d];}return 0===c;},P:function(a,b,c,d){var e;e=0;for(d===t&&(d=[]);32<=b;b-=32){d.push(c),c=0;}if(0===b){return d.concat(a);}for(e=0;e<a.length;e++){d.push(c|a[e]>>>b),c=a[e]<<32-b;}e=a.length?a[a.length-1]:0;a=sjcl.bitArray.getPartial(e);d.push(sjcl.bitArray.partial(b+a&31,32<b+a?c:d.pop(),1));return d;},l:function(a,b){return [a[0]^b[0],a[1]^b[1],a[2]^b[2],a[3]^b[3]];}};sjcl.codec.utf8String={fromBits:function(a){var b="",c=sjcl.bitArray.bitLength(a),d,e;for(d=0;d<c/8;d++){0===(d&3)&&(e=a[d/4]),b+=String.fromCharCode(e>>>24),e<<=8;}return decodeURIComponent(escape(b));},toBits:function(a){a=unescape(encodeURIComponent(a));var b=[],c,d=0;for(c=0;c<a.length;c++){d=d<<8|a.charCodeAt(c),3===(c&3)&&(b.push(d),d=0);}c&3&&b.push(sjcl.bitArray.partial(8*(c&3),d));return b;}};sjcl.codec.hex={fromBits:function(a){var b="",c;for(c=0;c<a.length;c++){b+=((a[c]|0)+263882790666240).toString(16).substr(4);}return b.substr(0,sjcl.bitArray.bitLength(a)/4);},toBits:function(a){var b,c=[],d;a=a.replace(/\s|0x/g,"");d=a.length;a+="00000000";for(b=0;b<a.length;b+=8){c.push(parseInt(a.substr(b,8),16)^0);}return sjcl.bitArray.clamp(c,4*d);}};sjcl.codec.base64={J:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(a,b,c){var d="",e=0,f=sjcl.codec.base64.J,g=0,h=sjcl.bitArray.bitLength(a);c&&(f=f.substr(0,62)+"-_");for(c=0;6*d.length<=h;){d+=f.charAt((g^a[c]>>>e)>>>26),6>e?(g=a[c]<<6-e,e+=26,c++):(g<<=6,e-=6);}for(;d.length&3&&!b;){d+="=";}return d;},toBits:function(a,b){a=a.replace(/\s|=/g,"");var c=[],d,e=0,f=sjcl.codec.base64.J,g=0,h;b&&(f=f.substr(0,62)+"-_");for(d=0;d<a.length;d++){h=f.indexOf(a.charAt(d)),0>h&&q(new sjcl.exception.invalid("this isn't base64!")),26<e?(e-=26,c.push(g^h>>>e),g=h<<32-e):(e+=6,g^=h<<32-e);}e&56&&c.push(sjcl.bitArray.partial(e&56,g,1));return c;}};sjcl.codec.base64url={fromBits:function(a){return sjcl.codec.base64.fromBits(a,1,1);},toBits:function(a){return sjcl.codec.base64.toBits(a,1);}};sjcl.hash.sha256=function(a){this.b[0]||this.D();a?(this.r=a.r.slice(0),this.o=a.o.slice(0),this.h=a.h):this.reset();};sjcl.hash.sha256.hash=function(a){return (new sjcl.hash.sha256).update(a).finalize();};sjcl.hash.sha256.prototype={blockSize:512,reset:function(){this.r=this.N.slice(0);this.o=[];this.h=0;return this;},update:function(a){"string"===typeof a&&(a=sjcl.codec.utf8String.toBits(a));var b,c=this.o=sjcl.bitArray.concat(this.o,a);b=this.h;a=this.h=b+sjcl.bitArray.bitLength(a);for(b=512+b&-512;b<=a;b+=512){z(this,c.splice(0,16));}return this;},finalize:function(){var a,b=this.o,c=this.r,b=sjcl.bitArray.concat(b,[sjcl.bitArray.partial(1,1)]);for(a=b.length+2;a&15;a++){b.push(0);}b.push(Math.floor(this.h/4294967296));for(b.push(this.h|0);b.length;){z(this,b.splice(0,16));}this.reset();return c;},N:[],b:[],D:function(){function a(a){return 4294967296*(a-Math.floor(a))|0;};var b=0,c=2,d;a:for(;64>b;c++){for(d=2;d*d<=c;d++){if(0===c%d){continue a;}}8>b&&(this.N[b]=a(Math.pow(c,0.5)));this.b[b]=a(Math.pow(c,1/3));b++;}}};function z(a,b){var c,d,e,f=b.slice(0),g=a.r,h=a.b,l=g[0],k=g[1],n=g[2],m=g[3],p=g[4],s=g[5],r=g[6],v=g[7];for(c=0;64>c;c++){16>c?d=f[c]:(d=f[c+1&15],e=f[c+14&15],d=f[c&15]=(d>>>7^d>>>18^d>>>3^d<<25^d<<14)+(e>>>17^e>>>19^e>>>10^e<<15^e<<13)+f[c&15]+f[c+9&15]|0),d=d+v+(p>>>6^p>>>11^p>>>25^p<<26^p<<21^p<<7)+(r^p&(s^r))+h[c],v=r,r=s,s=p,p=m+d|0,m=n,n=k,k=l,l=d+(k&n^m&(k^n))+(k>>>2^k>>>13^k>>>22^k<<30^k<<19^k<<10)|0;}g[0]=g[0]+l|0;g[1]=g[1]+k|0;g[2]=g[2]+n|0;g[3]=g[3]+m|0;g[4]=g[4]+p|0;g[5]=g[5]+s|0;g[6]=g[6]+r|0;g[7]=g[7]+v|0;};sjcl.mode.ccm={name:"ccm",encrypt:function(a,b,c,d,e){var f,g=b.slice(0),h=sjcl.bitArray,l=h.bitLength(c)/8,k=h.bitLength(g)/8;e=e||64;d=d||[];7>l&&q(new sjcl.exception.invalid("ccm: iv must be at least 7 bytes"));for(f=2;4>f&&k>>>8*f;f++){}f<15-l&&(f=15-l);c=h.clamp(c,8*(15-f));b=sjcl.mode.ccm.L(a,b,c,d,e,f);g=sjcl.mode.ccm.p(a,g,c,b,e,f);return h.concat(g.data,g.tag);},decrypt:function(a,b,c,d,e){e=e||64;d=d||[];var f=sjcl.bitArray,g=f.bitLength(c)/8,h=f.bitLength(b),l=f.clamp(b,h-e),k=f.bitSlice(b,h-e),h=(h-e)/8;7>g&&q(new sjcl.exception.invalid("ccm: iv must be at least 7 bytes"));for(b=2;4>b&&h>>>8*b;b++){}b<15-g&&(b=15-g);c=f.clamp(c,8*(15-b));l=sjcl.mode.ccm.p(a,l,c,k,e,b);a=sjcl.mode.ccm.L(a,l.data,c,d,e,b);f.equal(l.tag,a)||q(new sjcl.exception.corrupt("ccm: tag doesn't match"));return l.data;},L:function(a,b,c,d,e,f){var g=[],h=sjcl.bitArray,l=h.l;e/=8;(e%2||4>e||16<e)&&q(new sjcl.exception.invalid("ccm: invalid tag length"));(4294967295<d.length||4294967295<b.length)&&q(new sjcl.exception.bug("ccm: can't deal with 4GiB or more data"));f=[h.partial(8,(d.length?64:0)|e-2<<2|f-1)];f=h.concat(f,c);f[3]|=h.bitLength(b)/8;f=a.encrypt(f);if(d.length){c=h.bitLength(d)/8;65279>=c?g=[h.partial(16,c)]:4294967295>=c&&(g=h.concat([h.partial(16,65534)],[c]));g=h.concat(g,d);for(d=0;d<g.length;d+=4){f=a.encrypt(l(f,g.slice(d,d+4).concat([0,0,0])));}}for(d=0;d<b.length;d+=4){f=a.encrypt(l(f,b.slice(d,d+4).concat([0,0,0])));}return h.clamp(f,8*e);},p:function(a,b,c,d,e,f){var g,h=sjcl.bitArray;g=h.l;var l=b.length,k=h.bitLength(b);c=h.concat([h.partial(8,f-1)],c).concat([0,0,0]).slice(0,4);d=h.bitSlice(g(d,a.encrypt(c)),0,e);if(!l){return {tag:d,data:[]};}for(g=0;g<l;g+=4){c[3]++,e=a.encrypt(c),b[g]^=e[0],b[g+1]^=e[1],b[g+2]^=e[2],b[g+3]^=e[3];}return {tag:d,data:h.clamp(b,k)};}};sjcl.mode.ocb2={name:"ocb2",encrypt:function(a,b,c,d,e,f){128!==sjcl.bitArray.bitLength(c)&&q(new sjcl.exception.invalid("ocb iv must be 128 bits"));var g,h=sjcl.mode.ocb2.H,l=sjcl.bitArray,k=l.l,n=[0,0,0,0];c=h(a.encrypt(c));var m,p=[];d=d||[];e=e||64;for(g=0;g+4<b.length;g+=4){m=b.slice(g,g+4),n=k(n,m),p=p.concat(k(c,a.encrypt(k(c,m)))),c=h(c);}m=b.slice(g);b=l.bitLength(m);g=a.encrypt(k(c,[0,0,0,b]));m=l.clamp(k(m.concat([0,0,0]),g),b);n=k(n,k(m.concat([0,0,0]),g));n=a.encrypt(k(n,k(c,h(c))));d.length&&(n=k(n,f?d:sjcl.mode.ocb2.pmac(a,d)));return p.concat(l.concat(m,l.clamp(n,e)));},decrypt:function(a,b,c,d,e,f){128!==sjcl.bitArray.bitLength(c)&&q(new sjcl.exception.invalid("ocb iv must be 128 bits"));e=e||64;var g=sjcl.mode.ocb2.H,h=sjcl.bitArray,l=h.l,k=[0,0,0,0],n=g(a.encrypt(c)),m,p,s=sjcl.bitArray.bitLength(b)-e,r=[];d=d||[];for(c=0;c+4<s/32;c+=4){m=l(n,a.decrypt(l(n,b.slice(c,c+4)))),k=l(k,m),r=r.concat(m),n=g(n);}p=s-32*c;m=a.encrypt(l(n,[0,0,0,p]));m=l(m,h.clamp(b.slice(c),p).concat([0,0,0]));k=l(k,m);k=a.encrypt(l(k,l(n,g(n))));d.length&&(k=l(k,f?d:sjcl.mode.ocb2.pmac(a,d)));h.equal(h.clamp(k,e),h.bitSlice(b,s))||q(new sjcl.exception.corrupt("ocb: tag doesn't match"));return r.concat(h.clamp(m,p));},pmac:function(a,b){var c,d=sjcl.mode.ocb2.H,e=sjcl.bitArray,f=e.l,g=[0,0,0,0],h=a.encrypt([0,0,0,0]),h=f(h,d(d(h)));for(c=0;c+4<b.length;c+=4){h=d(h),g=f(g,a.encrypt(f(h,b.slice(c,c+4))));}c=b.slice(c);128>e.bitLength(c)&&(h=f(h,d(h)),c=e.concat(c,[-2147483648,0,0,0]));g=f(g,c);return a.encrypt(f(d(f(h,d(h))),g));},H:function(a){return [a[0]<<1^a[1]>>>31,a[1]<<1^a[2]>>>31,a[2]<<1^a[3]>>>31,a[3]<<1^135*(a[0]>>>31)];}};sjcl.mode.gcm={name:"gcm",encrypt:function(a,b,c,d,e){var f=b.slice(0);b=sjcl.bitArray;d=d||[];a=sjcl.mode.gcm.p(!0,a,f,d,c,e||128);return b.concat(a.data,a.tag);},decrypt:function(a,b,c,d,e){var f=b.slice(0),g=sjcl.bitArray,h=g.bitLength(f);e=e||128;d=d||[];e<=h?(b=g.bitSlice(f,h-e),f=g.bitSlice(f,0,h-e)):(b=f,f=[]);a=sjcl.mode.gcm.p(u,a,f,d,c,e);g.equal(a.tag,b)||q(new sjcl.exception.corrupt("gcm: tag doesn't match"));return a.data;},Z:function(a,b){var c,d,e,f,g,h=sjcl.bitArray.l;e=[0,0,0,0];f=b.slice(0);for(c=0;128>c;c++){(d=0!==(a[Math.floor(c/32)]&1<<31-c%32))&&(e=h(e,f));g=0!==(f[3]&1);for(d=3;0<d;d--){f[d]=f[d]>>>1|(f[d-1]&1)<<31;}f[0]>>>=1;g&&(f[0]^=-520093696);}return e;},g:function(a,b,c){var d,e=c.length;b=b.slice(0);for(d=0;d<e;d+=4){b[0]^=4294967295&c[d],b[1]^=4294967295&c[d+1],b[2]^=4294967295&c[d+2],b[3]^=4294967295&c[d+3],b=sjcl.mode.gcm.Z(b,a);}return b;},p:function(a,b,c,d,e,f){var g,h,l,k,n,m,p,s,r=sjcl.bitArray;m=c.length;p=r.bitLength(c);s=r.bitLength(d);h=r.bitLength(e);g=b.encrypt([0,0,0,0]);96===h?(e=e.slice(0),e=r.concat(e,[1])):(e=sjcl.mode.gcm.g(g,[0,0,0,0],e),e=sjcl.mode.gcm.g(g,e,[0,0,Math.floor(h/4294967296),h&4294967295]));h=sjcl.mode.gcm.g(g,[0,0,0,0],d);n=e.slice(0);d=h.slice(0);a||(d=sjcl.mode.gcm.g(g,h,c));for(k=0;k<m;k+=4){n[3]++,l=b.encrypt(n),c[k]^=l[0],c[k+1]^=l[1],c[k+2]^=l[2],c[k+3]^=l[3];}c=r.clamp(c,p);a&&(d=sjcl.mode.gcm.g(g,h,c));a=[Math.floor(s/4294967296),s&4294967295,Math.floor(p/4294967296),p&4294967295];d=sjcl.mode.gcm.g(g,d,a);l=b.encrypt(e);d[0]^=l[0];d[1]^=l[1];d[2]^=l[2];d[3]^=l[3];return {tag:r.bitSlice(d,0,f),data:c};}};sjcl.misc.hmac=function(a,b){this.M=b=b||sjcl.hash.sha256;var c=[[],[]],d,e=b.prototype.blockSize/32;this.n=[new b,new b];a.length>e&&(a=b.hash(a));for(d=0;d<e;d++){c[0][d]=a[d]^909522486,c[1][d]=a[d]^1549556828;}this.n[0].update(c[0]);this.n[1].update(c[1]);this.G=new b(this.n[0]);};sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(a){this.Q&&q(new sjcl.exception.invalid("encrypt on already updated hmac called!"));this.update(a);return this.digest(a);};sjcl.misc.hmac.prototype.reset=function(){this.G=new this.M(this.n[0]);this.Q=u;};sjcl.misc.hmac.prototype.update=function(a){this.Q=!0;this.G.update(a);};sjcl.misc.hmac.prototype.digest=function(){var a=this.G.finalize(),a=(new this.M(this.n[1])).update(a).finalize();this.reset();return a;};sjcl.misc.pbkdf2=function(a,b,c,d,e){c=c||1000;(0>d||0>c)&&q(sjcl.exception.invalid("invalid params to pbkdf2"));"string"===typeof a&&(a=sjcl.codec.utf8String.toBits(a));"string"===typeof b&&(b=sjcl.codec.utf8String.toBits(b));e=e||sjcl.misc.hmac;a=new e(a);var f,g,h,l,k=[],n=sjcl.bitArray;for(l=1;32*k.length<(d||1);l++){e=f=a.encrypt(n.concat(b,[l]));for(g=1;g<c;g++){f=a.encrypt(f);for(h=0;h<f.length;h++){e[h]^=f[h];}}k=k.concat(e);}d&&(k=n.clamp(k,d));return k;};sjcl.prng=function(a){this.c=[new sjcl.hash.sha256];this.i=[0];this.F=0;this.s={};this.C=0;this.K={};this.O=this.d=this.j=this.W=0;this.b=[0,0,0,0,0,0,0,0];this.f=[0,0,0,0];this.A=t;this.B=a;this.q=u;this.w={progress:{},seeded:{}};this.m=this.V=0;this.t=1;this.u=2;this.S=65536;this.I=[0,48,64,96,128,192,256,384,512,768,1024];this.T=30000;this.R=80;};sjcl.prng.prototype={randomWords:function(a,b){var c=[],d;d=this.isReady(b);var e;d===this.m&&q(new sjcl.exception.notReady("generator isn't seeded"));if(d&this.u){d=!(d&this.t);e=[];var f=0,g;this.O=e[0]=(new Date).valueOf()+this.T;for(g=0;16>g;g++){e.push(4294967296*Math.random()|0);}for(g=0;g<this.c.length&&!(e=e.concat(this.c[g].finalize()),f+=this.i[g],this.i[g]=0,!d&&this.F&1<<g);g++){}this.F>=1<<this.c.length&&(this.c.push(new sjcl.hash.sha256),this.i.push(0));this.d-=f;f>this.j&&(this.j=f);this.F++;this.b=sjcl.hash.sha256.hash(this.b.concat(e));this.A=new sjcl.cipher.aes(this.b);for(d=0;4>d&&!(this.f[d]=this.f[d]+1|0,this.f[d]);d++){}}for(d=0;d<a;d+=4){0===(d+1)%this.S&&A(this),e=B(this),c.push(e[0],e[1],e[2],e[3]);}A(this);return c.slice(0,a);},setDefaultParanoia:function(a,b){0===a&&"Setting paranoia=0 will ruin your security; use it only for testing"!==b&&q("Setting paranoia=0 will ruin your security; use it only for testing");this.B=a;},addEntropy:function(a,b,c){c=c||"user";var d,e,f=(new Date).valueOf(),g=this.s[c],h=this.isReady(),l=0;d=this.K[c];d===t&&(d=this.K[c]=this.W++);g===t&&(g=this.s[c]=0);this.s[c]=(this.s[c]+1)%this.c.length;switch(typeof a){case "number":b===t&&(b=1);this.c[g].update([d,this.C++,1,b,f,1,a|0]);break;case "object":c=Object.prototype.toString.call(a);if("[object Uint32Array]"===c){e=[];for(c=0;c<a.length;c++){e.push(a[c]);}a=e;}else{"[object Array]"!==c&&(l=1);for(c=0;c<a.length&&!l;c++){"number"!==typeof a[c]&&(l=1);}}if(!l){if(b===t){for(c=b=0;c<a.length;c++){for(e=a[c];0<e;){b++,e>>>=1;}}}this.c[g].update([d,this.C++,2,b,f,a.length].concat(a));}break;case "string":b===t&&(b=a.length);this.c[g].update([d,this.C++,3,b,f,a.length]);this.c[g].update(a);break;default:l=1;}l&&q(new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string"));this.i[g]+=b;this.d+=b;h===this.m&&(this.isReady()!==this.m&&C("seeded",Math.max(this.j,this.d)),C("progress",this.getProgress()));},isReady:function(a){a=this.I[a!==t?a:this.B];return this.j&&this.j>=a?this.i[0]>this.R&&(new Date).valueOf()>this.O?this.u|this.t:this.t:this.d>=a?this.u|this.m:this.m;},getProgress:function(a){a=this.I[a?a:this.B];return this.j>=a?1:this.d>a?1:this.d/a;},startCollectors:function(){this.q||(this.a={loadTimeCollector:D(this,this.aa),mouseCollector:D(this,this.ba),keyboardCollector:D(this,this.$),accelerometerCollector:D(this,this.U)},window.addEventListener?(window.addEventListener("load",this.a.loadTimeCollector,u),window.addEventListener("mousemove",this.a.mouseCollector,u),window.addEventListener("keypress",this.a.keyboardCollector,u),window.addEventListener("devicemotion",this.a.accelerometerCollector,u)):document.attachEvent?(document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector)):q(new sjcl.exception.bug("can't attach event")),this.q=!0);},stopCollectors:function(){this.q&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,u),window.removeEventListener("mousemove",this.a.mouseCollector,u),window.removeEventListener("keypress",this.a.keyboardCollector,u),window.removeEventListener("devicemotion",this.a.accelerometerCollector,u)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.q=u);},addEventListener:function(a,b){this.w[a][this.V++]=b;},removeEventListener:function(a,b){var c,d,e=this.w[a],f=[];for(d in e){e.hasOwnProperty(d)&&e[d]===b&&f.push(d);}for(c=0;c<f.length;c++){d=f[c],delete e[d];}},$:function(){E(1);},ba:function(a){sjcl.random.addEntropy([a.x||a.clientX||a.offsetX||0,a.y||a.clientY||a.offsetY||0],2,"mouse");E(0);},aa:function(){E(2);},U:function(a){a=a.accelerationIncludingGravity.x||a.accelerationIncludingGravity.y||a.accelerationIncludingGravity.z;if(window.orientation){var b=window.orientation;"number"===typeof b&&sjcl.random.addEntropy(b,1,"accelerometer");}a&&sjcl.random.addEntropy(a,2,"accelerometer");E(0);}};function C(a,b){var c,d=sjcl.random.w[a],e=[];for(c in d){d.hasOwnProperty(c)&&e.push(d[c]);}for(c=0;c<e.length;c++){e[c](b);}};function E(a){window&&window.performance&&"function"===typeof window.performance.now?sjcl.random.addEntropy(window.performance.now(),a,"loadtime"):sjcl.random.addEntropy((new Date).valueOf(),a,"loadtime");};function A(a){a.b=B(a).concat(B(a));a.A=new sjcl.cipher.aes(a.b);};function B(a){for(var b=0;4>b&&!(a.f[b]=a.f[b]+1|0,a.f[b]);b++){}return a.A.encrypt(a.f);};function D(a,b){return function(){b.apply(a,arguments);};};sjcl.random=new sjcl.prng(6);a:try{var F,G,H,I;if(I="undefined"!==typeof _10e){var J;if(J=_10e.exports){var K;try{K=_10c("crypto");}catch(L){K=null;}J=(G=K)&&G.randomBytes;}I=J;}if(I){F=G.randomBytes(128),F=new Uint32Array((new Uint8Array(F)).buffer),sjcl.random.addEntropy(F,1024,"crypto['randomBytes']");}else{if(window&&Uint32Array){H=new Uint32Array(32);if(window.crypto&&window.crypto.getRandomValues){window.crypto.getRandomValues(H);}else{if(window.msCrypto&&window.msCrypto.getRandomValues){window.msCrypto.getRandomValues(H);}else{break a;}}sjcl.random.addEntropy(H,1024,"crypto['getRandomValues']");}}}catch(M){"undefined"!==typeof window&&window.console&&(undefined,undefined);}sjcl.json={defaults:{v:1,iter:1000,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},Y:function(a,b,c,d){c=c||{};d=d||{};var e=sjcl.json,f=e.e({iv:sjcl.random.randomWords(4,0)},e.defaults),g;e.e(f,c);c=f.adata;"string"===typeof f.salt&&(f.salt=sjcl.codec.base64.toBits(f.salt));"string"===typeof f.iv&&(f.iv=sjcl.codec.base64.toBits(f.iv));(!sjcl.mode[f.mode]||!sjcl.cipher[f.cipher]||"string"===typeof a&&100>=f.iter||64!==f.ts&&96!==f.ts&&128!==f.ts||128!==f.ks&&192!==f.ks&&256!==f.ks||2>f.iv.length||4<f.iv.length)&&q(new sjcl.exception.invalid("json encrypt: invalid parameters"));"string"===typeof a?(g=sjcl.misc.cachedPbkdf2(a,f),a=g.key.slice(0,f.ks/32),f.salt=g.salt):sjcl.ecc&&a instanceof sjcl.ecc.elGamal.publicKey&&(g=a.kem(),f.kemtag=g.tag,a=g.key.slice(0,f.ks/32));"string"===typeof b&&(b=sjcl.codec.utf8String.toBits(b));"string"===typeof c&&(c=sjcl.codec.utf8String.toBits(c));g=new sjcl.cipher[f.cipher](a);e.e(d,f);d.key=a;f.ct=sjcl.mode[f.mode].encrypt(g,b,f.iv,c,f.ts);return f;},encrypt:function(a,b,c,d){var e=sjcl.json,f=e.Y.apply(e,arguments);return e.encode(f);},X:function(a,b,c,d){c=c||{};d=d||{};var e=sjcl.json;b=e.e(e.e(e.e({},e.defaults),b),c,!0);var f;c=b.adata;"string"===typeof b.salt&&(b.salt=sjcl.codec.base64.toBits(b.salt));"string"===typeof b.iv&&(b.iv=sjcl.codec.base64.toBits(b.iv));(!sjcl.mode[b.mode]||!sjcl.cipher[b.cipher]||"string"===typeof a&&100>=b.iter||64!==b.ts&&96!==b.ts&&128!==b.ts||128!==b.ks&&192!==b.ks&&256!==b.ks||!b.iv||2>b.iv.length||4<b.iv.length)&&q(new sjcl.exception.invalid("json decrypt: invalid parameters"));"string"===typeof a?(f=sjcl.misc.cachedPbkdf2(a,b),a=f.key.slice(0,b.ks/32),b.salt=f.salt):sjcl.ecc&&a instanceof sjcl.ecc.elGamal.secretKey&&(a=a.unkem(sjcl.codec.base64.toBits(b.kemtag)).slice(0,b.ks/32));"string"===typeof c&&(c=sjcl.codec.utf8String.toBits(c));f=new sjcl.cipher[b.cipher](a);c=sjcl.mode[b.mode].decrypt(f,b.ct,b.iv,c,b.ts);e.e(d,b);d.key=a;return sjcl.codec.utf8String.fromBits(c);},decrypt:function(a,b,c,d){var e=sjcl.json;return e.X(a,e.decode(b),c,d);},encode:function(a){var b,c="{",d="";for(b in a){if(a.hasOwnProperty(b)){switch(b.match(/^[a-z0-9]+$/i)||q(new sjcl.exception.invalid("json encode: invalid property name")),c+=d+"\""+b+"\":",d=",",typeof a[b]){case "number":case "boolean":c+=a[b];break;case "string":c+="\""+escape(a[b])+"\"";break;case "object":c+="\""+sjcl.codec.base64.fromBits(a[b],0)+"\"";break;default:q(new sjcl.exception.bug("json encode: unsupported type"));}}}return c+"}";},decode:function(a){a=a.replace(/\s/g,"");a.match(/^\{.*\}$/)||q(new sjcl.exception.invalid("json decode: this isn't json!"));a=a.replace(/^\{|\}$/g,"").split(/,/);var b={},c,d;for(c=0;c<a.length;c++){(d=a[c].match(/^(?:(["']?)([a-z][a-z0-9]*)\1):(?:(\d+)|"([a-z0-9+\/%*_.@=\-]*)")$/i))||q(new sjcl.exception.invalid("json decode: this isn't json!")),b[d[2]]=d[3]?parseInt(d[3],10):d[2].match(/^(ct|salt|iv)$/)?sjcl.codec.base64.toBits(d[4]):unescape(d[4]);}return b;},e:function(a,b,c){a===t&&(a={});if(b===t){return a;}for(var d in b){b.hasOwnProperty(d)&&(c&&(a[d]!==t&&a[d]!==b[d])&&q(new sjcl.exception.invalid("required parameter overridden")),a[d]=b[d]);}return a;},ea:function(a,b){var c={},d;for(d in a){a.hasOwnProperty(d)&&a[d]!==b[d]&&(c[d]=a[d]);}return c;},da:function(a,b){var c={},d;for(d=0;d<b.length;d++){a[b[d]]!==t&&(c[b[d]]=a[b[d]]);}return c;}};sjcl.encrypt=sjcl.json.encrypt;sjcl.decrypt=sjcl.json.decrypt;sjcl.misc.ca={};sjcl.misc.cachedPbkdf2=function(a,b){var c=sjcl.misc.ca,d;b=b||{};d=b.iter||1000;c=c[a]=c[a]||{};d=c[d]=c[d]||{firstSalt:b.salt&&b.salt.length?b.salt.slice(0):sjcl.random.randomWords(2,0)};c=b.salt===t?d.firstSalt:b.salt;d[c]=d[c]||sjcl.misc.pbkdf2(a,c,b.iter);return {key:d[c].slice(0),salt:c.slice(0)};};});},"url:cb/page/boards/toolbar/Toolbar.html":"<div class=\"browser-toolbar\">\n    <div class=\"projects-select button-group browser-toolbar__left-container\">\n        <div data-dojo-attach-point=\"_projectSelectContainer\" class=\"button clean portfolio-select\"></div>\n        <span class=\"button clean create-portfolio\" data-dojo-attach-point=\"_createPortfolioButton\" data-dojo-attach-event=\"click: _onCreatePortfolioButtonClick\"><i class=\"fonticon-addportfolio\"></i> ${!i18n.project_new}</span>\n    </div>\n    <div class=\"browser-toolbar__right-container\">\n        <div id=\"boards-search-submit\" data-dojo-type=\"cb.widget.SearchSubmit\" data-dojo-attach-point=\"_searchSubmit\"></div>\n        <div data-dojo-type=\"cb.page.boards.personalcontainer.Filter\"></div>\n        \n        <div class=\"display-style button-group\">\n            <span onclick=\"sp.global.analytics.trackEvent('boardsDisplay','normal');\" class=\"button clean js-filter-display-link normal active\" spFilterKey=\"normal\" title=\"${!i18n.display_normal}\" data-dojo-attach-point=\"_displayTypeNormalNode\"><i class=\"fonticon-boards\"></i></span>\n            <span onclick=\"sp.global.analytics.trackEvent('boardsDisplay','flat');\" class=\"button clean js-filter-display-link flat\" spFilterKey=\"flat\" title=\"${!i18n.display_flat}\" data-dojo-attach-point=\"_displayTypeFlatNode\"><i class=\"fonticon-list\"></i></span>\n        </div>\n        <div class=\"sort button clean\">\n             <select class=\"js-filter-sort-link\" data-dojo-type=\"dijit.form.Select\" data-baseClass=\"private-page-filter-sort-select\" data-dojo-attach-point=\"_sortSelect\">\n                 <option value=\"lastmodifiedat\">${!i18n.sort_lastmodifiedat}</option>\n                 <option value=\"alphabet\">${!i18n.sort_alphabet}</option>\n             </select>\n         </div>\n     </div>\n</div>","cb/contacts/ContactsInviteDialog":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/on","dojo/when","dojo/topic","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/keys","dijit/focus","sp/dialog/TooltipDialog","sp/dialog/DialogContent","sp/ajax/AjaxEngine","sp/infos/InfoManager","sp/I18n","cb/Capabilities","./ContactsInviteTools","dojo/i18n!./nls/Contacts","dojo/text!./ContactsInviteDialog.html"],function(_10f,lang,on,when,_110,_111,_112,_113,keys,_114,_115,_116,_117,_118,_119,_11a,_11b,i18n,_11c){var _11d=_10f([_116],{i18n:i18n,templateString:_11c,widgetsInTemplate:true,buildRendering:function(){this.inherited(arguments);if(!this.dialog.referralStatus){console.warn("Referral status missing..");}this.contactsInviteTools=new _11b({"referralStatus":this.dialog.referralStatus},this._inviteToolsContainer);},startup:function(){this.inherited(arguments);this.contactsInviteTools.startup();},_handleCloseButtonClick:function(){this.dialog.hide();}});return _10f([_115],{baseClass:"contacts-invite-dialog",postCreate:function(){this.inherited(arguments);this.content=new _11d({dialog:this});}});});},"sp/JavaDeployer":function(){define(["dijit","dojo","dojox","dojo/require!dijit/_base/manager"],function(_11e,dojo,_11f){dojo.provide("sp.JavaDeployer");dojo.require("dijit._base.manager");sp.JavaDeployerRepository={};dojo.declare("sp.JavaDeployer",null,{constructor:function(_120,_121){this.container=_121;this.id=_11e.getUniqueId("sp_JavaDeployer");sp.JavaDeployerRepository[this.id]=this;window["sp_JavaDeployerRepository_"+this.id]=this;var _122="sp_JavaDeployerRepository_"+this.id+"_";dojo.forEach(["trackWithAnalytics","onAppletStarted","onAppletError","onAppletShutdown","onSuccessfullUpload","addRecentEditUrl","onUploadStart"],function(_123){window[_122+_123]=dojo.hitch(this,function(){var _124=arguments;var that=this;window.setTimeout(function(){that[_123].apply(that,_124);},1);});},this);this._installPopUp=null;this._locale=_120||"en";this._deployJava=this._createJavaDeploy();this._deployJava.locale=this._locale;this._deployJava.do_initialize();},showUrlAfterInstallation:function(url){location.href=url;},installJavaVersionWithUrl:function(url){dojo.query(".installJavaLink",this.container).connect("onclick",dojo.hitch(this,function(_125){if(dojo.isObject(this._installedPopup)&&!this._installPopUp.closed){this._installPopUp.location.href=url;}else{this._installPopUp=window.open(url,"installJavaWindow","location=yes,menubar=yes,resizable=yes,scrollbars=yes,status=yes,toolbar=yes");this._installPopUp.focus();}dojo.stopEvent(_125);}));dojo.query(".installJava",this.container).style("display","block");dojo.query(".appletContainerTextLoading",this.containerode).style("display","none");dojo.query(".appletContainerTextReady",this.container).style("display","none");},runApplet:function(_126,_127,_128){_126=dojo.mixin(_126,{});_127=dojo.mixin(_127,{javadeployerid:this.id});this._deployJava.runApplet(_126,_127,_128);},_createJavaDeploy:function(){return {javaDeployer:this,debug:null,myInterval:null,preInstallJREList:null,returnPage:null,brand:null,locale:null,installType:null,EAInstallEnabled:false,EarlyAccessURL:null,getJavaURL:"http://jdl.sun.com/webapps/getjava/BrowserRedirect?host=java.com",appleRedirectPage:"http://www.apple.com/support/downloads/",mimeType:"application/npruntime-scriptable-plugin;DeploymentToolkit",launchButtonPNG:"http://java.sun.com/products/jfc/tsc/articles/swing2d/webstart.png",getJREs:function(){var list=[];if(this.isPluginInstalled()){var _129=this.getPlugin();for(var i=0;i<_129.jvms.getLength();i++){list[i]=_129.jvms.get(i).version;}}else{var _12a=this.getBrowser();if(_12a=="MSIE"){if(this.testUsingActiveX("1.8.0")){list[0]="1.8.0";}else{if(this.testUsingActiveX("1.7.0")){list[0]="1.7.0";}else{if(this.testUsingActiveX("1.6.0")){list[0]="1.6.0";}else{if(this.testUsingActiveX("1.5.0")){list[0]="1.5.0";}else{if(this.testUsingActiveX("1.4.2")){list[0]="1.4.2";}else{if(this.testForMSVM()){list[0]="1.1";}}}}}}}else{if(_12a=="Netscape Family"){if(this.testUsingMimeTypes("1.8")){list[0]="1.8.0";}else{if(this.testUsingMimeTypes("1.7")){list[0]="1.7.0";}else{if(this.testUsingMimeTypes("1.6")){list[0]="1.6.0";}else{if(this.testUsingMimeTypes("1.5")){list[0]="1.5.0";}else{if(this.testUsingMimeTypes("1.4.2")){list[0]="1.4.2";}}}}}}else{if(_12a=="Safari"){if(this.testUsingPluginsArray("1.8.0")){list[0]="1.8.0";}else{if(this.testUsingPluginsArray("1.7.0")){list[0]="1.7.0";}else{if(this.testUsingPluginsArray("1.6.0")){list[0]="1.6.0";}else{if(this.testUsingPluginsArray("1.5.0")){list[0]="1.5.0";}else{if(this.testUsingPluginsArray("1.4.2")){list[0]="1.4.2";}}}}}}}}}if(this.debug){for(var k=0;k<list.length;k++){alert("We claim to have detected Java SE "+list[k]);}}return list;},installJRE:function(_12b){var ret=false;if(this.isPluginInstalled()){if(this.getPlugin().installJRE(_12b)){this.refresh();if(this.returnPage!=null){document.location=this.returnPage;}return true;}else{return false;}}else{return this.installLatestJRE();}},installLatestJRE:function(){if(this.isPluginInstalled()){if(this.getPlugin().installLatestJRE()){this.refresh();if(this.returnPage!=null){document.location=this.returnPage;}return true;}else{return false;}}else{var _12c=this.getBrowser();var _12d=navigator.platform.toLowerCase();if((this.EAInstallEnabled=="true")&&(_12d.indexOf("win")!=-1)&&(this.EarlyAccessURL!=null)){this.preInstallJREList=this.getJREs();if(this.returnPage!=null){this.myInterval=setInterval("this.poll()",3000);}this.javaDeployer.installJavaVersionWithUrl(this.EarlyAccessURL);return false;}else{if(_12c=="MSIE"){return this.IEInstall();}else{if((_12c=="Netscape Family")&&(_12d.indexOf("win32")!=-1)){return this.FFInstall();}else{var _12e=this.getJavaURL+((this.returnPage!=null)?("&returnPage="+this.returnPage):"")+((this.locale!=null)?("&locale="+this.locale):"")+((this.brand!=null)?("&brand="+this.brand):"");this.javaDeployer.installJavaVersionWithUrl(_12e);}}return false;}}},runApplet:function(_12f,_130,_131){if(_131=="undefined"||_131==null){_131="1.1";}var _132="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?$";var _133=_131.match(_132);if(this.returnPage==null){this.returnPage=escape(document.location);}if(_133!=null){var _134=this.getBrowser();if((_134!="?")&&(_134!="Safari")){if(this.versionCheck(_131+"+")){this.writeAppletTag(_12f,_130);}else{if(this.installJRE(_131+"+")){this.refresh();location.href=document.location;this.writeAppletTag(_12f,_130);}}}else{this.writeAppletTag(_12f,_130);}}else{if(this.debug){alert("Invalid minimumVersion argument to runApplet():"+_131);}}},checkJavaVersion:function(_135){if(_135=="undefined"||_135==null){_135="1.1";}var _136="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?$";var _137=_135.match(_136);if(_137!=null){var _138=this.getBrowser();if((_138!="?")&&(_138!="Safari")){if(this.versionCheck(_135+"+")){return true;}else{return false;}}else{this.writeAppletTag(attributes,parameters);return true;}}else{if(this.debug){alert("Invalid minimumVersion argument to runApplet():"+_135);}}},writeAppletTag:function(_139,_13a){var _13b="";var s="<"+"applet ";for(var _13c in _139){if(_139.hasOwnProperty(_13c)){s+=(" "+_13c+"=\""+_139[_13c]+"\"");}}s+=">";_13b+=s;if(_13a!="undefined"&&_13a!=null){var _13d=false;for(var _13e in _13a){if(_13a.hasOwnProperty(_13e)){if(_13e=="codebase_lookup"){_13d=true;}s="<param name=\""+_13e+"\" value=\""+_13a[_13e]+"\">";_13b+=s;}}if(!_13d){_13b+="<param name=\"codebase_lookup\" value=\"false\">";}}_13b+="<"+"/"+"applet"+">";this.writeHtml(_13b);},versionCheck:function(_13f){var _140=0;var _141="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?(\\*|\\+)?$";var _142=_13f.match(_141);if(_142!=null){var _143=true;var _144=new Array();for(var i=1;i<_142.length;++i){if((typeof _142[i]=="string")&&(_142[i]!="")){_144[_140]=_142[i];_140++;}}if(_144[_144.length-1]=="+"){_143=false;_144.length--;}else{if(_144[_144.length-1]=="*"){_144.length--;}}var list=this.getJREs();for(var i=0;i<list.length;++i){if(this.compareVersionToPattern(list[i],_144,_143)){return true;}}return false;}else{alert("Invalid versionPattern passed to versionCheck: "+_13f);return false;}},isWebStartInstalled:function(_145){var _146=this.getBrowser();if((_146=="?")||(_146=="Safari")){return true;}if(_145=="undefined"||_145==null){_145="1.4.2";}var _147=false;var _148="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?$";var _149=_145.match(_148);if(_149!=null){_147=this.versionCheck(_145+"+");}else{if(this.debug){alert("Invalid minimumVersion argument to isWebStartInstalled(): "+_145);}_147=this.versionCheck("1.4.2+");}return _147;},createWebStartLaunchButton:function(jnlp,_14a){if(this.returnPage==null){this.returnPage=escape(jnlp);}var url="javascript:"+"if (!this.isWebStartInstalled(&quot;"+_14a+"&quot;)) {"+"if (this.installLatestJRE()) {"+"if (this.launch(&quot;"+jnlp+"&quot;)) {}"+"}"+"} else {"+"if (this.launch(&quot;"+jnlp+"&quot;)) {}"+"}";this.writeHtml("<"+"a href=\""+url+"\" onMouseOver=\"window.status=''; "+"return true;\"><"+"img "+"src=\""+this.launchButtonPNG+"\" "+"border=\"0\" /><"+"/"+"a"+">");},launch:function(jnlp){if(this.isPluginInstalled()){return this.getPlugin().launch(jnlp);}else{document.location=jnlp;return true;}},isPluginInstalled:function(){var _14b=this.getPlugin();if(_14b&&_14b.jvms){return true;}else{return false;}},isAutoUpdateEnabled:function(){if(this.isPluginInstalled()){return this.getPlugin().isAutoUpdateEnabled();}return false;},setAutoUpdateEnabled:function(){if(this.isPluginInstalled()){return this.getPlugin().setAutoUpdateEnabled();}return false;},setInstallerType:function(type){this.installType=type;if(this.isPluginInstalled()){return this.getPlugin().setInstallerType(type);}return false;},setAdditionalPackages:function(_14c){if(this.isPluginInstalled()){return this.getPlugin().setAdditionalPackages(_14c);}return false;},setEarlyAccess:function(_14d){this.EAInstallEnabled=_14d;},isPlugin2:function(){if(this.isPluginInstalled()){try{return this.getPlugin().isPlugin2();}catch(err){}}return false;},getPlugin:function(){this.refresh();var ret=document.getElementById("deployJavaPlugin");return ret;},compareVersionToPattern:function(_14e,_14f,_150){var _151="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?$";var _152=_14e.match(_151);if(_152!=null){var _153=0;var _154=new Array();for(var i=1;i<_152.length;++i){if((typeof _152[i]=="string")&&(_152[i]!="")){_154[_153]=_152[i];_153++;}}var l=Math.min(_154.length,_14f.length);if(_150){for(var i=0;i<l;++i){if(_154[i]!=_14f[i]){return false;}}return true;}else{for(var i=0;i<l;++i){if(_154[i]<_14f[i]){return false;}else{if(_154[i]>_14f[i]){return true;}}}return true;}}else{return false;}},getBrowser:function(){var _155=navigator.userAgent.toLowerCase();if(this.debug){alert("userAgent -> "+_155);}if((navigator.vendor)&&(navigator.vendor.toLowerCase().indexOf("apple")!=-1)&&(_155.indexOf("safari")!=-1)){if(this.debug){alert("We claim to have detected \"Safari\".");}return "Safari";}else{if(_155.indexOf("msie")!=-1){if(this.debug){alert("We claim to have detected \"IE\".");}return "MSIE";}else{if((_155.indexOf("mozilla")!=-1)||(_155.indexOf("firefox")!=-1)){if(this.debug){alert("We claim to have detected a Netscape family browser.");}return "Netscape Family";}else{if(this.debug){alert("We claim to have failed to detect a browser.");}return "?";}}}},testUsingActiveX:function(_156){var _157="JavaWebStart.isInstalled."+_156+".0";if(!ActiveXObject){if(this.debug){alert("Browser claims to be IE, but no ActiveXObject object?");}return false;}try{return (new ActiveXObject(_157)!=null);}catch(exception){return false;}},testForMSVM:function(){var _158="{08B0E5C0-4FCB-11CF-AAA5-00401C608500}";if(typeof oClientCaps!="undefined"){var v=oClientCaps.getComponentVersion(_158,"ComponentID");if((v=="")||(v=="5,0,5000,0")){return false;}else{return true;}}else{return false;}},testUsingMimeTypes:function(_159){if(!navigator.mimeTypes){if(this.debug){alert("Browser claims to be Netscape family, but no mimeTypes[] array?");}return false;}for(var i=0;i<navigator.mimeTypes.length;++i){var s=navigator.mimeTypes[i].type;var m=s.match(/^application\/x-java-applet\x3Bversion=(1\.8|1\.7|1\.6|1\.5|1\.4\.2)$/);if(m!=null){if(this.compareVersions(m[1],_159)){return true;}}}return false;},testUsingPluginsArray:function(_15a){if((!navigator.plugins)||(!navigator.plugins.length)){if(this.debug){alert("Browser claims to be Safari, but no plugins[] array?");}return false;}for(var i=0;i<navigator.plugins.length;++i){s=navigator.plugins[i].description;if(s.search(/^Java Switchable Plug-in/)!=-1){return true;}m=s.match(/^Java (1\.4\.2|1\.5|1\.6|1\.7).* Plug-in/);if(m!=null){if(this.compareVersions(m[1],_15a)){return true;}}}return false;},IEInstall:function(){var _15b=this.getJavaURL+((this.returnPage!=null)?("&returnPage="+this.returnPage):"")+((this.locale!=null)?("&locale="+this.locale):"")+((this.brand!=null)?("&brand="+this.brand):"")+((this.installType!=null)?("&type="+this.installType):"");this.javaDeployer.installJavaVersionWithUrl(_15b);return false;},done:function(name,_15c){},FFInstall:function(){var _15d=this.getJavaURL+((this.returnPage!=null)?("&returnPage="+this.returnPage):"")+((this.locale!=null)?("&locale="+this.locale):"")+((this.brand!=null)?("&brand="+this.brand):"")+((this.installType!=null)?("&type="+this.installType):"");this.javaDeployer.installJavaVersionWithUrl(_15d);return false;},compareVersions:function(_15e,_15f){var a=_15e.split(".");var b=_15f.split(".");for(var i=0;i<a.length;++i){a[i]=Number(a[i]);}for(var i=0;i<b.length;++i){b[i]=Number(b[i]);}if(a.length==2){a[2]=0;}if(a[0]>b[0]){return true;}if(a[0]<b[0]){return false;}if(a[1]>b[1]){return true;}if(a[1]<b[1]){return false;}if(a[2]>b[2]){return true;}if(a[2]<b[2]){return false;}return true;},enableAlerts:function(){this.debug=true;},poll:function(){this.refresh();var _160=this.getJREs();if((this.preInstallJREList.length==0)&&(_160.length!=0)){clearInterval(this.myInterval);if(this.returnPage!=null){this.javaDeployer.showUrlAfterInstallation(this.returnPage);}}if((this.preInstallJREList.length!=0)&&(_160.length!=0)&&(this.preInstallJREList[0]!=_160[0])){clearInterval(this.myInterval);if(this.returnPage!=null){this.javaDeployer.showUrlAfterInstallation(this.returnPage);}}},writePluginTag:function(){var _161=this.getBrowser();if(_161=="MSIE"){this.writeHtml("<"+"object classid=\"clsid:CAFEEFAC-DEC7-0000-0000-ABCDEFFEDCBA\" "+"id=\"deployJavaPlugin\" width=\"0\" height=\"0\">"+"<"+"/"+"object"+">");}else{if(_161=="Netscape Family"){if(navigator.mimeTypes!=null){for(var i=0;i<navigator.mimeTypes.length;i++){if(navigator.mimeTypes[i].type==this.mimeType){if(navigator.mimeTypes[i].enabledPlugin){this.writeHtml("<"+"embed id=\"deployJavaPlugin\" type=\""+this.mimeType+"\" hidden=\"true\" />");}}}}}}},refresh:function(){navigator.plugins.refresh(false);var _162=this.getBrowser();if(_162=="Netscape Family"){var _163=document.getElementById("deployJavaPlugin");if(_163==null){if(navigator.mimeTypes!=null){for(var i=0;i<navigator.mimeTypes.length;i++){if(navigator.mimeTypes[i].type==this.mimeType){if(navigator.mimeTypes[i].enabledPlugin){this.writeHtml("<"+"embed id=\"deployJavaPlugin\" type=\""+this.mimeType+"\" hidden=\"true\" />");}}}}}}},do_initialize:function(){this.writePluginTag();if(this.locale==null){var loc=null;if(loc==null){try{loc=navigator.userLanguage;}catch(err){}}if(loc==null){try{loc=navigator.systemLanguage;}catch(err){}}if(loc==null){try{loc=navigator.language;}catch(err){}}if(loc!=null){loc.replace("-","_");this.locale=loc;}}},writeHtml:function(_164){this.javaDeployer.container.innerHTML+=_164;}};},trackWithAnalytics:function(_165){if(_165==="scratchpaste/initialized"){sp.global.analytics.trackEvent("board insert","screenshot applet","initialized");}else{if(_165==="scratchpaste/framesnapshot"){sp.global.analytics.trackEvent("board insert","screenshot applet","frame shot");}else{if(_165==="scratchpaste/fullscreensnapshot"){sp.global.analytics.trackEvent("board insert","screenshot applet","full screen shot");}else{if(_165==="scratchpaste/uploadfinished"){sp.global.analytics.trackEvent("board insert","screenshot applet","upload finished");}else{if(_165==="scratchpaste/appleterror"){sp.global.analytics.trackEvent("board insert","screenshot applet","error");}else{sp.global.analytics.trackEvent("board insert","screenshot applet",_165);}}}}}},onAppletStarted:function(){},onAppletError:function(){},onAppletShutdown:function(){},onSuccessfullUpload:function(_166){},addRecentEditUrl:function(_167){},onUploadStart:function(){}});});},"cb/page/profile_account/SocialConnectionList":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/dom-construct","dojo/_base/event","dijit/_Widget","cb/widget/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","cb/widget/SimpleTable","sp/infos/InfoManager","sp/ajax/AjaxEngine","sp/I18n","sp/dialog/YesNoDialog","dojo/i18n!./nls/SocialConnectionList","cb/widget/BigSwitch"],function(_168,dArr,lang,_169,_16a,_16b,_16c,_16d,_16e,_16f,_170,_171,_172,i18n,_173){var _174=_168([_16b,_16c,_16d],{baseClass:"socialconnection",templateString:"<li><strong>${connection.key.providerDisplayName}</strong> ${connection.displayName} <span class=\"remove-action\" data-dojo-attach-point=\"_removeSwitch\" data-dojo-props=\"'checked':'on'\" data-dojo-type=\"cb.widget.BigSwitch\" data-dojo-attach-event=\"onChange:_handleSwitchChange\"></span></li>",i18n:i18n,_handleSwitchChange:function(_175){if(!_175){var _176=new _172({questionText:_171.wrap(i18n)("confirm_delete",[this.connection.key.providerDisplayName]),hintText:_171.wrapToEmpty(i18n)("confirm_delete_hint_"+this.connection.key.providerId),okButtonText:_171.wrap(i18n)("confirm_delete_confirm"),onYes:lang.hitch(this,function(){return _170.deleteSocialConnection({providerId:this.connection.key.providerId,providerUserId:this.connection.key.providerUserId,userId:sp.info.user.id}).then(lang.hitch(this,function(_177){if(_177.success){this.store.remove(this.connection.id);}})).then(function(){_176.hide();},function(){_176.hide();});}),onNo:lang.hitch(this,function(){this._removeSwitch.set("checked",true);})});_176.show(this._removeSwitch.domNode);}}});var _178=_168([_16e],{type:"list",createEntryWidget:function(id,item,node){return new _174({connection:item,store:this.store},node);}});return _168([_16b],{baseClass:"socialconnection-list",postCreate:function(){this.inherited(arguments);_16f.getById({type:"socialconnections",id:sp.info.user.id}).then(lang.hitch(this,function(_179){if(_179.connections.length===0){this._showEmpty();}else{var _17a=this._socialConnectionList=new _178(null,_169.create("div",null,this.domNode));dArr.forEach(_179.connections,function(_17b){_17b.id=_17b.key.providerId+"/"+_17b.key.providerUserId;_17a.store.put(_17b);});}})).then(null,lang.hitch(this,function(_17c){this._showError();}));},_showError:function(){_169.create("p",{"innerHTML":_171.wrap(i18n)("error")},this.domNode);},_showEmpty:function(){_169.create("p",{"innerHTML":_171.wrap(i18n)("empty")},this.domNode);}});});},"url:cb/widget/BigSwitch.html":"<span class=\"big-switch\" >\n    <span class=\"switch-container\" data-dojo-attach-event=\"onclick:_onClick,onflick:_handleFlick\" data-dojo-attach-point=\"titleNode\">\n        <span class=\"switch\"></span>\n        <input\n            ${!nameAttrSetting} \n            type=\"${type}\" \n            ${checkedAttrSetting} \n            class=\"hideBlock\" \n            data-dojo-attach-point=\"focusNode\" />\n    </span>\n    <label for=\"${id}\" id=\"${id}_label\"\n        ><span class=\"dijitReset dijitInline dijitIcon\" data-dojo-attach-point=\"iconNode\"></span\n        ><span data-dojo-attach-point=\"containerNode\"></span\n        ></label\n    ><span class=\"hideBlock ${baseClass}Hint\" data-dojo-attach-point=\"_hintNode\"></span\n></span>","cb/contacts/ContactsFilters":function(){define(["dojo/ready","dojo/on","dojo/aspect","dojo/query","dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/dom-class","dojo/dom-attr","dojo/json","dojox/lang/functional","dojo/store/Memory","dojo/store/Observable","dojo/Stateful","dojo/date/stamp","dojo/promise/all","dijit/_WidgetBase","cb/widget/_TemplatedMixin","dijit/_Container","dijit/form/Select","cb/util","sp/dialog/NewBoardDialog","cb/api/Api","cb/Capabilities","cb/widget/_HideableMixin","cb/util","sp/infos/InfoManager","sp/I18n","cb/user/UserDisplay","sp/ActivityIndicatorMixin","./ContactsTableRow","./ContactsInviteTools","./ContactsTable","dojo/i18n!./nls/Contacts"],function(_17d,on,_17e,_17f,lang,_180,_181,_182,_183,_184,json,_185,_186,_187,_188,_189,_18a,_18b,_18c,_18d,_18e,util,_18f,Api,_190,_191,_192,_193,_194,_195,_196,_197,_198,_199,i18n){var I18N=_194.wrap(i18n);var _19a=(sp.info.company&&sp.info.company.id)||null;var _19b={"ALL_CONTACTS":{},"ALL_TEAM":function(_19c){return _19c.companyId&&_19c.companyId===_19a&&!_19c.role_student;},"OPEN_INVITATIONS":{invitation_accepted_or_null:false,companyId:_19a},"ACCEPTED_INVITATIONS":function(_19d){return _19d.invitation_accepted_or_null===true&&_19d.userId!==sp.info.user.info.id&&_19d.companyId===_19a;},"ADMINISTRATORS":{role_manager:true,invitation_accepted_or_null:true,companyId:_19a},"INTERNAL_USERS":{role_user:true,role_manager:undefined,invitation_accepted_or_null:true,companyId:_19a},"EXTERNAL_USERS":{role_external_user:true,invitation_accepted_or_null:true,companyId:_19a},"STUDENTS":{role_student:true,invitation_accepted_or_null:true,companyId:_19a}};return _181([_18b],{postCreate:function postCreate(){this.inherited(arguments);_183.add(this.domNode,"contacts-filter");this.own(on(this.domNode,".contacts-filter__filter[data-filter-id]:click",lang.hitch(this,"_handleFilterClick")));if(sp.info.user.info.accountType.asString==="basic"){this.set("filtersShown",["ALL_CONTACTS",["OPEN_INVITATIONS","ACCEPTED_INVITATIONS"]]);this.set("filter",this.get("filtersShown")[0]);}else{_193.getById({type:"companyuserV2",id:sp.info.user.id}).then(lang.hitch(this,function(_19e){if(_180.indexOf(_19e.companyuserV2.roles,"student")>-1){this.set("filtersShown",["ALL_CONTACTS"]);}else{if(_180.indexOf(_19e.companyuserV2.roles,"external_user")>-1){this.set("filtersShown",["ALL_CONTACTS"]);}else{if(sp.info.user.info.accountType.education){this.set("filtersShown",["ALL_CONTACTS","ALL_TEAM",["ADMINISTRATORS","INTERNAL_USERS","EXTERNAL_USERS","OPEN_INVITATIONS"],"STUDENTS"]);}else{this.set("filtersShown",["ALL_CONTACTS","ALL_TEAM",["ADMINISTRATORS","INTERNAL_USERS","EXTERNAL_USERS","OPEN_INVITATIONS"]]);}}}this.set("filter",this.get("filtersShown")[0]);}));}},_setFiltersShownAttr:function(_19f){_182.empty(this.domNode);var _1a0=this.store,self=this;function _1a1(root,_1a2){var _1a3=root;_180.forEach(_1a2,function(_1a4){if(lang.isArrayLike(_1a4)){_1a1(_182.create("ul",{"class":"contacts-filter__sub"},_1a3),_1a4);}else{var _1a5=_1a0.query(_19b[_1a4]);var _1a6=_1a3=_182.create("li",{"data-filter-id":_1a4,"class":"contacts-filter__filter"},root);var _1a7=_182.create("span",{"class":"contacts-filter__filter__label","innerHTML":I18N("contacts_filter_"+_1a4,[_1a5.length])},_1a6);_1a6.title=I18N("contacts_filter_title_"+_1a4,[_1a5.length]);self.own(_1a5.observe(function(){var _1a8=_1a0.query(_19b[_1a4]);_1a6.title=I18N("contacts_filter_title_"+_1a4,[_1a8.length]);_1a7.innerHTML=I18N("contacts_filter_"+_1a4,[_1a8.length]);}));}});};_1a1(_182.create("ul",null,this.domNode),_19f);this._set("filtersShown",_19f);this.set("filter",this.get("filter"));},_setFilterAttr:function(_1a9){_17f(".contacts-filter__filter",this.domNode).removeClass("contacts-filter__filter--active").filter(function(n){return _184.get(n,"data-filter-id")===_1a9;}).addClass("contacts-filter__filter--active");this._set("filter",_1a9);this.set("query",_19b[_1a9]);},_handleFilterClick:function(e){var _1aa=_17f(e.target).parent("[data-filter-id]").attr("data-filter-id")[0];if(_1aa){this.set("filter",_1aa);}}});});},"cb/personalcontainer/header/Header":function(){define(["dijit","dojo","dojox","dojo/i18n!cb/personalcontainer/header/nls/Header","dojo/require!cb/personalcontainer/header/UserProfileDialog,cb/widget/UserDialog,cb/notifications/AlertsButton,dojo/fx,dojo/cache,dijit/_Widget,cb/widget/_Templated,sp/I18n,sp/I18nWidget,sp/Tooltip,cb/Capabilities"],function(_1ab,dojo,_1ac){dojo.provide("cb.personalcontainer.header.Header");dojo.require("cb.personalcontainer.header.UserProfileDialog");dojo.require("cb.widget.UserDialog");dojo.require("cb.notifications.AlertsButton");dojo.require("dojo.fx");dojo.require("dojo.cache");dojo.require("dijit._Widget");dojo.require("cb.widget._Templated");dojo.require("sp.I18n");dojo.require("sp.I18nWidget");dojo.require("sp.Tooltip");dojo.require("cb.Capabilities");dojo.requireLocalization("cb.personalcontainer.header","Header");dojo.declare("cb.personalcontainer.header.Header",[_1ab._Widget,cb.widget._Templated,sp.I18nWidget],{widgetsInTemplate:true,skipWidgetBundle:false,templateString:dojo.cache("cb.personalcontainer.header","Header.html","<div class=\"profile-container-header\">\r\n    <span data-dojo-type=\"cb/notifications/AlertsButton\"></span>\r\n    <div class=\"button quiet profile\" data-dojo-attach-point=\"_profileButton\" data-dojo-attach-event=\"onclick:_profileButtonClick\">\r\n        <img src=\"/__/photo/user.id.small.png\" class=\"profile-image\" data-dojo-attach-point=\"_profileImage\"/>\r\n        <span class=\"user-name\" data-dojo-attach-point=\"_profileName\"></span> <i class=\"fonticon-triangle-down\"></i>\r\n    </div>\r\n</div>"),isPcHeader:true,userIsIdentified:sp.info.user.isIdentified,userId:null,userName:sp.info.user.info.displayname,sidebarState:null,controller:null,postCreate:function(){this.inherited("postCreate",arguments);this._updatePersonalContainerHeader();this._updateUserProfileInformation();this.connect(this.getParent(),"onSidebarToggle","_updateSidebarState");cb.Capabilities.checkFeature("announcements").then(function(_1ad){return _1ad==="enabled";}).then(dojo.hitch(this,function(_1ae){if(_1ae){new cb.notifications.Announcements(null,dojo.create("div",null,this.domNode,"first"));}}));},_updatePersonalContainerHeader:function(){if(!this.userIsIdentified){dojo.destroy(this._boardsButton);dojo.destroy(this._homeButton);dojo.addClass(this.domNode,"not-logged-in");}if(sp.info.document&&sp.info.document.ownerCompany){dojo.addClass(this.domNode,"no-report-subscribe");}},_updateUserProfileInformation:function(){this._profileName.innerHTML=sp.I18n.esc(sp.info.user.info.displayname);dojo.attr(this._profileImage,"src","/__/photo/"+sp.I18n.escAttr(this.userId)+".small.png");},_profileButtonClick:function(_1af){cb.Capabilities.checkFeature("registration.selfsignup").then(function(_1b0){return _1b0==="enabled";}).then(dojo.hitch(this,function(_1b1){var _1b2=new cb.personalcontainer.header.UserProfileDialog({controller:this.controller,featureRegistrationSelfsignup:_1b1});_1b2.show(this._profileButton);}));},_updateSidebarState:function(_1b3){dojo.toggleClass(this.domNode,"closed",_1b3);},_toggleSidebar:function(){if(this.getParent().getParent().toggleSidebar){this.getParent().getParent().toggleSidebar();}}});});},"cb/contacts/ContactsPage":function(){define(["dojo/ready","dojo/when","dojo/on","dojo/aspect","dojo/query","dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/dom-class","dojo/dom-attr","dojo/json","dojox/lang/functional","dojo/store/Memory","dojo/store/Observable","dojo/Stateful","dojo/date/stamp","dojo/promise/all","dijit/_WidgetBase","cb/widget/_TemplatedMixin","dijit/_Container","dijit/form/Select","dijit/layout/ContentPane","dijit/registry","cb/util","sp/dialog/NewBoardDialog","sp/dialog/TooltipDialog","cb/api/Api","cb/Capabilities","cb/widget/_HideableMixin","cb/util","sp/infos/InfoManager","sp/I18n","cb/user/UserDisplay","sp/ActivityIndicatorMixin","./ContactsTableRow","./ContactsInviteDialog","./ContactsTable","./ContactsFilters","./RoleSelect","dojo/text!./ContactsPageLayout.html","dojo/i18n!./nls/Contacts"],function(_1b4,when,on,_1b5,_1b6,lang,_1b7,_1b8,_1b9,_1ba,_1bb,json,_1bc,_1bd,_1be,_1bf,_1c0,_1c1,_1c2,_1c3,_1c4,_1c5,_1c6,_1c7,util,_1c8,_1c9,Api,_1ca,_1cb,_1cc,_1cd,_1ce,_1cf,_1d0,_1d1,_1d2,_1d3,_1d4,_1d5,_1d6,i18n){var I18N=_1ce.wrap(i18n);var _1d7=_1cc.relayMethodInvocation;var _1d8=_1cc.watchAndGetImmediately;var _1d9=function _1d9(_1da){return [_1da.contactId,_1da.contactType].join(":");};var _1db=_1b8([_1c2,_1c3],{baseClass:"join-requests",templateString:"<div class=\"${baseClass} content-module\"><h3 data-dojo-attach-point=\"_titleNode\"></h3><ul data-dojo-attach-point=\"_requestsListNode\"></ul></div>",joinRequests:null,parentWidget:null,postCreate:function(){this.inherited(arguments);this._titleNode.innerHTML=I18N("joinrequests_headline",[this.joinRequests.length]);_1b7.forEach(this.joinRequests,lang.hitch(this,function(_1dc){var _1dd={size:"large",displayname:_1dc.displayname,emailAdresses:{unconfirmedEmailAdress:_1dc.email},forceEmailSubline:true};if(_1dc.identifier.providerId==="conceptboard"){_1dd.userId=_1dc.identifier.providerUserId;}var _1de=_1b9.create("li",{"class":this.baseClass+"__request"});var _1df=new _1cf(_1dd,_1b9.create("div",null,_1de));var _1e0=_1b9.create("div",{"class":this.baseClass+"__request__action-container"},_1de,"last");_1b9.create("span",{"class":this.baseClass+"__request__date","innerHTML":I18N("joinrequests_createdat",[_1dc.createdAt])},_1de);var _1e1=_1b9.create("span",{"class":this.baseClass+"__request__action-container__accept button","innerHTML":"<i class=\"fonticon-invite\"></i> "+I18N("joinrequests_action_accept")},_1e0,"last");this.own(on(_1e1,"click",lang.hitch(this,function(_1e2){this._handleInviteLinkClick(_1e2,_1dc);})));var _1e3=_1b9.create("span",{"class":this.baseClass+"__request__action-container__deny button secondary","innerHTML":I18N("joinrequests_action_deny")},_1e0,"last");this.own(on(_1e3,"click",lang.hitch(this,function(_1e4){this._handleDenyLinkClick(_1e4,_1dc);})));_1b9.place(_1de,this._requestsListNode,"last");}));},_handleInviteLinkClick:function(_1e5,_1e6){var self=this;var _1e7=new _1c9({content:"<div class=\"dialog-content tooltip-hint-content\"><fieldset><ul><li>"+I18N("invite_tool_contact_inline_message")+"</li><li><div data-dojo-attach-point=\"_roleSelectNode\" data-dojo-type=\"cb/contacts/RoleSelectRadio\"></div></li><li><div class=\"button full-width\">"+I18N("invite_submit")+"</div></li></ul></fieldset></div>",position:["below-centered","below","above-centered","above"],i18n:i18n,postCreate:function(){this.inherited("postCreate",arguments);this.own(on(this.domNode,".button:click",lang.hitch(this,this._handleSubmitClick)));},_handleSubmitClick:function(_1e8){var _1e9=this;Api.contacts.post({companyUserRoles:this.get("roles"),contactType:"company",contactId:null,displayname:_1e6.displayname,identifiers:[_1e6.identifier]}).then(function(){return Api.companyjoinrequests.del(_1e6.companyjoinrequestid);}).then(function(){_1e9.hide();self.parentWidget.onContactManipulated(_1e6);}).otherwise(function(_1ea){Api.Validate.withSpec(_1ea,{errorCode:"generic",dom:Api.Validate.errorDom(this,_1e8.target,"after")});});},_getRolesAttr:function(){return _1b7.filter(_1c7.findWidgets(this.containerNode),function(w){return w.isInstanceOf(_1d5.RadioGroup);})[0].get("roles");}}).show(_1e5.target);},_handleDenyLinkClick:function(_1eb,_1ec){return Api.companyjoinrequests.del(_1ec.companyjoinrequestid).then(lang.hitch(this,function(){this.parentWidget.onContactManipulated(_1ec);}));}});return function loadContactsPage(_1ed,_1ee){var _1ef=_1be(new _1bd());var _1f0;var _1f1;var _1f2=new _1d3({store:_1ef,region:"center"});var _1f3=new _1d4({store:_1ef,region:"left"});var _1f4=_1c1({isManager:_1ca.checkIsManager(),selfsignupAvailable:_1ca.checkFeature("registration.selfsignup").then(function(_1f5){return _1f5==="enabled";})}).then(function(_1f6){if(!_1f6.selfsignupAvailable&&!_1f6.isManager){return new _1c2({region:"left",buildRendering:function(){this.inherited("buildRendering",arguments);this.domNode.innerHTML="<span>"+I18N("invite_people_admin_hint")+"</span>";}});}else{var _1f7=new _1c2({region:"left",buildRendering:function(){this.inherited("buildRendering",arguments);this.domNode.innerHTML="<span class=\"large full-width button\">"+I18N("invite_people")+"</span>";}});on(_1f7.domNode,".button:click",lang.hitch(this,function(){Api.Util.data(Api.Caching.referrals.get()).then(function(_1f8){var _1f9=new _1d2({"referralStatus":_1f8});dojo.connect(_1f9,"onHide",this,function(){_1f0();});_1f9.show();return _1f8;});}));return _1f7;}});var _1fa=new _1c6({region:"left",style:"height: 100%",layoutPriority:1,"class":"contacts-page-content__sidebar"});when(_1f3).then(function(_1fb){_1fa.addChild(_1fb);}).always(function(){return when(_1f4);}).then(function(_1fc){_1fa.addChild(_1fc);});_1ed.addChild(_1fa);_1ee.addChild(_1f2);_1ed.resize();_1d8(_1f3,"query",function(name,_1fd,q){_1f2.set("query",q);});Api.Listen.contacts.get().onInvalidate(function(){});_1f0=_1cc.debounce(function _1f0(){var _1fe=_1bc.mapIn(_1cc.arrayToObj(_1b7.map(_1ef.query(),function(c){return c.id;})),function(){return true;});Api.Invalidate.contacts.get();_1c1({contacts:Api.Util.data(Api.Caching.contacts.get()),referrals:Api.Util.data(Api.Caching.referrals.get())}).then(function(_1ff){_1b7.forEach(_1ff.contacts,function(_200){_200=lang.delegate(_200);_200.id=_1d9(_200);_1fe[_200.id]=false;_1b7.forEach(_200.companyUserRoles,function(role){_200["role_"+role]=true;});_200["referredMe"]=_1b7.indexOf(_1ff.referrals.referredByContacts,_200.contactId)!==-1;_200["referredByMe"]=_1b7.indexOf(_1ff.referrals.referredContacts,_200.contactId)!==-1;_200["referralResults"]=_1ff.referrals;_200["invitation_accepted_or_null"]=!_200.invitationStatus||(_200.invitationStatus&&_200.invitationStatus.status==="associated");_1ef.put(_200);when(_200).then(function(_201){if(_201.displayname){_201.sortKey=_201.displayname.toLocaleLowerCase();}return _201;}).then(function(_202){if(_202.userId){return _1cd.getById({type:"user",id:_202.userId}).then(function(_203){_202.sortKey=_203.user.displayname.toLocaleLowerCase();return _202;});}else{return _202;}}).then(function(_204){if(!_204.sortKey&&_204.emailAdresses&&_204.emailAdresses.oneEmailAddress){_204.sortKey=_204.emailAdresses.oneEmailAddress.toLocaleLowerCase();}return _204;}).then(function(_205){_1ef.put(_205);}).always(function(){_1bc.forIn(_1fe,function(_206,id){if(_206){_1ef.remove(id);}});});});_1ca.checkIsManager().then(lang.hitch(this,function(_207){if(_207){Api.Util.data(Api.Caching.companyjoinrequests.get({"companyid":sp.info.company.id})).then(lang.hitch(this,function(_208){if(_208.length>=1){if(typeof _1f1!=="undefined"){_1f1.destroy();}_1f1=new _1db({joinRequests:_208,parentWidget:_1f2}).placeAt(_1f2,"before");}else{if(typeof _1f1!=="undefined"){_1f1.destroy();}}}));}}));});},50);_1f2.own(_1b5.after(_1f2,"onContactManipulated",function(_209){_1f0();},true));_1f0();};});},"cb/page/boards/DocumentSelector":function(){define(["dojo","dojo/_base/array","dojo/_base/lang","dojo/when","dojo/hash","dojo/Deferred","dojo/DeferredList","dojo/dom-construct","dojo/dom-class","dojo/dom-attr","dojo/dom-geometry","dojo/dom-style","dojo/html","dojox/lang/functional","dojo/window","dojo/behavior","dojo/on","dojo/promise/all","dijit/_Widget","dijit/_Container","dijit/layout/ContentPane","dijit/registry","sp/I18n","sp/infos/InfoManager","sp/ajax/AjaxEngine","sp/ActivityIndicatorMixin","cb/widget/_SimpleTableMixin","sp/StackLayout","cb/user/CurrentlyActiveUsers","./toolbar/Toolbar","./PortfolioInformation","cb/ext/timeago/Timeago","./PortfolioSettingsDialog","./DocumentSettingsDialog","sp/dialog/ShowDownloadsDialog","sp/dialog/ShowParticipantsDialog","cb/util","cb/widget/CreateBoard","dojo/i18n!./nls/DocumentSelector"],function(dojo,arr,lang,when,_20a,_20b,_20c,_20d,_20e,_20f,_210,_211,_212,_213,_214,_215,on,_216,_217,_218,_219,_21a,_21b,_21c,_21d,_21e,_21f,_220,_221,_222,_223,_224,_225,_226,_227,_228,_229,_22a,i18n){var _22b="/cb/page/boards/displaySettings";var _22c=_22b+"/changed";var _22d=_22b+"/set";var _22e={limit:15,sortType:"LASTMODIFIED",filter:"ALL",portfolioId:null,displayType:"COMBINED",searchText:"",limitIncrement:10};var _22f=(function(){var _230=function(){return _21c.getById({type:"usertasks",id:sp.info.user.id}).then(dojo.hitch(this,function(_231){var _232={};if(_231&&_231.tasks&&_231.tasks.length){for(var i=0;i<_231.tasks.length;i++){var _233=_231.tasks[i];if(_233.status=="open"){_232[_233.documentId]=_232[_233.documentId]?_232[_233.documentId]+1:1;}}}return _232;}));};var _234;return function(){if(!_234){_234=_230();}return _234;};})();var _235=dojo.declare([_217],{portfolioId:null,buildRendering:function(){this.inherited(arguments);this.domNode=_20d.create("li",{"class":"entry-document with-button"},this.domNode);},postCreate:function(){this.inherited(arguments);this.createBoardWidget=new _22a({portfolioId:this.portfolioId,baseClass:"new-board large single-color"});_20d.place(this.createBoardWidget.domNode,this.domNode);}});var _236=dojo.declare([_217],{buildRendering:function(){this.inherited(arguments);this.containerNode=_20d.create("div",null,this.domNode);},postCreate:function(){this.inherited(arguments);_21c.getById({type:"portfolio",id:this.portfolioId}).then(dojo.hitch(this,function(_237){this.portfolioInformationWidget=new _223({portfolioResult:_237},_20d.create("div",null,this.containerNode));}));},refresh:function(){if(this.portfolioInformationWidget){this.portfolioInformationWidget.refresh();}},resize:function(){if(this.portfolioInformationWidget){this.portfolioInformationWidget.resize();}},onHide:function(){},hide:function(){if(this.portfolioInformationWidget){this.portfolioInformationWidget.hide();}this.onHide();}});var _238=dojo.declare([_217],{parent:null,postMixInProperties:function(){this.inherited(arguments);this.spEntryId=this.item.realid;this.spEntryType=this.item.type==="portfolio"?"portfolio":"document";},buildRendering:function(){this.inherited(arguments);var _239=this.domNode;_20f.set(this.domNode,"spEntryId",this.spEntryId);_20f.set(this.domNode,"spEntryType",this.spEntryType);var _23a=this.entryNode=_20d.create("span",{"class":"entry","spEntryId":this.spEntryId,"spEntryType":this.spEntryType},this.domNode);_22f().then(dojo.hitch(this,function(_23b){var _23c=this.getOpenTasksNumber(_23b);if(_23c>0){dojo.create("span",{"class":"opentasks-count","innerHTML":"<span class=\"number\">"+_21b.esc(_23c)+"</span>"},_23a);}}));this.statusIconContainer=dojo.create("div",{"class":"icons-container"},_23a);this.infoContainer=this.infoList=_20d.create("div",{"class":"info-container"},_23a);var _23d=_20d.create("div",{"class":"overflow-container"},this.infoContainer);this._titleRow=_20d.create("h2",{"class":"title-row",innerHTML:"&nbsp;"},_23d);this.modifiedRow=_20d.create("span",{"class":"modified-row"},_23d);this.statusIcons=_20d.create("ul",{"class":"board-icons"},_23d);this.linkOverlay=dojo.create("a",{"class":"link-overlay","spEntryId":this.spEntryId,"spEntryType":this.spEntryType},_23a);},postCreate:function(){this.inherited(arguments);this.update(this.item);},update:function(item){this.item=item;},getOpenTasksNumber:function(_23e){var _23f=null;var ret=0;if(this.item.type=="document"||this.item.type=="adhocportfolio"){_23f=this.item.realid;ret+=_23e[_23f]?_23e[_23f]:0;}else{if(this.item.type=="portfolio"){if(this.item.result&&this.item.result.documentIds&&this.item.result.documentIds.length){for(var i=0;i<this.item.result.documentIds.length;i++){_23f=this.item.result.documentIds[i];ret+=_23e[_23f]?_23e[_23f]:0;}}}else{console.warn("weird item type: ",this.item);}}return ret;}});var _240=dojo.declare([_238],{buildRendering:function(){this.inherited(arguments);_20f.set(this.domNode,{"spFolderId":this.item.result.portfolioId});_20e.add(this.domNode,"entry-project");this.connect(_20d.create("li",{"class":"status-icon fonticon-cog","spProjectId":this.item.result.portfolioId,"title":_21b.wrap(i18n)("portfolio_settings")},this.statusIcons,"first"),"click",function(_241){dojo.stopEvent(_241);_21c.getById({type:"portfolio",id:this.item.realid}).then(function(_242){new _225({portfolioResult:_242}).show();});});_20e.add(this.statusIconContainer,"stacklayoutsizer");this.connect(this.linkOverlay,"click",function(){dojo.publish(_22d+"/portfolioId",this.item.result.portfolioId);});},update:function(){this.inherited(arguments);_20e.remove(this.domNode,"empty read-only");_21c.watchById({type:"portfolio",id:this.item.realid},dojo.hitch(this,function(_243){if(_243.readOnly){_20e.add(this.domNode,"read-only");var _244=_20d.create("span",{"class":"project-readonly-notice",innerHTML:"<i class=\"fonticon-exclamation-alt\"></i> "+_21b.wrap(i18n)("portfolio_readonly_notice")},this.domNode);}var _245=_20d.create("span",{"class":"board-count"},this.domNode);if(_243.project.documents.length!==0){_245.innerHTML=(_243.project.documents.length===1)?_21b.wrap(i18n)("portfolio_boardcount_single"):_21b.wrap(i18n)("portfolio_boardcount_multiple",[_243.project.documents.length]);}else{_245.innerHTML=_21b.wrap(i18n)("portfolio_boardcount_empty");_20e.add(this.domNode,"empty");}_20f.set(this.linkOverlay,"title",_243.project.title);_20f.set(this._titleRow,"title",_243.project.title);_212.set(this._titleRow,_243.project.title);if(this.timeago){this.timeago.destroy();}this.timeago=new _224(null,_20d.create("span",{"class":"last-modified-at","title":_243.project.lastModifiedAt},this.modifiedRow));this.parent.resize();_215.apply();}));}});var _246=dojo.declare([_238],{buildRendering:function(){this.inherited(arguments);_20f.set(this.domNode,{"spFolderId":this.item.result.portfolioId});_20e.add(this.domNode,"entry-document");this.connect(_20d.create("li",{"class":"status-icon js-show-participants fonticon-participants-small","spDocumentId":this.spEntryId,"title":_21b.wrap(i18n)("participants")},this.statusIcons),"click",function(_247){dojo.stopEvent(_247);sp.infos.getInstance().getById({"type":"document","id":this.item.realid}).addCallback(function(_248){var _249=new _228({documentId:_248.document.id,docTitle:_248.document.title});_249.show();});});this.connect(_20d.create("li",{"class":"status-icon js-show-attachments fonticon-download","spDocumentId":this.spEntryId,"title":_21b.wrap(i18n)("attachments")},this.statusIcons),"click",function(_24a){dojo.stopEvent(_24a);sp.infos.getInstance().getById({"type":"document","id":this.item.realid}).addCallback(function(_24b){var _24c=new _227({documentId:_24b.document.id,docTitle:_24b.document.title});_24c.show();});});this.connect(_20d.create("li",{"class":"status-icon fonticon-cog","spProjectId":this.item.result.portfolioId,"spDocumentId":this.item.realid,"title":_21b.wrap(i18n)("document_settings")},this.statusIcons,"first"),"click",function(_24d){dojo.stopEvent(_24d);_216({portfolio:_21c.getById({type:"portfolio",id:this.item.result.portfolioId}),document:_21c.getById({type:"document",id:this.item.realid})}).then(function(_24e){new _226({portfolioResult:_24e.portfolio,documentResult:_24e.document}).show();});});this.imgNode=_20d.create("img",{"class":"loading",src:"/_/images/blank_1x1.png"},this.statusIconContainer,"first");this.sqmNode=_20d.create("span",{"class":"sqm-display hideBlock"},this.modifiedRow,"last");},update:function(){this.inherited(arguments);var _24f=_21c.getById({type:"document",id:this.item.realid});_24f.then(lang.hitch(this,function(_250){_20f.set(this.linkOverlay,"title",_250.document.title);_20f.set(this._titleRow,"title",_250.document.title);_212.set(this._titleRow,_250.document.title);var _251=arr.filter(_250.documentParticipants,function(item){return item.id==sp.info.user.id;});if(_251.length===0||_251[0].lastAccessedAt<_250.document.lastModifiedAt){_20e.add(this.domNode,"updated");}if(this.timeago){this.timeago.destroy();}this.timeago=new _224(null,_20d.create("span",{"class":"last-modified-at","title":_250.document.lastModifiedAt},this.modifiedRow,"first"));var sqm=_250.document.squaremeters;if(!isNaN(parseFloat(sqm))&&isFinite(sqm)){var _252=Math.round(sqm*10)/10;this.sqmNode.innerHTML=", "+(_252>=10?"&gt;10":(_252<0.1?"0.1":_21b.esc(_252)))+" m²";_20e.remove(this.sqmNode,"hideBlock");}else{_20e.add(this.sqmNode,"hideBlock");}_20f.set(this.linkOverlay,{"spFolderId":_250.document.projectId,"href":_250.document.currentLocation.fullEditUrl});_20f.set(this.imgNode,{spWidth:_250.document.width,spHeight:_250.document.height});if(_250.document.ownerId==="captaincb"){_20e.add(this.domNode,"demo-board");}if(this.activeUsersWidget){this.activeUsersWidget.destroy();}if(_250.currentlyActiveUsers&&_250.currentlyActiveUsers.length>0){this.activeUsersWidget=new _221({users:_250.currentlyActiveUsers,customClass:"participants-display"});_20d.place(this.activeUsersWidget.domNode,this.infoContainer,"first");}this._set("currentlyActiveUsers",_250.currentlyActiveUsers);this.parent.resize();_215.apply();return _250;}));_24f.then(dojo.hitch(this,function(_253){window.setTimeout(dojo.hitch(this,function(){_20f.set(this.imgNode,"src",_253.document.currentLocation.fullPublicUrl+".sizedpreview.png");_20e.remove(this.imgNode,"loading");}),5);}));_24f.then(dojo.hitch(this,function(){}));}});var _254=dojo.declare([_246],{});var _255=dojo.declare([_246],{});var _256=dojo.declare(null,{constructor:function(_257,type,_258,_259){this.id=type+"_"+_258;this.result=_257;this.type=type;this.realid=_258;this.sortKey=_259;}});return dojo.declare([_217,_218,_21f,_21e],{type:"list",currentDisplay:"normal",_entryNodeType:"li",queryOptions:{sort:[{attribute:"sortKey",descending:false}]},postMixInProperties:function(){this.inherited(arguments);this.displaySettings={};this.borderContainer=_21a.byId("borderContainer");},buildRendering:function(){this.inherited(arguments);this.containerNode=_20d.create("ul",{"class":"browser-list js-browser-list normal"},this.domNode);_20d.create("span",{"class":"activity-indicator-container"},this.domNode);this.showMoreContainer=_20d.create("div",{"class":"show-more-container hideBlock"},this.domNode);this.showMoreLink=_20d.create("span",{"class":"show-more button secondary full-width",innerHTML:_21b.wrap(i18n)("show_more")},this.showMoreContainer);},postCreate:function(){this.inherited(arguments);this.stackLayout=new _220(this.containerNode);this.subscribe(_22d+"/displayType",function(_25a){this.changeDisplayType(_25a);});this.subscribe(_22d+"/filter",function(_25b){this.changeFilter(_25b);});this.subscribe(_22d+"/portfolioId",function(_25c){this.changePortfolioId(_25c);});this.subscribe(_22d+"/sort",function(_25d){this.changeSortType(_25d);});this.subscribe(_22d+"/search",function(_25e){this.changeSearchText(_25e);});this.subscribe(_22c+"/portfolioId",function(_25f){if(_25f){this.showPortfolioInfo(_25f);}else{this.hidePortfolioInfo(_25f);}});this.connect(this.showMoreLink,"click",function(){var _260=this.displaySettings.limit||_22e.limit;this.changeLimit(_260+_22e.limitIncrement);});this.connect(_21c,"onInvalidate",function(_261){if(_261.type==="portfolio"||_261.type==="document"){this.reloadLater();}});if(!this.displaySettings.limit){this.changeLimit(_22e.limit,false);}if(!this.displaySettings.sortType){this.changeSortType(_22e.sortType,false);}if(!this.displaySettings.filter){this.changeFilter(_22e.filter,false);}if(!this.displaySettings.portfolioId){this.changePortfolioId(_22e.portfolioId,false);}if(!this.displaySettings.displayType){this.changeDisplayType(_22e.displayType,false);}if(!this.displaySettings.searchText){this.changeSearchText(_22e.searchText,false);}this._newBoardButtonEntryWidget=new _235();this._setupHashHandling();this.createToolbar();this.reloadLater(1);},startup:function(){},_setupHashHandling:function(){this._setupHashUpdates();this.subscribe("/dojo/hashchange",function(_262){this._handleHashChange(_262);});this._handleHashChange(dojo.hash());},createToolbar:function(){var _263;if(this.portfolioInfoWidget){_263=this.portfolioInfoWidget.portfolioId;}var _264=new _222({portfolioId:_263});window.setTimeout(dojo.hitch(this,function(){_20d.place(_264.domNode,this.domNode,"before");}),1000);on(this.domNode,"scroll",_229.debounce(dojo.hitch(this,function(){_20e.toggle(_264.domNode,"scrolled",this.domNode.scrollTop>20);}),20));},_handleHashChange:function(_265){var _266=dojo.queryToObject(_265);if(!_266){return;}dojo.publish(_22d+"/search",_266.q||"");dojo.publish(_22d+"/portfolioId",_266.p||null);},_setupHashUpdates:function(){this.subscribe(_22c+"/search",function(_267){var _268=dojo.queryToObject(dojo.hash())||{};_268.q=_267;if(!_268.q){delete _268.q;}dojo.hash(dojo.objectToQuery(_268),true);});this.subscribe(_22c+"/portfolioId",function(_269){var _26a=dojo.queryToObject(dojo.hash())||{};_26a.p=_269;if(!_26a.p){sp.global.analytics.trackPageView("/boards");delete _26a.p;}else{sp.global.analytics.trackPageView("/project");}dojo.hash(dojo.objectToQuery(_26a),true);});},changeSearchText:function(_26b,_26c){if(this.displaySettings.searchText!==_26b){this.displaySettings.searchText=_26b;dojo.publish(_22c+"/search",this.displaySettings.searchText);if(!_26c){this.reloadLater();}}},changeFilter:function(_26d,_26e){var _26f=this.displaySettings.ownerType!==_26d;if(_26d){this.changePortfolioId(null,_26e);}this.displaySettings.ownerType=_26d;if(_26f){dojo.publish(_22c+"/filter",this.displaySettings.ownerType);if(!_26e){this.reloadLater();}}},changePortfolioId:function(_270,_271){var _272=this.displaySettings.portfolioId!==_270;this.displaySettings.portfolioId=_270;if(_270){this.changeFilter(null,_271);}if(_272){dojo.publish(_22c+"/portfolioId",this.displaySettings.portfolioId);if(!_271){this.reloadLater();}}},changeDisplayType:function(_273,_274){if(_273!=="COMBINED"&&_273!=="ONLYDOCUMENTS"){_273="COMBINED";}if(this.displaySettings.displayType!==_273){this.displaySettings.displayType=_273;dojo.publish(_22c+"/displayType",this.displaySettings.displayType);this.currentDisplay=(_273==="COMBINED")?"normal":"flat";if(!_274){this.reloadLater();}}},changeSortType:function(_275,_276){if(_275!=="ALPHABET"&&_275!=="LASTMODIFIED"){_275="LASTMODIFIED";}if(this.displaySettings.sortType!==_275){this.displaySettings.sortType=_275;dojo.publish(_22c+"/sort",this.displaySettings.sortType);this.changeLimit(_22e.limit,false);if(!_276){this.reloadLater();}}},changeLimit:function(_277,_278){if(!_277||_277<=0){return;}if(this.displaySettings.limit!==_277){this.displaySettings.limit=_277;dojo.publish(_22c+"/limit",this.displaySettings.limit);if(!_278){this.reloadLater();}}},reloadLater:function(_279){if(this._reloadLaterTimeout){window.clearTimeout(this._reloadLaterTimeout);}this._reloadLaterTimeout=window.setTimeout(dojo.hitch(this,function(){this.reload();}),_279||50);},reload:function(){var _27a=this.displaySettings.ownerType||"ALL";var _27b=this.displaySettings.portfolioId?"ONLYDOCUMENTS":this.displaySettings.displayType;this.showActivityIndicator();var _27c=_21d.queryBoardList({ownerType:_27a,searchText:this.displaySettings.searchText,portfolioId:this.displaySettings.portfolioId,limit:this.displaySettings.limit,sortType:this.displaySettings.sortType,displayType:_27b}).then(dojo.hitch(this,function(_27d){if(this.emptyHintContainer){_20e.remove(this.domNode,"empty no-search-result no-shared");_20d.destroy(this.emptyHintContainer);}var ret=dojo.filter(dojo.map(_27d.boardQueryResultList,function(_27e,_27f){var type,id;if(_27e.adhoc){type="adhocportfolio";}else{if(_27b==="ONLYDOCUMENTS"){type="document";}else{type="portfolio";}}if((type==="document"||type==="adhocportfolio")&&(!_27e.documentIds||_27e.documentIds.length===0)){console.error("incomplete portfolio document mapping found for ",_27e);return null;}switch(type){case "document":case "adhocportfolio":id=_27e.documentIds[0];break;case "portfolio":id=_27e.portfolioId;break;default:console.error("unknown type",type," determined for boardQueryResult",_27e);return null;}return new _256(_27e,type,id,_27f);}),function(_280){return _280!==null;});ret.resultSize=_27d.boardQueryResultList.length;return ret;})).then(dojo.hitch(this,function(_281){var _282={};var _283={};dojo.forEach(_281,function(_284){switch(_284.type){case "document":_283[_284.realid]=true;break;case "adhocportfolio":_282[_284.result.portfolioId]=true;_283[_284.realid]=true;break;case "portfolio":_282[_284.result.portfolioId]=true;break;default:console.error("unknown type",_284.type," determined for boardQueryResult",_284.result);return null;}});var _285=_21c.bulkloadByIds({type:"portfolio",ids:_213.keys(_282)});var _286=_21c.bulkloadByIds({type:"document",ids:_213.keys(_283)});var _287=_21c.bulkloadByIds({type:"boardtasks",ids:_213.keys(_283)});return new _20c([_285,_286,_287]).then(function(){return _281;});})).then(dojo.hitch(this,function(_288){var _289=this.store.query({},{});when(this.store.query({},{})).then(lang.hitch(this,function(_28a){return dojo.map(_28a,function(_28b,_28c){return this.store.getIdentity(_28b);},this);})).then(function(_28d){return arr.filter(_28d,function(id){return id!=="newboardbutton_newboardbutton"&&!arr.some(_288,function(_28e){return _28e.id===id;});});}).then(lang.hitch(this,function(_28f){arr.forEach(_28f,this.store.remove,this.store);}));dojo.forEach(_288,function(_290){this.store.put(_290);},this);return _288;})).then(lang.hitch(this,function(_291){if(_291.resultSize===0){_20e.add(this.domNode,"empty");this.emptyHintContainer=_20d.create("div",{"class":"empty-hint-container"},this.domNode);var _292=_21b.wrap(i18n)("empty_hint_headline");var _293=_21b.wrap(i18n)("empty_hint_text");if(this.displaySettings.ownerType==="FOREIGN"){_20e.add(this.domNode,"no-shared");_292=_21b.wrap(i18n)("empty_hint_foreign_headline");_293=_21b.wrap(i18n)("empty_hint_foreign_text");}if(this.displaySettings.searchText){_20e.add(this.domNode,"no-search-result");_292=_21b.wrap(i18n)("empty_hint_search_headline");_293=_21b.wrap(i18n)("empty_hint_search_text",[this.displaySettings.searchText]);}var _294=_20d.create("div",{"class":"empty-hint-text","innerHTML":"<h4>"+_292+"</h4>"+"<p>"+_293+"</p>"},this.emptyHintContainer);}this.resize();this.hideActivityIndicator();if(_291.resultSize===this.displaySettings.limit){this.showShowMoreContainer();}else{this.hideShowMoreContainer();}var _295=new _256("","newboardbutton","newboardbutton",-100);this.store.put(_295);var _296=dojo.map(_291,function(_297){if(_297.type==="adhocportfolio"||_297.type==="document"){return _21c.getById({type:"document",id:_297.realid}).then(lang.hitch(this,function(_298){return (_298.document.ownerId==="captaincb")?true:false;}));}else{return false;}});_216(_296).then(dojo.hitch(this,function(_299){var _29a=(_299.length>0&&arr.every(_299,function(item){return !!item;}));var _29b=this._newBoardButtonEntryWidget;if(_29b){_29b.createBoardWidget.set("demoBoardsLabel",_29a);}}));}));},createEntryWidget:function(id,item,node){var _29c;var args={item:item,parent:this};var _29d=null;if(this.portfolioInfoWidget){_29d=this.portfolioInfoWidget.portfolioId;}switch(item.type){case "newboardbutton":_29c=this._newBoardButtonEntryWidget;_29c.set("portfolioId",_29d);break;case "document":_29c=new _254(args,node);break;case "adhocportfolio":_29c=new _255(args,node);break;case "portfolio":_29c=new _240(args,node);break;}dojo.fadeIn({node:_29c.domNode,duration:150}).play();return _29c;},handleRemovedItem:function(id,item){var _29e=this._widgets[id];if(_29e){delete this._widgets[id];dojo.fadeOut({node:_29e.domNode,duration:100,onEnd:dojo.hitch(this,function(){this.removeChild(_29e);_29e.destroy();})}).play();}},resize:function(dim){this.inherited("resize",arguments);if(dim){dojo.marginBox(this.domNode,dim);}if(this._relayoutTimeout){window.clearTimeout(this._relayoutTimeout);}this._relayoutTimeout=window.setTimeout(dojo.hitch(this,function(){this._relayout();}),100);this.resizePortfolioInfo();},_relayout:function(){if(this.currentDisplay==="normal"){_20e.remove(this.containerNode,"flat");_20e.add(this.containerNode,"normal");this.stackLayout.relayout();}else{_20e.add(this.containerNode,"flat");_20e.remove(this.containerNode,"normal");this.stackLayout.cleanup();}},showPortfolioInfo:function(_29f){if(this.portfolioInfoWidget){if(this.portfolioInfoWidget.portfolioId===_29f){this.portfolioInfoWidget.refresh();return;}else{this.hidePortfolioInfo();}}this.portfolioInfoWidget=new _236({portfolioId:_29f});this.portfolioPane=new _219({region:"left",style:"height: 100%",layoutPriority:1,"class":"browser-portfolio-info",content:this.portfolioInfoWidget});this.borderContainer.addChild(this.portfolioPane);this.borderContainer.resize();_20e.add(dojo.body(),"portfolio-pane-open");},hidePortfolioInfo:function(){if(this.portfolioInfoWidget){this.portfolioInfoWidget.hide();this.portfolioInfoWidget.destroy();this.portfolioInfoWidget=null;this.borderContainer.removeChild(this.portfolioPane);_20e.remove(dojo.body(),"portfolio-pane-open");this.borderContainer.resize();}},resizePortfolioInfo:function(){if(this.portfolioInfoWidget){this.portfolioInfoWidget.resize();}},showShowMoreContainer:function(){_20e.remove(this.showMoreContainer,"hideBlock");},hideShowMoreContainer:function(){_20e.add(this.showMoreContainer,"hideBlock");}});});},"cb/infobanner/ChromeWebstoreRatingBanner":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/on","dojo/_base/array","dojo/promise/all","dijit/_TemplatedMixin","cb/infobanner/Banner","cb/api/Api","cb/Capabilities","./Container","sp/I18n","dojo/i18n!./nls/BannerMessages"],function(_2a0,lang,on,arr,_2a1,_2a2,_2a3,Api,_2a4,_2a5,_2a6,i18n){var _2a7="chromeWebstoreRatingBanner";var _2a8=_2a0([_2a3,_2a2],{templateString:"<div class=\"info-banner__chrome-store-rating\" data-dojo-attach-point=\"_bannerNode\"></div>",bannerId:_2a7,isCloseable:true,preventCloseDestroy:true,buildRendering:function(){this.analyticsBannerId="chrome webstore rating";this.defaultIconClass="no-icon";this.defaultMessage=_2a6.wrap(i18n)("chrome_store_rating_message");this.inherited(arguments);},postCreate:function(){this.inherited(arguments);on(this.messageNode,"click",lang.hitch(this,function(_2a9){if(_2a9.target.tagName==="A"){sp.global.analytics.trackEvent(this.analyticsCategory,"click rating",this.analyticsLabel);this.setBannerStatusAndClose();}}));on(this.closeLinkNode,"click",lang.hitch(this,function(_2aa){this.setBannerStatusAndClose();}));},setBannerStatusAndClose:function(){Api.userbannerstatus.deleteByIdAndBannerId(sp.info.user.id,"chromeWebstoreRatingBanner").always(lang.hitch(this,function(){this.getParent().removeChild(this);}));}});_2a8.addToContainerIfNecessary=function addToContainerIfNecessary(_2ab){return _2ab.addIfNotPresent(_2a7,function(){if(typeof chrome==="undefined"){return null;}var _2ac=chrome.app.isInstalled;if(!_2ac){return null;}if(sp.info.document){return null;}var _2ad=_2a4.checkCreateBoard().then(function(_2ae){return _2ae!=="nofreesqm";});var _2af=Api.Caching.userbannerstatus.getById(sp.info.user.id).then(lang.hitch(this,function(_2b0){if(_2b0&&_2b0.data&&_2b0.data.deletedBannerIds){var _2b1=_2b0.data.deletedBannerIds;return arr.indexOf(_2b1,"chromeWebstoreRatingBanner")===-1;}else{return false;}}));var _2b2=5;var _2b3=Api.Caching.users_me_statistics.get().then(function(_2b4){return _2b4.data.boardsCreated&&_2b4.data.boardsCreated>=_2b2;});var _2b5=_2a4.checkFeature("chromewebstoreapp.usable").then(function(_2b6){return _2b6==="enabled";});return _2a1([_2ad,_2af,_2b3,_2b5]).then(function(_2b7){if(arr.every(_2b7,function(item){return item===true;})){return new _2a8();}else{return null;}});});};return _2a8;});},"cb/page/dashboard/UserNoticesList":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/query","dojo/json","dojo/_base/lang","dojo/_base/Deferred","dojo/DeferredList","dojo/date/stamp","dojo/date/locale","dojo/dom-construct","dojo/dom-class","dojo/dom-geometry","dojo/dom-attr","dojo/on","dojo/when","dojox/lang/functional","dojo/promise/all","dijit/_Widget","sp/I18n","sp/infos/InfoManager","cb/widget/SimpleTable","cb/widget/UserIconListEntry","cb/ext/timeago/Timeago","cb/common/UserListUtils","cb/util","cb/util-mentions","cb/util-hashtags","cb/util-text","cb/api/Api","dojo/i18n!./nls/UserNoticesList"],function(_2b8,arr,_2b9,json,lang,_2ba,_2bb,_2bc,_2bd,_2be,_2bf,_2c0,_2c1,on,when,_2c2,_2c3,_2c4,_2c5,_2c6,_2c7,_2c8,_2c9,_2ca,_2cb,_2cc,_2cd,_2ce,Api,i18n){var _2cf=_2c5.wrap(i18n);var _2d0=_2ca.getPersonListI18nPrefix;var _2d1=_2b8([_2c4],{baseClass:"user-notices-list-entry",unread:false,_setUnreadAttr:function(_2d2){_2bf.toggle(this.domNode,"unread",_2d2);this._set("unread",_2d2);}});var _2d3=_2b8([_2d1],{buildRendering:function(){this.inherited(arguments);this.baseWidgetContentNodeWrapper=_2be.create("a",{"class":"full-entry-link"},this.domNode);this.firstLinePictures=_2be.create("ul",{"class":"user-notices-list-entry-first-pictures"},this.baseWidgetContentNodeWrapper);this.firstLine=_2be.create("div",{"class":"user-notices-list-entry-first"},this.baseWidgetContentNodeWrapper);this.firstLineContent=_2be.create("span",{"class":"user-notices-list-entry-first-content"},this.firstLine);this.contentNode=_2be.create("div",{"class":"user-notices-list-entry-content hideBlock"},this.firstLine);this.metaInfo=_2be.create("span",{"class":"user-notices-list-entry-meta"},this.firstLine);if(this.item.isLive){_2be.create("span",{"class":"user-notices-list-entry-meta-createdat online-badge","innerHTML":_2c5.wrap(i18n)("createdat_live")},this.metaInfo);}else{new _2c9(null,_2be.create("span",{"class":"user-notices-list-entry-meta-createdat","innerHTML":_2bd.format(this.item.createdAt),"title":_2bc.toISOString(this.item.createdAt)},this.metaInfo));}_2c1.set(this.domNode,"spitemid",this.item["arguments"]["txtGId"]);this.typeIcon=_2be.create("div",{"class":"user-notices-list-entry-type-icon"},this.baseWidgetContentNodeWrapper);_2bf.toggle(this.domNode,this.baseClass+"-live",!!this.item.isLive);if(this.item&&this.item.id){_2bf.add(this.domNode,"user-notices-list-entry--"+this.item.id);}},_setFullEntryLinkAttr:function(_2d4){this._set("fullEntryLink",_2d4);this.set("activeFullEntryLink",this.get("activeFullEntryLink"));},_setActiveFullEntryLinkAttr:function(_2d5){var link=this.get("fullEntryLink");if(_2d5&&link){_2c1.set(this.baseWidgetContentNodeWrapper,"href",link);}else{_2c1.remove(this.baseWidgetContentNodeWrapper,"href");}this._set("activeFullEntryLink",_2d5);}});var _2d6=_2b8([_2d3],{postCreate:function(){this.inherited(arguments);this.contentNode.innerHTML=json.stringify(this.item);}});var _2d7=_2ca.createOrderingWithNeedleLast;var _2d8=_2ca.createUsersListSortedWithMyselfLast;function _2d9(_2da,_2db,_2dc,_2dd){var _2de=_2ca.createUsersListSortedWithMyselfLast(_2da,_2db);var _2df=_2ca.createNamesListWithMyself(_2de,_2db,_2cf);var _2e0=arr.map(_2de,function(_2e1){return new _2c8({userid:_2e1});});return _2ba.when(_2df,lang.hitch(this,function(_2e2){return _2c6.getById({type:"document",id:_2dc}).then(function(_2e3){var _2e4;if(_2e3.document.currentLocation.fullEditUrl){_2e4="<a href=\""+_2c5.escAttr(_2e3.document.currentLocation.fullEditUrl)+"\">"+_2c5.esc(_2e3.document.title)+"</a>";}else{_2e4=_2e3.document.title;}return _2cf(_2ca.getPersonListI18nPrefix(_2de,_2db)+_2dd,[_2e2,_2e4]);},function(_2e5){return _2cf(_2ca.getPersonListI18nPrefix(_2de,_2db)+_2dd+"_error",[_2e2]);}).then(function(_2e6){return {content:_2e6,pictures:_2e0};});}));};function _2e7(_2e8,text){var _2e9=_2c5.esc(text);return when(_2ce.convertTextToFullyEnrichedMarkup(_2e9)).then(function(_2ea){_2e8.innerHTML=_2ea;});};var _2eb={"clientnotice_liveborder":_2b8([_2c4],{baseClass:"user-notices-list-entry-live-border",buildRendering:function(){this.inherited(arguments);this.domNode.innerHTML="<span class=\"label\">"+_2c5.wrap(i18n)("live_border")+"</span>";}}),"clientnotice_onlineusers_live":_2b8([_2d3],{postCreate:function(){this.inherited(arguments);_2ba.when(_2d9(this.item["arguments"].activeUsers,this.userid,this.item["arguments"].documentId,"live_on_document"),lang.hitch(this,function(v){arr.forEach(v.pictures,function(_2ec){_2be.place(_2ec.domNode,this.firstLinePictures);},this);this.firstLineContent.innerHTML=v.content;}));_2be.create("i",{"class":"fonticon-pencil"},this.typeIcon);}}),1:_2b8([_2d3],{postCreate:function(){this.inherited(arguments);_2ba.when(this._getActiveUsersLine(this.item,this.userid),lang.hitch(this,function(v){arr.forEach(v.pictures,function(_2ed){_2be.place(_2ed.domNode,this.firstLinePictures);},this);this.firstLineContent.innerHTML=v.content;}));arr.forEach(this.item["arguments"].activities,function(_2ee){if(_2ee.text){_2bf.remove(this.contentNode,"hideBlock");var _2ef=_2be.create("div",{"class":"acitivity-text","innerHTML":_2c5.esc(_2ee.text)},this.contentNode);_2c6.getById({type:"user",id:_2ee.activeUser}).then(function(_2f0){var _2f1=_2be.create("span",{"class":"activity-text-author","innerHTML":_2c5.esc(_2f0.user.displayname)+": "},_2ef,"first");});_2c6.getById({type:"document",id:_2ee.documentId}).then(function(_2f2){if(_2f2.document.currentLocation.fullEditUrl){var _2f3=_2be.create("a",{"class":"activity-text-item-link","href":_2f2.document.currentLocation.fullEditUrl+"#item="+_2ee.itemId,"innerHTML":_2cf("goto_item_link_label")},_2ef,"last");}else{}});}},this);window.setTimeout(dojo.hitch(this,function(){if(_2c0.getMarginBox(this.contentNode).h>100){_2bf.add(this.contentNode,"to-many-items");this.expandLink=_2be.create("a",{"class":"show-more","innerHTML":"<i class=\"fonticon-triangle-down\"></i> "+_2cf("expand_link_expand"),"href":"#"},this.contentNode,"after");this.allItemsVisible=false;on(this.expandLink,"click",dojo.hitch(this,function(){if(this.allItemsVisible){_2bf.add(this.contentNode,"to-many-items");this.allItemsVisible=false;this.expandLink.innerHTML="<i class=\"fonticon-triangle-down\"></i> "+_2cf("expand_link_expand");}else{_2bf.remove(this.contentNode,"to-many-items");this.allItemsVisible=true;this.expandLink.innerHTML="<i class=\"fonticon-triangle-up\"></i> "+_2cf("expand_link_collapse");}}));}}),10);_2be.create("i",{"class":"fonticon-pencil"},this.typeIcon);},_getActiveUsersLine:function(item,_2f4){return _2d9(item["arguments"].activeUsers,_2f4,item["arguments"].documentId,"active_on_document");}}),5:_2b8([_2d3],{postCreate:function(){this.inherited(arguments);_2be.create("i",{"class":"fonticon-reply"},this.typeIcon);_2be.place(new _2c8({userid:this.item["arguments"].activeUser}).domNode,this.firstLinePictures);return _2c6.getById({type:"user",id:this.item["arguments"].activeUser}).then(lang.hitch(this,function(_2f5){return _2c6.getById({type:"document",id:this.item["arguments"].documentId}).then(lang.hitch(this,function(_2f6){if(!_2f6.document.currentLocation.fullEditUrl){throw "";}var _2f7=_2f6.document.currentLocation.fullEditUrl+"#item="+this.item["arguments"]["txtGId"];this.set("fullEntryLink",_2f7);var _2f8="<a href=\""+_2f7+"\">"+_2f6.document.title+"</a>";var _2f9=_2be.create("a",{href:_2f6.document.currentLocation.fullEditUrl+"#item="+this.item["arguments"]["txtGId"],"class":"user-notices-list-entry-block-link",innerHTML:_2c5.esc(this.item["arguments"].text)},this.contentNode);_2e7(_2f9,this.item["arguments"].text);_2bf.remove(this.contentNode,"hideBlock");return _2cf("textadded_to_subscribed_item_by",[_2f5.user.displayname,_2f8]);})).otherwise(lang.hitch(this,function(_2fa){return _2cf("textadded_to_subscribed_item_by_document_error",[_2f5.user.displayname]);}));})).then(lang.hitch(this,function(_2fb){this.firstLineContent.innerHTML=_2fb;}));}}),6:_2b8([_2d3],{postCreate:function(){this.inherited(arguments);}}),12:_2b8([_2d3],{postCreate:function(){this.inherited(arguments);_2be.place(new _2c8({userid:this.item["arguments"].userId}).domNode,this.firstLinePictures);var _2fc=_2c6.getById({type:"user",id:this.item["arguments"].userId}).then(function(_2fd){return _2fd.user.displayname;});_2be.create("i",{"class":"fonticon-invite"},this.typeIcon);var _2fe=[this.item["arguments"].granted?"added":"removed",this.item["arguments"].userId===this.userid?"myself":"user","to_portfolio"].join("_");_2ba.when(_2fc,lang.hitch(this,function(_2ff){return _2c6.getById({type:"user",id:this.item.causedBy}).then(lang.hitch(this,function(_300){return _2c6.getById({type:"portfolio",id:this.item["arguments"].portfolioId}).then(lang.hitch(this,function(_301){var _302="<a href=\"/boards#p="+_301.project.id+"\">"+_301.project.title+"</a>";return _2cf(_2d0([_300.user.id],this.userid)+_2fe,[[_300.user.displayname],_2ff,_302]);}),lang.hitch(this,function(_303){var _304=_2fe+"_err";return _2cf(_2d0([_300.user.id],this.userid)+_304,[[_300.user.displayname],_2ff]);}));})).then(lang.hitch(this,function(_305){this.firstLineContent.innerHTML=_305;}));}));}}),14:_2b8([_2d3],{postCreate:function(){this.inherited(arguments);_2c3({referringUser:_2c6.getById({type:"user",id:this.item["arguments"].referringUserId}),referredUser:_2c6.getById({type:"user",id:this.item["arguments"].referredUserId})}).then(lang.hitch(this,function(_306){if(this.userid===_306.referringUser.user.id){var _307=_306.referringUser.user.accountType.hasSqmLimit&&_306.referredUser.user.accountType.hasSqmLimit;if(!this.item["arguments"].addedSqm||this.item["arguments"].addedSqm<=0){_307=false;}_2be.place(new _2c8({userid:_306.referredUser.user.id}).domNode,this.firstLinePictures);this.firstLineContent.innerHTML=_2cf("referred_other_user"+(_307?"_sqm":""),[_306.referredUser.user.displayname,this.item["arguments"].addedSqm||null]);}else{if(this.userid===_306.referredUser.user.id){_2be.place(new _2c8({userid:_306.referringUser.user.id}).domNode,this.firstLinePictures);this.firstLineContent.innerHTML=_2cf("referred_by_other_user",[_306.referringUser.user.displayname]);}else{}}}));_2be.create("i",{"class":"fonticon-star"},this.typeIcon);}}),18:_2b8([_2d3],{postCreate:function(){this.inherited(arguments);_2c6.getById({type:"user",id:this.item["arguments"].createdBy}).then(lang.hitch(this,function(_308){this.firstLineContent.innerHTML=_2cf(_2d0([_308.user.id],this.userid)+"deleted_document",[_308.user.displayname,this.item["arguments"].document.title]);}));_2be.create("i",{"class":"fonticon-trashcan"},this.typeIcon);}}),19:_2b8([_2d3],{postCreate:function(){this.inherited(arguments);_2c6.getById({type:"user",id:this.item["arguments"].createdBy}).then(lang.hitch(this,function(_309){this.firstLineContent.innerHTML=_2cf(_2d0([this.id],this.userid)+"deleted_portfolio",[_309.user.displayname,this.item["arguments"].portfolio.title]);}));_2be.create("i",{"class":"fonticon-trashcan"},this.typeIcon);}}),15:_2b8([_2d3],{postCreate:function(){this.inherited(arguments);var _30a;if(this.item["arguments"].existingUserId){_2be.place(new _2c8({userid:this.item["arguments"].existingUserId}).domNode,this.firstLinePictures);_30a=_2c6.getById({type:"user",id:this.item["arguments"].existingUserId}).then(function(_30b){return _30b.user.displayname;});}else{_30a=this.item["arguments"].email;}_2ba.when(_30a,lang.hitch(this,function(_30c){this.firstLineContent.innerHTML=_2cf("myself_invited_user",[_30c]);}));_2be.create("i",{"class":"fonticon-heart"},this.typeIcon);}}),20:_2b8([_2d3],{postCreate:function(){this.inherited(arguments);var _30d;if(this.item["arguments"].invitedUserId){_2be.place(new _2c8({userid:this.item["arguments"].invitedUserId}).domNode,this.firstLinePictures);_30d=_2c6.getById({type:"user",id:this.item["arguments"].invitedUserId}).then(function(_30e){return _30e.user.displayname;});}else{_30d=this.item["arguments"].invitedEmail;}_2be.create("i",{"class":"fonticon-invite"},this.typeIcon);_2ba.when(_30d,lang.hitch(this,function(_30f){return _2c6.getById({type:"user",id:this.item["arguments"].createdBy}).then(lang.hitch(this,function(_310){return _2c6.getById({type:"document",id:this.item["arguments"].documentId}).then(lang.hitch(this,function(_311){if(!_311.document.currentLocation.fullEditUrl){throw "";}var _312="<a href=\""+_311.document.currentLocation.fullEditUrl+"\">"+_311.document.title+"</a>";return _2cf(_2d0([_310.user.id],this.userid)+"invited_user_to_document",[[_310.user.displayname],_30f,_312]);})).otherwise(lang.hitch(this,function(_313){return _2cf(_2d0([_310.user.id],this.userid)+"invited_user_to_error_document",[[_310.user.displayname],_30f]);}));})).then(lang.hitch(this,function(_314){this.firstLineContent.innerHTML=_314;}));}));}}),21:_2b8([_2d3],{postCreate:function(){this.inherited(arguments);_2be.place(new _2c8({userid:this.item["arguments"].userId}).domNode,this.firstLinePictures);_2be.create("i",{"class":"fonticon-star"},this.typeIcon);if(this.item["arguments"].userId===sp.info.user.id){this.firstLineContent.innerHTML=_2cf("account_created_myself");}else{_2c6.getById({type:"user",id:this.item["arguments"].userId}).then(lang.hitch(this,function(_315){this.firstLineContent.innerHTML=_2cf("account_created_other",[_315.user.displayname]);}));}}}),23:_2b8([_2d3],{postCreate:function(){this.inherited(arguments);_2be.place(new _2c8({userid:this.item["arguments"].userId}).domNode,this.firstLinePictures);_2be.create("i",{"class":"fonticon-message"},this.typeIcon);if(this.item["arguments"].userId===this.userid){this.firstLineContent.innerHTML=_2cf("email_confirmed_myself",[this.item["arguments"].newConfirmedEmailAddress]);}else{_2c6.getById({type:"user",id:this.item["arguments"].userId}).then(lang.hitch(this,function(_316){this.firstLineContent.innerHTML=_2cf("email_confirmed_other",[_316.user.displayname]);}));}}}),24:_2b8([_2d3],{postCreate:function(){this.inherited(arguments);_2be.create("i",{"class":"fonticon-invite"},this.typeIcon);if(this.item["arguments"].userId===this.userid){this.firstLineContent.innerHTML=_2cf("user_invited_to_company_by_myself",[this.item["arguments"].invitedUserDisplay]);}else{_2c6.getById({type:"user",id:this.item["arguments"].userId}).then(lang.hitch(this,function(_317){this.firstLineContent.innerHTML=_2cf("user_invited_to_company_by_other",[this.item["arguments"].invitedUserDisplay,_317.user.displayname]);}));}}}),25:_2b8([_2d3],{postCreate:function(){this.inherited(arguments);_2be.create("i",{"class":"fonticon-invite"},this.typeIcon);_2be.place(new _2c8({userid:this.item["arguments"].userId}).domNode,this.firstLinePictures);_2c3({userResult:_2c6.getById({type:"user",id:this.item["arguments"].userId}),companyResult:_2c6.getById({type:"company",id:this.item["arguments"].companyId})}).then(lang.hitch(this,function(_318){if(this.item["arguments"].userId===this.userid){this.firstLineContent.innerHTML=_2cf("user_joined_company_myself",[_318.companyResult.company.name]);}else{this.firstLineContent.innerHTML=_2cf("user_joined_company_other",[_318.userResult.user.displayname]);}}));}}),26:_2b8([_2d3],{postCreate:function(){this.inherited(arguments);_2be.create("i",{"class":"fonticon-commentText"},this.typeIcon);_2be.place(new _2c8({userid:this.item["arguments"].createdBy}).domNode,this.firstLinePictures);return _2c6.getById({type:"user",id:this.item["arguments"].createdBy}).then(lang.hitch(this,function(_319){return _2c6.getById({type:"document",id:this.item["arguments"].documentId}).then(lang.hitch(this,function(_31a){if(!_31a.document.currentLocation.fullEditUrl){throw "";}var _31b=_31a.document.currentLocation.fullEditUrl+"#item="+this.item["arguments"].commentId;this.set("fullEntryLink",_31b);var _31c="<a href=\""+_31b+"\">"+_31a.document.title+"</a>";var _31d=_2be.create("a",{href:_31a.document.currentLocation.fullEditUrl+"#item="+this.item["arguments"].commentId,"class":"user-notices-list-entry-block-link",innerHTML:_2c5.esc(this.item["arguments"].text)},this.contentNode);_2e7(_31d,this.item["arguments"].text);_2bf.remove(this.contentNode,"hideBlock");return _2cf("mentioned_by",[_319.user.displayname,_31c]);})).otherwise(lang.hitch(this,function(_31e){return _2cf("mentioned_by_document_error",[_319.user.displayname]);}));})).then(lang.hitch(this,function(_31f){this.firstLineContent.innerHTML=_31f;}));}}),32:_2b8([_2d3],{postCreate:function(){this.inherited(arguments);_2be.create("i",{"class":"fonticon-task-round-done"},this.typeIcon);_2be.place(new _2c8({userid:this.item["arguments"].createdBy}).domNode,this.firstLinePictures);return _2c6.getById({type:"user",id:this.item["arguments"].createdBy}).then(lang.hitch(this,function(_320){return _2c6.getById({type:"user",id:this.item["arguments"].userId}).then(lang.hitch(this,function(_321){return _2c6.getById({type:"document",id:this.item["arguments"].documentId}).then(lang.hitch(this,function(_322){if(!_322.document.currentLocation.fullEditUrl){throw "";}var _323=_322.document.currentLocation.fullEditUrl+"#item="+this.item["arguments"].commentId;this.set("fullEntryLink",_323);var _324="<a href=\""+_323+"\">"+_322.document.title+"</a>";var _325=_321.user.id==sp.info.user.id;_2bf.add(this.domNode,(_325?"with-own-task":"with-task"));_2be.create("div",{"class":"opentasks-count",innerHTML:"<i class=\"icon "+(_325?"fonticon-task-open-for-me":"fonticon-task-open")+"\"></i>"},this.baseWidgetContentNodeWrapper);_2be.destroy(this.contentNode);if(!_325){return _2cf("task_assigned_by_to",[_320.user.displayname,_321.user.displayname,_324]);}else{return _2cf("task_assigned_by_to_you",[_320.user.displayname,_324]);}})).otherwise(lang.hitch(this,function(_326){return _2cf("task_assigned_by_to_document_error",[_320.user.displayname,_321.user.displayname]);}));}));})).then(lang.hitch(this,function(_327){this.firstLineContent.innerHTML=_327;}));}}),35:_2b8([_2d1],{buildRendering:function(){this.inherited(arguments);_2bf.add(this.domNode,"user-notices-list-entry--newsflash");this.contentNode=_2be.create("a",{"target":"_blank","class":"user-notices-list-entry--newsflash__container"},this.domNode);},postCreate:function(){this.inherited(arguments);Api.Caching.newsflashs.getNewsflash(this.item["arguments"].id).then(lang.hitch(this,function(_328){this.set("html",_328.data.html);this.set("href",_328.data.href);}));},_setHtmlAttr:function(html){this.contentNode.innerHTML=html;this._set("html",html);},_setHrefAttr:function(href){_2c1.set(this.contentNode,"href",href);this._set("href",href);}})};var _329=_2b8([_2c7],{type:"list",baseClass:"user-notices-list",skipRenderingFilterMap:null,_liveItemAdded:false,constructor:function(){this.skipRenderingFilterMap={};},query:function(){return true;},queryOptions:{sort:function(left,_32a){var _32b=!!left.isLive;var _32c=!!_32a.isLive;if(_32b!==_32c){return _32b?-1:1;}return left.createdAt>_32a.createdAt?-1:(left.createdAt==_32a.createdAt?0:1);}},postCreate:function(){this.inherited(arguments);this._alertslastreadat=Api.Caching.users_me_alertslastreadat.get().then(function(_32d){return _2bc.fromISOString(_32d.data);});},createEntryWidget:function(id,item,node){if(this.skipRendering(item)){return;}var _32e=_2eb[item.type];var w=_32e?new _32e({item:item,userid:this.userid||sp.info.user.id,activeFullEntryLink:this.activeFullEntryLink},node):null;if(w){var self=this;_2cb.defer(function(){when(self._alertslastreadat).then(function(_32f){w.set("unread",_32f<item.createdAt);});});}return w;},add:function(_330){if(lang.isString(_330.createdAt)){_330.createdAt=_2bc.fromISOString(_330.createdAt);}this.store.put(_330);if(_330.isLive&&!this._liveItemAdded){this._liveItemAdded=true;this.add({id:"clientnotice_liveborder",type:"clientnotice_liveborder",createdAt:new Date(0),isLive:true});}},skipRendering:function(item){return false||this._skipRenderingForCommentEntryItems(item)||this._skipRenderingForNewsflashItems(item);},_skipRenderingForCommentEntryItems:function(item){if(!item.type||!item.eventSubject||!item.eventSubject.documentId||!item.eventSubject.commentId||!item.causedBy){return false;}if(item.type!==5&&item.type!==26&&item.type!==32){return false;}var type=item.type===26?5:item.type;var _331=item.eventSubject.documentId;var _332=item.eventSubject.commentId;var _333=item.causedBy;var _334=_331+"#"+type+"#"+_332+"#"+_333;return this._skipOnSecondFilterOccasion(_334);},_skipRenderingForNewsflashItems:function(item){if(!item.type||!item["arguments"]||!item["arguments"].id){return false;}if(item.type!==35){return false;}return this._skipOnSecondFilterOccasion(item.type+"#"+item["arguments"].id);},_skipOnSecondFilterOccasion:function(_335){if(!_335){return false;}var ret=this.skipRenderingFilterMap[_335];if(ret){return true;}this.skipRenderingFilterMap[_335]=true;return false;}});var _336=_2b8([_329],{constructor:function(){this.loadMore=_2cb.debounce(this.loadMore,150);},postCreate:function(){this.inherited(arguments);this.loadMore();},_getHasMoreAttr:function(){return Api.Util.hasPrev(this._lastResponse);},_setStoreLoadPredicateAttr:function(_337){this.loadUntil(_337);},loadUntil:function(_338){if(!_338){return when(true);}var self=this;return when(_338(this.store,this._lastResponse)).then(function(_339){if(_339){return when(self.loadNextPage()).then(function(_33a){if(_33a&&_33a.data&&_33a.length!==0){return self.loadUntil(_338);}else{return false;}});}else{return true;}});},loadNextPage:function(){var _33b;if(this._lastResponse){_33b=Api.Util.prevPage(Api.Caching,this._lastResponse);}else{_33b=this._loadFirstPage();}if(_33b){var ret=_33b.then(lang.hitch(this,function(_33c){arr.forEach(_33c.data,this.add,this);this._lastResponse=_33c;return _33c;})).otherwise(lang.hitch(this,function(e){this._lastResponse=null;throw e||"error";}));ret.always(lang.hitch(this,function(){this._updateHasMore();}));return ret;}return when(null);},loadMore:function(){var _33d=1;this.loadUntil(function(){_33d=_33d-1;return _33d>=0;});},_loadFirstPage:function(){var _33e=(sp.info.document&&sp.info.document.id)?{documentid:sp.info.document.id}:{};return Api.Caching.users_me_notifications.get(_33e);},_updateHasMore:function(){this._set("hasMore",this.get("hasMore"));}});_336.Basic=_329;return _336;});},"cb/contacts/ContactsTable":function(){define(["dojo/ready","dojo/on","dojo/aspect","dojo/query","dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/dom-class","dojo/dom-attr","dojo/json","dojox/lang/functional","dojo/store/Memory","dojo/store/Observable","dojo/Stateful","dojo/date/stamp","dojo/promise/all","dojo/when","dijit/_WidgetBase","cb/widget/_TemplatedMixin","dijit/_Container","dijit/form/Select","cb/util","sp/dialog/NewBoardDialog","cb/api/Api","cb/Capabilities","cb/widget/_HideableMixin","cb/util","sp/infos/InfoManager","sp/I18n","cb/user/UserDisplay","sp/ActivityIndicatorMixin","./ContactsTableRow","./ContactsInviteTools","dojo/text!./ContactsTable.html","dojo/i18n!./nls/Contacts","dojo/NodeList-traverse"],function(_33f,on,_340,_341,lang,_342,_343,_344,_345,_346,json,_347,_348,_349,_34a,_34b,_34c,when,_34d,_34e,_34f,_350,util,_351,Api,_352,_353,_354,_355,_356,_357,_358,_359,_35a,_35b,i18n){var I18N=_356.wrap(i18n);return _343([_34d,_34f,_34e],{constructor:function(){this._widgetsById={};},templateString:_35b,i18n:i18n,postCreate:function postCreate(){this.inherited(arguments);this.watch("query",_354.debounce(_354.logExceptions(lang.hitch(this,function(name,_35c,_35d){if(_35c!==_35d){this._handleQueryChange(_35d);}})),50));this.own(on(this.domNode,".contacts-table__head__new-board-button:click",lang.hitch(this,"_handleNewBoardButtonClick")));this.own(on(this.domNode,".contacts-table__row__check input:change",lang.hitch(this,"_handleCheckboxChange")));},_handleQueryChange:function(q){if(this._observeHandle){this._observeHandle.remove();}var _35e=this.store.query(q,{sort:[{attribute:"sortKey"}]});_342.forEach(this.getChildren(),function(c){c.destroy();});_342.forEach(_35e,function(_35f,_360){this.addContact(_35f,_360);},this);this._observeHandle=_35e.observe(lang.hitch(this,function(_361,_362,_363){if(_363===-1){this.removeContact(_361);}else{this.addContact(_361,_363);}}),true);this.own(this._observeHandle);},_handleNewBoardButtonClick:function(e){var self=this;var _364=new _351({_getInvitationToAttr:function(){return _34c(_347.reduce(self.get("selectedContacts"),function(acc,c){if(!c){}else{if(c.userId){acc.push(_355.getById({type:"user",id:c.userId}).then(function(_365){return _365.user.emailAddresses.firstConfirmedEmailAddress;}));}else{if(c.emailAdresses&&c.emailAdresses.confirmedEmailAddress){acc.push(when(c.emailAdresses.confirmedEmailAddress));}}}return acc;},[])).then(function(_366){return _342.filter(_366,function(a){return !!a;}).join(";");});}});_364.show(e.target);},_handleCheckboxChange:function(_367){var _368=_341(_367.target).parents(".contacts-table__row")[0];_345.toggle(_368,"contacts-table__row--selected",_367.target.checked);},addContact:function(_369,_36a){var _36b=new _359({contact:_369});_354.relayMethodInvocation(_36b,this,"onContactManipulated");this.addChild(_36b,_36a===-1?undefined:_36a);},removeContact:function(_36c){var _36d=_36c.id;if(this._widgetsById[_36d]){this._widgetsById[_36d].destroyRecursive();this._widgetsById[_36d]=null;}},addChild:function(_36e,_36f){var _370=_36e.contact.id;if(this._widgetsById[_370]&&this._widgetsById[_370]!==_36e){this._widgetsById[_370].destroyRecursive();this._widgetsById[_370]=null;}this.inherited(arguments);this._widgetsById[_36e.contact.id]=_36e;},onContactManipulated:function(_371){},_getSelectedContactsAttr:function(){return _347.reduce(this.getChildren(),function(acc,row){if(row.get("selected")){acc.push(row.get("contact"));}return acc;},[]);}});});},"url:cb/personalcontainer/container/LogoContainer.html":"<div class=\"logo-container\">\n    <div class=\"logo empty\" data-dojo-attach-point=\"_logoNode\">\n        <img data-dojo-attach-point=\"_imgNode\" src=\"/_/images/logo_rgb_horizont_s.png\" />\n    </div>\n</div>","cb/notifications/Announcements":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/date/stamp","dojo/dom-construct","dojo/dom-class","dojo/dom-attr","dojo/on","dojo/when","dojo/query","dojo/NodeList-traverse","dojo/store/Observable","dojo/store/Memory","dijit/_WidgetBase","sp/dialog/TooltipDialog","sp/dialog/DialogContent","cb/widget/_TemplatedMixin","cb/common/escapeHtml","cb/widget/SimpleTable","cb/api","cb/assert","sp/I18n","dojo/i18n!./nls/Announcements",],function(_372,lang,arr,_373,_374,_375,_376,on,when,_377,_378,_379,_37a,_37b,_37c,_37d,_37e,_37f,_380,api,_381,_382,i18n){var _383=_382.wrap(i18n);var _384="<div><div class=\"scroll-container pretty-scrollbars\"><div data-dojo-attach-point=\"_announcementsNode\"></div></div><div class=\"in-app-announcements__dialog__social-buttons social-buttons--tiny\">"+_383("announcements_socialbuttons_label")+"<a href=\"https://twitter.com/conceptboardapp\" data-cb-click=\"twitter\" target=\"_blank\"><i class=\"fonticon-twitter\"></i></a><a href=\"http://conceptboardapp.tumblr.com/\" data-cb-click=\"tumblr\" target=\"_blank\"><i class=\"fonticon-tumblr\"></i></a><a href=\"https://plus.google.com/+Conceptboard/\" data-cb-click=\"google\" target=\"_blank\"><i class=\"fonticon-google\"></i></a><a data-cb-click=\"blog\" href=\"http://blog.conceptboard.com/\" target=\"_blank\"><i class=\"fonticon-rss\"></i></a></div></div>";function _385(){if(window.sessionStorage){return window.sessionStorage;}else{return {getItem:function(){return null;},setItem:function(){},removeItem:function(){},clear:function(){},length:0,key:function(){return null;}};}};var _386=_372([_37b,_37e],{entry:null,templateString:"<div><h3 class=\"in-app-announcements__dialog__announcement__title\" data-dojo-attach-point=\"_titleNode\"></h3><p class=\"in-app-announcements__dialog__announcement__text\" data-dojo-attach-point=\"_textNode\"></p><a data-dojo-attach-point=\"_linkNode\" target=\"_blank\" data-cb-click=\"link\">${i18n.announcements_readmore}</a></div>",i18n:i18n,_setEntryAttr:function(_387){this._titleNode.innerHTML=_37f(_387.title);this._textNode.innerHTML=_37f(_387.text);_376.set(this._linkNode,"href",_387.href);this._set("entry",_387);}});var _388=_372([_380],{type:"list",queryOptions:{sort:[{attribute:"sort-createdat",descending:true},{attribute:"title",descending:false}]},createEntryWidget:function(id,item,node){return new _386({entry:item},node);}});var _389=_372([_37c],{invisibleMilk:true,baseClass:"in-app-announcements-dialog in-app-announcements__dialog",postCreate:function(){this.inherited(arguments);this.content=new _37d({dialog:this,templateString:_384,postCreate:function(){this.inherited("postCreate",arguments);var _38a=this.dialog.announcementsStore;new _388({postCreate:function(){this.inherited("postCreate",arguments);},changeQuery:function(){this.inherited("changeQuery",arguments);this._resyncStores();},_resyncStores:function(){var anns=_38a.query();anns.forEach(lang.hitch(this,function(ann){this.store.put(ann);}));anns.observe(lang.hitch(function(item,_38b,_38c){if(_38b===-1){this.store.put(item);}if(_38c===-1){this.store.del(item.id);}}));}},this._announcementsNode);this.own(on(this.domNode,on.selector("[data-cb-click]","click"),function(_38d){var _38e=_377(_38d.target).closest("[data-cb-click]").at(0).attr("data-cb-click");if(_38e){sp.global.analytics.trackEvent("in app banner","click newsflash","click "+_38e);}}));}});}});return _372([_37b],{baseClass:"in-app-announcements",notificationsReadAt:null,notificationsAvailable:false,constructor:function(){this.announcementsStore=_379(new _37a());},buildRendering:function(){this.inherited(arguments);_375.add(this.domNode,this.baseClass);this.container=_374.create("div",{"class":this.baseClass+"__container"},this.domNode);_374.create("img",{"class":this.baseClass+"__container__captain","src":"/_/images/cpt-CB-right-45deg.svg"},this.container);this.buttonNode=_374.create("span",{"class":this.baseClass+"__container__button","innerHTML":_383("announcements_button_label")},this.container);},postCreate:function(){this.inherited(arguments);this.announcementsStore.query().observe(lang.hitch(this,function(){this._updateReadStatus();this._updateAvailableStatus();}));api.Caching.users_me_announcements.get().then(api.Util.data).then(lang.hitch(this,function(_38f){arr.forEach(_38f,function(ann){_381.object(ann);_381.string(ann.title);_381.string(ann.text);_381.string(ann.href);_381.string(ann.createdat);_381.string(ann.id);var _390=lang.delegate(ann);_390.createdat=_373.fromISOString(ann.createdat);_390["sort-createdat"]=_390.createdat.getTime();this.announcementsStore.put(_390);},this);}));this.set("noticiationsreadAt",this.notificationsReadAt);var _391=parseInt(_385().getItem("announcements/notificationsReadAt"),10);_391=_391>0?_391:null;if(_391){if(_391<this.get("notificationsReadAt")){_385().setItem("announcements/notificationsReadAt",this.get("notificationsReadAtFromStorage"));}else{this.set("notificationsReadAt",new Date(_391));}}this.own(on(this.container,"click",lang.hitch(this,"_handleContainerClicked")));this._updateAvailableStatus();this._updateReadStatus();},_handleContainerClicked:function(){var _392=new _389({announcementsStore:this.announcementsStore});_392.show(this.buttonNode);sp.global.analytics.trackEvent("in app banner","open newsflash");this.own(on.once(_392,"hide",lang.hitch(this,function(){sp.global.analytics.trackEvent("in app banner","close newsflash");this.set("notificationsReadAt",new Date());})));},_updateAvailableStatus:function(){when(this.announcementsStore.query()).then(lang.hitch(this,function(_393){this.set("notificationsAvailable",_393.length>0);this._updateReadStatus();}));},_setNotificationsAvailableAttr:function(_394){_375.toggle(this.domNode,"hideBlock",!_394);this._set("notificationsAvailable",_394);},_setNotificationsReadAtAttr:function(_395){_385().setItem("announcements/notificationsReadAt",_395.getTime());this._set("notificationsReadAt",_395);this._updateReadStatus();},_updateReadStatus:function(){var _396=this.get("notificationsReadAt")||new Date(0);when(this.announcementsStore.query({createdat:{test:function(_397,item){return _397>_396;}}})).then(lang.hitch(this,function(_398){this.set("unreadNotificationsAvailable",this.get("notificationsAvailable")&&_398.length>0);}));},_setUnreadNotificationsAvailableAttr:function(_399){_375.toggle(this.domNode,"in-app-announcements--all-read",!_399);this._set("unreadNotificationsAvailable",_399);}});});},"cb/widget/SearchSubmit":function(){define(["dojo","dojo/keys","dojo/dom-attr","dojo/dom-class","dijit/_Widget","cb/widget/_Templated","dojo/text!./SearchSubmit.html"],function(dojo,_39a,_39b,_39c,_39d,_39e,_39f){return dojo.declare([_39d,_39e],{baseClass:"search-submit",templateString:_39f,value:"",postCreate:function(){},onChange:function(_3a0){},_handleBlur:function(e){var _3a1=_39b.get(this._inputNode,"value");if(this.value!==_3a1&&_3a1===""){this.set("value",_3a1);}},_handleResetButtonClick:function(e){this.set("value","");_39c.add(this._resetNode,"hideBlock");},_handleMousedownSubmitButton:function(e){dojo.stopEvent(e);this.set("value",_39b.get(this._inputNode,"value"));},_handleKeyupInputNode:function(e){_39c.toggle(this._resetNode,"hideBlock",(_39b.get(this._inputNode,"value")===""));if(e.keyCode===_39a.ENTER){this.set("value",_39b.get(this._inputNode,"value"));}},_setValueAttr:function(_3a2){_39b.set(this._inputNode,"value",_3a2);if(this.value===_3a2){return;}this.value=_3a2;this._set("value",_3a2);this.onChange(_3a2);}});});},"cb/common/UserListUtils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/_base/Deferred","dojo/DeferredList","cb/widget/UserIconListEntry","sp/infos/InfoManager"],function(lang,arr,_3a3,_3a4,_3a5,_3a6){function _3a7(_3a8,_3a9){if(_3a8.length===1){if(_3a8[0]===_3a9){return "myself_";}else{return "user_";}}else{return "users_";}};function _3aa(_3ab,path){return function(a,b){var _3ac=a,_3ad=b;if(path){_3ac=lang.getObject(path,a);_3ad=lang.getObject(path,b);}if(_3ac===_3ab){return -1;}else{if(_3ad===_3ab){return 1;}else{return 0;}}};};function _3ae(_3af,_3b0){return _3af.slice(0).sort(_3aa(_3b0));};function _3b1(_3b2,_3b3,_3b4){var _3b5=_3b4("myself");return _3a4.gatherResults(arr.map(_3b2,function(_3b6){if(_3b6===_3b3){var ret=new _3a3();ret.callback(_3b5);return ret;}else{return _3a6.getById({type:"user",id:_3b6}).then(function(_3b7){return _3b7.user.displayname;});}}));};return {getPersonListI18nPrefix:_3a7,createOrderingWithNeedleLast:_3aa,createUsersListSortedWithMyselfLast:_3ae,createNamesListWithMyself:_3b1};});},"dijit/form/_ComboBoxMenuMixin":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/dom-attr","dojo/i18n","dojo/i18n!./nls/ComboBox"],function(_3b8,_3b9,_3ba,i18n){return _3b9("dijit.form._ComboBoxMenuMixin",null,{_messages:null,postMixInProperties:function(){this.inherited(arguments);this._messages=i18n.getLocalization("dijit.form","ComboBox",this.lang);},buildRendering:function(){this.inherited(arguments);this.previousButton.innerHTML=this._messages["previousMessage"];this.nextButton.innerHTML=this._messages["nextMessage"];},_setValueAttr:function(_3bb){this.value=_3bb;this.onChange(_3bb);},onClick:function(node){if(node==this.previousButton){this._setSelectedAttr(null);this.onPage(-1);}else{if(node==this.nextButton){this._setSelectedAttr(null);this.onPage(1);}else{this.onChange(node);}}},onChange:function(){},onPage:function(){},onClose:function(){this._setSelectedAttr(null);},_createOption:function(item,_3bc){var _3bd=this._createMenuItem();var _3be=_3bc(item);if(_3be.html){_3bd.innerHTML=_3be.label;}else{_3bd.appendChild(_3bd.ownerDocument.createTextNode(_3be.label));}if(_3bd.innerHTML==""){_3bd.innerHTML="&#160;";}this.applyTextDir(_3bd,(_3bd.innerText||_3bd.textContent||""));return _3bd;},createOptions:function(_3bf,_3c0,_3c1){this.items=_3bf;this.previousButton.style.display=(_3c0.start==0)?"none":"";_3ba.set(this.previousButton,"id",this.id+"_prev");_3b8.forEach(_3bf,function(item,i){var _3c2=this._createOption(item,_3c1);_3c2.setAttribute("item",i);_3ba.set(_3c2,"id",this.id+i);this.nextButton.parentNode.insertBefore(_3c2,this.nextButton);},this);var _3c3=false;if(_3bf.total&&!_3bf.total.then&&_3bf.total!=-1){if((_3c0.start+_3c0.count)<_3bf.total){_3c3=true;}else{if((_3c0.start+_3c0.count)>_3bf.total&&_3c0.count==_3bf.length){_3c3=true;}}}else{if(_3c0.count==_3bf.length){_3c3=true;}}this.nextButton.style.display=_3c3?"":"none";_3ba.set(this.nextButton,"id",this.id+"_next");},clearResultList:function(){var _3c4=this.containerNode;while(_3c4.childNodes.length>2){_3c4.removeChild(_3c4.childNodes[_3c4.childNodes.length-2]);}this._setSelectedAttr(null);},highlightFirstOption:function(){this.selectFirstNode();},highlightLastOption:function(){this.selectLastNode();},selectFirstNode:function(){this.inherited(arguments);if(this.getHighlightedOption()==this.previousButton){this.selectNextNode();}},selectLastNode:function(){this.inherited(arguments);if(this.getHighlightedOption()==this.nextButton){this.selectPreviousNode();}},getHighlightedOption:function(){return this.selected;}});});},"dijit/form/_SearchMixin":function(){define(["dojo/data/util/filter","dojo/_base/declare","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/query","dojo/sniff","dojo/string","dojo/when","../registry"],function(_3c5,_3c6,_3c7,keys,lang,_3c8,has,_3c9,when,_3ca){return _3c6("dijit.form._SearchMixin",null,{pageSize:Infinity,store:null,fetchProperties:{},query:{},searchDelay:200,searchAttr:"name",queryExpr:"${0}*",ignoreCase:true,_abortQuery:function(){if(this.searchTimer){this.searchTimer=this.searchTimer.remove();}if(this._queryDeferHandle){this._queryDeferHandle=this._queryDeferHandle.remove();}if(this._fetchHandle){if(this._fetchHandle.abort){this._cancelingQuery=true;this._fetchHandle.abort();this._cancelingQuery=false;}if(this._fetchHandle.cancel){this._cancelingQuery=true;this._fetchHandle.cancel();this._cancelingQuery=false;}this._fetchHandle=null;}},_processInput:function(evt){if(this.disabled||this.readOnly){return;}var key=evt.charOrCode;if(evt.altKey||((evt.ctrlKey||evt.metaKey)&&(key!="x"&&key!="v"))||key==keys.SHIFT){return;}var _3cb=false;this._prev_key_backspace=false;switch(key){case keys.DELETE:case keys.BACKSPACE:this._prev_key_backspace=true;this._maskValidSubsetError=true;_3cb=true;break;default:_3cb=typeof key=="string"||key==229;}if(_3cb){if(!this.store){this.onSearch();}else{this.searchTimer=this.defer("_startSearchFromInput",1);}}},onSearch:function(){},_startSearchFromInput:function(){this._startSearch(this.focusNode.value.replace(/([\\\*\?])/g,"\\$1"));},_startSearch:function(text){this._abortQuery();var _3cc=this,_3c8=lang.clone(this.query),_3cd={start:0,count:this.pageSize,queryOptions:{ignoreCase:this.ignoreCase,deep:true}},qs=_3c9.substitute(this.queryExpr,[text]),q,_3ce=function(){var _3cf=_3cc._fetchHandle=_3cc.store.query(_3c8,_3cd);if(_3cc.disabled||_3cc.readOnly||(q!==_3cc._lastQuery)){return;}when(_3cf,function(res){_3cc._fetchHandle=null;if(!_3cc.disabled&&!_3cc.readOnly&&(q===_3cc._lastQuery)){when(_3cf.total,function(_3d0){res.total=_3d0;var _3d1=_3cc.pageSize;if(isNaN(_3d1)||_3d1>res.total){_3d1=res.total;}res.nextPage=function(_3d2){_3cd.direction=_3d2=_3d2!==false;_3cd.count=_3d1;if(_3d2){_3cd.start+=res.length;if(_3cd.start>=res.total){_3cd.count=0;}}else{_3cd.start-=_3d1;if(_3cd.start<0){_3cd.count=Math.max(_3d1+_3cd.start,0);_3cd.start=0;}}if(_3cd.count<=0){res.length=0;_3cc.onSearch(res,_3c8,_3cd);}else{_3ce();}};_3cc.onSearch(res,_3c8,_3cd);});}},function(err){_3cc._fetchHandle=null;if(!_3cc._cancelingQuery){console.error(_3cc.declaredClass+" "+err.toString());}});};lang.mixin(_3cd,this.fetchProperties);if(this.store._oldAPI){q=qs;}else{q=_3c5.patternToRegExp(qs,this.ignoreCase);q.toString=function(){return qs;};}this._lastQuery=_3c8[this.searchAttr]=q;this._queryDeferHandle=this.defer(_3ce,this.searchDelay);},constructor:function(){this.query={};this.fetchProperties={};},postMixInProperties:function(){if(!this.store){var list=this.list;if(list){this.store=_3ca.byId(list);}}this.inherited(arguments);}});});},"cb/freezing/FreezeOverlay":function(){define(["dojo/_base/declare","dojo/_base/window","dojo/ready","dojo/when","dojo/query","dojo/dom-class","dojo/dom-construct","dijit/_Widget","cb/widget/_Templated","cb/Capabilities","sp/I18n","dojo/text!./FreezeOverlay.html","dojo/i18n!./nls/FreezeOverlay"],function(_3d3,_3d4,_3d5,when,_3d6,_3d7,_3d8,_3d9,_3da,_3db,_3dc,_3dd,i18n){var _3de=_3d3([_3d9,_3da],{bemBaseClass:"freeze-overlay",i18n:i18n,templateString:_3dd,buildRendering:function(){this.inherited(arguments);this._companyNameNodes=_3d6(".js-company-name",this.domNode);},postCreate:function(){this.inherited(arguments);this._underlayNode=_3d8.create("div",{"class":this.bemBaseClass+"__underlay"},dojo.body(),"first");},_setModeAttr:function(mode){_3d7.toggle(this._adminMessageNode,"hideBlock","external"===mode);_3d7.toggle(this._userMessageNode,"hideBlock","internal"===mode);this._set("mode",mode);},_setCompanyNameAttr:function(_3df){this._companyNameNodes.innerHTML=_3dc.esc(_3df);this._set("companyName",_3df);},_destroyRendering:function(){this.inherited(arguments);_3d8.destroy(this._underlayNode);}});function init(){if(!sp.info.freezing){return;}when(sp.info.freezing.nooverlay||false).then(function(_3e0){if(_3e0){return;}if(sp.info.freezing.company){var mode="external";if(sp.info.company&&sp.info.company.id===sp.info.freezing.company.id){mode=_3db.checkHasAnyRoleOf(["manager","user"]).then(function(_3e1){return _3e1?"internal":"external";});}when(mode).then(function(mode){new _3de({companyName:sp.info.freezing.company.name,mode:mode},_3d8.create("div",{},_3d4.body()));});}});};_3d5(init);_3de.init=init;return _3de;});},"sp/dialog/UpgradeDialog":function(){define(["dojo","dojo/dom","dojo/dom-attr","dojo/dom-style","dojo/_base/connect","sp/dialog/TooltipDialog","sp/dialog/DialogContent","sp/ajax/AjaxEngine","sp/I18n","dojo/text!./UpgradeDialog.html","dojo/text!./UpgradeDialogPane.html","dojo/i18n!./nls/UpgradeDialog","dojox/widget/Rotator","dojox/widget/rotator/Pan","dojox/widget/rotator/Controller"],function(dojo,dom,_3e2,_3e3,_3e4,_3e5,_3e6,_3e7,_3e8,_3e9,_3ea,i18n){var _3eb=["security","projects","team","branding","video","moderator","sqm"];var _3ec=dojo.map(_3eb,function(_3ed){return _3ea.replace(/@@PANE_ID@@/g,_3ed);}).join("\n");var _3ee=_3e9.replace(/@@PANES_MARKUP@@/g,_3ec);var _3ef=dojo.declare([_3e6],{i18n:i18n,dialogContent:null,templateString:_3ee,widgetsInTemplate:true,transitionDuration:null,referer:window.location.pathname.replace(/\D*[^\w]/,""),postMixinProperties:function(){this.dialog.transitionDuration=this.transitionDuration;},postCreate:function(){this.inherited(arguments);_3e4.subscribe(this.id+"_FeaturesRotator/rotator/update",this,"rotatorUpdated");this.featuresRotator.resize(598,400);this.switchToPane(this.initialPane);this.logInAnalytics();},_handleCloseButtonClick:function(){this.dialog.hide();},logInAnalytics:function(){var _3f0=window.location.pathname.replace(/\D*[^\w]/,"");this.referer=this.referer.replace(/([0-9a-z]{4}-?){5}/,"board");var _3f1="/dialog/"+this.referer+"/upgrade/"+this.initialPane;sp.global.analytics.trackPageView(_3f1);},switchToPane:function(_3f2){this.featuresRotator.go(this.id+"_"+_3f2);},rotatorUpdated:function(type,_3f3){if(type==="onAfterTransition"){var _3f4=_3f3.panes[_3f3.idx].id;switch(_3f4){case this.id+"_moderator":this.reloadImage(this.imageNode_moderator);break;}}},reloadImage:function(_3f5){var _3f6=_3f5.clientWidth;var _3f7=_3f5.clientHeight;var _3f8=_3e2.get(_3f5,"src");_3e2.set(_3f5,{src:"/_/images/blank_1x1.png",width:_3f6,height:_3f7});window.setTimeout(function(){_3e2.set(_3f5,"src",_3f8);},10);}});return dojo.declare([_3e5],{baseClass:"with-title upgrade-dialog",dialogContent:null,invisibleMilk:false,transitionDuration:450,postCreate:function(){this.inherited(arguments);this.content=new _3ef({dialog:this,initialPane:this.dialogContent,transitionDuration:this.transitionDuration});},onHide:function(){this.inherited(arguments);if(this.open){sp.global.analytics.trackPageView("/"+this.content.referer);}}});});},"cb/util-mentions":function(){define(["dojox/lang/functional","dojo/promise/all","sp/infos/InfoManager"],function(_3f9,_3fa,_3fb){var ret={};ret.isOwnMentionInText=function isOwnMentionInText(text){return (text||"").indexOf("@["+sp.info.user.id+"]")!==-1;};ret.getUserIdsFromMentionText=function getUserIdsFromMentionText(_3fc){var ret=[];var re=new RegExp("@\\[([0-9a-zA-Z_\\-]+)\\]","gi");var _3fd=_3fc.match(re);if(_3fd&&_3fd.length>0){for(var i=0;i<_3fd.length;i++){var _3fe=_3fd[i];if(_3fe.length>=4){var _3ff=_3fe.substring(2,_3fe.length-1);ret.push(_3ff);}}}return ret;};ret.insertClickableMentionMarkup=function insertClickableMentionMarkup(_400,_401,_402,_403){var map=_401;dojo.forEach(dojox.lang.functional.keys(map),function(_404){var _405=map[_404];var _406="@\\["+_404+"\\]";var _407;if(_403){var _408="link mention "+(_404==sp.info.user.id?"own-mention":"");_407="<span class=\""+_408+"\" "+(_402?_402:"")+" spuseridforprofile=\""+_404+"\">@"+_405+"</span>";}else{_407="<strong>@"+_405+"</strong>";}var re=new RegExp(_406,"g");_400=_400.replace(re,_407);},this);return _400;};ret.convertTextToFullyEnrichedMarkup=function convertTextToFullyEnrichedMarkup(text,_409,_40a){var _40b=ret.getUserIdsFromMentionText(text);return _3fb.bulkloadByIds({type:sp.infos.TYPE.user,ids:_40b}).then(function(){return _3fa(_3f9.foldl(_40b,function(ret,_40c){ret[_40c]=_3fb.getById({type:"user",id:_40c}).then(function(_40d){return _40d.user.displayname;});return ret;},{}));}).then(function(_40e){return ret.insertClickableMentionMarkup(text,_40e,_409,_40a);});};return ret;});},"cb/page/dashboard/personalcontainer/Navigation":function(){define(["dojo","dojo/query","dojo/dom-attr","dojo/dom-class","dojox/lang/functional","dojo/dom-construct","dojo/_base/lang","dojo/when","dojo/promise/all","dijit/_Widget","cb/widget/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","sp/I18n","sp/infos/InfoManager","cb/Capabilities","dojo/text!./Navigation.html","dojo/i18n!./nls/Navigation","dojo/NodeList-traverse"],function(dojo,_40f,_410,_411,_412,_413,lang,when,_414,_415,_416,_417,_418,_419,_41a,_41b,i18n){var _41c=/(?:\/__)?\/(.*)/;return dojo.declare([_415,_416,_417],{templateString:_41b,i18n:i18n,widgetsInTemplate:true,postCreate:function(){this.inherited(arguments);_419.getById({type:"companyuser",id:sp.info.user.info.id}).then(dojo.hitch(this,function(_41d){if(_41d&&_41d.companyuser&&dojo.indexOf(_41d.companyuser.roles,"manager")>-1){_411.remove(this._companyAdminNode,"hideBlock");}else{_413.destroy(this._companyAdminNode);}}));_414({isBasic:when(sp.info.user.info.accountType.asString==="basic"),featureRegistrationSelfsignup:_41a.checkFeature("registration.selfsignup").then(function(_41e){return _41e==="enabled";})}).then(lang.hitch(this,function(_41f){if(_41f.isBasic&&_41f.featureRegistrationSelfsignup){_411.remove(this._freeUpgradeNode,"hideBlock");}}));var _420=(this._navPointNodes={});_40f("li > a",this.domNode).forEach(function(node){var href=_410.get(node,"href");var _421=href.match(_41c);if(_421){var _422=href.match(_41c)[1].replace("/","_");_420[_422]=node;}});this._setActiveNavPointAttr(this.activeNavPoint);},_setActiveNavPointAttr:function(_423){_412.forIn(this._navPointNodes,function(node,key){var _424=_40f(node).parent()[0];_411.toggle(_424,"active",key===_423);});this.activeNavPoint=_423;this._set("activeNavPoint",_423);}});});},"url:cb/contacts/InviteToolStudent.html":"<div class=\"\">\r\n    <div class=\"hideBlock\" data-mode=\"nostudregcode-manager\">\r\n        <p class=\"small light\">${!i18n.invite_per_student_without_studregcode_manager_message}</p>\r\n    </div>\r\n    <div class=\"hideBlock\" data-mode=\"nostudregcode\">\r\n        <p class=\"small light\">${!i18n.invite_per_student_without_studregcode_message}</p>\r\n    </div>\r\n    <div class=\"hideBlock\" data-mode=\"studregcode\">\r\n        <div>\r\n            <p class=\"small light\">${!i18n.invite_per_student_message}</p>\r\n            <p class=\"small light\" data-dojo-attach-point=\"_instructionsNode\"></p>\r\n            \r\n                \r\n            <p class=\"small light\">${!i18n.invite_per_student_regcode_label}</p>\r\n            <p data-dojo-attach-point=\"_regcodeDisplayNode\" class=\"blue large-font center\" style=\"font-size:3em; margin:0;\"></p>\r\n        </div>\r\n    </div>\r\n</div>","cb/status/editingStatus":function(){define(["cb/Capabilities","sp/infos/InfoManager"],function(_425,_426){return function editingStatus(_427,_428){if(!_427.documentId){return;}_428.set("editing",{readonly:false,reason:undefined});_425.checkCreateBoard().then(function(_429){if(_429==="nofreesqm"){_428.set("editing",{readonly:true,reason:"nofreesqm"});}else{return _425.collaborateOnBoard.watch(function(_42a){if(_42a==="enabled"){return _426.getById({type:"document",id:_427.documentId}).then(function(_42b){var _42c=_42b.document.accessControlState;if(!_42c.collaboration){_428.set("editing",{readonly:false,reason:"collaborationmode"});}else{_428.set("editing",{readonly:false,reason:undefined});}}).otherwise(function(){_428.set("editing",{readonly:false,reason:undefined});});}else{_428.set("editing",{readonly:true,reason:"collaborationmode"});}},_427.documentId);}}).otherwise(function(){});return _428;};});},"url:cb/widget/UserDialog.html":"<div class=\"dialog-content\">\r\n    <div data-dojo-attach-point=\"additionalButtons\" class=\"additional-user-dialog-buttons\">\r\n        <div class=\"hideBlock\" data-dojo-attach-point=\"_guestLoginNode\">${!i18n.guest_login}</div>\r\n        <div class=\"hideBlock\" data-dojo-attach-point=\"_logoutNode\">${!i18n.logout}</div>\r\n    </div>\r\n</div>","dijit/form/_AutoCompleterMixin":function(){define(["dojo/data/util/filter","dojo/_base/declare","dojo/dom-attr","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/query","dojo/regexp","dojo/sniff","dojo/string","./DataList","../registry","./_TextBoxMixin","./_SearchMixin"],function(_42d,_42e,_42f,_430,keys,lang,_431,_432,has,_433,_434,_435,_436,_437){return _42e("dijit.form._AutoCompleterMixin",_437,{item:null,autoComplete:true,highlightMatch:"first",labelAttr:"",labelType:"text",maxHeight:-1,_stopClickEvents:false,_getCaretPos:function(_438){var pos=0;if(typeof (_438.selectionStart)=="number"){pos=_438.selectionStart;}else{if(has("ie")){var tr=_438.ownerDocument.selection.createRange().duplicate();var ntr=_438.createTextRange();tr.move("character",0);ntr.move("character",0);try{ntr.setEndPoint("EndToEnd",tr);pos=String(ntr.text).replace(/\r/g,"").length;}catch(e){}}}return pos;},_setCaretPos:function(_439,_43a){_43a=parseInt(_43a);_436.selectInputText(_439,_43a,_43a);},_setDisabledAttr:function(_43b){this.inherited(arguments);this.domNode.setAttribute("aria-disabled",_43b?"true":"false");},_onKey:function(evt){if(evt.charCode>=32){return;}var key=evt.charCode||evt.keyCode;if(key==keys.ALT||key==keys.CTRL||key==keys.META||key==keys.SHIFT){return;}var pw=this.dropDown;var _43c=null;this._abortQuery();this.inherited(arguments);if(evt.altKey||evt.ctrlKey||evt.metaKey){return;}if(this._opened){_43c=pw.getHighlightedOption();}switch(key){case keys.PAGE_DOWN:case keys.DOWN_ARROW:case keys.PAGE_UP:case keys.UP_ARROW:if(this._opened){this._announceOption(_43c);}_430.stop(evt);break;case keys.ENTER:if(_43c){if(_43c==pw.nextButton){this._nextSearch(1);_430.stop(evt);break;}else{if(_43c==pw.previousButton){this._nextSearch(-1);_430.stop(evt);break;}}_430.stop(evt);}else{this._setBlurValue();this._setCaretPos(this.focusNode,this.focusNode.value.length);}case keys.TAB:var _43d=this.get("displayedValue");if(pw&&(_43d==pw._messages["previousMessage"]||_43d==pw._messages["nextMessage"])){break;}if(_43c){this._selectOption(_43c);}case keys.ESCAPE:if(this._opened){this._lastQuery=null;this.closeDropDown();}break;}},_autoCompleteText:function(text){var fn=this.focusNode;_436.selectInputText(fn,fn.value.length);var _43e=this.ignoreCase?"toLowerCase":"substr";if(text[_43e](0).indexOf(this.focusNode.value[_43e](0))==0){var cpos=this.autoComplete?this._getCaretPos(fn):fn.value.length;if((cpos+1)>fn.value.length){fn.value=text;_436.selectInputText(fn,cpos);}}else{fn.value=text;_436.selectInputText(fn);}},_openResultList:function(_43f,_440,_441){var _442=this.dropDown.getHighlightedOption();this.dropDown.clearResultList();if(!_43f.length&&_441.start==0){this.closeDropDown();return;}this._nextSearch=this.dropDown.onPage=lang.hitch(this,function(_443){_43f.nextPage(_443!==-1);this.focus();});this.dropDown.createOptions(_43f,_441,lang.hitch(this,"_getMenuLabelFromItem"));this._showResultList();if("direction" in _441){if(_441.direction){this.dropDown.highlightFirstOption();}else{if(!_441.direction){this.dropDown.highlightLastOption();}}if(_442){this._announceOption(this.dropDown.getHighlightedOption());}}else{if(this.autoComplete&&!this._prev_key_backspace&&!/^[*]+$/.test(_440[this.searchAttr].toString())){this._announceOption(this.dropDown.containerNode.firstChild.nextSibling);}}},_showResultList:function(){this.closeDropDown(true);this.openDropDown();this.domNode.setAttribute("aria-expanded","true");},loadDropDown:function(){this._startSearchAll();},isLoaded:function(){return false;},closeDropDown:function(){this._abortQuery();if(this._opened){this.inherited(arguments);this.domNode.setAttribute("aria-expanded","false");this.focusNode.removeAttribute("aria-activedescendant");}},_setBlurValue:function(){var _444=this.get("displayedValue");var pw=this.dropDown;if(pw&&(_444==pw._messages["previousMessage"]||_444==pw._messages["nextMessage"])){this._setValueAttr(this._lastValueReported,true);}else{if(typeof this.item=="undefined"){this.item=null;this.set("displayedValue",_444);}else{if(this.value!=this._lastValueReported){this._handleOnChange(this.value,true);}this._refreshState();}}},_setItemAttr:function(item,_445,_446){var _447="";if(item){if(!_446){_446=this.store._oldAPI?this.store.getValue(item,this.searchAttr):item[this.searchAttr];}_447=this._getValueField()!=this.searchAttr?this.store.getIdentity(item):_446;}this.set("value",_447,_445,_446,item);},_announceOption:function(node){if(!node){return;}var _448;if(node==this.dropDown.nextButton||node==this.dropDown.previousButton){_448=node.innerHTML;this.item=undefined;this.value="";}else{var item=this.dropDown.items[node.getAttribute("item")];_448=(this.store._oldAPI?this.store.getValue(item,this.searchAttr):item[this.searchAttr]).toString();this.set("item",item,false,_448);}this.focusNode.value=this.focusNode.value.substring(0,this._lastInput.length);this.focusNode.setAttribute("aria-activedescendant",_42f.get(node,"id"));this._autoCompleteText(_448);},_selectOption:function(_449){this.closeDropDown();if(_449){this._announceOption(_449);}this._setCaretPos(this.focusNode,this.focusNode.value.length);this._handleOnChange(this.value,true);},_startSearchAll:function(){this._startSearch("");},_startSearchFromInput:function(){this.item=undefined;this.inherited(arguments);},_startSearch:function(key){if(!this.dropDown){var _44a=this.id+"_popup",_44b=lang.isString(this.dropDownClass)?lang.getObject(this.dropDownClass,false):this.dropDownClass;this.dropDown=new _44b({onChange:lang.hitch(this,this._selectOption),id:_44a,dir:this.dir,textDir:this.textDir});this.focusNode.removeAttribute("aria-activedescendant");this.textbox.setAttribute("aria-owns",_44a);}this._lastInput=key;this.inherited(arguments);},_getValueField:function(){return this.searchAttr;},postMixInProperties:function(){this.inherited(arguments);if(!this.store){var _44c=this.srcNodeRef;this.store=new _434({},_44c);if(!("value" in this.params)){var item=(this.item=this.store.fetchSelectedItem());if(item){var _44d=this._getValueField();this.value=this.store._oldAPI?this.store.getValue(item,_44d):item[_44d];}}}},postCreate:function(){var _44e=_431("label[for=\""+this.id+"\"]");if(_44e.length){if(!_44e[0].id){_44e[0].id=this.id+"_label";}this.domNode.setAttribute("aria-labelledby",_44e[0].id);}this.inherited(arguments);this.connect(this,"onSearch","_openResultList");},_getMenuLabelFromItem:function(item){var _44f=this.labelFunc(item,this.store),_450=this.labelType;if(this.highlightMatch!="none"&&this.labelType=="text"&&this._lastInput){_44f=this.doHighlight(_44f,this._lastInput);_450="html";}return {html:_450=="html",label:_44f};},doHighlight:function(_451,find){var _452=(this.ignoreCase?"i":"")+(this.highlightMatch=="all"?"g":""),i=this.queryExpr.indexOf("${0}");find=_432.escapeString(find);return this._escapeHtml(_451.replace(new RegExp((i==0?"^":"")+"("+find+")"+(i==(this.queryExpr.length-4)?"$":""),_452),"\uffff$1\uffff")).replace(/\uFFFF([^\uFFFF]+)\uFFFF/g,"<span class=\"dijitComboBoxHighlightMatch\">$1</span>");},_escapeHtml:function(str){str=String(str).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");return str;},reset:function(){this.item=null;this.inherited(arguments);},labelFunc:function(item,_453){return (_453._oldAPI?_453.getValue(item,this.labelAttr||this.searchAttr):item[this.labelAttr||this.searchAttr]).toString();},_setValueAttr:function(_454,_455,_456,item){this._set("item",item||null);if(_454==null){_454="";}this.inherited(arguments);},_setTextDirAttr:function(_457){this.inherited(arguments);if(this.dropDown){this.dropDown._set("textDir",_457);}}});});},"url:cb/contacts/ContactsInviteDialog.html":"<div>\n    <div class=\"dialog-content\">\n        <div class=\"dialog-title\">\n            ${!i18n.invite_dialog_title}\n            <div data-dojo-attach-event=\"click:_handleCloseButtonClick\" class=\"dialog-close-button\" title=\"close\"><i class=\"fonticon-cross\"></i></div>\n        </div>\n        \n        <div data-dojo-attach-point=\"_inviteToolsContainer\"></div>\n        \n        \n    </div>\n</div>","dijit/form/MappedTextBox":function(){define(["dojo/_base/declare","dojo/dom-construct","./ValidationTextBox"],function(_458,_459,_45a){return _458("dijit.form.MappedTextBox",_45a,{postMixInProperties:function(){this.inherited(arguments);this.nameAttrSetting="";},_setNameAttr:null,serialize:function(val){return val.toString?val.toString():"";},toString:function(){var val=this.filter(this.get("value"));return val!=null?(typeof val=="string"?val:this.serialize(val,this.constraints)):"";},validate:function(){this.valueNode.value=this.toString();return this.inherited(arguments);},buildRendering:function(){this.inherited(arguments);this.valueNode=_459.place("<input type='hidden'"+(this.name?" name=\""+this.name.replace(/"/g,"&quot;")+"\"":"")+"/>",this.textbox,"after");},reset:function(){this.valueNode.value="";this.inherited(arguments);}});});},"dijit/form/ComboBoxMixin":function(){define(["dojo/_base/declare","dojo/_base/Deferred","dojo/_base/kernel","dojo/_base/lang","dojo/store/util/QueryResults","./_AutoCompleterMixin","./_ComboBoxMenu","../_HasDropDown","dojo/text!./templates/DropDownBox.html"],function(_45b,_45c,_45d,lang,_45e,_45f,_460,_461,_462){return _45b("dijit.form.ComboBoxMixin",[_461,_45f],{dropDownClass:_460,hasDownArrow:true,templateString:_462,baseClass:"dijitTextBox dijitComboBox",cssStateNodes:{"_buttonNode":"dijitDownArrowButton"},_setHasDownArrowAttr:function(val){this._set("hasDownArrow",val);this._buttonNode.style.display=val?"":"none";},_showResultList:function(){this.displayMessage("");this.inherited(arguments);},_setStoreAttr:function(_463){if(!_463.get){lang.mixin(_463,{_oldAPI:true,get:function(id){var _464=new _45c();this.fetchItemByIdentity({identity:id,onItem:function(_465){_464.resolve(_465);},onError:function(_466){_464.reject(_466);}});return _464.promise;},query:function(_467,_468){var _469=new _45c(function(){_46a.abort&&_46a.abort();});_469.total=new _45c();var _46a=this.fetch(lang.mixin({query:_467,onBegin:function(_46b){_469.total.resolve(_46b);},onComplete:function(_46c){_469.resolve(_46c);},onError:function(_46d){_469.reject(_46d);}},_468));return _45e(_469);}});}this._set("store",_463);},postMixInProperties:function(){var _46e=this.params.store||this.store;if(_46e){this._setStoreAttr(_46e);}this.inherited(arguments);if(!this.params.store&&!this.store._oldAPI){var _46f=this.declaredClass;lang.mixin(this.store,{getValue:function(item,attr){_45d.deprecated(_46f+".store.getValue(item, attr) is deprecated for builtin store.  Use item.attr directly","","2.0");return item[attr];},getLabel:function(item){_45d.deprecated(_46f+".store.getLabel(item) is deprecated for builtin store.  Use item.label directly","","2.0");return item.name;},fetch:function(args){_45d.deprecated(_46f+".store.fetch() is deprecated for builtin store.","Use store.query()","2.0");var shim=["dojo/data/ObjectStore"];require(shim,lang.hitch(this,function(_470){new _470({objectStore:this}).fetch(args);}));}});}}});});},"dijit/form/_TextBoxMixin":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/dom","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/on","../main"],function(_471,_472,dom,_473,keys,lang,on,_474){var _475=_472("dijit.form._TextBoxMixin",null,{trim:false,uppercase:false,lowercase:false,propercase:false,maxLength:"",selectOnClick:false,placeHolder:"",_getValueAttr:function(){return this.parse(this.get("displayedValue"),this.constraints);},_setValueAttr:function(_476,_477,_478){var _479;if(_476!==undefined){_479=this.filter(_476);if(typeof _478!="string"){if(_479!==null&&((typeof _479!="number")||!isNaN(_479))){_478=this.filter(this.format(_479,this.constraints));}else{_478="";}}}if(_478!=null&&((typeof _478)!="number"||!isNaN(_478))&&this.textbox.value!=_478){this.textbox.value=_478;this._set("displayedValue",this.get("displayedValue"));}if(this.textDir=="auto"){this.applyTextDir(this.focusNode,_478);}this.inherited(arguments,[_479,_477]);},displayedValue:"",_getDisplayedValueAttr:function(){return this.filter(this.textbox.value);},_setDisplayedValueAttr:function(_47a){if(_47a==null){_47a="";}else{if(typeof _47a!="string"){_47a=String(_47a);}}this.textbox.value=_47a;this._setValueAttr(this.get("value"),undefined);this._set("displayedValue",this.get("displayedValue"));if(this.textDir=="auto"){this.applyTextDir(this.focusNode,_47a);}},format:function(_47b){return _47b==null?"":(_47b.toString?_47b.toString():_47b);},parse:function(_47c){return _47c;},_refreshState:function(){},onInput:function(){},__skipInputEvent:false,_onInput:function(evt){if(this.textDir=="auto"){this.applyTextDir(this.focusNode,this.focusNode.value);}this._processInput(evt);},_processInput:function(evt){this._refreshState();this._set("displayedValue",this.get("displayedValue"));},postCreate:function(){this.textbox.setAttribute("value",this.textbox.value);this.inherited(arguments);var _47d=function(e){var _47e;if(e.type=="keydown"){_47e=e.keyCode;switch(_47e){case keys.SHIFT:case keys.ALT:case keys.CTRL:case keys.META:case keys.CAPS_LOCK:case keys.NUM_LOCK:case keys.SCROLL_LOCK:return;}if(!e.ctrlKey&&!e.metaKey&&!e.altKey){switch(_47e){case keys.NUMPAD_0:case keys.NUMPAD_1:case keys.NUMPAD_2:case keys.NUMPAD_3:case keys.NUMPAD_4:case keys.NUMPAD_5:case keys.NUMPAD_6:case keys.NUMPAD_7:case keys.NUMPAD_8:case keys.NUMPAD_9:case keys.NUMPAD_MULTIPLY:case keys.NUMPAD_PLUS:case keys.NUMPAD_ENTER:case keys.NUMPAD_MINUS:case keys.NUMPAD_PERIOD:case keys.NUMPAD_DIVIDE:return;}if((_47e>=65&&_47e<=90)||(_47e>=48&&_47e<=57)||_47e==keys.SPACE){return;}var _47f=false;for(var i in keys){if(keys[i]===e.keyCode){_47f=true;break;}}if(!_47f){return;}}}_47e=e.charCode>=32?String.fromCharCode(e.charCode):e.charCode;if(!_47e){_47e=(e.keyCode>=65&&e.keyCode<=90)||(e.keyCode>=48&&e.keyCode<=57)||e.keyCode==keys.SPACE?String.fromCharCode(e.keyCode):e.keyCode;}if(!_47e){_47e=229;}if(e.type=="keypress"){if(typeof _47e!="string"){return;}if((_47e>="a"&&_47e<="z")||(_47e>="A"&&_47e<="Z")||(_47e>="0"&&_47e<="9")||(_47e===" ")){if(e.ctrlKey||e.metaKey||e.altKey){return;}}}if(e.type=="input"){if(this.__skipInputEvent){this.__skipInputEvent=false;return;}}else{this.__skipInputEvent=true;}var faux={faux:true},attr;for(attr in e){if(attr!="layerX"&&attr!="layerY"){var v=e[attr];if(typeof v!="function"&&typeof v!="undefined"){faux[attr]=v;}}}lang.mixin(faux,{charOrCode:_47e,_wasConsumed:false,preventDefault:function(){faux._wasConsumed=true;e.preventDefault();},stopPropagation:function(){e.stopPropagation();}});if(this.onInput(faux)===false){faux.preventDefault();faux.stopPropagation();}if(faux._wasConsumed){return;}this.defer(function(){this._onInput(faux);});};this.own(on(this.textbox,"keydown, keypress, paste, cut, input, compositionend",lang.hitch(this,_47d)));},_blankValue:"",filter:function(val){if(val===null){return this._blankValue;}if(typeof val!="string"){return val;}if(this.trim){val=lang.trim(val);}if(this.uppercase){val=val.toUpperCase();}if(this.lowercase){val=val.toLowerCase();}if(this.propercase){val=val.replace(/[^\s]+/g,function(word){return word.substring(0,1).toUpperCase()+word.substring(1);});}return val;},_setBlurValue:function(){this._setValueAttr(this.get("value"),true);},_onBlur:function(e){if(this.disabled){return;}this._setBlurValue();this.inherited(arguments);},_isTextSelected:function(){return this.textbox.selectionStart!=this.textbox.selectionEnd;},_onFocus:function(by){if(this.disabled||this.readOnly){return;}if(this.selectOnClick&&by=="mouse"){this._selectOnClickHandle=this.connect(this.domNode,"onmouseup",function(){this.disconnect(this._selectOnClickHandle);this._selectOnClickHandle=null;if(!this._isTextSelected()){_475.selectInputText(this.textbox);}});this.defer(function(){if(this._selectOnClickHandle){this.disconnect(this._selectOnClickHandle);this._selectOnClickHandle=null;}},500);}this.inherited(arguments);this._refreshState();},reset:function(){this.textbox.value="";this.inherited(arguments);},_setTextDirAttr:function(_480){if(!this._created||this.textDir!=_480){this._set("textDir",_480);this.applyTextDir(this.focusNode,this.focusNode.value);}}});_475._setSelectionRange=_474._setSelectionRange=function(_481,_482,stop){if(_481.setSelectionRange){_481.setSelectionRange(_482,stop);}};_475.selectInputText=_474.selectInputText=function(_483,_484,stop){_483=dom.byId(_483);if(isNaN(_484)){_484=0;}if(isNaN(stop)){stop=_483.value?_483.value.length:0;}try{_483.focus();_475._setSelectionRange(_483,_484,stop);}catch(e){}};return _475;});},"url:cb/personalcontainer/container/Footer.html":"<div>\r\n    <a target=\"_blank\" class=\"website\" href=\"${baseUrl}/teamwork\"><i class=\"fonticon-board\" title=\"Conceptboard website\"></i>&nbsp;&nbsp;<span class=\"label\">Conceptboard</span></a>\r\n    <a target=\"_blank\" class=\"support\" href=\"/support\"><i class=\"fonticon-question\" title=\"FAQ & support forum\"></i>&nbsp;&nbsp;<span class=\"label\">FAQ&nbsp;&amp;&nbsp;Support&nbsp;</span></a>\r\n</div>","url:cb/contacts/ContactsPageLayout.html":"<div class=\"container_12_fluid contacts-page-content clearfix\">\r\n    <div class=\"contacts-page-content__header\" data-dojo-attach-point=\"_contactsPageHeader\"></div>\r\n    <div class=\"contacts-page-content__main\" data-dojo-attach-point=\"_contactsPageContent\"></div>\r\n</div>","url:cb/notifications/NotificationsDialog.html":"<div>\n    <div class=\"dialog-title\">${!i18n.alerts_on_this_board}</div>\n    <div class=\"scroll-container pretty-scrollbars\">\n        <div data-dojo-attach-point=\"_containerNode\"></div>\n        <div class=\"end-of-list\">\n            <div data-dojo-attach-point=\"_loadMoreButton\" data-dojo-attach-event=\"click:_loadMoreButtonClick\" class=\"button secondary small full-width hideBlock\">${!i18n.load_more_label}</div>\n            <div class=\"light empty-list-message\" data-dojo-attach-point=\"_emptyMessage\">${!i18n.empty_message}</div>\n        </div>\n    </div>\n</div>\n","url:cb/contacts/ContactsTableRow.html":"<tr class=\"contacts-table__row\">\r\n    <td class=\"contacts-table__row__check\" data-dojo-attach-point=\"_checkNode\">\r\n        <input type=\"checkbox\" data-dojo-attach-point=\"_checkBoxNode\"></input>\r\n    </td>\r\n    <td class=\"contacts-table__row__user\" data-dojo-attach-point=\"_userNode\"></td>\r\n    <td class=\"contacts-table__row__relation\" data-dojo-attach-point=\"_relationNode\"></td>\r\n    <td class=\"contacts-table__row__actions\" data-dojo-attach-point=\"_actionsNode\"></td>\r\n</tr>","cb/status":function(){define(["dojo/_base/declare","dojo/_base/lang","dojox/lang/functional","dojo/Stateful","cb/util","./status/editingStatus"],function(_485,lang,_486,_487,_488,_489){var _48a=_485([_487],{getAndWatch:function(attr,_48b){var _48c=this.watch(attr,_48b);_488.defer(_48b,attr,undefined,this.get(attr));return _48c;},mixInto:function(attr,_48d){var _48e=this.get(attr);var _48f=lang.mixin({},(_48e||{}),_48d);this.set(attr,_48f);return _48f;}});return {editingStatus:_489,Util:{create:function create(_490,_491){return _486.foldl(_491,function(_492,_493){return _493(_490,_492)||_492;},new _48a());}}};});},"dijit/form/RadioButton":function(){define(["dojo/_base/declare","./CheckBox","./_RadioButtonMixin"],function(_494,_495,_496){return _494("dijit.form.RadioButton",[_495,_496],{baseClass:"dijitRadio"});});},"cb/widget/UserIconListEntry":function(){define(["dojo","dojo/_base/lang","dojo/dom-prop","dojo/dom-class","dojo/dom-style","dojo/_base/Deferred","dojo/DeferredList","dojo/_base/Color","dijit/_Widget","cb/widget/_TemplatedMixin","sp/infos/InfoManager","./UserDialog","cb/user/UserTags","sp/I18n","dojo/text!./UserIconListEntry.html"],function(dojo,lang,_497,_498,_499,_49a,_49b,_49c,_49d,_49e,_49f,_4a0,_4a1,_4a2,_4a3){function _4a4(_4a5){var ret=new _49a();ret.callback(_4a5);return ret;};return dojo.declare([_49d,_49e],{templateString:_4a3,entry:null,entryDialogConstructor:_4a0,baseClass:"user-icon-list-entry",small:false,includeUserTags:false,postMixInProperties:function(){this.inherited(arguments);if(!this.entry){this.entry={};}if(!this.userid&&this.entry.id){this.userid=this.entry.id;}this.isMyself=this.userid===sp.info.user.info.id;},_setSmallAttr:function(_4a6){dojo.toggleClass(this.domNode,this.baseClass+"-small",_4a6);this._set("small",_4a6);},buildRendering:function(){this.inherited(arguments);this._userTags=new _4a1(null,this._tagsNode);},postCreate:function(){this.inherited(arguments);this.set("includeUserTags",this.get("includeUserTags"));var _4a7=this.entry.user?_4a4(this.entry.user):_49f.getById({type:"user",id:this.userid}).then(function(_4a8){return _4a8.user;});var _4a9=this.entry.company?_4a4(this.entry.company):_49f.getById({type:"companyuser",id:this.userid}).then(function(_4aa){if(!!_4aa.companyuser){return _49f.getById({type:"company",id:_4aa.companyuser.companyId}).then(function(_4ab){return {company:_4ab.company,companyuser:_4aa.companyuser};});}else{return null;}});_49b.gatherResults([_4a7,_4a9]).then(lang.hitch(this,function(_4ac){this.entry=lang.mixin(this.entry||{},{user:_4ac[0],company:_4ac[1]===null?null:_4ac[1].company,companyuser:_4ac[1]===null?null:_4ac[1].companyuser});this.update(this.entry);this._initHoverDialog();}));},_initHoverDialog:function(){if(!this.entry.user){return;}if(this._dialogConnect){return;}if(this.dialog&&!this.dialog.isOpen()){this.dialog.destroy();this.dialog=null;}this._dialogConnect=dojo.map([this._imgNode,this._initialsNode],function(n){return this.connect(n,"click",function(){this._toggleDialog();});},this);},_toggleDialog:function(show){if(!this.dialog){this.dialog=new this.entryDialogConstructor({user:this.entry.user,company:this.entry.company});}if(show||!this.dialog.isOpen()){this.dialog.show(this._imgNode);}else{this.dialog.hide();}},update:function(_4ad){if(!_4ad){return;}if(this._destroyed){return;}var user=_4ad.user;if(!user){return;}if(user.id!==this.userid){console.warn("ParticipantWidget for ",this.userid,"can not be updated with",user);return;}this._userTags.set("userId",user.id);if(this._imgNode&&this._initialsNode&&this._displaynameNode){if(user.hasUserPhoto){_497.set(this._imgNode,"src","/__/photo/"+_4a2.escAttr(user.id)+".png");_498.add(this._initialsNode,"hideBlock");}else{_497.set(this._imgNode,"src","/_/images/userphoto_default_silhouette_small.png");_498.remove(this._initialsNode,"hideBlock");_497.set(this._initialsNode,"innerHTML",_4a2.esc(user.initials));}_497.set(this._displaynameNode,"innerHTML",_4a2.esc(user.displayname));}},_setIncludeUserTagsAttr:function(_4ae){_498.toggle(this._userTags.domNode,"hideBlock",!_4ae);this._set("includeUserTags",_4ae);},updateUserColor:function(_4af){if(this.domNode){_499.set(this.domNode,"borderColor",_4af);}if(this._initialsNode){var _4b0=new _49c(_4af);_4b0.a=0.15;_499.set(this._initialsNode,"backgroundColor",_4b0.toCss(true));}},destroy:function(){if(this._hoverDialogTrigger){this._hoverDialogTrigger.destroy();}this.inherited(arguments);}});});},"cb/widget/DropDownSelectMixin":function(){define(["dojo","dojo/on","dojo/_base/lang","dojo/when","dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/dom-class","dojo/dom-attr","dojox/lang/functional","dijit/Tooltip","sp/dialog/TooltipDialog"],function(dojo,on,lang,when,_4b1,_4b2,_4b3,_4b4,_4b5,_4b6,_4b7,_4b8){var _4b9=_4b2([],{existingTooltip:null,noEntriesLeftHint:null,postCreate:function(){this.inherited(arguments);this.connect(this,"onSearch","_handleEmptyResults");},_onBlur:function(){this.inherited(arguments);if(this.existingTooltip){this.existingTooltip.destroy();}},_handleEmptyResults:function(_4ba,_4bb,_4bc){when(_4ba).then(lang.hitch(this,function(_4bd){if(this.noEntriesLeftHint&&_4bd.length===0){this.set("message",this.noEntriesLeftHint);}}));},displayMessage:function(_4be,_4bf,_4c0){if(this.existingTooltip){this.existingTooltip.destroy();}if(this.focused||_4bf){if(_4be){var _4c1=_4c0?"danger":"light";this.existingTooltip=new _4b8({complexOrient:["below-centered","above-centered"],content:new sp.dialog.DialogContent({templateString:"<div class=\"dialog-content\"><span class=\""+_4c1+"\">"+_4be+"</span></div>",dialog:this,closeLinkText:null}),baseClass:"dropdown-select-message-dialog",invisibleMilk:true,autoHide:4000});dojo.style(this.existingTooltip.domNode,{"width":dojo.getMarginBox(this.domNode).w+"px"});this.existingTooltip.show(this.domNode);return true;}}}});return _4b9;});},"cb/contacts/ContactSelectFilterComboBox":function(){define(["dojo","dojo/on","dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/dom-class","dojo/dom-attr","dojox/lang/functional","dijit/form/FilteringSelect","cb/widget/DropDownSelectMixin","cb/user/ComboBoxMenu","sp/I18n","dojo/i18n!./nls/Contacts"],function(dojo,on,lang,_4c2,_4c3,_4c4,_4c5,_4c6,_4c7,_4c8,_4c9,_4ca,_4cb,i18n){var I18N=_4cb.wrap(i18n);var _4cc=_4c3([_4c8,_4c9],{noEntriesLeftHint:I18N("no_contacts_left_to_select"),dropDownClass:_4ca});return _4cc;});},"cb/personalcontainer/container/UploadBox":function(){define(["dojo/_base/declare","dojo/dom-construct","dijit/_Widget","cb/widget/CreateBoard"],function(_4cd,_4ce,_4cf,_4d0){return _4cd([_4cf],{baseClass:"upload-container",postCreate:function(){this.inherited(arguments);new _4d0({fullWidth:true,callToAction:false},_4ce.create("span",null,this.domNode));}});});},"dojo/dnd/autoscroll":function(){define(["../_base/lang","../sniff","../_base/window","../dom-geometry","../dom-style","../window"],function(lang,has,win,_4d1,_4d2,_4d3){var _4d4={};lang.setObject("dojo.dnd.autoscroll",_4d4);_4d4.getViewport=_4d3.getBox;_4d4.V_TRIGGER_AUTOSCROLL=32;_4d4.H_TRIGGER_AUTOSCROLL=32;_4d4.V_AUTOSCROLL_VALUE=16;_4d4.H_AUTOSCROLL_VALUE=16;var _4d5,doc=win.doc,_4d6=Infinity,_4d7=Infinity;_4d4.autoScrollStart=function(d){doc=d;_4d5=_4d3.getBox(doc);var html=win.body(doc).parentNode;_4d6=Math.max(html.scrollHeight-_4d5.h,0);_4d7=Math.max(html.scrollWidth-_4d5.w,0);};_4d4.autoScroll=function(e){var v=_4d5||_4d3.getBox(doc),html=win.body(doc).parentNode,dx=0,dy=0;if(e.clientX<_4d4.H_TRIGGER_AUTOSCROLL){dx=-_4d4.H_AUTOSCROLL_VALUE;}else{if(e.clientX>v.w-_4d4.H_TRIGGER_AUTOSCROLL){dx=Math.min(_4d4.H_AUTOSCROLL_VALUE,_4d7-html.scrollLeft);}}if(e.clientY<_4d4.V_TRIGGER_AUTOSCROLL){dy=-_4d4.V_AUTOSCROLL_VALUE;}else{if(e.clientY>v.h-_4d4.V_TRIGGER_AUTOSCROLL){dy=Math.min(_4d4.V_AUTOSCROLL_VALUE,_4d6-html.scrollTop);}}window.scrollBy(dx,dy);};_4d4._validNodes={"div":1,"p":1,"td":1};_4d4._validOverflow={"auto":1,"scroll":1};_4d4.autoScrollNodes=function(e){var b,t,w,h,rx,ry,dx=0,dy=0,_4d8,_4d9;for(var n=e.target;n;){if(n.nodeType==1&&(n.tagName.toLowerCase() in _4d4._validNodes)){var s=_4d2.getComputedStyle(n),_4da=(s.overflow.toLowerCase() in _4d4._validOverflow),_4db=(s.overflowX.toLowerCase() in _4d4._validOverflow),_4dc=(s.overflowY.toLowerCase() in _4d4._validOverflow);if(_4da||_4db||_4dc){b=_4d1.getContentBox(n,s);t=_4d1.position(n,true);}if(_4da||_4db){w=Math.min(_4d4.H_TRIGGER_AUTOSCROLL,b.w/2);rx=e.pageX-t.x;if(has("webkit")||has("opera")){rx+=win.body().scrollLeft;}dx=0;if(rx>0&&rx<b.w){if(rx<w){dx=-w;}else{if(rx>b.w-w){dx=w;}}_4d8=n.scrollLeft;n.scrollLeft=n.scrollLeft+dx;}}if(_4da||_4dc){h=Math.min(_4d4.V_TRIGGER_AUTOSCROLL,b.h/2);ry=e.pageY-t.y;if(has("webkit")||has("opera")){ry+=win.body().scrollTop;}dy=0;if(ry>0&&ry<b.h){if(ry<h){dy=-h;}else{if(ry>b.h-h){dy=h;}}_4d9=n.scrollTop;n.scrollTop=n.scrollTop+dy;}}if(dx||dy){return;}}try{n=n.parentNode;}catch(x){n=null;}}_4d4.autoScroll(e);};return _4d4;});},"dijit/form/_RadioButtonMixin":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/dom-attr","dojo/_base/event","dojo/_base/lang","dojo/query","../registry"],function(_4dd,_4de,_4df,_4e0,lang,_4e1,_4e2){return _4de("dijit.form._RadioButtonMixin",null,{type:"radio",_getRelatedWidgets:function(){var ary=[];_4e1("input[type=radio]",this.focusNode.form||this.ownerDocument).forEach(lang.hitch(this,function(_4e3){if(_4e3.name==this.name&&_4e3.form==this.focusNode.form){var _4e4=_4e2.getEnclosingWidget(_4e3);if(_4e4){ary.push(_4e4);}}}));return ary;},_setCheckedAttr:function(_4e5){this.inherited(arguments);if(!this._created){return;}if(_4e5){_4dd.forEach(this._getRelatedWidgets(),lang.hitch(this,function(_4e6){if(_4e6!=this&&_4e6.checked){_4e6.set("checked",false);}}));}},_getSubmitValue:function(_4e7){return _4e7===null?"on":_4e7;},_onClick:function(e){if(this.checked||this.disabled){_4e0.stop(e);return false;}if(this.readOnly){_4e0.stop(e);_4dd.forEach(this._getRelatedWidgets(),lang.hitch(this,function(_4e8){_4df.set(this.focusNode||this.domNode,"checked",_4e8.checked);}));return false;}return this.inherited(arguments);}});});},"sp/EmailComboBox":function(){define(["dijit","dojo","dojox","dojo/require!dijit/form/ComboBox,dojox/data/AndOrReadStore,dojo/store/Memory,cb/api/Api,cb/widget/DropDownSelectMixin,dojo/promise/all,cb/user/ComboBoxMenu"],function(_4e9,dojo,_4ea){dojo.provide("sp.EmailComboBox");dojo.require("dijit.form.ComboBox");dojo.require("dojox.data.AndOrReadStore");dojo.require("dojo.store.Memory");dojo.require("cb.api.Api");dojo.require("cb.widget.DropDownSelectMixin");dojo.require("dojo.promise.all");dojo.require("cb.user.ComboBoxMenu");dojo.declare("sp.EmailComboBox",[_4e9.form.ComboBox,cb.widget.DropDownSelectMixin],{searchAttr:"search",queryExpr:"*${0}*",hasDownArrow:true,name:"to",noEntriesLeftHint:null,dropDownClass:cb.user.ComboBoxMenu,emailAddressesContainerNode:null,autoComplete:false,promptMessage:"",constructor:function(){this.fetchProperties={sort:[{attribute:"sortKey"},{attribute:"display"},{attribute:"search"}]};this.value={type:"email",value:""};this.query={visible:true};cb.api.Api.Caching.contacts.get().then(dojo.hitch(this,function(_4eb){return dojo.promise.all(dojo.map(_4eb.data,function(_4ec){if(_4ec.userId){if(_4ec.userId===sp.info.user.id){return null;}return sp.infos.getInstance().getById({type:"user",id:_4ec.userId}).then(function(_4ed){return {contact:_4ec,user:_4ed.user};});}else{return {contact:_4ec,user:null};}})).then(function(_4ee){return dojo.map(_4ee,function(_4ef){if(!_4ef){return null;}var _4f0=_4ef.contact.emailAdresses.mostUsableEmailAddress;var _4f1=_4ef.user?_4ef.user.displayname:_4ef.contact.displayname;var _4f2=_4f0?(_4f0+" - "+_4f1):_4f1;var _4f3=_4f1;var _4f4=_4f1?_4f1.toLocaleLowerCase():(_4f0?_4f0.toLocaleLowerCase():_4f2);return {id:_4ef.contact.contactId,contactId:_4ef.contact.contactId,contactType:_4ef.contact.contactType,userId:_4ef.contact.userId,display:_4f3,search:_4f2,contact:_4ef.contact,user:_4ef.user,email:_4f0,visible:true,sortKey:_4f4};});}).then(dojo.hitch(this,function(_4f5){var _4f6=new dojo.store.Memory();dojo.forEach(_4f5,function(_4f7){if(_4f7){_4f6.put(_4f7);}});this.set("store",_4f6);})).otherwise(function(_4f8){});}));},postCreate:function(){this.inherited("postCreate",arguments);if(this.autofocus){dojo.addClass(this.textbox,"js-focus");}if(dojo.isIE<9){dojo.style(this.textbox,"fontFamily",null);}dojo.attr(this.textbox,"name",this.id+"_textbox");this.connect(this,"_selectOption",this._updateValue);this.connect(this,"_onBlur",this._updateValue);this.connect(this,"onKeyPress",function(_4f9){if(_4f9.charOrCode===dojo.keys.TAB){var _4fa=!this.get("value");this._updateValue();if(!_4fa){dojo.stopEvent(_4f9);}}});if(!dojo.isIE){dojo.query("input[type=text]",this.domNode).attr("type","email");}},_updateValue:function(){if(this.get("item")){sp.global.analytics.trackEvent("contactsDropdown","knownContactChosen");}else{sp.global.analytics.trackEvent("contactsDropdown","newEmailEntered");}this.set("value",this.get("value"),null,null,this.get("item"));},removeValueFromCandidates:function(v){if(v.type==="contact"){var oldV=this.store.get(v.value);if(oldV){var newV=dojo.delegate(oldV);newV.visible=false;this.store.put(newV);}}},addValueToCandidates:function(v){if(v.type==="contact"){var oldV=this.store.get(v.value);if(oldV){var newV=dojo.delegate(oldV);newV.visible=true;this.store.put(newV);}}},format:function(_4fb){if(_4fb.type==="email"){return _4fb.value;}else{if(_4fb.type==="contact"){return this.store.get(_4fb.value).display;}else{return _4fb;}}},_getValueAttr:function(){var item=this.get("item");if(item){return {type:"contact",value:item.contactId,valueType:item.contactType};}else{if(this.get("displayedValue")){return {type:"email",value:this.get("displayedValue")};}else{return null;}}},_updatePlaceHolder:function(){this.inherited(arguments);if(this._phspan&&this._phspan.style.display==="none"){dojo.attr(this.textbox,"placeholder",this.get("placeHolder"));}else{dojo.attr(this.textbox,"placeholder","");}},_onKeyUp:function(){}});});},"dojo/store/Observable":function(){define(["../_base/kernel","../_base/lang","../_base/Deferred","../_base/array"],function(_4fc,lang,_4fd,_4fe){var _4ff=function(_500){var _501,_502=[],_503=0;_500=lang.delegate(_500);_500.notify=function(_504,_505){_503++;var _506=_502.slice();for(var i=0,l=_506.length;i<l;i++){_506[i](_504,_505);}};var _507=_500.query;_500.query=function(_508,_509){_509=_509||{};var _50a=_507.apply(this,arguments);if(_50a&&_50a.forEach){var _50b=lang.mixin({},_509);delete _50b.start;delete _50b.count;var _50c=_500.queryEngine&&_500.queryEngine(_508,_50b);var _50d=_503;var _50e=[],_50f;_50a.observe=function(_510,_511){if(_50e.push(_510)==1){_502.push(_50f=function(_512,_513){_4fd.when(_50a,function(_514){var _515=_514.length!=_509.count;var i,l,_510;if(++_50d!=_503){throw new Error("Query is out of date, you must observe() the query prior to any data modifications");}var _516,_517=-1,_518=-1;if(_513!==_501){for(i=0,l=_514.length;i<l;i++){var _519=_514[i];if(_500.getIdentity(_519)==_513){_516=_519;_517=i;if(_50c||!_512){_514.splice(i,1);}break;}}}if(_50c){if(_512&&(_50c.matches?_50c.matches(_512):_50c([_512]).length)){var _51a=_517>-1?_517:_514.length;_514.splice(_51a,0,_512);_518=_4fe.indexOf(_50c(_514),_512);_514.splice(_51a,1);if((_509.start&&_518==0)||(!_515&&_518==_514.length)){_518=-1;}else{_514.splice(_518,0,_512);}}}else{if(_512){if(_513!==_501){_518=_517;}else{if(!_509.start){_518=_500.defaultIndex||0;_514.splice(_518,0,_512);}}}}if((_517>-1||_518>-1)&&(_511||!_50c||(_517!=_518))){var _51b=_50e.slice();for(i=0;_510=_51b[i];i++){_510(_512||_516,_517,_518);}}});});}var _51c={};_51c.remove=_51c.cancel=function(){var _51d=_4fe.indexOf(_50e,_510);if(_51d>-1){_50e.splice(_51d,1);if(!_50e.length){_502.splice(_4fe.indexOf(_502,_50f),1);}}};return _51c;};}return _50a;};var _51e;function _51f(_520,_521){var _522=_500[_520];if(_522){_500[_520]=function(_523){if(_51e){return _522.apply(this,arguments);}_51e=true;try{var _524=_522.apply(this,arguments);_4fd.when(_524,function(_525){_521((typeof _525=="object"&&_525)||_523);});return _524;}finally{_51e=false;}};}};_51f("put",function(_526){_500.notify(_526,_500.getIdentity(_526));});_51f("add",function(_527){_500.notify(_527);});_51f("remove",function(id){_500.notify(undefined,id);});return _500;};lang.setObject("dojo.store.Observable",_4ff);return _4ff;});},"dojo/dnd/TimedMoveable":function(){define(["../_base/declare","./Moveable"],function(_528,_529){var _52a=_529.prototype.onMove;return _528("dojo.dnd.TimedMoveable",_529,{timeout:40,constructor:function(node,_52b){if(!_52b){_52b={};}if(_52b.timeout&&typeof _52b.timeout=="number"&&_52b.timeout>=0){this.timeout=_52b.timeout;}},onMoveStop:function(_52c){if(_52c._timer){clearTimeout(_52c._timer);_52a.call(this,_52c,_52c._leftTop);}_529.prototype.onMoveStop.apply(this,arguments);},onMove:function(_52d,_52e){_52d._leftTop=_52e;if(!_52d._timer){var _52f=this;_52d._timer=setTimeout(function(){_52d._timer=null;_52a.call(_52f,_52d,_52d._leftTop);},this.timeout);}}});});},"cb/contacts/ContactListWidget":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/on","dojo/dom-construct","dojo/dom-class","cb/user/UserDisplay","cb/api/Api","cb/util","dijit/_Widget","dijit/_Container","dojox/validate/regexp","sp/I18n","dojo/i18n!./nls/Contacts"],function(_530,lang,_531,on,_532,_533,_534,Api,util,_535,_536,_537,_538,i18n){var I18N=_538.wrap(i18n);var _539=_530([_535],{bemBaseClass:"contact-list-entry",buildRendering:function(){this.inherited(arguments);_533.add(this.domNode,this.bemBaseClass);this._userDisplay=new _534({size:"small"},_532.create("div",null,this.domNode));this._removeNode=_532.create("span",{"class":this.bemBaseClass+"__remove",innerHTML:"x"},this.domNode);this.own(on(this._removeNode,"click",lang.hitch(this,function(){this.getParent().removeValue(this.get("value"));})));},highlight:function(_53a){var self=this;if(self.get("highlighted")){return;}self.set("highlighted",true);util.delay(_53a||1000,function(){self.set("highlighted",false);});},_setHighlightedAttr:function(v){_533.toggle(this.domNode,this.bemBaseClass+"--highlighted",!!v);this._set("highlighted",v);},_setValueAttr:function(_53b){if(_53b.type==="email"){this._userDisplay.set({displayname:_53b.value,emailAdresses:{unconfirmedEmailAdress:_53b.value}});}else{if(_53b.type==="contact"){this._userDisplay.set({contactIdentifier:{id:_53b.value,type:_53b.valueType}});}else{this._userDisplay.set({contactIdentifier:null,displayname:null,emailAdresses:null});}}this._set("value",_53b);}});function _53c(left,_53d){return left.type===_53d.type&&left.value===_53d.value&&left.valueType===_53d.valueType;};function _53e(_53f,_540){return _531.some(_53f,function(v){return _53c(v,_540);});};var _541=(function(_542){return function _541(_543){return _542.test(_543);};})(new RegExp(_537.emailAddress({allowPort:false})));function _544(_545){if(!_545){return false;}else{if(_545.type==="email"){return _541(_545.value);}else{return true;}}};return _530([_535,_536],{bemBaseClass:"contact-list",value:null,valueWidgets:null,constructor:function(){this.value=[];this.valueWidgets=[];},buildRendering:function(){this.inherited(arguments);_533.add(this.domNode,this.bemBaseClass);},_setConnectedWidgetAttr:function(w){this.own(w.watch("value",lang.hitch(this,this._handleConnectedValueChange)));this._set("connectedWidget",w);},_handleConnectedValueChange:util.wrapDefer(function(attr,_546,_547){if(!_547){return;}else{if(lang.isString(_547)){return;}else{if(!_547.value){return;}else{if(_53c(_546,_547)){return;}else{this.addValue(_547);}}}}}),highlight:function(v){_531.forEach(this.findChildrenForValue(v),function(_548){_548.highlight();});},addValue:function(v){if(_544(v)){if(_53e(this.value,v)){this.highlight(v);}else{this.addEntryForValue(v);this.onNewValue(v);this.set("value",[].concat(this.value,v));}if(_53c(v,this.connectedWidget.get("value"))){this.connectedWidget.set("value",null);if(this.connectedWidget.removeValueFromCandidates){this.connectedWidget.removeValueFromCandidates(v);}}}else{this.connectedWidget.displayMessage(I18N("invalid_email"),true,true);this.onInvalidValue(v);}},removeValue:function(v){_531.forEach(this.findChildrenForValue(v),function(_549){this.removeChild(_549);},this);if(this.connectedWidget.addValueToCandidates){this.connectedWidget.addValueToCandidates(v);}this.onRemovedValue(v);this.set("value",_531.filter(this.get("value"),function(_54a){return !_53c(_54a,v);}));},onNewValue:function(_54b){},onRemovedValue:function(_54c){},onInvalidValue:function(_54d){},addEntryForValue:function(_54e){if(_54e.type==="email"||_54e.type==="contact"){this.addChild(new _539({value:_54e}));}},findChildrenForValue:function(v){return _531.filter(this.getChildren(),function(_54f){return _53c(_54f.get("value"),v);});}});});},"sp/dialog/NewBoardDialog":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/on","dojo/when","dojo/topic","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/keys","dijit/focus","sp/dialog/TooltipDialog","sp/dialog/DialogContent","sp/ajax/AjaxEngine","sp/infos/InfoManager","cb/widget/UpgradeButton","sp/I18n","cb/Capabilities","cb/widget/PortfolioSelect","dojo/i18n!./nls/NewBoardDialog","dojo/text!./NewBoardDialog.html","cb/widget/BigSwitch"],function(_550,lang,on,when,_551,_552,_553,_554,keys,_555,_556,_557,_558,_559,_55a,_55b,_55c,_55d,i18n,_55e){var _55f=_550([_557],{i18n:i18n,portfolioId:null,templateString:_55e,widgetsInTemplate:true,newDocumentTitle:null,passphraseActive:false,postMixInProperties:function(){this.inherited(arguments);this.couldSetPassphraseIfPro=!(sp.info.pageBrandCompany||sp.info.company)&&!sp.info.user.info.accountType.hasPassphrase;if(sp.info.user.info.accountType.asString==="basic"){this.projectsLabel=_55b.wrap(i18n)("create_project_label_basic");this.passphraseLabel=_55b.wrap(i18n)("passphrase_label_basic");}else{this.projectsLabel=_55b.wrap(i18n)("create_project_label");this.passphraseLabel=_55b.wrap(i18n)("passphrase_label");}},postCreate:function(){this.inherited(arguments);this.kepressListener=on(window.document,"keypress",dojo.hitch(this,function(e){if(e.which===keys.ENTER){this._handleCreateButtonClick();}}));this._showBasicOrProContent();},_handleSelectWidgetChange:function(_560){this._togglePassphrase(_560.type==="option"&&_560.value==="default_selection");},_togglePassphrase:function(_561){if(_561){_553.remove(this._passphraseContainer,"disabled");this._passphraseSwitch.set("disabled",false);}else{_553.add(this._passphraseContainer,"disabled");this.passphraseActive=false;_553.add(this._passphraseInput,"hideBlock");this._passphraseSwitch.set("disabled",true);this._passphraseSwitch.set("checked",false);}},_handleCloseButtonClick:function(){this.dialog.hide();},_handleCreateButtonClick:function(){window.setTimeout(dojo.hitch(this,function(){this._showActivityIndicator();}),1);var _562=null,_563=null;if(this.projectSelectWidget){var _564=this.projectSelectWidget.get("value");if(_564.type==="option"){if(_564.value==="default_selection"){_563=null;_562=null;}else{_563=_564.value;_562=null;}}else{if(_564.type==="new"){_563=null;_562=_564.value;}}}this._createBoard({portfolioId:_563,portfolioTitle:_562,documentTitle:_552.get(this._nameInput,"value")}).then(dojo.hitch(this,function(_565){var _566=_552.get(this._passphraseInput,"value");if(_566!==""&&this.passphraseActive){return _558.changePortfolioAccessControl({portfolioId:_565.portfolioId,token:_566}).then(function(_567){return _565;});}else{return _565;}})).then(dojo.hitch(this,this.onCreateSuccess),dojo.hitch(this,this.onCreateError)).always(dojo.hitch(this,this._cleanup));},_handlePassphraseSwitchChange:function(){if(!this._passphraseSwitch.disabled){this.passphraseActive=(!this.passphraseActive);_553.toggle(this._passphraseInput,"hideBlock",!this.passphraseActive);_555.focus(this._passphraseInput);}},_showActivityIndicator:function(){_553.toggle(this._documentCreateForm,"hideBlock",true);_553.toggle(this._documentCreateIndicator,"hideBlock",false);},onCreateSuccess:function(_568){window.location=_568.location;},onCreateError:function(_569){this.dialog.hide();},_createBoard:function(args){return when(this.get("invitationTo")).then(function(_56a){return _558.createDocument({portfolioId:args.portfolioId,documentTitle:args.documentTitle,portfolioTitle:args.portfolioTitle,invitationTo:_56a});}).then(lang.hitch(this,function(_56b){this._cleanup(_56b);return _56b;}));},_getInvitationToAttr:function(){return this.dialog.get("invitationTo");},_cleanup:function(_56c){if(_56c){window.setTimeout(lang.hitch(this,function(){if(_56c.documentId){_559.invalidateById({type:"document",id:_56c.documentId});}if(_56c.portfolioId){_559.invalidateById({type:"portfolio",id:_56c.portfolioId});}_559.invalidateById({type:"portfolios",id:sp.info.user.info.id});}),1);}return _56c;},_showBasicOrProContent:function(){_55c.checkPassphrase().then(dojo.hitch(this,function(_56d){if(_56d==="premium"){this._passphraseSwitch.set("disabled",true);_553.add(this._passphraseSwitch.titleNode,"hideBlock");_553.add(this._passphraseTooltip_connect,"hideBlock");_553.add(this._passphraseInput,"hideBlock");_55c.checkFeature("registration.selfsignup").then(function(_56e){return _56e==="enabled";}).then(dojo.hitch(this,function(_56f){if(_56f){var _570=new _55a({upgradeDialogContent:"security"},_554.create("span",null,this._passphraseInput,"after"));}}));}}));_55c.checkPortfolios().then(dojo.hitch(this,function(_571){if(_571==="premium"){_55c.checkFeature("registration.selfsignup").then(function(_572){return _572==="enabled";}).then(dojo.hitch(this,function(_573){if(_573){var _574=new _55a({upgradeDialogContent:"projects"},_554.create("span",null,this._projectSelectContainer,"first"));}}));}else{this.projectSelectWidget=new _55d({portfolioId:this.portfolioId,tabindex:20,createNewItemOption:true},this._projectSelectContainer);this.changeListener=this.own(on(this.projectSelectWidget,"change",dojo.hitch(this,this._handleSelectWidgetChange)));this._handleSelectWidgetChange(this.projectSelectWidget.get("value"));}}));}});return _550([_556],{complexOrient:["after-centered","before-centered","below-centered","above-centered","before","after"],baseClass:"create-new-board-dialog with-title",portfolioId:null,autofocus:true,postCreate:function(){this.inherited(arguments);this.content=new _55f({dialog:this,portfolioId:this.portfolioId,postCreate:function(){this.inherited("postCreate",arguments);this._passphraseTooltip.set("connectId",[this._passphraseTooltip_connect]);}});},onHide:function(){this.content.kepressListener.remove();},_getInvitationToAttr:function(){return null;}});});},"cb/widget/EmailTooltip":function(){define(["dojo/_base/lang","dojo/_base/declare","dojo/_base/array","cb/widget/_TemplatedMixin","sp/Tooltip","sp/I18n","cb/util","dojo/i18n!./nls/EmailTooltip","dojo/text!./EmailTooltip.html"],function(lang,_575,_576,_577,_578,_579,_57a,i18n,_57b){var I18N=_579.wrap(i18n);return _575([_578,_577],{templateString:_57b,i18n:i18n,additionalI18n:null,subject_i18n:null,body_i18n:null,to_fallback:I18N("email_tooltip_to_default"),from_fallback:I18N("email_tooltip_from_default"),subject_fallback:"",body_fallback:"",companyname:sp.info.company?sp.info.company.name:null,postMixInProperties:function(){this.inherited(arguments);this._templateVarNames={};this._updateContentDebounced=_57a.debounce(lang.hitch(this,this._updateContent),50);this._updateDisplayDebounced=_57a.debounce(lang.hitch(this,this._updateDisplay),50);this.i18n=lang.mixin({},i18n,this.i18n||{});this._i18n=_579.wrap(this.i18n);},buildRendering:function(){this.inherited(arguments);this.own(_576.map(["to","from","subject","body","to_i18n","from_i18n","subject_i18n","body_i18n"],function(attr){return this.watch(attr,this._updateContentDebounced);},this));this.own(this.watch(lang.hitch(function(attr){if(this._templateVarNames.hasOwnProperty(attr)){this._updateContentDebounced();}})));},postCreate:function(){this.inherited(arguments);this.own(this.watch(lang.hitch(function(attr,_57c,_57d){if(/^.+_i18n$/.test(attr)){this._addTemplateVarNamesFromString(this.i18n[_57d]);}})));this._addTemplateVarNamesFromString(this.i18n[this.subject_i18n||"____"]);this._addTemplateVarNamesFromString(this.i18n[this.body_i18n||"____"]);this._updateContent();},_updateContent:function(){this._set("to",(this.to_i18n?this._i18n(this.to_i18n,this):_579.esc(this.get("to"))||""));this._set("from",(this.from_i18n?this._i18n(this.from_i18n,this):_579.esc(this.get("from"))||""));this._set("subject",(this.subject_i18n?this._i18n(this.subject_i18n,this):_579.esc(this.get("subject"))||""));this._set("body",(this.body_i18n?this._i18n(this.body_i18n,this):_579.esc(this.get("body"))||""));this._updateDisplayDebounced();},_updateDisplay:function(node,_57e,_57f){this._toNode.innerHTML=this.get("to")||this.get("to_fallback");this._fromNode.innerHTML=this.get("from")||this.get("from_fallback");this._subjectNode.innerHTML=this.get("subject")||this.get("subject_fallback");this._bodyNode.innerHTML=this.get("body")||this.get("body_fallback");},_addTemplateVarNamesFromString:function(s){if(!s){return;}var _580=/\$\{([^}]+)\}/g;var _581;while((_581=_580.exec(s))!==null){this._templateVarNames[_581[1]]=true;}}});});},"cb/ext/sjcl":function(){define(["./sjcl/sjcl"],function(sjcl){return sjcl;});},"dijit/form/_ListMouseMixin":function(){define(["dojo/_base/declare","dojo/mouse","dojo/on","dojo/touch","./_ListBase"],function(_582,_583,on,_584,_585){return _582("dijit.form._ListMouseMixin",_585,{postCreate:function(){this.inherited(arguments);this.own(on(this.domNode,_584.press,function(evt){evt.preventDefault();}));this._listConnect(_584.press,"_onMouseDown");this._listConnect(_584.release,"_onMouseUp");this._listConnect(_583.enter,"_onMouseOver");this._listConnect(_583.leave,"_onMouseOut");},_onMouseDown:function(evt,_586){if(this._hoveredNode){this.onUnhover(this._hoveredNode);this._hoveredNode=null;}this._isDragging=true;this._setSelectedAttr(_586);},_onMouseUp:function(evt,_587){this._isDragging=false;var _588=this.selected;var _589=this._hoveredNode;if(_588&&_587==_588){this.onClick(_588);}else{if(_589&&_587==_589){this._setSelectedAttr(_589);this.onClick(_589);}}},_onMouseOut:function(evt,_58a){if(this._hoveredNode){this.onUnhover(this._hoveredNode);this._hoveredNode=null;}if(this._isDragging){this._cancelDrag=(new Date()).getTime()+1000;}},_onMouseOver:function(evt,_58b){if(this._cancelDrag){var time=(new Date()).getTime();if(time>this._cancelDrag){this._isDragging=false;}this._cancelDrag=null;}this._hoveredNode=_58b;this.onHover(_58b);if(this._isDragging){this._setSelectedAttr(_58b);}}});});},"cb/api/Api":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/Stateful","dojo/when","dojo/date/stamp","./ApiEngine","./Validate","./Types","cb/util","cb/util-url","dojo/promise/all"],function(lang,_58c,_58d,when,_58e,_58f,_590,_591,util,_592,_593){function _594(_595){return util.asPromise(function(){if(_58c.every(arguments,_595)){return true;}else{var err=new _591.ClientCbApiError(new Error("invalid argument"));err.args=arguments;err.checkFnName=_595.name;throw err;}});};var _596=_594(function _596(arg){return arg!==undefined&&arg!==null&&lang.isString(arg)&&arg.length>0;});var _597=_594(function _597(arg){return arg!==undefined&&arg!==null&&lang.isObject(arg);});var _598=_594(function _598(arg){return arg!==undefined&&arg!==null&&lang.isArray(arg);});var _599=_592.addParamToUrl;function _59a(date){if(lang.isString(date)){return date;}return _58e.toISOString(date);};function _59b(url,_59c){if(!url||!_59c){return url;}if(_59c.hasOwnProperty("pagesize")){url=_599(url,"pagesize",_59c.pagesize);}if(_59c.hasOwnProperty("timelimit")){url=_599(url,"timelimit",_59a(_59c.timelimit));}if(_59c.hasOwnProperty("timeoffset")){url=_599(url,"timeoffset",_59a(_59c.timeoffset));}return url;};function _59d(_59e){return {rest:{get:function(url){return _59e.get(url);}},restApi:{get:function(url){return _59e.get("/api/v0_1"+url);}},contacts:{get:function(){return _59e.get("/api/v0_1/contacts");},post:function(_59f){return _597(_59f).then(function(){return _59e.post("/api/v0_1/contacts",{data:_59f});});},delContact:function(_5a0,_5a1){return _596(_5a0,_5a1).then(function(){return _59e.del("/api/v0_1/contacts/"+_5a0+"/"+_5a1);});},getContact:function(_5a2,_5a3){return _596(_5a2,_5a3).then(function(){return _59e.get("/api/v0_1/contacts/"+_5a2+"/"+_5a3);});}},referrals:{get:function(){return _59e.get("/api/v0_1/referrals");}},users_me_announcements:{get:function(){var url="/api/v0_1/users/"+sp.info.user.id+"/announcements";return _59e.get(url);}},users_me_alertslastreadat:{get:function(){var url="/api/v0_1/users/"+sp.info.user.id+"/lastalertsreadat";return _59e.get(url);},post:function(date){return _597(date).then(function(){return _59e.post("/api/v0_1/users/"+sp.info.user.id+"/alertslastreadat",{data:{alertslastreadat:_58e.toISOString(date)}});});}},users_me_notifications:{get:function(_5a4){var url="/api/v0_1/users/"+sp.info.user.id+"/notifications?";url=_59b(url,_5a4);if(_5a4&&_5a4.documentid){url=_599(url,"documentid",_5a4.documentid);}return _59e.get(url);}},users_me_features:{get:function(_5a5){var _5a6=lang.isArray(_5a5)?_5a5:[_5a5];var url="/api/v0_1/users/"+sp.info.user.id+"/features/";url=url+_5a6.join(",");return _59e.get(url);}},users_me_statistics:{get:function(){var url="/api/v0_1/users/"+sp.info.user.id+"/statistics";return _59e.get(url);}},users_me_flags:{get:function(){var url="/api/v0_1/users/"+sp.info.user.id+"/flags";return _59e.get(url);},post:function(flag){return _596(flag).then(function(){var url="/api/v0_1/users/"+sp.info.user.id+"/flags/"+flag;return _59e.post(url);});},del:function(flag){return _596(flag).then(function(){var url="/api/v0_1/users/"+sp.info.user.id+"/flags/"+flag;return _59e.del(url);});}},users_me_ext_googledrive_folders:{get:function(){var url="/api/v0_1/users/"+sp.info.user.id+"/ext/googledrive/folders";return _59e.get(url);}},newsflashs:{getNewsflash:function(id){return _596(id).then(function(){return _59e.get("/api/v0_1/newsflashs/"+id);});}},documentinvitations:{post:function(_5a7){return _597(_5a7).then(function(){return _59e.post("/api/v0_1/documentinvitations",{data:_5a7});});}},document_ext_googledrive_connections:{getByDocumentid:function(_5a8){return _596(_5a8).then(function(){return _59e.get("/api/v0_1/documents/"+_5a8+"/ext/googledrive/connections");});}},companyjoinrequests:{get:function(_5a9){return _597(_5a9).then(function(){return _59e.get("/api/v0_1/companyjoinrequests",{query:_5a9});});},post:function(data){return _597(data).then(function(){return _59e.post("/api/v0_1/companyjoinrequests",{data:data});});},del:function(_5aa){return _596(_5aa).then(function(){return _59e.del("/api/v0_1/companyjoinrequests/"+_5aa);});}},licenses:{getById:function(id){return _596(id).then(function(){return _59e.get("/api/v0_1/licenses/"+id);});}},announcements:{get:function(){return _59e.get("/api/v0_1/announcements");}},userbannerstatus:{getById:function(id){return _596(id).then(function(){return _59e.get("/api/v0_1/userbannerstatus/"+id);});},deleteByIdAndBannerId:function(id,_5ab){return _596(id,_5ab).then(function(){return _59e.del("/api/v0_1/userbannerstatus/"+id+"/"+_5ab);});}},hashtags:{trello:{get:function(){return _59e.get("/api/v0_1/hashtags/trello/");}},get:function(){return _59e.get("/api/v0_1/hashtags/");},getByDocumentIdAndCommentIdAndEntryIdAndTagIds:function(_5ac,_5ad,_5ae,_5af){if(!lang.isArray(_5af)){_5af=[_5af];}return _593([_596(_5ac),_596(_5ad),_596(_5ae),_598(_5af)]).then(function(){return _59e.get("/api/v0_1/hashtags/"+[_5ac,_5ad,_5ae].join("/"),{query:{hashtagids:_5af.join(",")}});});}},Validate:_590,Util:{data:function data(_5b0){return when(_5b0).then(function(_5b1){return _5b1.data;});},consumeAndPage:(function(){function _5b2(Api,_5b3,_5b4,_5b5){var acc,goOn,prev;acc=_5b5||[];acc.push(_5b3);goOn=_5b4(_5b3);prev=goOn&&Api.Util.prevPage(Api,_5b3);if(prev){return prev.then(function(_5b6){return _5b2(Api,_5b6,_5b4,acc);});}else{return when(acc);}};return function(Api,_5b7,_5b8){var acc=[],_5b9=_5b8||function(){return true;};return _5b7.then(function(_5ba){return _5b2(Api,_5ba,_5b9,acc);});};})(),prevPage:function prevPage(Api,_5bb){var prev=_5bb.meta.headers["X-CB-Paging-Prev"];if(prev){return Api.rest.get(prev);}else{return null;}},hasPrev:function hasPrev(_5bc){return _5bc&&_5bc.meta.headers["X-CB-Paging-Prev"];}}};};var ret=_58f.mapApiFunctions(_59d(_58f),_58f.wrapResponsePromise);var _5bd=new _58d();ret.Caching=_58f.mapApiFunctions(_59d(_58f.makeCachingApiEngine(_58f,_5bd)),_58f.wrapResponsePromise);ret.Invalidate=_59d(_58f.makeInvalidatingApiEngine(_58f,_5bd));ret.Listen=_59d(_58f.makeListeningApiEngine(_58f,_5bd));ret._cache=_5bd;return ret;});},"cb/widget/PortfolioSelect":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/on","dojo/aspect","dojo/_base/array","dojo/_base/Deferred","dojo/promise/all","dojo/dom-construct","dojo/dom-class","dojo/dom-attr","dojo/store/Memory","dojo/store/Observable","dijit/_Widget","dijit/form/Select","dijit/form/TextBox","sp/I18n","sp/ajax/AjaxEngine","sp/infos/InfoManager","cb/util","dojo/i18n!./nls/PortfolioSelect","dojo/text!./PortfolioSelect_CancellableInput.html"],function(_5be,lang,on,_5bf,_5c0,_5c1,_5c2,_5c3,_5c4,_5c5,_5c6,_5c7,_5c8,_5c9,_5ca,_5cb,_5cc,_5cd,_5ce,i18n,_5cf){var _5d0=_5be([_5c9],{labelAttr:"name",sortByLabel:false,postMixInProperties:function(){this.inherited(arguments);if(!this.store){this.store=_5c7(new _5c6());}},buildRendering:function(){this.inherited(arguments);_5c4.add(this.dropDown.domNode,"portfolio-select__select__menu");}});var _5d1=_5be([_5ca],{templateString:_5cf,baseClass:"cancellable-input",cancelled:false,_handleCancelClick:function(e){dojo.stopEvent(e);this._cancel();},_cancel:function(){this.set("cancelled",true);this.set("value","");this.onCancel();},onCancel:function(){}});return _5be([_5c8],{store:null,portfolioId:"default_selection",maxHeight:-1,createNewItemOption:false,removeFromProjectOption:false,defaultSelectOption:true,ignoreReadOnlyState:true,defaultSelectProjects:false,value:null,constructor:function(){this.value={type:"option",value:"default_selection"};},buildRendering:function(){this.inherited(arguments);this.selectWidget=new _5d0({_aroundNode:_5c4.contains(this.domNode.parentNode,"button-group")?this.domNode.parentNode:null,queryOptions:{sort:[{attribute:"sort-priority"},{attribute:"sort-name"},{attribute:"name"},{attribute:"id"}]}},_5c3.create("div",null,this.domNode));this.inputWidget=new _5d1({},_5c3.create("div",null,this.domNode));},_setPortfolioIdAttr:function(_5d2){this.set("value",{type:"option",value:_5d2||"default_selection"});},postCreate:function(){this.inherited(arguments);this.reload();this.own(_5bf.after(this.selectWidget,"onChange",dojo.hitch(this,this._selectValueChange),true));this.own(_5bf.after(this.inputWidget,"onChange",dojo.hitch(this,this._inputWidgetChange),true));this.own(_5bf.after(this.inputWidget,"onCancel",dojo.hitch(this,this._inputWidgetCancel),true));var _5d3=_5ce.debounce(lang.hitch(this,this.reload),100);this.connect(_5cd,"onInvalidate",dojo.hitch(this,function(_5d4){if(_5d4.type==="portfolios"||_5d4.type==="portfolio"){_5d3();}}));},reload:function(){var _5d5=this.selectWidget.store;_5d5.setData([]);return _5c2([this._addActionItemToStore(_5d5),this._loadItemsIntoStore(_5d5)]).always(lang.hitch(this,function(){this.set("value",this.get("value"));}));},_selectValueChange:function(_5d6){if(this.defaultSelectOption){var _5d7=null;if(this.defaultSelectProjects&&_5d6==="default_selection"){_5d7=_5cb.wrap(i18n)("option_select_project");}else{_5d7=_5cb.wrap(i18n)("option_myboards");}var _5d8=_5c0.filter(this.selectWidget.options,function(_5d9){return _5d9.value=="default_selection";});_5d8[0].label=_5d7;}if(_5d6&&this.selectWidget.store.get(_5d6).action==="createNewItem"){this.set("value",{type:"new",value:""});}else{if(_5d6&&this.selectWidget.store.get(_5d6).action==="removeItem"){this.set("value",{type:"remove",value:this.portfolioId});}else{this.set("value",{type:"option",value:_5d6});}}},_inputWidgetChange:function(_5da){if(this.inputWidget.get("cancelled")){this.set("value",this._beforeCreateNewItemValue||{type:"option",value:"default_selection"});}else{this.set("value",{type:"new",value:_5da});}},_inputWidgetCancel:function(){this.set("value",this._beforeCreateNewItemValue||{type:"option",value:"default_selection"});},_setValueAttr:function(_5db){var _5dc=this.get("value");this._set("value",_5db);this.onChange(_5db);if(_5db.type==="option"){_5c4.remove(this.selectWidget.domNode,"hideBlock");_5c4.add(this.inputWidget.domNode,"hideBlock");this.selectWidget.set("value",_5db.value);this.inputWidget.set("cancelled",true);this.inputWidget.set("value","");}else{if(_5db.type==="new"){_5c4.add(this.selectWidget.domNode,"hideBlock");_5c4.remove(this.inputWidget.domNode,"hideBlock");this.selectWidget.set("value","select_action_create_item");this.inputWidget.set("value",_5db.value||"");this.inputWidget.set("cancelled",false);if(_5dc.type==="option"){this._beforeCreateNewItemValue=_5dc;}}}},_loadItemsIntoStore:function(_5dd){return sp.infos.getInstance().getById({type:sp.infos.TYPE.portfolios,id:sp.info.user.info.id}).then(function(_5de){return dojo.filter(_5de.portfolios,function(p){return !p.adhoc;});}).then(dojo.hitch(this,function(_5df){return _5c2(_5c0.map(_5df,function(_5e0){return sp.infos.getInstance().getById({type:sp.infos.TYPE.portfolio,id:_5e0.portfolioId});}));})).then(dojo.hitch(this,function(_5e1){_5c0.forEach(_5e1,function(_5e2){if(!_5e2.readOnly||this.ignoreReadOnlyState){_5dd.put({id:_5e2.id,name:_5e2.project.title+" ("+_5e2.project.documents.length+")","sort-name":_5e2.project.title.toLowerCase()});}},this);this.onItemStoreFilled();}));},_addActionItemToStore:function(_5e3){if(this.defaultSelectOption){_5e3.put({id:"default_selection",name:_5cb.wrap(i18n)("option_myboards"),action:"noAction","sort-priority":100});}if(this.createNewItemOption){_5e3.put({id:"select_action_create_item",name:_5cb.wrap(i18n)("option_create_project"),action:"createNewItem","sort-priority":0});}if(this.removeFromProjectOption){_5e3.put({id:"select_action_remove_item",name:_5cb.wrap(i18n)("option_remove_project"),action:"removeItem","sort-priority":50});}_5e3.put({id:"separator",name:"","sort-priority":90});},onItemStoreFilled:function(){this.set("value",this.value);},onChange:function(){}});});},"cb/contacts/ContactsInviteTools":function(){define(["dojo/ready","dojo/when","dojo/on","dojo/aspect","dojo/query","dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/dom-class","dojo/dom-attr","dojo/json","dojox/lang/functional","dojo/store/Memory","dojo/store/Observable","dojo/Stateful","dojo/date/stamp","dojo/behavior","dojo/promise/all","dijit/_WidgetBase","cb/widget/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dijit/_Container","dijit/_Contained","dijit/form/Select","dijit/layout/ContentPane","dijit/layout/TabContainer","cb/api/Api","cb/Capabilities","cb/widget/_HideableMixin","cb/util","sp/infos/InfoManager","sp/I18n","cb/user/UserDisplay","sp/ActivityIndicatorMixin","sp/Tooltip","cb/widget/FilterableListWidget","./RoleSelectRadio","./RoleSelectRadioPanes","cb/widget/EmailTooltip","dojo/text!./ContactsPageLayout.html","dojo/text!./InviteToolEmail.html","dojo/text!./InviteToolStudent.html","dojo/text!./InviteToolReferAFriend.html","dojo/i18n!./nls/Contacts"],function(_5e4,when,on,_5e5,_5e6,lang,_5e7,_5e8,_5e9,_5ea,_5eb,json,_5ec,_5ed,_5ee,_5ef,_5f0,_5f1,_5f2,_5f3,_5f4,_5f5,_5f6,_5f7,_5f8,_5f9,_5fa,Api,_5fb,_5fc,_5fd,_5fe,_5ff,_600,_601,_602,_603,_604,_605,_606,_607,_608,_609,_60a,i18n){var I18N=_5ff.wrap(i18n);var _60b=_5e8([_5f3,_5fc,_5f4,_5f5],{open:false,i18n:i18n,postMixInProperties:function(){this.inherited(arguments);if(!this.toolTemplateString){throw "InviteTools have to provide a toolTemplateString";}this.templateString="<div class=\"invite-tool invite-tool--${toolId}\" data-invite-tool-id=\"${toolId}\">"+this.toolTemplateString+"</div>";},buildRendering:function(){this.inherited(arguments);this.containerNode=_5e6(this.domNode).children().last()[0];_5ea.add(this.containerNode,"invite-tool__container");},_getRoleAttr:function(){return null;},processInvite:function(_60c){return _5fb.checkIsManager().then(function(_60d){return {contactType:_60d?"company":"contact"};}).then(lang.hitch(this,function(_60e){return lang.mixin(_60e,_60c);})).then(function(_60f){return Api.contacts.post(_60f);}).then(lang.hitch(this,function(_610){sp.global.err.showMessage("invitation","",I18N("invitation_sent_message_title"));}));}});var _611=_5e8([_5f3,_5f7],{i18n:i18n,buildRendering:function(){this.domNode=_5e9.create("li",{"class":"filterable-l"});this.inherited(arguments);this._userDisplay=new _600({reduced:true},_5e9.create("div",null,this.domNode));var _612=this._inviteButton=_5e9.create("span",{"class":"button small","innerHTML":_5ff.wrap(i18n)("user_invite")},this.domNode);this.own(on(_612,"click",lang.hitch(this,"_handleInviteClick")));},_setItemAttr:function(item){_5eb.set(this.domNode,"data-provider-id",item.providerId);_5eb.set(this.domNode,"data-provider-user-id",item.providerUserId);this._userDisplay.set("displayname",item.displayname);this._userDisplay.set("emailAdresses",{unconfirmedEmailAdress:item.email});this._userDisplay.set("profileImageSrc",item.userphotolink||null);this._userDisplay.set("profileImageInitials",null);this._userDisplay.set("identityProviders",[item.providerId]);this._set("item",item);},_setActiveAttr:function(_613){_5ea.toggle(this._inviteButton,"disabled",_613);this._set("active",_613);},_handleInviteClick:function(){var item=this.getParent().store.get(this.item.id);if(this._lastApiErrorRemover){this._lastApiErrorRemover.remove();}this.set("active",true);this.getParent().getParent().getParent().processInvite({identifiers:[{providerId:item.providerId,providerUserId:item.providerUserId}],displayname:item.displayname,companyUserRoles:this.getParent().getParent().getParent().get("roles")}).otherwise(lang.hitch(this,function(_614){this.own(this._lastApiErrorRemover=Api.Validate.withSpec(_614,{dom:Api.Validate.errorDom(this.domNode,this._inviteButton),messageCode:"generic"}));})).always(lang.hitch(this,function(){this.set("active",false);}));}});var _615=_5e8([_603],{createEntryWidget:function(id,item,node){return new _611({item:item},node);}});var _616=_5e8([_60b],{toolTemplateString:"<div><div class=\"${baseClass}-content\"><div class=\"hideBlock connection-hint\" data-dojo-attach-point=\"_connectionHintNode\"></div><div data-dojo-attach-point=\"_listNode\"></div></div></div>",showConnectionHint:false,title:null,buildRendering:function(){this.inherited(arguments);this.renderConnectionHint(this._connectionHintNode);this.list=new _615({i18n:i18n},this._listNode);this._roleSelect=new _604(null,_5e9.create("div",null,this.list.filteringInput.domNode,"after"));},_getRolesAttr:function(){return this._roleSelect.get("roles");},renderConnectionHint:function(node){_5e9.create("p",{innerHTML:_5ff.wrap(i18n)("provider_list_connectionhint",[_5ff.wrap(i18n)("provider_"+this.provider)])},node);_5e9.create("a",{"class":"button","innerHTML":_5ff.wrap(i18n)("provider_list_connectionhint_submit",[_5ff.wrap(i18n)("provider_"+this.provider)]),"href":"/__/signin/"+this.provider+"?afterwardsUrl="+encodeURIComponent(window.location)},node);},_setTitleAttr:function(_617){this._titleNode.innerHTML=_5ff.esc(_617);this._set("title",_617);},_setShowConnectionHintAttr:function(_618){this._set("showConnectionHint",_618);_5ea.toggle(this._connectionHintNode,"hideBlock",!this.showConnectionHint);_5ea.toggle(this.list.domNode,"hideBlock",!!this.showConnectionHint);},add:function(_619){this.list.add(lang.mixin({id:_619.providerUserId+"@"+_619.providerId,searchfield:_619.displayname+_619.email,userphotolink:_619.userphotolink||"/__/photos/guest_.small.png"},_619));}});var _61a=_5e8([_60b],{toolTemplateString:_609,toolId:"STUDENT",i18n:i18n,postCreate:function(){this.inherited(arguments);this.set("company",sp.info.company);},_setCompanyAttr:function(_61b){if(_61b.studRegCode){this.set("mode","studregcode");this.set("domain",_61b.subdomain+"."+sp.info.app.serverhost);this.set("studRegCode",_61b.studRegCode);}else{_5fb.checkIsManager().then(lang.hitch(this,function(_61c){if(_61c){this.set("mode","nostudregcode-manager");}else{this.set("mode","nostudregcode");}}));this.set("domain",null);this.set("studRegCode",null);}this._set("company",_61b);},_setDomainAttr:function(_61d){this._instructionsNode.innerHTML=_61d?_5ff.wrap(i18n)("invite_per_student_instructions",[_61d]):null;this._set("domain",_61d);},_setStudRegCodeAttr:function(_61e){this._regcodeDisplayNode.innerHTML=_5ff.esc(_61e);this._set("studRegCode",_61e);},_setModeAttr:function(mode){_5e6("[data-mode]",this.containerNode).forEach(function(n){_5ea.toggle(n,"hideBlock",mode!==_5eb.get(n,"data-mode"));});this._set("mode",mode);}});var _61f=_5e8([_60b,_5f5],{toolTemplateString:_608,i18n:i18n,featureRegistrationSelfsignup:false,baseClass:"invite-tool-email",postCreate:function(){this.inherited(arguments);this.set("roleEnabled",this.get("roleEnabled"));this.emailTooltip=new _606({i18n:i18n,connectId:[this._emailTooltipConnectNode],from:sp.info.user.info.displayname,to_fallback:I18N("email_tooltip_to_input_required"),subject_i18n:"email_tooltip_subject_basic",body_i18n:"email_tooltip_body_basic"});this.own(_5fd.watchAndGetImmediately(this._roleSelect,"value",lang.hitch(this,function(){this._updateEmailTooltip();})));this.own(_5fd.watchAndGetImmediately(this._roleSelect,"availableValues",lang.hitch(this,function(attr,_620,_621){this.set("basicRoleAvailable",_5e7.indexOf(_621,"basic")!==-1);})));var _622=lang.hitch(this,function(){var _623=this._roleSelect.get("availableValues");var _624=this._roleSelect.get("disabledValues");var _625=_5e7.filter(_623,function(v){return _5e7.indexOf(_624,v)===-1;}).length>0;this.set("submitButtonEnabled",_625);});this.own(_5fd.watchAndGetImmediately(this._roleSelect,"availableValues",_622));this.own(_5fd.watchAndGetImmediately(this._roleSelect,"disabledValues",_622));},_updateEmailTooltip:function(){var _626="basic"===this._roleSelect.get("value");var to=this._nameInputNode.value;if(this._emailInputNode.value){to=to+" &lt;"+this._emailInputNode.value+"&gt;";}this.emailTooltip.set("subject_i18n","email_tooltip_subject_"+(_626?"basic":"pro"));this.emailTooltip.set("body_i18n","email_tooltip_body_"+(_626?"basic":"pro"));},_setRoleEnabledAttr:function(_627){this._roleSelect.set("disabledValues",_627?[]:["student","user","external_user","manager"]);if(!_627){this._roleSelect.set("value","basic");_5ea.remove(this._teamOverlay,"hideBlock");if(!sp.info.user.info.accountType.hasUserRoles&&this.featureRegistrationSelfsignup){this._teamMessage.innerHTML=I18N("team_message_upgrade");}else{this._teamMessage.innerHTML=I18N("team_message_manager");}dojo.query(".invite-tool__container",this.domNode).toggleClass("basic-checked",true);}this._set("roleEnabled",_627);},_setBasicRoleAvailableAttr:function(_628){_5ea.toggle(this.domNode,this.baseClass+"--without-basic-role",!_628);this._set("basicRoleAvailable",_628);},_setSubmitButtonEnabledAttr:function(_629){_5ea.toggle(this._submitButtonNode,"disabled",!_629);_5eb.set(this._submitButtonNode,"disabled",!_629);this._set("submitButtonEnabled",_629);},_handleSubmitClick:function(){if(this._oldValidationResults){this._oldValidationResults.remove();}this.set("active",true);var _62a=this._roleSelect.get("roles");if(_62a===null){this.set("active",false);return;}this.processInvite({identifiers:[{providerId:"email",providerUserId:this._emailInputNode.value}],displayname:this._nameInputNode.value,companyUserRoles:_62a.length>0?_62a:null,contactType:_62a.length>0?"company":"contact"}).then(lang.hitch(this,function(){this._nameInputNode.value="";this._emailInputNode.value="";})).otherwise(lang.hitch(this,function(_62b){var self=this;this.own(this._oldValidationResults=Api.Validate.withSpec(_62b,{fieldHandlers:[{matchField:"identifiers[0].providerUserId",dom:Api.Validate.errorDom(this,"_emailInputNode")},{matchField:"displayname",dom:Api.Validate.errorDom(this,"_nameInputNode")}]}));})).always(lang.hitch(this,function(){this.set("active",false);}));}});var _62c=_5e8([_61f],{toolId:"EMAIL_BASIC",roleEnabled:false});var _62d=_5e8([_61f],{toolId:"EMAIL_FULL",roleEnabled:true,pricingMessage:"",postCreate:function(){this.inherited(arguments);_5fb.checkFeature("registration.selfsignup").then(function(_62e){return _62e==="enabled";}).then(function(_62f){if(!_62f){return null;}var _630=sp.info.company&&sp.info.company.activeLicense?sp.info.company.activeLicense:null;if(!_630){return null;}return Api.Caching.licenses.getById(_630).then(lang.hitch(this,function(_631){var _632="";if(_631&&_631.data){var _633=_631.data;if(_633.basePricePerUser&&_633.basePricePerUser.currency&&_633.basePricePerUser.priceInCents){var curr=_633.basePricePerUser.currency;_632+=(curr==="EUR"?"€":(curr==="USD"?"$":curr))+(_633.basePricePerUser.priceInCents/100);}if(_633.billingPeriodInMonth){if(1*_633.billingPeriodInMonth===1){_632+=" "+I18N("per_month");}else{if(1*_633.billingPeriodInMonth===12){_632+=" "+I18N("per_year");}}}if(_633.numberOfIncludedUsers){_632+=", "+_633.numberOfIncludedUsers+" "+I18N("users_included");}}return _632;}));}).then(lang.hitch(this,function(_634){this.pricingMessage=_634;if(this.pricingMessage&&this.pricingMessage.length>0){this._modalitiesTeam.innerHTML=this._modalitiesTeam.innerHTML+" ("+this.pricingMessage+")";}}));}});var _635=_5e8([_60b],{toolTemplateString:_60a,toolId:"REFER_A_FRIEND",i18n:i18n,open:true,joinLink:sp.info.app.serverUrls.https+"/registration",postCreate:function(){this.inherited(arguments);this._headerInfoIconNode=_5e6("[data-dojo-attach-point=_headerInfoIconNode]",this.domNode)[0];this.own(new _602({connectId:[this._headerInfoIconNode],label:"<div class=\"dialog-content tooltip-hint-content\">"+I18N("invite_tool_referafriend_tooltip")+"</div>"}));_5f1.apply(this.domNode);},_setReferralStatusAttr:function(_636){this.set("joinLink",_636.referralData.link);},_setJoinLinkAttr:function(_637){this._joinLinkInputNode.value=_637;_5eb.set(this._twitterLinkNode,"href","http://twitter.com/share?related=conceptboardapp&url="+_637+"&text="+encodeURIComponent(I18N("invite_tool_referafriend_text")));_5eb.set(this._facebookLinkNode,"href","http://www.facebook.com/sharer.php?u="+_637);_5eb.set(this._googlePlusLinkNode,"href","https://plus.google.com/share?url="+_637);}});var _638=_5e8([_616],{toolId:"SALESFORCE",provider:"forcedotcom",buildRendering:function(){this.inherited(arguments);_5e9.create("p",{innerHTML:I18N("email_message_content_hint")},this._roleSelect.domNode,"after");this._emailTooltipConnectNode=_5e6("[data-dojo-attach-point=\"_emailTooltipConnectNode\"]",this.domNode)[0];},postCreate:function(){this.inherited(arguments);this.emailTooltip=new _606({i18n:i18n,connectId:[this._emailTooltipConnectNode],from:sp.info.user.info.displayname});this.emailTooltip.set("subject_i18n","email_tooltip_subject_pro");this.emailTooltip.set("body_i18n","email_tooltip_body_pro");_5fe.getById({type:"socialconnections",id:sp.info.user.id}).then(lang.hitch(this,function(_639){return _5e7.some(_639.connections,function(_63a){return _63a.key.providerId==="forcedotcom";});})).then(lang.hitch(this,function(_63b){this.set("showConnectionHint",!_63b);var _63c=false;if(_63b){this.watch("open",lang.hitch(this,function(attr,_63d,open){if(!open||_63c){return;}this.list.set("status","loading");return _5fe.getById({type:"chatterusers",id:sp.info.user.id}).then(lang.hitch(this,function(_63e){_63c=true;this.list.set("status",_63e.users.length>0?"nonempty":"empty");_5e7.map(_63e.users,function(_63f){this.add({providerId:this.provider,providerUserId:_63f.id,displayname:_63f.name,email:_63f.email,userphotolink:_63f.photo.smallPhotoUrlCb});},this);}));}));}}));}});var _640={STUDENT:_61a,EMAIL_BASIC:_62c,EMAIL_FULL:_62d,SALESFORCE:_638,REFER_A_FRIEND:_635};var _641=_5e8([_5fa],{buildRendering:function(){this.inherited(arguments);_5ea.add(this.domNode,"invite-tools");},postCreate:function(){this.inherited(arguments);var _642;var _643=_5fb.checkIsManager();var _644=when(sp.info.user.info.accountType.hasUserRoles);var _645=when(sp.info.user.info.accountType.hasForcedotcomChatter);var _646=_5fb.checkFeature("forcedotcom.invite").then(function(_647){return _647==="enabled";});var _648=_5fb.checkFeature("registration.selfsignup").then(function(_649){return _649==="enabled";});var _64a=when(sp.info.user.info.accountType.education);var _64b=function _64b(arr){return _5e7.every(arr,function(item){return !!item;});};var not=function not(_64c){return when(_64c).then(function(_64d){return !_64d;});};var _64e=_5f2([_644,_643]).then(_64b).then(function(_64f){return _64f?"EMAIL_FULL":"EMAIL_BASIC";});var _650=_5f2([_644,_643,_645,_646]).then(_64b).then(function(_651){return _651?"SALESFORCE":null;});var _652=_5f2([_644,_64a]).then(_64b).then(function(_653){return _653?"STUDENT":null;});var _654=_5f2([not(_644),_648]).then(_64b).then(function(_655){return _655?"REFER_A_FRIEND":null;});_642=_5f2([_64e,_650,_652,_654]).then(function(_656){return _5e7.filter(_656,function(tool){return tool!==null;});});when(_642).then(lang.hitch(this,function(_657){this.set("toolsShown",_657);}));},_setToolsShownAttr:function(_658){_5e7.forEach(this.getChildren(),function(w){this.removeChild(w);w.destroyRecursive();},this);_5fb.checkFeature("registration.selfsignup").then(function(_659){return _659==="enabled";}).then(lang.hitch(this,function(_65a){_5e7.forEach(_658,function(tool,_65b){var w=new _640[tool]({"referralStatus":this.referralStatus,featureRegistrationSelfsignup:_65a});var pane=new _5f9();pane.watch("selected",function(attr,old,_65c){w.set("open",_65c);});pane.set("title",I18N("invite_tool_header_"+tool));pane.set("content",w);pane.set("selected",_65b===0);this.addChild(pane);},this);this._set("toolsShown",_658);}));}});return _641;});},"cb/api/Types":function(){define([],function(){function _65d(_65e){return _65e?{status:_65e.status,url:_65e.url,options:_65e.options,headers:{link:_65e.getHeader("Link"),"X-CB-Paging-Prev":_65e.getHeader("X-CB-Paging-Prev")}}:{headers:{}};};function _65f(_660,_661){this.response=_660;this.error=_660.data;this.data=null;this.meta=_65d(_660);this.originalError=_661||null;};_65f.prototype=new Error();_65f.prototype.constructor=_65f;function _662(_663){this.response=_663.response;this.meta=_65d(_663.response);this.originalError=_663;this.error={problemType:"client",title:_663.message};};_662.prototype=new Error();_662.prototype.constructor=_662;function _664(_665){this.response=_665;this.error=null;this.data=_665.data;this.meta=_65d(_665);};_664.prototype={};_664.prototype.constructor=_664;return {CbApiError:_65f,ClientCbApiError:_662,ApiResponse:_664};});},"url:dijit/form/templates/DropDownBox.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\"\n\tid=\"widget_${id}\"\n\trole=\"combobox\"\n\t><div class='dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer'\n\t\tdata-dojo-attach-point=\"_buttonNode, _popupStateNode\" role=\"presentation\"\n\t\t><input class=\"dijitReset dijitInputField dijitArrowButtonInner\" value=\"&#9660; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"button presentation\" aria-hidden=\"true\"\n\t\t\t${_buttonInputDisabled}\n\t/></div\n\t><div class='dijitReset dijitValidationContainer'\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t/></div\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\n\t\t><input class='dijitReset dijitInputInner' ${!nameAttrSetting} type=\"text\" autocomplete=\"off\"\n\t\t\tdata-dojo-attach-point=\"textbox,focusNode\" role=\"textbox\" aria-haspopup=\"true\"\n\t/></div\n></div>\n","cb/personalcontainer/header/UserProfileDialog":function(){define(["dijit","dojo","dojox","dojo/i18n!cb/personalcontainer/header/nls/UserProfileDialog","dojo/require!cb/widget/UserDialog,sp/dialog/TooltipDialog,sp/I18n"],function(_666,dojo,_667){dojo.provide("cb.personalcontainer.header.UserProfileDialog");dojo.require("cb.widget.UserDialog");dojo.require("sp.dialog.TooltipDialog");dojo.require("sp.I18n");dojo.requireLocalization("cb.personalcontainer.header","UserProfileDialog");dojo.declare("cb.personalcontainer.header.UserProfileDialog",[sp.dialog.TooltipDialog],{baseClass:"personal-container-user-profile-dialog",controller:null,position:["below-centered","below"],widgetsInTemplate:true,invisibleMilk:true,userIsIdentified:sp.info.user.isIdentified,userId:sp.info.user.id,userName:sp.info.user.info.displayname,featureRegistrationSelfsignup:false,constructor:function(_668){this.controller=_668.controller;},postCreate:function(){this.inherited("postCreate",arguments);this.content=new sp.dialog.DialogContent({templateString:dojo.cache("cb.personalcontainer.header","UserProfileDialog.html","<div class=\"dialog-content\">\r\n\t<img src=\"/__/photo/user.large.png\" class=\"profile-image\" data-dojo-attach-point=\"_profileImage\" />\r\n\t<div class=\"infos\" data-dojo-attach-point=\"_profileInfos\"></div>\r\n\t<a href=\"/__/logout\" class=\"logout\" data-dojo-attach-point=\"_logoutLink\">${!i18n.logout}</a>\r\n</div>"),dialog:this,i18n:sp.I18n.bundle("cb.personalcontainer.header","UserProfileDialog")});this._updateUserProfileInformation();},_updateUserProfileInformation:function(){dojo.attr(this.content._profileImage,"src","/__/photo/"+sp.I18n.escAttr(this.userId)+".large.png");dojo.create("div",{"class":"title-line",innerHTML:"<span class=\"profile-name\">"+sp.I18n.esc(this.userName)+"</span>"},this.content._profileInfos);if(sp.info.user.userHasConfirmedEmailAddress){dojo.create("span",{"class":"profile-email","innerHTML":sp.I18n.esc(sp.info.user.info.emailAdress)},this.content._profileInfos);}if(this.userIsIdentified){var _669=dojo.create("div",{"class":"links"},this.content._profileInfos);dojo.create("a",{"innerHTML":"<i class=\"icon fonticon-participant\"></i> "+sp.I18n.get("cb.personalcontainer.header","UserProfileDialog")("link_settings"),"href":"/profile"},_669);if(sp.info.user.info.accountType.asString==="basic"&&this.featureRegistrationSelfsignup){dojo.create("a",{"innerHTML":"<i class=\"icon fonticon-star\"></i> "+sp.I18n.get("cb.personalcontainer.header","UserProfileDialog")("link_upgrade"),"href":"/upgrade"},_669);}}if(!this.userIsIdentified){this.content._logoutLink.innerHTML=sp.I18n.get("cb.personalcontainer.header","UserProfileDialog")("leave_board");dojo.attr(this.content._logoutLink,"href","http://conceptboard.com/thanks-for-working-with-us");var _66a=dojo.create("div",{"class":"license-infos"},this.content._profileInfos);dojo.create("div",{"innerHTML":sp.I18n.get("cb.widget","UserDialog")("licence_guest_myself"),"class":"user-licence"},_66a);dojo.create("div",{"innerHTML":sp.I18n.get("cb.widget","UserDialog")("guest_login_same_tab"),"class":"user-login"},_66a);}}});});},"sp/ActivityIndicatorMixin":function(){define(["dijit","dojo","dojox","dojo/require!sp/ActivityIndicator"],function(_66b,dojo,_66c){dojo.provide("sp.ActivityIndicatorMixin");dojo.require("sp.ActivityIndicator");dojo.declare("sp.ActivityIndicatorMixin",[],{autoStartActivityIndicator:false,activityIndicator:null,active:false,postMixInProperties:function(){this.inherited(arguments);if(this.autoStartActivityIndicator){this.active=true;}},_setActiveAttr:function(_66d){_66d=!!_66d;if(_66d){if(!this.activityIndicator){this.activityIndicator=new sp.ActivityIndicator({containerNode:this.getActivityIndicatorContainerNode()});}this.activityIndicator.show();}else{if(this.activityIndicator){this.activityIndicator.hide();}}this._set("active",_66d);},showActivityIndicator:function(){this.set("active",true);},hideActivityIndicator:function(){this.set("active",false);},getActivityIndicatorContainerNode:function(){return dojo.query(".activity-indicator-container",this.domNode).at(0)[0]||this.domNode;}});});},"sp/dialog/ShowParticipantsDialog":function(){define(["dijit","dojo","dojox","dojo/i18n!sp/dialog/nls/ShowParticipantsDialog","dojo/require!sp/dialog/TooltipDialog,sp/EmailComboBox,sp/I18n,sp/I18nWidget,cb/widget/ParticipantList,cb/widget/BigSwitch,cb/contacts/ContactListWidget,dojo/promise/all,cb/Capabilities,dijit/layout/TabContainer,dijit/layout/ContentPane"],function(_66e,dojo,_66f){dojo.provide("sp.dialog.ShowParticipantsDialog");dojo.require("sp.dialog.TooltipDialog");dojo.require("sp.EmailComboBox");dojo.require("sp.I18n");dojo.require("sp.I18nWidget");dojo.require("cb.widget.ParticipantList");dojo.require("cb.widget.BigSwitch");dojo.require("cb.contacts.ContactListWidget");dojo.require("dojo.promise.all");dojo.require("cb.Capabilities");dojo.require("dijit/layout/TabContainer");dojo.require("dijit/layout/ContentPane");dojo.requireLocalization("sp.dialog","ShowParticipantsDialog");dojo.declare("sp.dialog.ShowParticipantsDialog",[sp.dialog.TooltipDialog],{baseClass:"participants-dialog with-title",documentId:null,share:true,participantManager:null,constructor:function(){},postCreate:function(){this.inherited(arguments);this.content=new (dojo.declare([sp.dialog.DialogContent,sp.I18nWidget]))({templateString:"<div>\r\n    <div class=\"dialog-content\">\r\n        <div class=\"dialog-title\">\r\n            <span dojoAttachPoint=\"_dialogTitleInner\"></span>\r\n            <div data-dojo-attach-event=\"click:_handleCloseButtonClick\" class=\"dialog-close-button\" title=\"close\"><i class=\"fonticon-cross\"></i></div>\r\n        </div>\r\n        <div style=\"position:relative;\">\r\n            <div class=\"participants-invite-pane\" dojoAttachPoint=\"_ParticipantsInvitePane\">\r\n                <div data-dojo-type=\"dijit/layout/TabContainer\">\r\n                \r\n                    <div data-dojo-type=\"dijit/layout/ContentPane\" title=\"${i18n.headline_via_email}\" class=\"pretty-scrollbars\" data-dojo-props=\"selected:true\">\r\n                        <div class=\"upgrade-or-passphrase\" data-dojo-attach-point=\"_PassphraseContainer\">\r\n                            <div data-dojo-attach-point=\"showPassContainer\" class=\"hideBlock\">\r\n                                <strong>${!i18n.password_hint}</strong>\r\n                                <span class=\"blue\" dojoAttachPoint=\"showPassBlock\">\r\n                                    <span class=\"link\" dojoAttachEvent=\"onclick:_showPass\">${!i18n.show_password}</span>\r\n                                </span>\r\n                            </div>\r\n                            <div data-dojo-attach-point=\"showPassNoticeContainer\" class=\"hideBlock\">${!i18n.password_notice}</div>\r\n                            <div data-dojo-attach-point=\"upgradeNotice\" class=\"hideBlock\">${!i18n.upgrade_notice}</div>\r\n                        </div>\r\n                        <div class=\"email-invite-container\" data-dojo-attach-point=\"_sendEmailInvitationForm\">\r\n                            <div\r\n                                data-dojo-type=\"sp.EmailComboBox\"\r\n                                placeholder=\"${!i18n.toemail_hint}\"\r\n                                class=\"full-width\"\r\n                                data-dojo-props=\"autofocus : true\"\r\n                                data-dojo-attach-point=\"emailComboBox\"></div>\r\n                            <span class=\"errors error field-command-to\"></span>\r\n                            <textarea\r\n                                name=\"personalMessage\"\r\n                                id=\"personalMessage\"\r\n                                dojoAttachPoint=\"_personalMessageTextarea\"\r\n                                class=\"big-sized full-width\"\r\n                                autocorrect=\"off\"\r\n                                autocapitalize=\"off\"\r\n                                placeholder=\"${!i18n.personalmessage_hint}\"></textarea>\r\n                            <p class=\"light small\">${!i18n.email_information}</p>\r\n                            <span class=\"button large\" dojoAttachEvent=\"onclick:_executeClick\">${!i18n.submit_button}</span>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div data-dojo-type=\"dijit/layout/ContentPane\" title=\"${i18n.headline_via_link}\" class=\"pretty-scrollbars\">\r\n                        <p class=\"light small\">${!i18n.link_information}</p>\r\n                        <div dojoAttachPoint=\"editLinkContainer\" class=\"hideBlock edit-link-container\">\r\n                            <input\r\n                                type=\"text\"\r\n                                value=\"\"\r\n                                data-dojo-attach-point=\"editLinkInput\"\r\n                                class=\"full-width js-select-all-input\"\r\n                                readonly=\"readonly\" />\r\n                            <div\r\n                                class=\"social-buttons\"\r\n                                data-dojo-attach-point=\"_socialSharingButtons\">\r\n                                <span\r\n                                    class=\"social-share-label\"\r\n                                    type=\"checkbox\"\r\n                                    data-dojo-type=\"cb.widget.BigSwitch\"\r\n                                    data-dojo-attach-event=\"onChange:_handleShareSwitchChanged\"\r\n                                    data-dojo-attach-point=\"_collaborationSwitch\"\r\n                                    data-dojo-props='tinySwitch:\"true\"'>${!i18n.share_buttons_label}</span>\r\n                                <div class=\"share-buttons inactive\" data-dojo-attach-point=\"_shareButtonsContainer\">\r\n                                    <div class=\"click-preventer\"></div>\r\n                                    <a href=\"https://www.facebook.com/sharer.php?u=${EscapedBoardURL}&amp;t=${!i18n.social_text:encodeURIComponent}\" class=\"facebook\" target=\"_blank\"><i class=\"fonticon-facebook fonticon-large\"></i> ${!i18n.facebook}</a>\r\n                                    <a href=\"http://twitter.com/intent/tweet?related=conceptboardapp&amp;text=${!i18n.social_text:encodeURIComponent}&amp;url=${EscapedBoardURL}&amp;counturl=http%3A%2F%2Fconceptboard.com\" class=\"twitter\" target=\"_blank\"><i class=\"fonticon-twitter fonticon-large\"></i> ${!i18n.twitter}</a>\r\n                                    <a href=\"https://plus.google.com/share?url=${EscapedBoardURL}\" class=\"googleplus\" target=\"_blank\"><i class=\"fonticon-google fonticon-large\"></i> ${!i18n.googleplus}</a>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                </div>\r\n            </div>\r\n            <div class=\"participants-pane\" dojoAttachPoint=\"_ParticipantsPane\">\r\n                <div class=\"participants-headline\">${!i18n.headline_participants}</div>\r\n                <div class=\"\" data-dojo-attach-point=\"_ParticipantsContainer\"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>",dialog:this,from:sp.info.user.info.displayname+"",widgetsInTemplate:true,i18n:sp.I18n.bundle("sp.dialog","ShowParticipantsDialog"),EscapedBoardURL:sp.global.fixedEncodeURIComponent(window.location.href),showSocialShareTools:false,referer:window.location.pathname.replace(/\D*[^\w]/,""),postCreate:function(){this.inherited("postCreate",arguments);this._initParticipants();this.clWidget=new cb.contacts.ContactListWidget({connectedWidget:this.emailComboBox},dojo.create("div",null,this.emailComboBox.domNode,"after"));var _670=sp.infos.getInstance().getById({type:"document",id:this.dialog.documentId}).then(function(_671){return _671.document;});var _672=_670.then(function(_673){return sp.infos.getInstance().getById({type:"portfolio",id:_673.projectId}).then(function(_674){return _674.project;});});var _675=_670.then(function(_676){return sp.infos.getInstance().getById({type:"user",id:_676.ownerId}).then(function(_677){return _677.user;});});var _678=cb.Capabilities.checkFeature("registration.selfsignup").then(function(_679){return _679==="enabled";});dojo.promise.all({document:_670,project:_672,owner:_675,featureRegistrationSelfsignup:_678}).then(dojo.hitch(this,function(_67a){this.document=_67a.document;this.portfolio=_67a.project;this.owner=_67a.owner;this._dialogTitleInner.innerHTML=sp.I18n.get("sp.dialog","ShowParticipantsDialog")("dialog_title_participants",[this.document.title]);if(this.document.currentLocation.fullEditUrl){this.editLinkInput.value=this.document.currentLocation.fullEditUrl;dojo.removeClass(this.editLinkContainer,"hideBlock");}if(!sp.info.user.info.accountType.hasPassphrase&&!this.owner.accountType.hasPassphrase){dojo.toggleClass(this.upgradeNotice,"hideBlock",!_67a.featureRegistrationSelfsignup);}else{if(this.portfolio.accessControlState.controlled&&this.owner.accountType.hasPassphrase){dojo.removeClass(this.showPassContainer,"hideBlock");}else{if(!this.portfolio.accessControlState.controlled&&this.owner.accountType.hasPassphrase){dojo.addClass(this._PassphraseContainer,"hideBlock");}}}}));cb.Capabilities.checkFeature("board.socialsharetools").then(dojo.hitch(this,function(_67b){var _67c=_67b==="enabled";var _67d=sp.info.company&&sp.info.company.hideSocialsharing;var _67e=sp.info.document&&sp.info.document.ownerCompany&&sp.info.document.ownerCompany.hideSocialsharing;var _67f=_67c&&!_67d&&!_67e;this.set("showSocialShareTools",_67f);}));},_showPass:function(){this.showPassBlock.innerHTML=sp.I18n.esc(this.portfolio.accessControlState.accessControlToken);},_handleShareSwitchChanged:function(){this._toggleShareButtons();},_toggleShareButtons:function(){dojo.toggleClass(this._shareButtonsContainer,"inactive");},_handleCloseButtonClick:function(){this.dialog.hide();},_initParticipants:function(){new cb.widget.ParticipantList({participantsToShow:this.participantsToShow,ownUserId:sp.info.user.info.id,documentId:this.dialog.documentId,parent:this,participantManager:this.dialog.participantManager,postMixInProperties:function(){this.inherited("postMixInProperties",arguments);}},dojo.create("div",null,this._ParticipantsContainer,"first"));},_setShowSocialShareToolsAttr:function(_680){dojo.toggleClass(this._socialSharingButtons,"hideBlock",!_680);this._set("showSocialShareTools",_680);}});this.smErr=new sp.err({container:this.content._errContainer});},_onSubmit:function(){this.content.showMilk();this.smErr.clear();var _681=this.content.clWidget.get("value");var _682=dojo.filter(dojo.map(_681,function(v){var _683,_684;if(v.type==="email"){_683="email";_684=v.value;}else{if(v.valueType==="company"){_683="contact_company";}else{if(v.valueType==="contact"){_683="contact";}else{return null;}}}return {data:{personalMessage:this.content._personalMessageTextarea.value,documentId:this.documentId,invitingUser:sp.info.user.info.id,invitedUser:{providerId:_683,providerUserId:v.value}},value:v};},this),function(v){return !!v;});var _685=dojo.map(_682,function(_686){return cb.api.Api.documentinvitations.post(_686.data).then(dojo.hitch(this,function(_687){this.content.clWidget.removeValue(_686.value);}));},this);dojo.promise.all(_685).then(dojo.hitch(this,function(){sp.global.err.handle(sp.global.err.getNewMessageObject("invitation",null,sp.I18n.get("sp.dialog","ShowParticipantsDialog")("success_message")));this.hide();})).otherwise(dojo.hitch(this,function(e){this.content.hideMilk();this.smErr.handle(sp.global.err.getNewMessageObject("error",null,sp.I18n.get("sp.dialog","ShowParticipantsDialog")("error_message")));})).always(dojo.hitch(this,function(){sp.infos.getInstance().invalidateById({type:"document",id:this.documentId});sp.infos.getInstance().invalidateById({type:"documentinvitations",id:this.documentId});}));}});});},"url:cb/page/dashboard/OnboardingTasks.html":"<div>\r\n    <h3>\r\n        <div class=\"close\" data-dojo-attach-event=\"click: _hideOnboardingTasks\"><i class=\"fonticon-cross\"></i></div>\r\n        <span class=\"title\">${!i18n.title}</span>\r\n    </h3>\r\n    <div class=\"onboarding-tutorial-container\">\r\n        <a href=\"/tutorial\" class=\"button secondary full-width\">${!i18n.tutorialbutton} &nbsp;<i class=\"fonticon-chevron-right\"></i></a>\r\n    </div>\r\n    <p class=\"onboarding-intro-text\">${!i18n.introtext}</p>\r\n    <div data-dojo-type=\"cb.widget.OnboardingProgressBar\"></div>\r\n    <div data-dojo-attach-point=\"_tasksListNode\"></div>\r\n</div>","dojo/promise/all":function(){define(["../_base/array","../Deferred","../when"],function(_688,_689,when){"use strict";var some=_688.some;return function all(_68a){var _68b,_688;if(_68a instanceof Array){_688=_68a;}else{if(_68a&&typeof _68a==="object"){_68b=_68a;}}var _68c;var _68d=[];if(_68b){_688=[];for(var key in _68b){if(Object.hasOwnProperty.call(_68b,key)){_68d.push(key);_688.push(_68b[key]);}}_68c={};}else{if(_688){_68c=[];}}if(!_688||!_688.length){return new _689().resolve(_68c);}var _68e=new _689();_68e.promise.always(function(){_68c=_68d=null;});var _68f=_688.length;some(_688,function(_690,_691){if(!_68b){_68d.push(_691);}when(_690,function(_692){if(!_68e.isFulfilled()){_68c[_68d[_691]]=_692;if(--_68f===0){_68e.resolve(_68c);}}},_68e.reject);return _68e.isFulfilled();});return _68e.promise;};});},"cb/notifications/NotificationsDialog":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/query","dojo/dom-construct","dojo/dom-class","dojo/on","dojo/_base/array","dojo/dom-attr","sp/infos/InfoManager","sp/dialog/TooltipDialog","sp/dialog/DialogContent","cb/page/dashboard/UserNoticesList","cb/util","dojo/text!./NotificationsDialog.html","sp/I18n","dojo/i18n!./nls/Messages"],function(_693,lang,_694,_695,_696,on,arr,_697,_698,_699,_69a,_69b,_69c,_69d,_69e,i18n){var _69f=_69e.wrap(i18n);var _6a0=_693([_69a],{templateString:_69d,i18n:i18n,query:null,storeLoadPredicate:null,hasMore:false,postCreate:function(){this.inherited(arguments);this.set("hasMore",this.get("hasMore"));this.userNoticeList=new _69b({query:this.query,storeLoadPredicate:this.storeLoadPredicate,activeFullEntryLink:true},this._containerNode);this.userNoticeList.watch("hasMore",lang.hitch(this,function(attr,_6a1,_6a2){if(dojo.query("ul li",this._containerNode).length>0){_696.add(this._emptyMessage,"hideBlock");_696.remove(this._loadMoreButton,"hideBlock");}}));_69c.watchAndGetImmediately(this.userNoticeList,"hasMore",lang.hitch(this,function(attr,_6a3,_6a4){this.set("hasMore",_6a4);}));},_loadMoreButtonClick:function(){this.userNoticeList.loadMore();},_setHasMoreAttr:function(_6a5){_696.toggle(this._loadMoreButton,"disabled",!_6a5);this._set("hasMore",_6a5);}});return _693([_699],{storeLoadPredicate:null,query:null,baseClass:"notifications-dialog",invisibleMilk:true,isBoardMode:false,postCreate:function(){this.inherited(arguments);this.content=new _6a0({query:this.query,dialog:this,storeLoadPredicate:this.storeLoadPredicate});on(this.content,"click",lang.hitch(this,"_handleClick"));},_handleClick:function(e){var _6a6=_694(e.target).closest("li.user-notices-list-entry");if(_6a6&&_6a6.length>0&&_6a6[0].children[0].href){sp.global.analytics.trackEvent("alertsDialog","navigateToItem");}},createAndConnectCloseHandler:function(){if(this.isBoardMode){arr.forEach(["/sp/pad/controller/mousedown","/window/resize"],function(_6a7){this.subscribe(_6a7,_69c.wrapDefer(function(){this.hide();if(this.onCancel){this.onCancel();}}));},this);}else{this.inherited(arguments);}}});});},"cb/api/validateWithSpec":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/dom","dojo/dom-class","dojox/lang/functional","./Types","sp/I18n","dojo/i18n!./nls/DefaultMessages"],function(lang,_6a8,dom,_6a9,_6aa,_6ab,_6ac,_6ad){function _6ae(i18n,_6af){return function(_6b0){var I18N=_6ac.wrap(i18n);var msg;var _6b1=[];if(_6af){_6b1.push(_6af);}else{if(_6b0.problemType==="fielderror"){if(_6b0.resource){_6b1.push(_6b0.resource+"_"+_6b0.fieldName+"_"+_6b0.fieldErrorCode);}_6b1.push(_6b0.fieldName+"_"+_6b0.fieldErrorCode);_6b1.push(_6b0.fieldErrorCode);}if(_6b0.resource){_6b1.push(_6b0.resource+"_"+_6b0.problemType);}_6b1.push(_6b0.problemType);}_6a8.some(_6b1,function(code){var _6b2=I18N(code,_6b0.detailObjects);if(_6b2===code){return false;}else{msg=_6b2;return true;}});return msg||_6b1[0];};};function _6b3(_6b4,spec,_6b5,_6b6,_6b7){var _6b8=[];var ret=lang.isFunction(spec)?spec(_6b4,_6b8):false;Array.prototype.push.apply(_6b7,_6b8);return ret;};function _6b9(_6ba,spec,_6bb,_6bc,_6bd){return (lang.isObject(spec)&&spec[_6ba.problemType])?_6be(_6ba,spec[_6ba.problemType],_6bb,_6bc,_6bd):false;};function _6bf(_6c0){return function(_6c1){if(!_6c0){return true;}else{if(lang.isString(_6c0)){return _6c0===_6c1;}else{if(lang.isFunction(_6c0.test)){return _6c0.test(_6c1);}else{if(lang.isFunction(_6c0)){return _6c0(_6c1);}else{return false;}}}}};};function _6c2(_6c3,spec,_6c4,_6c5,_6c6){if(_6c3.problemType!=="fielderror"||!spec||!lang.isObject(spec)||!spec.fieldHandlers){return false;}var fhs=spec.fieldHandlers;if(!lang.isArray(fhs)){if(lang.isObject(fhs)){fhs=[fhs];}}if(!lang.isArray(fhs)){return false;}var _6c7=_6aa.reduce(fhs,function(acc,fh){if(!fh){}else{if(fh[_6c3.fieldName]){acc.push(fh[_6c3.fieldName]);}else{if(_6bf(fh.matchCode)(_6c3.fieldErrorCode)&&_6bf(fh.matchField)(_6c3.fieldName)&&_6bf(lang.isFunction(fh.match)?fh.match:null)(_6c3)){acc.push(lang.mixin(lang.delegate(fh),{match:null,matchCode:null,matchField:null,fieldHandlers:null}));}else{}}}return acc;},[]);return _6c7.length>0&&_6a8.every(_6c7,function(spec){return _6be(_6c3,spec,_6c4,_6c5,_6c6);});};function _6c8(_6c9,spec,_6ca,_6cb,_6cc){if(_6c9.problemType==="multiple"){_6a8.forEach(_6c9.errors,function(_6cd){_6be(_6cd,spec,_6ca,_6cb,_6cc);});return true;}else{return false;}};function _6ce(_6cf,spec,_6d0,_6d1,_6d2){return (lang.isObject(spec)&&spec.catchall)?_6be(_6cf,spec.catchall,_6d0,_6d1,_6d2):false;};function _6d3(_6d4,spec,_6d5,_6d6,_6d7){if(!spec.dom){return false;}var i18n=lang.delegate(_6ad);if(spec.i18n){lang.mixin(i18n,spec.i18n);}if(_6d5.i18n){lang.mixin(i18n,_6d5.i18n);}var _6d8=_6ae(i18n,spec.messageCode);var _6d9;var _6da;if(lang.isString(_6d8)){_6da=_6d8;}else{if(lang.isFunction(_6d8)){_6da=_6d8(_6d4);}}if(!_6da){return false;}if(lang.isFunction(spec.dom)){_6d9=spec.dom(_6d4);}else{_6d9=dom.byId(spec.dom);}if(!_6d9){return false;}_6d9.innerHTML=_6da;_6a9.remove(_6d9,"hideBlock");_6d7.push((function(_6db){var node=_6db;return function(){node.innerHTML="";_6a9.add(node,"hideBlock");node=null;};})(_6d9));return true;};function _6be(_6dc,spec,_6dd,_6de,_6df){if(!spec){console.warn("missing spec for validation",_6dc);_6de.push(_6dc);return;}var _6e0=false;_6e0=_6e0||_6b3(_6dc,spec,_6dd,_6de,_6df);_6e0=_6e0||_6b9(_6dc,spec,_6dd,_6de,_6df);_6e0=_6e0||_6c2(_6dc,spec,_6dd,_6de,_6df);_6e0=_6e0||_6c8(_6dc,spec,_6dd,_6de,_6df);_6e0=_6e0||_6ce(_6dc,spec,_6dd,_6de,_6df);_6e0=_6e0||_6d3(_6dc,spec,_6dd,_6de,_6df);if(!_6e0){_6de.push(_6dc);}return _6e0;};return function(_6e1,spec){var _6e2=[],_6e3=[];if(!((_6e1 instanceof _6ab.CbApiError)||(_6e1 instanceof _6ab.ClientCbApiError))){console.warn("cannot handle error",_6e1);return;}_6be(_6e1.error,spec,spec,_6e2,_6e3);if(_6e2.length>0){}return {remove:function(){_6a8.forEach(_6e3,function(fn){fn();});},unhandled:_6e2};};});},"cb/infobanner/ConfirmEmailBanner":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/dom-construct","dojo/dom-attr","dojo/on","dojo/_base/array","dojo/dom-class","dojo/query","dojo/html","dojo/date/stamp","dojo/promise/all","cb/infobanner/Banner","sp/infos/InfoManager","sp/ajax/AjaxEngine","cb/api/Api","cb/Capabilities","./Container","sp/I18n","dojo/i18n!./nls/BannerMessages"],function(_6e4,lang,_6e5,_6e6,on,arr,_6e7,_6e8,_6e9,_6ea,_6eb,_6ec,_6ed,_6ee,Api,_6ef,_6f0,_6f1,i18n){var _6f2="confirmEmailBanner";var _6f3=_6e4([_6ec],{bannerId:_6f2,isCloseable:false,buildRendering:function(){this.analyticsBannerId="confirm email";this.defaultIconClass="fonticon-message";this.defaultMessage=_6f1.wrap(i18n)("confirm_email_message");this.inherited(arguments);},postCreate:function(){this.inherited(arguments);_6e8("a.js-resend",this.domNode).on("click",lang.hitch(this,function(){sp.global.analytics.trackEvent(this.analyticsCategory,"click resend");return true;}));}});_6f3.addToContainerIfNecessary=function addToContainerIfNecessary(_6f4){return _6f4.addIfNotPresent(_6f2,function(){if(sp.info.user&&sp.info.user.isIdentified&&!sp.info.user.info.emailAddresses.confirmedEmailAddressPresent){return new _6f3();}});};return _6f3;});},"cb/widget/UserDialog":function(){define(["require","dojo","dojo/dom-class","dojo/dom-construct","dojo/query","sp/dialog/DialogTooltip","sp/dialog/DialogContent","sp/I18n","sp/I18nWidget","sp/ajax/AjaxEngine","sp/infos/InfoManager","dojo/text!./UserDialog.html","dojo/i18n!./nls/UserDialog"],function(_6f5,dojo,_6f6,_6f7,_6f8,_6f9,_6fa,_6fb,_6fc,_6fd,_6fe,_6ff,i18n){var _700=dojo.declare([_6fa],{templateString:_6ff,widgetsInTemplate:true,i18n:i18n,loginEnabled:false,logoutEnabled:false,postMixInProperties:function(){this.inherited(arguments);this.isMyself=this.user.id===sp.info.user.info.id;},buildRendering:function(){this.inherited(arguments);var _701=_6f5("cb/user/UserDisplay").Extended;this._userDisplay=new _701({profileImageSize:"large",userDialogClass:null},_6f7.create("div",null,this.domNode,"first"));},_setUserAttr:function(user){this._userDisplay.set("userId",user?user.id:null);this._set("user",user);this.set("myself",user?user.id===sp.info.user.info.id:false);},_setCompanyAttr:function(_702){this._userDisplay.set("companyId",_702?_702.id:null);this._set("company",_702);},_setMyselfAttr:function(_703){_6f6.toggle(this._guestLoginNode,"hideBlock",!(_703&&!sp.info.user.isIdentified&&this.loginEnabled));_6f6.toggle(this._logoutNode,"hideBlock",!(_703&&sp.info.user.isIdentified&&this.logoutEnabled));this._set("myself",_703);},_updateUserInformation:function(){if(this.user.namedGuest||this.user.visitor){_6f6.toggle(this._userLicence,"hideBlock");this._userLicence.innerHTML=_6fb.wrap(i18n)("licence_guest");if(this.isMyself){_6f6.toggle(this._userLogin,"hideBlock");this._userLogin.innerHTML=_6fb.wrap(i18n)("guest_login");this._userLicence.innerHTML=_6fb.wrap(i18n)("licence_guest_myself");}}if(this.isMyself){_6f6.toggle(this._myselfIndicator,"hideBlock");}if(this.company||this.user.company!==""){_6f6.toggle(this._descriptionLine,"hideBlock");var _704=_6fb.esc(this.user.company!==""?this.user.company:"");var _705=" "+(this.company&&this.user.company!==""?_6fb.wrap(i18n)("at_company_prefix"):"")+" ";var _706=_6fb.esc(this.company?this.company.name:"");this._descriptionLine.innerHTML=_704+_705+_706;}if(this.user.phone!==""){_6f6.toggle(this._detailsLine,"hideBlock");this._detailsLine.innerHTML=_6fb.esc(this.user.phone);}}});return dojo.declare([_6f9],{complexOrient:["below","above","after-centered","before-centered","after","before"],baseClass:"user-profile-dialog",invisibleMilk:true,loginEnabled:false,logoutEnabled:false,postCreate:function(){this.inherited(arguments);new _700({dialog:this,user:this.user,company:this.company,loginEnabled:this.loginEnabled,logoutEnabled:this.logoutEnabled});}});});},"cb/page/boards/toolbar/Toolbar":function(){define(["dojo","dojo/_base/declare","dojo/dom-class","dojo/dom-construct","dojo/on","cb/Capabilities","cb/widget/PortfolioSelect","sp/dialog/NewPortfolioDialog","dijit/_Widget","cb/widget/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dijit/registry","sp/I18nWidget","cb/util","dojo/text!./Toolbar.html","dojo/i18n!./nls/Toolbar","dijit/form/Select"],function(dojo,_707,_708,_709,on,_70a,_70b,_70c,_70d,_70e,_70f,_710,_711,_712,_713,i18n,_714){return _707([_70d,_70e,_70f,_711],{templateString:_713,i18n:i18n,portfolioId:null,postCreate:function(){this.inherited(arguments);this._setupSearchControls();this._setupSortControls();this._setupDisplayTypeControls();this._setupProjectSelectControls();},_setupSearchControls:function(){this.subscribe("/cb/page/boards/displaySettings/changed/search",function(_715){this._searchSubmit.set("value",_715);});this.connect(this._searchSubmit,"onChange",function(_716){dojo.publish("/cb/page/boards/displaySettings/set/search",_716);});},_setupSortControls:function(){this.subscribe("/cb/page/boards/displaySettings/changed/sort",function(_717){this._sortSelect.set("value",_717.toLowerCase());});this.connect(this._sortSelect,"onChange",function(_718){dojo.publish("/cb/page/boards/displaySettings/set/sort",_718.toUpperCase());});},_setupDisplayTypeControls:function(){this.subscribe("/cb/page/boards/displaySettings/changed/displayType",function(_719){_708.toggle(this._displayTypeNormalNode,"active",_719==="COMBINED");_708.toggle(this._displayTypeFlatNode,"active",_719!=="COMBINED");});this.connect(this._displayTypeNormalNode,"click",function(){dojo.publish("/cb/page/boards/displaySettings/set/displayType","COMBINED");});this.connect(this._displayTypeFlatNode,"click",function(){dojo.publish("/cb/page/boards/displaySettings/set/displayType","ONLYDOCUMENTS");});},_setupProjectSelectControls:function(){var _71a=new _70b({portfolioId:this.portfolioId,createNewItemOption:false,defaultSelectProjects:true},this._projectSelectContainer);this.subscribe("/cb/page/boards/displaySettings/changed/portfolioId",function(_71b){_71a.set("value",{type:"option",value:_71b});});this.own(on(_71a,"change",dojo.hitch(this,function(){if(_71a.value.value!=="default_selection"){dojo.publish("/cb/page/boards/displaySettings/set/portfolioId",_71a.value.value);}else{dojo.publish("/cb/page/boards/displaySettings/set/filter","ALL");}})));_70a.checkPortfolios().then(dojo.hitch(this,function(_71c){if(_71c==="premium"){_709.destroy(this._createPortfolioButton);}}));},_onCreatePortfolioButtonClick:function(){var _71d=new _70c();_71d.show();}});});},"url:dijit/form/templates/CheckBox.html":"<div class=\"dijit dijitReset dijitInline\" role=\"presentation\"\n\t><input\n\t \t${!nameAttrSetting} type=\"${type}\" role=\"${type}\" aria-checked=\"false\" ${checkedAttrSetting}\n\t\tclass=\"dijitReset dijitCheckBoxInput\"\n\t\tdata-dojo-attach-point=\"focusNode\"\n\t \tdata-dojo-attach-event=\"onclick:_onClick\"\n/></div>\n","cb/contacts/RoleSelect":function(){define(["dojo/on","dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/dom-class","dojo/dom-attr","dojox/lang/functional","dijit/_WidgetBase","dijit/form/Select","cb/widget/_HideableMixin","cb/Capabilities","sp/I18n","dojo/i18n!./nls/Contacts"],function(on,lang,_71e,_71f,_720,_721,_722,_723,_724,_725,_726,_727,_728,i18n){var I18N=_728.wrap(i18n);var _729={manager:["user","manager"],user:["user"],external_user:["external_user"],student:["student"]};var _72a=["manager","user","external_user"];if(sp.info.user.info.accountType.education){_72a.push("student");}function _72b(_72c){if(_71e.indexOf(_72c,"manager")>-1){return "manager";}else{if(_71e.indexOf(_72c,"user")>-1){return "user";}else{if(_71e.indexOf(_72c,"external_user")>-1){return "external_user";}else{if(_71e.indexOf(_72c,"student")>-1){return "student";}else{return null;}}}}};function _72d(_72e){return _729[_72e]||null;};var _72f=_71f([],{postMixInProperties:function(){this.inherited(arguments);this.own(this.watch("value",lang.hitch(this,function(attr,_730,_731){this.set("roles",this._valueToRoles(_731));})));},_valueToRoles:function(_732){return _72d(_732);},_rolesToValue:function(_733){return _72b(_733);},_setRolesAttr:function(_734){var v=this._rolesToValue(_734);this.set("value",v);this._set("roles",_734);},_getRolesAttr:function(){return this._valueToRoles(this.get("value"));}});var _735=_71f([_724,_726,_72f],{value:"user",postMixInProperties:function(){this.inherited(arguments);this.availableValues=this.availableValues||_72a.slice();},buildRendering:function(){this.inherited(arguments);_721.add(this.domNode,"role-select");var _736=this.containerNode=_720.create("ul",{"class":"role-select__options radiogroup"},this.domNode);var _737=this._radioNodes={};_71e.map(this.availableValues,function(_738){var _739=this._createRadioNode(_738);_737[_738]=_739;},this);},postCreate:function(){this.inherited(arguments);this.own(on(this.domNode,"input[type=radio]:change",lang.hitch(this,this._handleRadioChange)));},_setDisabledValuesAttr:function(_73a){_71e.forEach(this.availableValues,function(v){this._setValueDisabled(v,_71e.indexOf(_73a,v)!==-1);},this);this._set("disabledValues",_73a);},_setValueDisabled:function(v,_73b){if(_73b&&v===this.get("value")){this.set("value",null);}var node=this._radioNodes[v];if(!node){return;}_722.set(node,"disabled",_73b);_721.toggle(node.parentNode.parentNode,"dijitRadioDisabled",_73b);},_createRadioNode:function(_73c){var li=_720.create("li",{"class":"radiogroup-entry"},this.containerNode);var _73d=this.get("id")+"_radio";var _73e=_73d+"_"+_73c;var _73f=_720.create("input",{"type":"radio","name":_73d,"id":_73e,"value":_73c,"title":I18N("role_title_"+_73c),"class":"role-select__option"},li);var _740=_720.create("label",{"for":_73e,"innerHTML":I18N("role_"+_73c),"title":I18N("role_title_"+_73c),"class":"role-select__label"},li);return _73f;},_handleRadioChange:function(e){var v=_722.get(e.target,"value");if(v){this.set("value",v);}},_setValueAttr:function(_741){_723.forIn(this._radioNodes,function(node,_742){_722.set(node,"checked",_741===_742);_721.toggle(node.parentNode,"dijitRadioChecked",_741===_742);_721.toggle(node.parentNode.parentNode,"checked",_741===_742);});dojo.query(this.domNode).closest(".invite-tool__container").toggleClass("basic-checked",_741==="basic");this._set("value",_741);}});var _743=_71f([_725,_726,_72f],{postMixInProperties:function(){this.inherited(arguments);this.availableValues=this.availableValues||_72a.slice(0);this.options=_71e.map(this.availableValues,function(_744){return {value:_744,label:I18N("role_"+_744)};});}});_743.RolesTranslationMixin=_72f;_743.util={rolesToValue:_72b,valueToRoles:_72d};_743.RadioGroup=_735;return _743;});},"cb/user/ComboBoxMenu":function(){define(["dojo/_base/declare","dojo/_base/lang","dijit/registry","dijit/form/_ComboBoxMenu","./UserDisplay"],function(_745,lang,_746,_747,_748){return _745([_747],{baseClass:"dijitComboBoxMenu user-select-dropdown pretty-scrollbars",createOptions:function(){this.inherited(arguments);},_createOption:function(item,_749){var _74a={userDialogClass:null};if(item.type==="loading"){var _74b=this._createMenuItem();_74b.innerHTML="<strong>Loading</strong>";return _74b;}if(item.email){_74a.emailAdresses={unconfirmedEmailAdress:item.email};}if(item.displayname){_74a.displayname=item.displayname;}if(item.contact){_74a.contact=item.contact;}if(item.userId){_74a.userId=item.userId;}var _74c=new _748(_74a);return _74c.domNode;},clearResultList:function(){var _74d=this.containerNode,node,_74e;while(_74d.childNodes.length>2){node=_74d.childNodes[_74d.childNodes.length-2];_74e=_746.byNode(node);if(_74e){_74e.destroyRecursive();}else{_74d.removeChild(node);}}this._setSelectedAttr(null);}});});},"cb/util-url":function(){define([],function(){var ret={};ret.fixUrlForParams=function fixUrlForParams(url){if(url.search(/[&?]$/)!==-1){return url;}else{if(url.lastIndexOf("?")===-1){return url+"?";}else{return url+"&";}}};ret.addParamToUrl=function addParamToUrl(url,name,_74f){url=ret.fixUrlForParams(url);url=url+encodeURIComponent(name)+"="+((_74f===undefined||_74f===null)?"":encodeURIComponent(_74f));return url;};return ret;});},"cb/personalcontainer/container/LogoContainer":function(){define(["dojo/_base/declare","dojo/dom-construct","dojo/dom-class","dojo/dom-attr","dijit/_Widget","cb/widget/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","sp/I18n","dojo/i18n!./nls/LogoContainer","dojo/text!./LogoContainer.html"],function(_750,_751,_752,_753,_754,_755,_756,_757,i18n,_758){return _750([_754,_755,_756],{i18n:i18n,templateString:_758,company:null,widgetsInTemplate:true,constructor:function(){if(!this.company){this.company=sp.info.pageBrandCompany;}},buildRendering:function(){this.inherited("buildRendering",arguments);if(this.company){_752.remove(this._logoNode,"empty");if(this.company.hasCompanylogo){_753.set(this._imgNode,"src","/__/companylogo/"+_757.escAttr(this.company.id)+".standard.png");}else{_751.create("img",{"class":"signet","src":"/_/images/logo_signet_56x48.png"},this._logoNode);_751.create("span",{"class":"company-name",innerHTML:_757.esc(this.company.name)},this._logoNode);_751.destroy(this._imgNode);}}}});});},"cb/page/upgrade/Page":function(){define(["dojo/dom","dojo/on","dojo/dom-class","cb/Capabilities"],function(dom,on,_759,_75a){var _75b=false;var _75c=dom.byId("email-form");var _75d=dom.byId("email-cancel");var _75e=dom.byId("email-show");var _75f=function(){_759.toggle(_75c,"inactive");};var _760=function(){on(_75d,"click",_75f);on(_75e,"click",_75f);};var init=function init(){if(_75b){return;}_760();};return {init:init};});},"url:sp/dialog/NewPortfolioDialog.html":"<div>\r\n    <div class=\"margin\" data-dojo-attach-point=\"_documentCreateForm\">\r\n        <input type=\"text\" tabindex=\"1\" data-dojo-attach-point=\"_nameInput\" class=\"full-width board-title\" id=\"${id}_name\" value=\"\" placeholder=\"${!i18n.default_board_title}\"/>\r\n        <hr/>\r\n        <div class=\"passphrase\" data-dojo-attach-point=\"_passphraseContainer\">\r\n            <span type=\"checkbox\" id=\"${id}_passphrase\" data-dojo-type=\"cb.widget.BigSwitch\" tabindex=\"30\" data-dojo-attach-event=\"onChange:_handlePassphraseSwitchChange\" data-dojo-attach-point=\"_passphraseSwitch\">&nbsp;<i class=\"fonticon-lock fonticon-large\"></i>&nbsp;&nbsp;${passphraseLabel}</span>\r\n            <span class=\"passphrase-disabled-help\" id=\"${id}_passphrase_help\" data-dojo-attach-point=\"_passphraseTooltip_connect\">\r\n                <i class=\"fonticon fonticon-large fonticon-question\"></i>\r\n            </span>                        \r\n            <input type=\"text\" class=\"input-passphrase hideBlock\" data-dojo-attach-point=\"_passphraseInput\" value=\"\" placeholder=\"${!i18n.default_passphrase}\"/>\r\n        </div>\r\n        <div class=\"dialog-action\">\r\n            <span class=\"button call-to-action full-width large\" data-dojo-attach-event=\"click:_handleCreateButtonClick\">${!i18n.create_board_button}&nbsp;&nbsp;<i class=\"fonticon-circlearrow-right fonticon-large\"></i></span>\r\n        </div>\r\n    </div>\r\n    <div class=\"hideBlock\" data-dojo-attach-point=\"_documentCreateIndicator\">\r\n        <div class=\"activity-indicator\">${!i18n.redirect_message}</div>\r\n    </div>\r\n    <div class=\"dialog-title\">\r\n        ${!i18n.dialog_title}\r\n        <div data-dojo-attach-event=\"click:_handleCloseButtonClick\" class=\"dialog-close-button\" title=\"close\"><i class=\"fonticon-cross\"></i></div>\r\n    </div>\r\n</div>","url:cb/contacts/InviteToolEmail.html":"<div>\r\n    <fieldset>\r\n        <ul class=\"address-fields\">\r\n            <li class=\"intro\">\r\n                <i class=\"fonticon-participant\"></i>\r\n                <div class=\"user-tags user-tags-checked\"><div class=\"user-tags__tag user-tags__tag\">BASIC</div><div class=\"user-tags__tag user-tags__tag--pro\">PRO</div></div>\r\n            </li>\r\n            <li>\r\n                <label class=\"for-input-with-placeholder\" for=\"${id}_nameInput\">${!i18n.invite_tool_email_name_label}</label>\r\n                <input id=\"${id}_nameInput\" type=\"text\" class=\"large full-width\" data-dojo-attach-point=\"_nameInputNode\" title=\"${!i18n.invite_tool_email_name_label}\" placeholder=\"${!i18n.invite_tool_email_name_label}\" />\r\n            </li>\r\n            <li>\r\n                <label class=\"for-input-with-placeholder\" for=\"${id}_emailInput\">${!i18n.invite_tool_email_email_label}</label>\r\n                <input id=\"${id}_emailInput\" type=\"text\" class=\"large full-width\" data-dojo-attach-point=\"_emailInputNode\" title=\"${!i18n.invite_tool_email_email_label}\" placeholder=\"${!i18n.invite_tool_email_email_label}\" />\r\n            </li>\r\n         </ul>\r\n         \r\n         <div class=\"modalities\">\r\n            <div class=\"modalities-free\"><span data-dojo-attach-point=\"_modalitiesBasic\">${!i18n.modalities_basic}</span></div>\r\n            <div class=\"modalities-spacer\">&nbsp;</div>\r\n            <div class=\"modalities-team\"><span data-dojo-attach-point=\"_modalitiesTeam\">${!i18n.modalities_team}</span></div>\r\n         </div>\r\n         \r\n         <div data-dojo-attach-point=\"_roleSelect\" data-dojo-type=\"cb/contacts/RoleSelectRadioPanes\"></div>\r\n\r\n         <div class=\"send-container\">\r\n            <div class=\"team-overlay hideBlock\" data-dojo-attach-point=\"_teamOverlay\"><div class=\"team-overlay-msg\" data-dojo-attach-point=\"_teamMessage\"></div></div>\r\n            <p>${!i18n.email_message_content_hint}</p>\r\n            <button style=\"width:300px;\" class=\"large\" type=\"submit\" data-dojo-attach-event=\"click:_handleSubmitClick\" data-dojo-attach-point=\"_submitButtonNode\">${!i18n.invite_submit}</button>\r\n         </div>\r\n\r\n    </fieldset>\r\n</div>","url:sp/dialog/UpgradeDialogPane.html":"<div class=\"feature-slide feature-slide-@@PANE_ID@@\" id=\"${id}_@@PANE_ID@@\">\r\n    <div class=\"dialog-title\">\r\n        ${!i18n.@@PANE_ID@@_title}\r\n        <div data-dojo-attach-event=\"click:_handleCloseButtonClick\" class=\"dialog-close-button\" title=\"close\"><i class=\"fonticon-cross\"></i></div>\r\n    </div>\r\n    <div class=\"margin\">\r\n        <div class=\"image-container\">\r\n            <img src=\"${!i18n.@@PANE_ID@@_image_src}\" alt=\"${!i18n.@@PANE_ID@@_image_alt}\" data-dojo-attach-point=\"imageNode_@@PANE_ID@@\" class=\"feature-image\"/>\r\n        </div>\r\n        <div class=\"teaser-text\">\r\n            <p>${!i18n.@@PANE_ID@@_text}</p>\r\n            <ul class=\"paragraph\">${!i18n.@@PANE_ID@@_list}</ul>\r\n        </div>\r\n    </div>\r\n</div>","cb/widget/ParticipantList":function(){define(["dojo","dojo/_base/declare","sp/I18n","sp/infos/InfoManager","./UserList","./UserIconListEntry","cb/user/ParticipantManager","dojo/i18n!wp/widget/nls/ParticipantsList"],function(dojo,_761,_762,_763,_764,_765,_766,_767){var _768=_761([_765],{buildRendering:function(){this.inherited(arguments);var _769=this._detailsContainer=dojo.create("div",{"class":"details"},this.domNode,"last");this._detailsName=dojo.create("strong",{"class":"name"},_769);dojo.place(dojo.doc.createTextNode(" "),_769);this._detailsNameDetail=dojo.create("span",{"class":"name-detail"},_769);dojo.create("br",null,_769);dojo.place(this._userTags.domNode,_769);dojo.addClass(this._userTags.domNode,"hideBlock");this._detailsOnlineBadge=dojo.create("span",{innerHTML:_762.wrap(_767)("state_online"),"class":"online-badge"},_769);this._detailsLastAccess=dojo.create("span",{"class":"last-access-att"},_769);},update:function(_76a){this.inherited("update",arguments);if(!_76a){return;}if(this._destroyed){return;}var _76b=_76a.participant;if(!_76b){return;}if(_76b.id!==this.userid){console.warn("ParticipantWidget for ",this.userid,"can not be updated with",_76b);return;}dojo.toggleClass(this.domNode,"myself",_76b.id===sp.info.user.info.id);if(_76b.id===sp.info.user.info.id){dojo.html.set(this._detailsNameDetail,_762.wrap(_767)("name_detail_myself"));}else{dojo.html.set(this._detailsNameDetail,_762.esc(_76b.displaynameDetail||""));}dojo.html.set(this._detailsName,_762.esc(_76b.displayname||""));dojo.attr(this._detailsName,"title",_76b.displayname||"");this._userTags.set("tags",{online:_76b.state==="online"});if(_76b.state==="online"){dojo.removeClass(this._detailsOnlineBadge,"hideBlock");dojo.html.set(this._detailsLastAccess,"");dojo.addClass(this._detailsLastAccess,"hideBlock");}else{if(_76b.lastAccessedAt){dojo.addClass(this._detailsOnlineBadge,"hideBlock");dojo.html.set(this._detailsLastAccess,_762.wrap(_767)("last_accessed_at",[_76b.lastAccessedAt]));dojo.removeClass(this._detailsLastAccess,"hideBlock");}else{dojo.addClass(this._detailsOnlineBadge,"hideBlock");dojo.html.set(this._detailsLastAccess,_762.wrap(_767)("last_accessed_at_invited"));dojo.removeClass(this._detailsLastAccess,"hideBlock");}}}});return _761([_764],{baseClass:"participant-list-widget",entryWidgetConstructor:_768,participantManager:null,documentId:null,postMixInProperties:function(){this.inherited(arguments);this.queryOptions={sort:[{attribute:"sortKeyOwner"},{attribute:"sortKeyUserPhoto"},{attribute:"sortKeyAccountType"},{attribute:"sortKeyMyself"},{attribute:"sortKey"}]};if(this.participantManager===null){this.participantManager=new _766({documentId:this.documentId});}},postCreate:function(){this.inherited(arguments);dojo.addClass(this.domNode,"pretty-scrollbars");this.connect(this.participantManager,"onNewUser","addParticipant");this.connect(this.participantManager,"onChangedUser","addParticipant");dojo.forEach(this.participantManager.getAllParticipants(),dojo.hitch(this,"addParticipant"));},getDataEnrichmentMixin:function(_76c,_76d,_76e){return {sortKeyOwner:_76c===this.participantManager.getPadOwnerId()?-1:1,sortKeyUserPhoto:_76d.hasUserPhoto?-1:1,sortKeyAccountType:_76d.visitor?2:(_76d.namedGuest?1:-1),sortKeyMyself:_76c===this.ownUserId?1:-1,myself:_76c===this.ownUserId};},addParticipant:function(_76f){return _763.getById({type:"user",id:_76f.id}).then(dojo.hitch(this,function(_770){return this.addUser(_76f.id,_770.user,{participant:_76f});})).then(function(){return true;});},addUsers:function(){throw "this call is unsupported from this widget";}});});},"cb/widget/FilterableListWidget":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/Deferred","dojo/dom-construct","dojo/dom-attr","dojo/dom-class","dojo/topic","dojo/behavior","dijit/_Widget","cb/widget/_TemplatedMixin","dijit/_Container","dijit/_Contained","cb/widget/SimpleTable","sp/err","sp/I18n","sp/ajax/AjaxEngine","sp/infos/InfoManager","dojo/i18n!./nls/WidgetCommon"],function(_771,lang,dArr,_772,_773,_774,_775,_776,_777,_778,_779,_77a,_77b,_77c,err,_77d,_77e,_77f,i18n){var _780=_771([_778],{status:"init",STATUS_CHANGES:{"init":{"loading":true,"error":true,"init":true},"loading":{"nonempty":true,"empty":true,"error":true},"error":{loading:true},"empty":{"nonempty":true,"error":true},"nonempty":{"empty":true,"error":true}},STATUSES:{"init":{},"loading":{},"error":{},"empty":{},"nonempty":{hidden:true}},_setStatusAttr:function(_781){if(this.status===_781){return;}var _782=this.STATUS_CHANGES[this.status];if(!_782){return;}var _783=_782[_781];if(!_783){return;}this._set("status",_781);var _784=this.STATUSES[_781];_774.set(this.domNode,"innerHTML",_77d.wrap(i18n)("list_status_"+_781));_775.add(this.domNode,"status-node "+_781);_775.toggle(this.domNode,"hideBlock",!!_784.hidden);}});var _785=_771([_778],{baseClass:"filterable-list-widget-input filterable-list__input",buildRendering:function(){this.domNode=_773.create("input",{"class":"full-width","type":"text",placeholder:_77d.wrap(i18n)("filterable_list_widget_input_placeholder")});this.inherited(arguments);},postCreate:function(){this.inherited(arguments);var _786=null;this.connect(this.domNode,"keyup",function(){var self=this;if(_786){window.clearTimeout(_786);}_786=window.setTimeout(function(){self._fireChangeEventIfNeeded();},100);});this.connect(this.domNode,"change",this._fireChangeEventIfNeeded);},_fireChangeEventIfNeeded:function(){var _787=_774.get(this.domNode,"value");if(this._oldValue!=_787){this._oldValue=_787;var self=this;window.setTimeout(function(){self.onChange(_787,self._oldValue);},1);}}});var _788=_771([_77c],{type:"list",baseClass:"filterable-list-widget-list filterable-list__list",changeQueryNoStoreReload:function(_789,_78a){var _78b=this.store.query(this.query,this.queryOptions);_772.when(_78b,lang.hitch(this,function(_78c){dojo.forEach(_78c,function(_78d){var id=this.store.getIdentity(_78d);this.handleRemovedItem(id,_78d);},this);}));if(this.currentObserver){this.currentObserver.cancel();}this.query=(_789||this.query)||{};this.queryOptions=(_78a||this.newQueryOptions)||{};var _78e=this.store.query(this.query,this.queryOptions);this.currentObserver=_78e.observe(dojo.hitch(this,function(_78f,_790,_791){var id=this.store.getIdentity(_78f);if(_790===-1){this.handleNewItem(id,_78f,_791);}else{if(_791===-1){this.handleRemovedItem(id,_78f);}else{this.handleItemReordered(id,_78f,_790,_791);}}}),true);_772.when(_78e,dojo.hitch(this,function(_792){dojo.forEach(_792,function(_793,_794){var id=this.store.getIdentity(_793);this.handleNewItem(id,_793,_794);},this);}));}});var _795=_771([_778],{baseClass:"filterable-list-widget  filterable-list",postCreate:function(){this.inherited(arguments);this.status=new _780(null);this.filteringInput=new _785(null);this.filteringList=(_771([_788],{createEntryWidget:(function(fn){return function(){var ret=fn.apply(this,arguments);if(ret){_775.add(ret.domNode,"filterable-list__list__entry");}return ret;};})(this.createEntryWidget),_handleWidgetClick:this._handleWidgetClick,onInvite:this.onInvite}))(null);this.connect(this.filteringList,"onInvite","onInvite");this.connect(this.filteringInput,"onChange",function(_796,_797){this.filteringList.changeQueryNoStoreReload({searchfield:new RegExp(".*"+_796+".*")},null);});_773.place(this.filteringInput.domNode,this.domNode);_773.place(this.status.domNode,this.domNode);_773.place(this.filteringList.domNode,this.domNode);this.connect(this.filteringList,"onNewItem, onItemReordered, onRemovedItem, onStoreLoadFinished","_checkEmptiness");},onInvite:function(item){},add:function(item){this.filteringList.store.put(item);},_checkEmptiness:function(){this.set("status",this.filteringList.isEmpty()?"empty":"nonempty");},_setStatusAttr:function(_798){this.status.set("status",_798);}});_795.FilteringInput=_785;_795.FilterableList=_788;return _795;});},"url:cb/user/UserDisplay.html":"<div class=\"user-display\">\r\n    <div class=\"profile-image\" data-dojo-attach-point=\"_profileImageNode\">\r\n        <div class=\"profile-image__initials\" data-dojo-attach-point=\"_profileImageInitialsNode\"></div>\r\n        <img class=\"profile-image__image\" data-dojo-attach-point=\"_profileImageImgNode\" src=\"/_/images/blank_1x1.png\"/>\r\n    </div>\r\n    <div class=\"user-display__details\" data-dojo-attach-point=\"_detailsNode\">\r\n        <div class=\"user-display__details__displayname\" data-dojo-attach-point=\"_displaynameNode\"></div>\r\n        <div class=\"user-display__details__subline__container\">\r\n            <span class=\"user-display__details__subline\" data-dojo-attach-point=\"_sublineNode\"></span>\r\n        </div>\r\n        <div class=\"user-display__extended__container\" data-dojo-attach-point=\"_extendedNode\"></div>\r\n        <div data-dojo-attach-point=\"_tagsNode\"></div>\r\n        <div class=\"user-display__noemailbadge hideBlock\" data-dojo-attach-point=\"_noemailbadgeNode\"><i class=\"fonticon-email-warning\"></i></div>\r\n    </div>\r\n</div>","cb/user/UserStats":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/dom-construct","dojo/_base/array","dojox/lang/functional/object","dijit/_WidgetBase","cb/api/Api","sp/I18n","dojo/i18n!./nls/User"],function(_799,lang,_79a,_79b,_79c,_79d,Api,_79e,i18n){var I18N=_79e.wrap(i18n);var _79f=["boardsCreated","portfoliosCreated","taskAssignedAndClosed"];var _7a0=_799([_79d],{baseClass:"minimal-stat",stat:null,buildRendering:function(){this.inherited(arguments);this.domNode=_79a.create("span",{"class":this.baseClass});},postCreate:function(){this.inherited(arguments);var _7a1=_79c.keys(this.stat)[0];_79a.create("span",{"class":"number",innerHTML:_79e.esc(this.stat[_7a1])},this.domNode);_79a.create("span",{"class":"label",innerHTML:_79e.wrap(i18n)("statlabel_"+_7a1)},this.domNode);}});return _799([_79d],{baseClass:"user-stats",postCreate:function(){this.inherited(arguments);Api.Caching.users_me_statistics.get().then(lang.hitch(this,function(_7a2){_79b.forEach(_79f,function(item,_7a3){if(item in _7a2.data){var _7a4={};_7a4[item]=_7a2.data[item];_79a.place(new _7a0({stat:_7a4}).domNode,this.domNode);}},this);}));}});});},"cb/ext/skrollr":function(){define([],function(){return (function(_7a5,_7a6,_7a7){"use strict";var _7a8={get:function(){return _7a9;},init:function(_7aa){return _7a9||new _7ab(_7aa);},VERSION:"0.6.9"};var _7ac=Object.prototype.hasOwnProperty;var Math=_7a5.Math;var _7ad=_7a5.getComputedStyle;var _7ae;var body;var _7af="touchstart";var _7b0="touchmove";var _7b1="touchcancel";var _7b2="touchend";var _7b3="skrollable";var _7b4=_7b3+"-before";var _7b5=_7b3+"-between";var _7b6=_7b3+"-after";var _7b7="skrollr";var _7b8="no-"+_7b7;var _7b9=_7b7+"-desktop";var _7ba=_7b7+"-mobile";var _7bb="linear";var _7bc=1000;var _7bd=0.0006;var _7be=200;var _7bf="start";var _7c0="end";var _7c1="center";var _7c2="bottom";var _7c3="___skrollable_id";var _7c4=/^\s+|\s+$/g;var _7c5=/^data(?:-(_\w+))?(?:-?(-?\d+))?(?:-?(start|end|top|center|bottom))?(?:-?(top|center|bottom))?$/;var _7c6=/\s*([\w\-\[\]]+)\s*:\s*(.+?)\s*(?:;|$)/gi;var _7c7=/^([a-z\-]+)\[(\w+)\]$/;var _7c8=/-([a-z])/g;var _7c9=function(str,_7ca){return _7ca.toUpperCase();};var _7cb=/[\-+]?[\d]*\.?[\d]+/g;var _7cc=/\{\?\}/g;var _7cd=/rgba?\(\s*-?\d+\s*,\s*-?\d+\s*,\s*-?\d+/g;var _7ce=/[a-z\-]+-gradient/g;var _7cf="";var _7d0="";var _7d1=function(){var _7d2=/^(?:O|Moz|webkit|ms)|(?:-(?:o|moz|webkit|ms)-)/;if(!_7ad){return;}var _7d3=_7ad(body,null);for(var k in _7d3){_7cf=(k.match(_7d2)||(+k==k&&_7d3[k].match(_7d2)));if(_7cf){break;}}if(!_7cf){_7cf=_7d0="";return;}_7cf=_7cf[0];if(_7cf.slice(0,1)==="-"){_7d0=_7cf;_7cf=({"-webkit-":"webkit","-moz-":"Moz","-ms-":"ms","-o-":"O"})[_7cf];}else{_7d0="-"+_7cf.toLowerCase()+"-";}};var _7d4=function(){var _7d5=_7a5.requestAnimationFrame||_7a5[_7cf.toLowerCase()+"RequestAnimationFrame"];var _7d6=_7d7();if(_7d8||!_7d5){_7d5=function(_7d9){var _7da=_7d7()-_7d6;var _7db=Math.max(0,1000/60-_7da);_7a5.setTimeout(function(){_7d6=_7d7();_7d9();},_7db);};}return _7d5;};var _7dc={begin:function(){return 0;},end:function(){return 1;},linear:function(p){return p;},quadratic:function(p){return p*p;},cubic:function(p){return p*p*p;},swing:function(p){return (-Math.cos(p*Math.PI)/2)+0.5;},sqrt:function(p){return Math.sqrt(p);},outCubic:function(p){return (Math.pow((p-1),3)+1);},bounce:function(p){var a;if(p<=0.5083){a=3;}else{if(p<=0.8489){a=9;}else{if(p<=0.96208){a=27;}else{if(p<=0.99981){a=91;}else{return 1;}}}}return 1-Math.abs(3*Math.cos(p*a*1.028)/a);}};function _7ab(_7dd){_7ae=_7a6.documentElement;body=_7a6.body;_7d1();_7a9=this;_7dd=_7dd||{};_7de=_7dd.constants||{};if(_7dd.easing){for(var e in _7dd.easing){_7dc[e]=_7dd.easing[e];}}_7df=_7dd.edgeStrategy||"set";_7e0={beforerender:_7dd.beforerender,render:_7dd.render};_7e1=_7dd.forceHeight!==false;if(_7e1){_7e2=_7dd.scale||1;}_7e3=_7dd.smoothScrolling!==false;_7e4=_7dd.smoothScrollingDuration||_7be;_7e5={targetTop:_7a9.getScrollTop()};_7d8=((_7dd.mobileCheck||function(){return (/Android|iPhone|iPad|iPod|BlackBerry|Windows Phone/i).test(navigator.userAgent||navigator.vendor||_7a5.opera);})());if(_7d8){_84c=_7a6.getElementById("skrollr-body");if(_84c){_86b();}_80f();_7fd(_7ae,[_7b7,_7ba],[_7b8]);}else{_7fd(_7ae,[_7b7,_7b9],[_7b8]);}_7a9.refresh();_81b(_7a5,"resize orientationchange",_7fe);var _7e6=_7d4();var _7e7=function(){_7e8();_7e6(_7e7);};_7e7();return _7a9;};_7ab.prototype.refresh=function(_7e9){var _7ea;var _7eb;var _7ec=false;if(_7e9===_7a7){_7ec=true;_7ed=[];_7ee=0;_7e9=_7a6.getElementsByTagName("*");}else{_7e9=[].concat(_7e9);}_7ea=0;_7eb=_7e9.length;for(;_7ea<_7eb;_7ea++){var el=_7e9[_7ea];var _7ef=el;var _7f0=[];var _7f1=_7e3;var _7f2=_7df;if(!el.attributes){continue;}var _7f3=0;var _7f4=el.attributes.length;for(;_7f3<_7f4;_7f3++){var attr=el.attributes[_7f3];if(attr.name==="data-anchor-target"){_7ef=_7a6.querySelector(attr.value);if(_7ef===null){throw "Unable to find anchor target \""+attr.value+"\"";}continue;}if(attr.name==="data-smooth-scrolling"){_7f1=attr.value!=="off";continue;}if(attr.name==="data-edge-strategy"){_7f2=attr.value;continue;}var _7f5=attr.name.match(_7c5);if(_7f5===null){continue;}var _7f6=_7f5[1];_7f6=_7f6&&_7de[_7f6.substr(1)]||0;var _7f7=(_7f5[2]|0)+_7f6;var _7f8=_7f5[3];var _7f9=_7f5[4]||_7f8;var kf={offset:_7f7,props:attr.value,element:el};_7f0.push(kf);if(!_7f8||_7f8===_7bf||_7f8===_7c0){kf.mode="absolute";if(_7f8===_7c0){kf.isEnd=true;}else{kf.frame=_7f7*_7e2;delete kf.offset;}}else{kf.mode="relative";kf.anchors=[_7f8,_7f9];}}if(!_7f0.length){continue;}var _7fa,_7fb;var id;if(!_7ec&&_7c3 in el){id=el[_7c3];_7fa=_7ed[id].styleAttr;_7fb=_7ed[id].classAttr;}else{id=(el[_7c3]=_7ee++);_7fa=el.style.cssText;_7fb=_7fc(el);}_7ed[id]={element:el,styleAttr:_7fa,classAttr:_7fb,anchorTarget:_7ef,keyFrames:_7f0,smoothScrolling:_7f1,edgeStrategy:_7f2};_7fd(el,[_7b3],[]);}_7fe();_7ea=0;_7eb=_7e9.length;for(;_7ea<_7eb;_7ea++){var sk=_7ed[_7e9[_7ea][_7c3]];if(sk===_7a7){continue;}_7ff(sk);_800(sk);}return _7a9;};_7ab.prototype.relativeToAbsolute=function(_801,_802,_803){var _804=_7ae.clientHeight;var box=_801.getBoundingClientRect();var _805=box.top;var _806=box.bottom-box.top;if(_802===_7c2){_805-=_804;}else{if(_802===_7c1){_805-=_804/2;}}if(_803===_7c2){_805+=_806;}else{if(_803===_7c1){_805+=_806/2;}}_805+=_7a9.getScrollTop();return (_805+0.5)|0;};_7ab.prototype.animateTo=function(top,_807){_807=_807||{};var now=_7d7();var _808=_7a9.getScrollTop();_809={startTop:_808,topDiff:top-_808,targetTop:top,duration:_807.duration||_7bc,startTime:now,endTime:now+(_807.duration||_7bc),easing:_7dc[_807.easing||_7bb],done:_807.done};if(!_809.topDiff){if(_809.done){_809.done.call(_7a9,false);}_809=_7a7;}return _7a9;};_7ab.prototype.stopAnimateTo=function(){if(_809&&_809.done){_809.done.call(_7a9,true);}_809=_7a7;};_7ab.prototype.isAnimatingTo=function(){return !!_809;};_7ab.prototype.setScrollTop=function(top,_80a){if(_80a===true){_80b=top;_80c=true;}if(_7d8){_80d=Math.min(Math.max(top,0),_80e);}else{_7a5.scrollTo(0,top);}return _7a9;};_7ab.prototype.getScrollTop=function(){if(_7d8){return _80d;}else{return _7a5.pageYOffset||_7ae.scrollTop||body.scrollTop||0;}};_7ab.prototype.on=function(name,fn){_7e0[name]=fn;return _7a9;};_7ab.prototype.off=function(name){delete _7e0[name];return _7a9;};var _80f=function(){var _810;var _811;var _812;var _813;var _814;var _815;var _816;var _817;var _818;var _819;var _81a;_81b(_7ae,[_7af,_7b0,_7b1,_7b2].join(" "),function(e){e.preventDefault();var _81c=e.changedTouches[0];_813=_81c.clientY;_814=_81c.clientX;_818=e.timeStamp;switch(e.type){case _7af:if(_810){_810.blur();}_7a9.stopAnimateTo();_810=e.target;_811=_815=_813;_812=_814;_817=_818;break;case _7b0:_816=_813-_815;_81a=_818-_819;_7a9.setScrollTop(_80d-_816,true);_815=_813;_819=_818;break;default:case _7b1:case _7b2:var _81d=_811-_813;var _81e=_812-_814;var _81f=_81e*_81e+_81d*_81d;if(_81f<49){_810.focus();_810.click();return;}_810=_7a7;var _820=_816/_81a;_820=Math.max(Math.min(_820,3),-3);var _821=Math.abs(_820/_7bd);var _822=_820*_821+0.5*_7bd*_821*_821;var _823=_7a9.getScrollTop()-_822;var _824=0;if(_823>_80e){_824=(_80e-_823)/_822;_823=_80e;}else{if(_823<0){_824=-_823/_822;_823=0;}}_821=_821*(1-_824);_7a9.animateTo(_823,{easing:"outCubic",duration:_821});break;}});_7a5.scrollTo(0,0);_7ae.style.overflow=body.style.overflow="hidden";};var _825=function(){var _826;var _827;var _828;var _829;var _82a;var _82b;var kf;var _82c;var _82d;_82c=0;_82d=_7ed.length;for(;_82c<_82d;_82c++){_826=_7ed[_82c];_827=_826.element;_828=_826.anchorTarget;_829=_826.keyFrames;_82a=0;_82b=_829.length;for(;_82a<_82b;_82a++){kf=_829[_82a];if(kf.mode==="relative"){_82e(_827);kf.frame=_7a9.relativeToAbsolute(_828,kf.anchors[0],kf.anchors[1])-kf.offset;_82e(_827,true);}if(_7e1){if(!kf.isEnd&&kf.frame>_80e){_80e=kf.frame;}}}}_80e=Math.max(_80e,_82f());_82c=0;_82d=_7ed.length;for(;_82c<_82d;_82c++){_826=_7ed[_82c];_829=_826.keyFrames;_82a=0;_82b=_829.length;for(;_82a<_82b;_82a++){kf=_829[_82a];if(kf.isEnd){kf.frame=_80e-kf.offset;}}_826.keyFrames.sort(_830);}};var _831=function(_832,_833){var _834=0;var _835=_7ed.length;for(;_834<_835;_834++){var _836=_7ed[_834];var _837=_836.element;var _838=_836.smoothScrolling?_832:_833;var _839=_836.keyFrames;var _83a=_839[0].frame;var _83b=_839[_839.length-1].frame;var _83c=_838<_83a;var _83d=_838>_83b;var _83e=_839[_83c?0:_839.length-1];var key;var _83f;if(_83c||_83d){if(_83c&&_836.edge===-1||_83d&&_836.edge===1){continue;}_7fd(_837,[_83c?_7b4:_7b6],[_7b4,_7b5,_7b6]);_836.edge=_83c?-1:1;switch(_836.edgeStrategy){case "reset":_82e(_837);continue;case "ease":_838=_83e.frame;break;default:case "set":var _840=_83e.props;for(key in _840){if(_7ac.call(_840,key)){_83f=_841(_840[key].value);_7a8.setStyle(_837,key,_83f);}}continue;}}else{if(_836.edge!==0){_7fd(_837,[_7b3,_7b5],[_7b4,_7b6]);_836.edge=0;}}var _842=0;var _843=_839.length-1;for(;_842<_843;_842++){if(_838>=_839[_842].frame&&_838<=_839[_842+1].frame){var left=_839[_842];var _844=_839[_842+1];for(key in left.props){if(_7ac.call(left.props,key)){var _845=(_838-left.frame)/(_844.frame-left.frame);_845=left.props[key].easing(_845);_83f=_846(left.props[key].value,_844.props[key].value,_845);_83f=_841(_83f);_7a8.setStyle(_837,key,_83f);}}break;}}}};var _7e8=function(){var _847=_7a9.getScrollTop();var _848;var now=_7d7();var _849;if(_809){if(now>=_809.endTime){_847=_809.targetTop;_848=_809.done;_809=_7a7;}else{_849=_809.easing((now-_809.startTime)/_809.duration);_847=(_809.startTop+_849*_809.topDiff)|0;}_7a9.setScrollTop(_847,true);}else{if(!_7d8){var _84a=_7e5.targetTop-_847;if(_84a){_7e5={startTop:_80b,topDiff:_847-_80b,targetTop:_847,startTime:_84b,endTime:_84b+_7e4};}if(now<=_7e5.endTime){_849=_7dc.sqrt((now-_7e5.startTime)/_7e4);_847=(_7e5.startTop+_849*_7e5.topDiff)|0;}}}if(_7d8&&_84c){_7a8.setStyle(_84c,"transform","translate(0, "+-(_80d)+"px) "+_84d);}if(_80c||_80b!==_847){_84e=(_847>=_80b)?"down":"up";_80c=false;var _84f={curTop:_847,lastTop:_80b,maxTop:_80e,direction:_84e};var _850=_7e0.beforerender&&_7e0.beforerender.call(_7a9,_84f);if(_850!==false){_831(_847,_7a9.getScrollTop());_80b=_847;if(_7e0.render){_7e0.render.call(_7a9,_84f);}}if(_848){_848.call(_7a9,false);}}_84b=now;};var _7ff=function(_851){var _852=0;var _853=_851.keyFrames.length;for(;_852<_853;_852++){var _854=_851.keyFrames[_852];var _855;var _856;var prop;var _857={};var _858;while((_858=_7c6.exec(_854.props))!==null){prop=_858[1];_856=_858[2];_855=prop.match(_7c7);if(_855!==null){prop=_855[1];_855=_855[2];}else{_855=_7bb;}_856=_856.indexOf("!")?_859(_856):[_856.slice(1)];_857[prop]={value:_856,easing:_7dc[_855]};}_854.props=_857;}};var _859=function(val){var _85a=[];_7cd.lastIndex=0;val=val.replace(_7cd,function(rgba){return rgba.replace(_7cb,function(n){return n/255*100+"%";});});if(_7d0){_7ce.lastIndex=0;val=val.replace(_7ce,function(s){return _7d0+s;});}val=val.replace(_7cb,function(n){_85a.push(+n);return "{?}";});_85a.unshift(val);return _85a;};var _800=function(sk){var _85b={};var _85c;var _85d;_85c=0;_85d=sk.keyFrames.length;for(;_85c<_85d;_85c++){_85e(sk.keyFrames[_85c],_85b);}_85b={};_85c=sk.keyFrames.length-1;for(;_85c>=0;_85c--){_85e(sk.keyFrames[_85c],_85b);}};var _85e=function(_85f,_860){var key;for(key in _860){if(!_7ac.call(_85f.props,key)){_85f.props[key]=_860[key];}}for(key in _85f.props){_860[key]=_85f.props[key];}};var _846=function(val1,val2,_861){var _862;var _863=val1.length;if(_863!==val2.length){throw "Can't interpolate between \""+val1[0]+"\" and \""+val2[0]+"\"";}var _864=[val1[0]];_862=1;for(;_862<_863;_862++){_864[_862]=val1[_862]+((val2[_862]-val1[_862])*_861);}return _864;};var _841=function(val){var _865=1;_7cc.lastIndex=0;return val[0].replace(_7cc,function(){return val[_865++];});};var _82e=function(_866,undo){_866=[].concat(_866);var _867;var _868;var _869=0;var _86a=_866.length;for(;_869<_86a;_869++){_868=_866[_869];_867=_7ed[_868[_7c3]];if(!_867){continue;}if(undo){_868.style.cssText=_867.dirtyStyleAttr;_7fd(_868,_867.dirtyClassAttr);}else{_867.dirtyStyleAttr=_868.style.cssText;_867.dirtyClassAttr=_7fc(_868);_868.style.cssText=_867.styleAttr;_7fd(_868,_867.classAttr);}}};var _86b=function(){_84d="translateZ(0)";_7a8.setStyle(_84c,"transform",_84d);var _86c=_7ad(_84c);var _86d=_86c.getPropertyValue("transform");var _86e=_86c.getPropertyValue(_7d0+"transform");var _86f=(_86d&&_86d!=="none")||(_86e&&_86e!=="none");if(!_86f){_84d="";}};_7a8.setStyle=function(el,prop,val){var _870=el.style;prop=prop.replace(_7c8,_7c9).replace("-","");if(prop==="zIndex"){_870[prop]=""+(val|0);}else{if(prop==="float"){_870.styleFloat=_870.cssFloat=val;}else{try{if(_7cf){_870[_7cf+prop.slice(0,1).toUpperCase()+prop.slice(1)]=val;}_870[prop]=val;}catch(ignore){}}}};var _81b=_7a8.addEvent=function(_871,_872,_873){var _874=function(e){e=e||_7a5.event;if(!e.target){e.target=e.srcElement;}if(!e.preventDefault){e.preventDefault=function(){e.returnValue=false;};}return _873.call(this,e);};_872=_872.split(" ");var _875=0;var _876=_872.length;for(;_875<_876;_875++){if(_871.addEventListener){_871.addEventListener(_872[_875],_873,false);}else{_871.attachEvent("on"+_872[_875],_874);}}};var _7fe=function(){var pos=_7a9.getScrollTop();_80e=0;if(_7e1&&!_7d8){body.style.height="auto";}_825();if(_7e1&&!_7d8){body.style.height=(_80e+_7ae.clientHeight)+"px";}if(_7d8){_7a9.setScrollTop(Math.min(_7a9.getScrollTop(),_80e));}else{_7a9.setScrollTop(pos,true);}_80c=true;};var _82f=function(){var _877=(_84c&&_84c.offsetHeight||0);var _878=Math.max(_877,body.scrollHeight,body.offsetHeight,_7ae.scrollHeight,_7ae.offsetHeight,_7ae.clientHeight);return _878-_7ae.clientHeight;};var _7fc=function(_879){var prop="className";if(_7a5.SVGElement&&_879 instanceof _7a5.SVGElement){_879=_879[prop];prop="baseVal";}return _879[prop];};var _7fd=function(_87a,add,_87b){var prop="className";if(_7a5.SVGElement&&_87a instanceof _7a5.SVGElement){_87a=_87a[prop];prop="baseVal";}if(_87b===_7a7){_87a[prop]=add;return;}var val=_87a[prop];var _87c=0;var _87d=_87b.length;for(;_87c<_87d;_87c++){val=_87e(val).replace(_87e(_87b[_87c])," ");}val=_87f(val);var _880=0;var _881=add.length;for(;_880<_881;_880++){if(_87e(val).indexOf(_87e(add[_880]))===-1){val+=" "+add[_880];}}_87a[prop]=_87f(val);};var _87f=function(a){return a.replace(_7c4,"");};var _87e=function(a){return " "+a+" ";};var _7d7=Date.now||function(){return +new Date();};var _830=function(a,b){return a.frame-b.frame;};var _7a9;var _7ed;var _84c;var _7e0;var _7e1;var _80e=0;var _7e2=1;var _7de;var _84e="down";var _80b=-1;var _84b=_7d7();var _809;var _7e3;var _7e4;var _7e5;var _80c;var _7ee=0;var _7df;var _7d8=false;var _80d=0;var _84d;return _7a8;}(window,document));});},"cb/widget/BigSwitch":function(){define(["dojo","dojo/dom-attr","dojo/dom-class","dojo/html","dijit/_Widget","cb/widget/_TemplatedMixin","dijit/form/CheckBox","dijit/form/Button","sp/I18nWidget","dojo/text!./BigSwitch.html","dojo/i18n!./nls/BigSwitch","dijit/form/RadioButton"],function(dojo,_882,_883,_884,_885,_886,_887,_888,_889,_88a,i18n){return dojo.declare("cb.widget.BigSwitch",[_887,_889],{baseClass:"cbBigSwitch",templateString:_88a,i18n:i18n,tinySwitch:false,value:false,constructor:function(){this.watch("checked",dojo.hitch(this,function(name,_88b,_88c){this._handleCheckedChange(_88c);}));},postMixInProperties:function(){this.inherited(arguments);this.checkedAttrSetting=this.checked?"checked":"";},buildRendering:function(){this.inherited(arguments);dojo.toggleClass(this.domNode,"on",this.checked);dojo.toggleClass(this.domNode,"tinySwitch",this.tinySwitch);},_handleFlick:function(_88d){switch(_88d.direction){case "ltr":this.set("checked",false);break;case "rtl":this.set("checked",true);break;default:break;}},_setLabelAttr:function(){return _888.prototype._setLabelAttr.apply(this,arguments);},_setHintAttr:function(hint){this._set("hint",hint);_884.set(this._hintNode,hint);_883.toggle(this._hintNode,"hideBlock",!hint);},_setIconClassAttr:{node:"iconNode",type:"class"},_fillContent:function(){return _888.prototype._fillContent.apply(this,arguments);},_handleCheckedChange:function(_88e){dojo.toggleClass(this.domNode,"on",_88e);}});});},"cb/widget/SecuritySettingsDisplay":function(){define(["dojo","dojo/dom-class","dojo/query","dojo/html","dijit/_Widget","cb/widget/_TemplatedMixin","sp/I18n","sp/I18nWidget","sp/infos/InfoManager","dojo/text!./SecuritySettingsDisplay.html","dojo/i18n!./nls/SecuritySettingsDisplay"],function(dojo,_88f,_890,_891,_892,_893,_894,_895,_896,_897,i18n){return dojo.declare([_892,_893,_895],{templateString:_897,documentId:null,i18n:i18n,oneliner:false,baseClass:"security-settings-display",postCreate:function(){this.inherited(arguments);this._updateSecurityLevel();this.connect(_896,"onInvalidate",function(_898){if(_898.type==="document"&&_898.id===this.documentId){this._updateSecurityLevel();}if(_898.type==="portfolio"&&_898.id===this._portfolioId){this._updateSecurityLevel();}});},_updateSecurityLevel:function(){dojo.when(this._determineSecurityLevel(),dojo.hitch(this,function(_899){this._setSecurityLevel(_899);}));},_setSecurityLevel:function(_89a){if(this._destroyed){return;}_891.set(this._descriptionNode,_894.wrap(i18n)("description_"+_89a+(this.oneliner?"_oneliner":"")));if(this._started&&this.getParent()&&this.getParent().resize){this.getParent().resize();}},_determineSecurityLevel:function(){var def;if(this.documentId){def=_896.getById({type:"document",id:this.documentId}).then(function(_89b){return {document:_89b.document};}).then(function(_89c){return _896.getById({type:"portfolio",id:_89c.document.projectId}).then(function(_89d){_89c.portfolio=_89d.project;return _89c;});}).then(function(_89e){return _896.getById({type:"user",id:_89e.document.ownerId}).then(function(_89f){_89e.owner=_89f.user;return _89e;});});}else{def=_896.getById({type:"portfolio",id:this.portfolioId}).then(function(_8a0){return {portfolio:_8a0.project};}).then(function(_8a1){return _896.getById({type:"user",id:_8a1.portfolio.ownerId}).then(function(_8a2){_8a1.owner=_8a2.user;return _8a1;});});}return dojo.when(def,dojo.hitch(this,function(_8a3){this._portfolioId=_8a3.portfolio.id;this._ownerId=_8a3.owner.id;var _8a4=1;if(_8a3.owner.accountType.hasSsl){_8a4=2;}if(_8a3.portfolio.accessControlState.controlled){_8a4=3;}return _8a4;}));}});});},"cb/page/boards/PortfolioInformation":function(){define(["dojo","dojo/_base/lang","dojo/DeferredList","dojo/dom-construct","dojo/dom-class","dojo/html","dojo/on","dojo/store/Memory","dojo/store/Observable","dojo/date/stamp","dojo/date/locale","dijit/_Widget","cb/widget/_TemplatedMixin","cb/contacts/ContactSelectFilterComboBox","cb/contacts/ContactSelectStoreFactory","cb/widget/UserList","cb/widget/UserDialog","cb/ext/timeago/Timeago","sp/infos/InfoManager","sp/ajax/AjaxEngine","sp/Tooltip","sp/I18n","./PortfolioSettingsDialog","dojo/i18n!./nls/PortfolioInformation","dojo/text!./PortfolioInformation.html"],function(dojo,lang,_8a5,_8a6,_8a7,_8a8,on,_8a9,_8aa,_8ab,_8ac,_8ad,_8ae,_8af,_8b0,_8b1,_8b2,_8b3,_8b4,_8b5,_8b6,_8b7,_8b8,i18n,_8b9){return dojo.declare([_8ad,_8ae],{baseClass:"portfolio-information",portfolio:null,participants:null,readOnly:null,portfolioResult:null,templateString:_8b9,i18n:i18n,_entryNodeType:"li",postMixInProperties:function(){this.inherited(arguments);this.store=_8aa(new _8a9());this.portfolio=this.portfolioResult.project;this.participants=this.portfolioResult.projectParticipants;this.readOnly=this.portfolioResult.readOnly;},postCreate:function(){this.inherited(arguments);if(this.timeago){this.timeago.destroy();}this.timeago=new _8b3(null,_8a6.create("span",{"class":"last-modified-at","title":this.portfolio.lastModifiedAt},this.modifiedRow));new _8b6({connectId:this.timeago.id,showDelay:50,label:_8ac.format(_8ab.fromISOString(this.portfolio.lastModifiedAt),{selector:"date time",formatLength:"medium"})});if(this.readOnly){_8b4.getById({type:"user",id:this.portfolio.ownerId}).then(dojo.hitch(this,function(_8ba){_8a6.create("span",{innerHTML:_8b7.wrap(i18n)("project_access_restricted")},this.containerNode);var _8bb=_8a6.create("span",{"class":"link",innerHTML:_8ba.user.displayname},this.containerNode,"last");on(_8bb,"click",function(evt){var _8bc=new _8b2({user:_8ba.user});_8bc.show(evt.target);});}));}else{var _8bd=this;this._participantsWidget=new _8b1({postMixInProperties:function(){this.inherited("postMixInProperties",arguments);this.queryOptions={sort:[{attribute:"lastAccessedAtTimeStamp"}]};this.entryWidgetConstructor=dojo.declare([this.entryWidgetConstructor],{includeUserTags:true,postMixInProperties:function(){this.inherited(arguments);this.entryDialogConstructor=dojo.declare([this.entryDialogConstructor],{postCreate:function(){this.inherited(arguments);_8b4.getById({type:"companyuser",id:_8bd.portfolio.ownerId}).then(dojo.hitch(this,function(_8be){var _8bf=_8be!==null&&_8be.companyuser.companyid===sp.info.company.id;var _8c0=this.user.id===_8bd.portfolio.ownerId;var _8c1=_8bf!==null&&!_8bd.readOnly;if(_8c1&&!_8c0){var _8c2=_8a6.create("span",{"class":"button secondary small",innerHTML:_8b7.wrap(i18n)("remove_participant_from_portfolio")},this.content.additionalButtons);this.connect(_8c2,"click",function(_8c3){dojo.stopEvent(_8c3);_8bd._removeParticipant(this.user.id).then(dojo.hitch(this,function(){this.hide();}));});}}));}});}});},buildRendering:function(){this.inherited("buildRendering",arguments);_8a7.add(this.containerNode,"pretty-scrollbars");},addUser:function(_8c4,_8c5){var _8c6;if(_8c5.lastAccessedAt){_8c6=_8ab.fromISOString(_8c5.lastAccessedAt);}if(!_8c6){_8c6=new Date();}this.store.put({id:_8c5.id,user:_8c5.user,lastAccessedAtTimeStamp:_8c6.getTime()});},addUsers:function(_8c7){dojo.forEach(_8c7,function(_8c8){this.addUser(_8c8.id,_8c8);},this);},clear:function(){}},_8a6.create("div",null,this.containerNode));this._participantsWidget.addUsers(this.participants);if(sp.info.company){this._participantSelectStore=_8b0.create({isUserIdAllowedFunction:lang.hitch(this,function(_8c9){return dojo.every(this.participants,function(p){return _8c9!==p.id;});}),predicate:[_8b0.defaultPredicate,"onlyProAccounts"]});this._participantSelect=new _8af({store:this._participantSelectStore,searchAttr:"displayname",highlightMatch:true,required:false,placeHolder:_8b7.wrap(i18n)("participant_select_placeholder")},_8a6.create("div",null,_8a6.create("div",{"class":"participant-select"},this.containerNode)));this.connect(this._participantSelect,"onChange",lang.hitch(this,function(_8ca){var _8cb=this._participantSelectStore.get(_8ca);this._handleParticipantSelectChange(_8cb?_8cb.userId:null);}));}else{}}this.connect(_8b4,"onInvalidate",function(_8cc){if(_8cc.type==="portfolio"&&_8cc.id===this.portfolio.id){_8b4.getById({type:"portfolio",id:this.portfolio.id}).then(dojo.hitch(this,function(_8cd){this.portfolioResult=_8cd;this.portfolio=this.portfolioResult.project;this.participants=this.portfolioResult.projectParticipants;this.readOnly=this.portfolioResult.readOnly;_8a8.set(this._titleNode,this.portfolio.title);}));}});},refresh:function(){},resize:function(){if(this._participantsWidget){this._participantsWidget.resize();}},_handleParticipantSelectChange:function(_8ce){if(!_8ce){return;}_8b5.addPortfolioParticipant({portfolioId:this.portfolio.id,userId:_8ce}).then(dojo.hitch(this,function(_8cf){_8b4.invalidateById({type:"portfolio",id:this.portfolio.id});if(_8cf.success){_8b4.getById({type:"user",id:_8cf.userId}).then(dojo.hitch(this,function(_8d0){if(this._participantsWidget){this._participantsWidget.addUser(_8cf.userId,{id:_8cf.userId,user:_8d0.user,portfolioId:this.portfolio.id});}if(this._participantSelectStore){this._participantSelectStore.remove(_8cf.userId);}if(this._participantSelect){this._participantSelect.set("value",null);}}));}}));},_handleSettingsClick:function(_8d1){new _8b8({portfolioResult:this.portfolioResult}).show(_8d1.currentTarget);},_handleBackToAllBoardsClick:function(){dojo.publish("/cb/page/boards/displaySettings/set/filter","ALL");},onHide:function(){},hide:function(){this.onHide();_8a7.add(this.domNode,"hideBlock");},onShow:function(){},show:function(){this.onShow();_8a7.remove(this.domNode,"hideBlock");},_removeParticipant:function(_8d2){return _8b5.removePortfolioParticipant({portfolioId:this.portfolio.id,userId:_8d2}).then(dojo.hitch(this,function(_8d3){_8b4.invalidateById({type:"portfolio",id:this.portfolio.id});if(_8d3.success){_8b4.getById({type:"user",id:_8d3.userId}).then(dojo.hitch(this,function(_8d4){if(this._participantsWidget){this._participantsWidget.removeUser(_8d3.userId);}if(this._participantSelectStore){this._participantSelectStore.add({id:_8d4.user.id,userId:_8d4.user.id,displayname:_8d4.user.displayname});}if(this._participantSelect){this._participantSelect.set("value",null);}if(_8d3.userId===sp.info.user.info.id){dojo.publish("/cb/page/boards/displaySettings/set/portfolioId",null);}}));}}));}});});},"url:cb/page/boards/personalcontainer/Filter.html":"<div class=\"boards-filter\">\n    <ul data-dojo-attach-point=\"containerNode\" class=\"button-group\">\n        <li spFilterKey=\"all\" class=\"button clean\"><span>${!i18n.filter_all}</span></li>\n        <li spFilterKey=\"self\" class=\"button clean\"><span>${!i18n.filter_own}</span></li> \n        <li spFilterKey=\"foreign\" class=\"button clean\"><span>${!i18n.filter_foreign}</span></li>\n    </ul>\n</div>","cb/infobanner/UpgradeNoFreeSqmBanner":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/dom-construct","dojo/dom-attr","dojo/on","dojo/dom-class","dojo/query","dojo/html","dojo/Deferred","dojo/promise/all","cb/widget/_TemplatedMixin","./Banner","cb/Capabilities","sp/infos/InfoManager","sp/I18n","dojo/i18n!./nls/BannerMessages"],function(_8d5,lang,_8d6,_8d7,on,_8d8,_8d9,_8da,_8db,_8dc,_8dd,_8de,_8df,_8e0,_8e1,i18n){var _8e2="upgrade_nofreesqm";var _8e3=_8d5([_8de,_8dd],{i18n:i18n,templateString:"<div class=\"info-banner-nofreesqm\" data-dojo-attach-point=\"_bannerNode\"></div>",bannerId:_8e2,analyticsBannerId:"no free space",_setSquaremetersAttr:function(_8e4){this._set("squaremeters",_8e4);var _8e5=_8e4.usedsqm-_8e4.sqm;var _8e6=Math.round(_8e5*10)/10;this._bannerNode.innerHTML=_8e1.wrap(i18n)("no_sqm_left_message",[_8e6]);},postCreate:function(){this.inherited(arguments);_8d9("a.js-upgrade",this.domNode).on("click",lang.hitch(this,function(){sp.global.analytics.trackEvent(this.analyticsCategory,"click upgrade");return true;}));}});_8e3.addToContainerIfNecessary=function addToContainerIfNecessary(_8e7){_8e7.addIfNotPresent(_8e2,function(){return _8df.checkCreateBoard().then(function(_8e8){if(_8e8==="nofreesqm"){return _8e0.getById({type:"squaremeters",id:sp.info.user.info.id}).then(function(_8e9){return new _8e3({squaremeters:_8e9});});}});});};return _8e3;});},"dojo/dnd/Moveable":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/lang","../dom","../dom-class","../Evented","../on","../topic","../touch","./common","./Mover","../_base/window"],function(_8ea,_8eb,_8ec,lang,dom,_8ed,_8ee,on,_8ef,_8f0,dnd,_8f1,win){var _8f2=_8eb("dojo.dnd.Moveable",[_8ee],{handle:"",delay:0,skip:false,constructor:function(node,_8f3){this.node=dom.byId(node);if(!_8f3){_8f3={};}this.handle=_8f3.handle?dom.byId(_8f3.handle):null;if(!this.handle){this.handle=this.node;}this.delay=_8f3.delay>0?_8f3.delay:0;this.skip=_8f3.skip;this.mover=_8f3.mover?_8f3.mover:_8f1;this.events=[on(this.handle,_8f0.press,lang.hitch(this,"onMouseDown")),on(this.handle,"dragstart",lang.hitch(this,"onSelectStart")),on(this.handle,"selectstart",lang.hitch(this,"onSelectStart"))];},markupFactory:function(_8f4,node,Ctor){return new Ctor(node,_8f4);},destroy:function(){_8ea.forEach(this.events,function(_8f5){_8f5.remove();});this.events=this.node=this.handle=null;},onMouseDown:function(e){if(this.skip&&dnd.isFormElement(e)){return;}if(this.delay){this.events.push(on(this.handle,_8f0.move,lang.hitch(this,"onMouseMove")),on(this.handle,_8f0.release,lang.hitch(this,"onMouseUp")));this._lastX=e.pageX;this._lastY=e.pageY;}else{this.onDragDetected(e);}_8ec.stop(e);},onMouseMove:function(e){if(Math.abs(e.pageX-this._lastX)>this.delay||Math.abs(e.pageY-this._lastY)>this.delay){this.onMouseUp(e);this.onDragDetected(e);}_8ec.stop(e);},onMouseUp:function(e){for(var i=0;i<2;++i){this.events.pop().remove();}_8ec.stop(e);},onSelectStart:function(e){if(!this.skip||!dnd.isFormElement(e)){_8ec.stop(e);}},onDragDetected:function(e){new this.mover(this.node,e,this);},onMoveStart:function(_8f6){_8ef.publish("/dnd/move/start",_8f6);_8ed.add(win.body(),"dojoMove");_8ed.add(this.node,"dojoMoveItem");},onMoveStop:function(_8f7){_8ef.publish("/dnd/move/stop",_8f7);_8ed.remove(win.body(),"dojoMove");_8ed.remove(this.node,"dojoMoveItem");},onFirstMove:function(){},onMove:function(_8f8,_8f9){this.onMoving(_8f8,_8f9);var s=_8f8.node.style;s.left=_8f9.l+"px";s.top=_8f9.t+"px";this.onMoved(_8f8,_8f9);},onMoving:function(){},onMoved:function(){}});return _8f2;});},"dojo/store/util/SimpleQueryEngine":function(){define(["../../_base/array"],function(_8fa){return function(_8fb,_8fc){switch(typeof _8fb){default:throw new Error("Can not query with a "+typeof _8fb);case "object":case "undefined":var _8fd=_8fb;_8fb=function(_8fe){for(var key in _8fd){var _8ff=_8fd[key];if(_8ff&&_8ff.test){if(!_8ff.test(_8fe[key],_8fe)){return false;}}else{if(_8ff!=_8fe[key]){return false;}}}return true;};break;case "string":if(!this[_8fb]){throw new Error("No filter function "+_8fb+" was found in store");}_8fb=this[_8fb];case "function":}function _900(_901){var _902=_8fa.filter(_901,_8fb);var _903=_8fc&&_8fc.sort;if(_903){_902.sort(typeof _903=="function"?_903:function(a,b){for(var sort,i=0;sort=_903[i];i++){var _904=a[sort.attribute];var _905=b[sort.attribute];if(_904!=_905){return !!sort.descending==(_904==null||_904>_905)?-1:1;}}return 0;});}if(_8fc&&(_8fc.start||_8fc.count)){var _906=_902.length;_902=_902.slice(_8fc.start||0,(_8fc.start||0)+(_8fc.count||Infinity));_902.total=_906;}return _902;};_900.matches=_8fb;return _900;};});},"sp/TasksList":function(){define(["dijit","dojo","dojox","dojo/i18n!sp/nls/TasksList","dojo/require!sp/infos/InfoManager,dijit/_Widget,dojo/date/locale,dojo/NodeList-html,dojo/NodeList-fx,dojox/lang/functional/object,sp/I18n,sp/ActivityIndicatorMixin,cb/ext/timeago/Timeago"],function(_907,dojo,_908){dojo.provide("sp.TasksList");dojo.require("sp.infos.InfoManager");dojo.require("dijit._Widget");dojo.require("dojo.date.locale");dojo.require("dojo.NodeList-html");dojo.require("dojo.NodeList-fx");dojo.require("dojox.lang.functional.object");dojo.require("sp.I18n");dojo.require("sp.ActivityIndicatorMixin");dojo.require("cb.ext.timeago.Timeago");dojo.requireLocalization("sp","TasksList");dojo.declare("sp.TasksList",[_907._Widget,sp.ActivityIndicatorMixin],{autoStartActivityIndicator:true,constructor:function(){},postCreate:function(){this.inherited("postCreate",arguments);dojo.addClass(this.domNode,"tasks-widget list-widget");this._itemListNode=dojo.create("ul",{"class":"list-item-list"},this.domNode);dojo.when(this._refresh(),dojo.hitch(this,function(){this.hideActivityIndicator();}));},_refresh:function(){return sp.infos.getInstance().getById({type:"usertasks",id:sp.info.user.id}).addCallback(dojo.hitch(this,function(_909){this._renderUserTasks(_909.tasks.sort(function(a,b){if(a.modifiedAt<b.modifiedAt){return 1;}if(a.modifiedAt>b.modifiedAt){return -1;}return 0;}));}));},_renderUserTasks:function(_90a){var _90b=dojo.query(this._itemListNode).children();if(this.emptyHintNode){_90b=_90b.concat(this.emptyHintNode);}_90b.fadeOut({onEnd:function(elem){dojo.query(elem).orphan();}});var _90c=false;var _90d={};dojo.forEach(_90a,function(task){if(!_90d[task.documentId]){_90d[task.documentId]=[];}_90d[task.documentId].push(task);},this);_908.lang.functional.forIn(_90d,function(_90e,_90f){if(_90e.length===0){return;}var _910=dojo.filter(_90e,function(task){return task.status==="open";}).length;var _911=dojo.filter(_90e,function(task){return task.status==="onhold";}).length;var _912=dojo.filter(_90e,function(task){return task.status==="closed";}).length;var _913=_910+_911;if(_913===0){return;}_90c=true;var _914=_910>0?(sp.I18n.get("sp","TasksList")("countopen",[_910])):"";var _915=_911>0?(sp.I18n.get("sp","TasksList")("counthold",[_911])):"";var _916=sp.I18n.get("sp","TasksList")("count_joiner");var _917=sp.I18n.get("sp","TasksList")("countsum",[[_916,_914,_915]]);var _918=sp.I18n.get("sp","TasksList")(_913>1?"item_text_pl":"item_text_sing",[_917]);var _919=dojo.create("li",{"class":"list-item"},this._itemListNode);var _91a=function(_91b,_91c,_91d){var _91e=_91b;var _91f=_91c;var _920=_91d;return function(_921){var _922=dojo.create("a",{"class":"list-item-inner","href":_921.document.currentLocation.fullEditUrl},_91e);var _923=dojo.create("span",{"class":"opentasks-count","innerHTML":"<span class=\"number\">"+_91f+"</span>","title":sp.I18n.get("sp","TasksList")("opentaskscount_label"+(_91f===1?"_sing":""),[_91f])},_922);var _924=dojo.create("span",{"class":"list-item-headline","innerHTML":sp.I18n.esc(_921.document.title)},_922);var _925=new cb.ext.timeago.Timeago(null,dojo.create("span",{"class":"list-item-content","title":_921.document.lastModifiedAt},_922));};};sp.infos.getInstance().getById({"type":"document","id":_90f}).addCallback(_91a(_919,_913,_918));},this);if(!_90c){this.emptyHintNode=dojo.create("p",{"class":"empty-hint",innerHTML:sp.I18n.get("sp","TasksList")("empty_hint")},this.domNode);}dojo.query("> :last-child",this._itemListNode).addClass("last");}});});},"sp/dialog/DialogContent":function(){define(["dijit","dojo","dojox","dojo/i18n!sp/nls/I18nWidget","dojo/require!sp/dialog/DialogContentWithoutTemplate,dijit/_Widget,cb/widget/_Templated,dijit/_WidgetsInTemplateMixin,sp/I18n"],function(_926,dojo,_927){dojo.provide("sp.dialog.DialogContent");dojo.require("sp.dialog.DialogContentWithoutTemplate");dojo.require("dijit._Widget");dojo.require("cb.widget._Templated");dojo.require("dijit._WidgetsInTemplateMixin");dojo.require("sp.I18n");dojo.requireLocalization("sp","I18nWidget");dojo.declare("sp.dialog.DialogContent",[sp.dialog.DialogContentWithoutTemplate,cb.widget._Templated]);});},"sp/dialog/ShowDownloadsDialog":function(){define(["dijit","dojo","dojox","dojo/i18n!sp/dialog/nls/ShowDownloadsDialog","dojo/require!sp/dialog/TooltipDialog,sp/I18n,sp/I18nWidget,cb/widget/AttachmentList,cb/Capabilities,dijit/layout/TabContainer,dijit/layout/ContentPane"],function(_928,dojo,_929){dojo.provide("sp.dialog.ShowDownloadsDialog");dojo.require("sp.dialog.TooltipDialog");dojo.require("sp.I18n");dojo.require("sp.I18nWidget");dojo.require("cb.widget.AttachmentList");dojo.require("cb.Capabilities");dojo.require("dijit/layout/TabContainer");dojo.require("dijit/layout/ContentPane");dojo.requireLocalization("sp.dialog","ShowDownloadsDialog");dojo.declare("sp.dialog.ShowDownloadsDialog",[sp.dialog.TooltipDialog],{baseClass:"downloads-dialog with-title",documentId:null,widgetsInTemplate:true,status:null,constructor:function(){},postCreate:function(){this.inherited(arguments);this.content=new (dojo.declare([sp.dialog.DialogContent,sp.I18nWidget],{templateString:"<div>\r\n    <div class=\"dialog-content\">\r\n        <div class=\"dialog-title\">\r\n            <span dojoAttachPoint=\"_dialogTitleInner\"></span>\r\n            <div data-dojo-attach-event=\"click:_handleCloseButtonClick\" class=\"dialog-close-button\" title=\"close\"><i class=\"fonticon-cross\"></i></div>\r\n        </div>\r\n        <div style=\"position:relative;\">\r\n            <div data-dojo-type=\"dijit/layout/TabContainer\">\r\n        \r\n                <div data-dojo-type=\"dijit/layout/ContentPane\" title=\"${i18n.headline_attachments}\" class=\"pretty-scrollbars\" data-dojo-props=\"selected:true\">\r\n                    <div class=\"attachments-pane\" dojoAttachPoint=\"_AttachmentsPane\"></div>\r\n                </div>\r\n                \r\n                <div data-dojo-type=\"dijit/layout/ContentPane\" title=\"${i18n.headline_export}\" class=\"pretty-scrollbars\">\r\n                    <div class=\"export-pane\" dojoAttachPoint=\"_ExportPane\"></div>\r\n                </div>\r\n                \r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>",dialog:this,documentId:this.documentId,widgetsInTemplate:true,i18n:sp.I18n.bundle("sp.dialog","ShowDownloadsDialog"),status:this.status,buildRendering:function(){this.inherited(arguments);},postCreate:function(){this.inherited("postCreate",arguments);this._initAttachments();sp.infos.getInstance().getById({type:"document",id:this.dialog.documentId}).then(dojo.hitch(this,function(_92a){this.document=_92a.document;this._dialogTitleInner.innerHTML=sp.I18n.get("sp.dialog","ShowDownloadsDialog")("dialog_title_downloads",[this.document.title]);this._initExports();}));},_initAttachments:function(){new cb.widget.AttachmentList({documentId:this.documentId},dojo.create("div",null,this._AttachmentsPane,"last"));},_initExports:function(){var _92b=this.document.currentLocation.fullPublicUrl+".mediumsizedpreview.png";var _92c=this.document.currentLocation.fullPublicUrl+".png";var _92d=this.document.currentLocation.fullPublicUrl+".pdf";dojo.create("div",{"innerHTML":"<img src=\""+_92b+"\" />","class":"image-container"},this._ExportPane);var _92e=dojo.create("p",{"class":"center"},this._ExportPane);dojo.create("a",{"class":"button","href":_92d,"target":"_blank","innerHTML":"<img src=\"/_/images/mime-type-icon_pdf_14x19.png\"/>"+sp.I18n.get("sp.dialog","ShowDownloadsDialog")("export_as_pdf")},_92e);dojo.create("a",{"class":"button","href":_92c,"target":"_blank","innerHTML":"<img src=\"/_/images/mime-type-icon_img_14x19.png\"/>"+sp.I18n.get("sp.dialog","ShowDownloadsDialog")("export_as_image")},_92e);},_handleCloseButtonClick:function(){this.dialog.hide();}}))();}});});},"url:cb/widget/SearchSubmit.html":"<div>\n    <input type=\"text\" class=\"search-submit-input\" value=\"\" data-dojo-attach-point=\"_inputNode\" data-dojo-attach-event=\"keyup:_handleKeyupInputNode,blur:_handleBlur\"/>\n    <span class=\"search-submit-submit\" data-dojo-attach-event=\"mousedown:_handleMousedownSubmitButton\"><i class=\"fonticon-magnifier\"></i></span>\n    <span class=\"search-submit-reset hideBlock\" data-dojo-attach-point=\"_resetNode\" data-dojo-attach-event=\"click:_handleResetButtonClick\"><i class=\"fonticon-cross\"></i></span>\n</div>","url:cb/widget/PortfolioSelect_CancellableInput.html":"<div class=\"input-with-button\" id=\"widget_${id}\" role=\"presentation\"\r\n    ><input class=\"input-with-button-input\" data-dojo-attach-point='textbox,focusNode' autocomplete=\"off\"\r\n            ${!nameAttrSetting} type='${type}'\r\n    /><span class=\"button secondary input-with-button-button\" data-dojo-attach-event='click:_handleCancelClick'><i class=\"fonticon-cross\"></i></span\r\n></div>\r\n","dojo/hash":function(){define(["./_base/kernel","require","./_base/config","./_base/connect","./_base/lang","./ready","./sniff"],function(dojo,_92f,_930,_931,lang,_932,has){dojo.hash=function(hash,_933){if(!arguments.length){return _934();}if(hash.charAt(0)=="#"){hash=hash.substring(1);}if(_933){_935(hash);}else{location.href="#"+hash;}return hash;};var _936,_937,_938,_939=_930.hashPollFrequency||100;function _93a(str,_93b){var i=str.indexOf(_93b);return (i>=0)?str.substring(i+1):"";};function _934(){return _93a(location.href,"#");};function _93c(){_931.publish("/dojo/hashchange",[_934()]);};function _93d(){if(_934()===_936){return;}_936=_934();_93c();};function _935(hash){if(_937){if(_937.isTransitioning()){setTimeout(lang.hitch(null,_935,hash),_939);return;}var href=_937.iframe.location.href;var _93e=href.indexOf("?");_937.iframe.location.replace(href.substring(0,_93e)+"?"+hash);return;}location.replace("#"+hash);!_938&&_93d();};function _93f(){var ifr=document.createElement("iframe"),_940="dojo-hash-iframe",_941=_930.dojoBlankHtmlUrl||_92f.toUrl("./resources/blank.html");if(_930.useXDomain&&!_930.dojoBlankHtmlUrl){console.warn("dojo.hash: When using cross-domain Dojo builds,"+" please save dojo/resources/blank.html to your domain and set djConfig.dojoBlankHtmlUrl"+" to the path on your domain to blank.html");}ifr.id=_940;ifr.src=_941+"?"+_934();ifr.style.display="none";document.body.appendChild(ifr);this.iframe=dojo.global[_940];var _942,_943,_944,_945,_946,_947=this.iframe.location;function _948(){_936=_934();_942=_946?_936:_93a(_947.href,"?");_943=false;_944=null;};this.isTransitioning=function(){return _943;};this.pollLocation=function(){if(!_946){try{var _949=_93a(_947.href,"?");if(document.title!=_945){_945=this.iframe.document.title=document.title;}}catch(e){_946=true;console.error("dojo.hash: Error adding history entry. Server unreachable.");}}var hash=_934();if(_943&&_936===hash){if(_946||_949===_944){_948();_93c();}else{setTimeout(lang.hitch(this,this.pollLocation),0);return;}}else{if(_936===hash&&(_946||_942===_949)){}else{if(_936!==hash){_936=hash;_943=true;_944=hash;ifr.src=_941+"?"+_944;_946=false;setTimeout(lang.hitch(this,this.pollLocation),0);return;}else{if(!_946){location.href="#"+_947.search.substring(1);_948();_93c();}}}}setTimeout(lang.hitch(this,this.pollLocation),_939);};_948();setTimeout(lang.hitch(this,this.pollLocation),_939);};_932(function(){if("onhashchange" in dojo.global&&(!has("ie")||(has("ie")>=8&&document.compatMode!="BackCompat"))){_938=_931.connect(dojo.global,"onhashchange",_93c);}else{if(document.addEventListener){_936=_934();setInterval(_93d,_939);}else{if(document.attachEvent){_937=new _93f();}}}});return dojo.hash;});},"cb/widget/SimpleTable":function(){define(["dojo","dojo/dom-construct","dijit/_Container","dijit/_Widget","./_SimpleTableMixin"],function(dojo,_94a,_94b,_94c,_94d){return dojo.declare([_94c,_94b,_94d],{baseClass:"simple-table",type:"table",postMixInProperties:function(){this.inherited(arguments);this._widgets={};switch(this.type){case "list":this._containerNodeType="ul";this._entryNodeType="li";break;case "table":default:this._containerNodeType="tbody";this._entryNodeType="tr";}},buildRendering:function(){if(this.type==="table"){this.domNode=_94a.create("table");}this.inherited(arguments);if(this.type==="table"){var _94e=this.createHeaderRow();if(_94e){var _94f=_94a.create("thead",null,this.domNode,"first");_94a.place(_94e,_94f);}}if(!this.containerNode||this.containerNode===this.domNode){this.containerNode=_94a.create(this._containerNodeType,null,this.domNode);}},createHeaderRow:function(){return false;}});});},"cb/personalcontainer/container/Footer":function(){define(["dojo/_base/declare","dijit/_Widget","cb/widget/_TemplatedMixin","cb/personalcontainer/container/_StayAtBottomMixin","dojo/text!./Footer.html"],function(_950,_951,_952,_953,_954){return _950([_951,_952,_953],{templateString:_954,baseClass:"personal-container-footer",postMixInProperties:function(){this.inherited(arguments);this.baseUrl=sp.info.app.serverUrls.https;}});});},"dojox/validate/regexp":function(){define("dojox/validate/regexp",["dojo/_base/lang","dojo/regexp","dojox/main"],function(lang,_955,_956){var _957=lang.getObject("validate.regexp",true,_956);_957=_956.validate.regexp={ipAddress:function(_958){_958=(typeof _958=="object")?_958:{};if(typeof _958.allowDottedDecimal!="boolean"){_958.allowDottedDecimal=true;}if(typeof _958.allowDottedHex!="boolean"){_958.allowDottedHex=true;}if(typeof _958.allowDottedOctal!="boolean"){_958.allowDottedOctal=true;}if(typeof _958.allowDecimal!="boolean"){_958.allowDecimal=true;}if(typeof _958.allowHex!="boolean"){_958.allowHex=true;}if(typeof _958.allowIPv6!="boolean"){_958.allowIPv6=true;}if(typeof _958.allowHybrid!="boolean"){_958.allowHybrid=true;}var _959="((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])";var _95a="(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]";var _95b="(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]";var _95c="(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|"+"4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])";var _95d="0[xX]0*[\\da-fA-F]{1,8}";var _95e="([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}";var _95f="([\\da-fA-F]{1,4}\\:){6}"+"((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])";var a=[];if(_958.allowDottedDecimal){a.push(_959);}if(_958.allowDottedHex){a.push(_95a);}if(_958.allowDottedOctal){a.push(_95b);}if(_958.allowDecimal){a.push(_95c);}if(_958.allowHex){a.push(_95d);}if(_958.allowIPv6){a.push(_95e);}if(_958.allowHybrid){a.push(_95f);}var _960="";if(a.length>0){_960="("+a.join("|")+")";}return _960;},host:function(_961){_961=(typeof _961=="object")?_961:{};if(typeof _961.allowIP!="boolean"){_961.allowIP=true;}if(typeof _961.allowLocal!="boolean"){_961.allowLocal=false;}if(typeof _961.allowPort!="boolean"){_961.allowPort=true;}if(typeof _961.allowNamed!="boolean"){_961.allowNamed=false;}var _962="(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)";var _963="(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)";var _964=_961.allowPort?"(\\:\\d+)?":"";var _965="((?:"+_962+"\\.)+"+_963+"\\.?)";if(_961.allowIP){_965+="|"+_957.ipAddress(_961);}if(_961.allowLocal){_965+="|localhost";}if(_961.allowNamed){_965+="|^[^-][a-zA-Z0-9_-]*";}return "("+_965+")"+_964;},url:function(_966){_966=(typeof _966=="object")?_966:{};if(!("scheme" in _966)){_966.scheme=[true,false];}var _967=_955.buildGroupRE(_966.scheme,function(q){if(q){return "(https?|ftps?)\\://";}return "";});var _968="(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]+(?:\\?[^?#\\s/]*)?(?:#[A-Za-z][\\w.:-]*)?)?)?";return _967+_957.host(_966)+_968;},emailAddress:function(_969){_969=(typeof _969=="object")?_969:{};if(typeof _969.allowCruft!="boolean"){_969.allowCruft=false;}_969.allowPort=false;var _96a="([!#-'*+\\-\\/-9=?A-Z^-~]+[.])*[!#-'*+\\-\\/-9=?A-Z^-~]+";var _96b=_96a+"@"+_957.host(_969);if(_969.allowCruft){_96b="<?(mailto\\:)?"+_96b+">?";}return _96b;},emailAddressList:function(_96c){_96c=(typeof _96c=="object")?_96c:{};if(typeof _96c.listSeparator!="string"){_96c.listSeparator="\\s;,";}var _96d=_957.emailAddress(_96c);var _96e="("+_96d+"\\s*["+_96c.listSeparator+"]\\s*)*"+_96d+"\\s*["+_96c.listSeparator+"]?\\s*";return _96e;},numberFormat:function(_96f){_96f=(typeof _96f=="object")?_96f:{};if(typeof _96f.format=="undefined"){_96f.format="###-###-####";}var _970=function(_971){return _955.escapeString(_971,"?").replace(/\?/g,"\\d?").replace(/#/g,"\\d");};return _955.buildGroupRE(_96f.format,_970);},ca:{postalCode:function(){return "([A-Z][0-9][A-Z] [0-9][A-Z][0-9])";},province:function(){return "(AB|BC|MB|NB|NL|NS|NT|NU|ON|PE|QC|SK|YT)";}},us:{state:function(_972){_972=(typeof _972=="object")?_972:{};if(typeof _972.allowTerritories!="boolean"){_972.allowTerritories=true;}if(typeof _972.allowMilitary!="boolean"){_972.allowMilitary=true;}var _973="AL|AK|AZ|AR|CA|CO|CT|DE|DC|FL|GA|HI|ID|IL|IN|IA|KS|KY|LA|ME|MD|MA|MI|MN|MS|MO|MT|"+"NE|NV|NH|NJ|NM|NY|NC|ND|OH|OK|OR|PA|RI|SC|SD|TN|TX|UT|VT|VA|WA|WV|WI|WY";var _974="AS|FM|GU|MH|MP|PW|PR|VI";var _975="AA|AE|AP";if(_972.allowTerritories){_973+="|"+_974;}if(_972.allowMilitary){_973+="|"+_975;}return "("+_973+")";}}};return _957;});},"dojo/dnd/Mover":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/lang","../sniff","../_base/window","../dom","../dom-geometry","../dom-style","../Evented","../on","../touch","./common","./autoscroll"],function(_976,_977,_978,lang,has,win,dom,_979,_97a,_97b,on,_97c,dnd,_97d){return _977("dojo.dnd.Mover",[_97b],{constructor:function(node,e,host){this.node=dom.byId(node);this.marginBox={l:e.pageX,t:e.pageY};this.mouseButton=e.button;var h=(this.host=host),d=node.ownerDocument;this.events=[on(d,_97c.move,lang.hitch(this,"onFirstMove")),on(d,_97c.move,lang.hitch(this,"onMouseMove")),on(d,_97c.release,lang.hitch(this,"onMouseUp")),on(d,"dragstart",_978.stop),on(d.body,"selectstart",_978.stop)];_97d.autoScrollStart(d);if(h&&h.onMoveStart){h.onMoveStart(this);}},onMouseMove:function(e){_97d.autoScroll(e);var m=this.marginBox;this.host.onMove(this,{l:m.l+e.pageX,t:m.t+e.pageY},e);_978.stop(e);},onMouseUp:function(e){if(has("webkit")&&has("mac")&&this.mouseButton==2?e.button==0:this.mouseButton==e.button){this.destroy();}_978.stop(e);},onFirstMove:function(e){var s=this.node.style,l,t,h=this.host;switch(s.position){case "relative":case "absolute":l=Math.round(parseFloat(s.left))||0;t=Math.round(parseFloat(s.top))||0;break;default:s.position="absolute";var m=_979.getMarginBox(this.node);var b=win.doc.body;var bs=_97a.getComputedStyle(b);var bm=_979.getMarginBox(b,bs);var bc=_979.getContentBox(b,bs);l=m.l-(bc.l-bm.l);t=m.t-(bc.t-bm.t);break;}this.marginBox.l=l-this.marginBox.l;this.marginBox.t=t-this.marginBox.t;if(h&&h.onFirstMove){h.onFirstMove(this,e);}this.events.shift().remove();},destroy:function(){_976.forEach(this.events,function(_97e){_97e.remove();});var h=this.host;if(h&&h.onMoveStop){h.onMoveStop(this);}this.events=this.node=this.host=null;}});});},"dojo/request/default":function(){define(["exports","require","../has"],function(_97f,_980,has){var _981=has("config-requestProvider"),_982;if(1){_982="./xhr";}else{if(0){_982="./node";}}if(!_981){_981=_982;}_97f.getPlatformDefaultId=function(){return _982;};_97f.load=function(id,_983,_984,_985){_980([id=="platform"?_982:_981],function(_986){_984(_986);});};});},"url:sp/dialog/NewBoardDialog.html":"<div>\r\n    <div class=\"margin\" data-dojo-attach-point=\"_documentCreateForm\">\r\n        <input type=\"text\" tabindex=\"1\" data-dojo-attach-point=\"_nameInput\" class=\"full-width large\" id=\"${id}_name\" value=\"\" placeholder=\"${!i18n.default_board_title}\"/>\r\n        <hr/>\r\n        <div class=\"projects\">\r\n            <label for=\"${id}_project\">&nbsp;<i class=\"fonticon-portfolio fonticon-large\"></i>&nbsp;&nbsp;${projectsLabel}</label>\r\n            <div class=\"project-select\" data-dojo-attach-point=\"_projectSelectContainer\"></div>\r\n        </div>\r\n        <hr/>\r\n        <div class=\"passphrase\" data-dojo-attach-point=\"_passphraseContainer\">\r\n            <span type=\"checkbox\" id=\"${id}_passphrase\" data-dojo-type=\"cb.widget.BigSwitch\" tabindex=\"30\" data-dojo-attach-event=\"onChange:_handlePassphraseSwitchChange\" data-dojo-attach-point=\"_passphraseSwitch\">&nbsp;<i class=\"fonticon-lock fonticon-large\"></i>&nbsp;&nbsp;${passphraseLabel}</span>\r\n            <span class=\"passphrase-disabled-help\" id=\"${id}_passphrase_help\" data-dojo-attach-point=\"_passphraseTooltip_connect\">\r\n                <i class=\"fonticon fonticon-large fonticon-question\"></i>\r\n            </span>             \r\n            <span data-dojo-type=\"sp.Tooltip\" data-dojo-props=\"connectId:['${id}_passphrase_help'], showDelay: 100\" data-dojo-attach-point=\"_passphraseTooltip\" class=\"hideBlock\">\r\n                <span class=\"tooltip-hint-content\">${!i18n.passphrase_disabled_tooltip}</span>\r\n            </span>            \r\n            <input type=\"text\" class=\"input-passphrase hideBlock\" data-dojo-attach-point=\"_passphraseInput\" value=\"\" placeholder=\"${!i18n.default_passphrase}\"/>\r\n        </div>\r\n        <div class=\"dialog-action\">\r\n            <span class=\"button full-width large\" data-dojo-attach-event=\"click:_handleCreateButtonClick\">${!i18n.create_board_button}&nbsp;&nbsp;<i class=\"fonticon-circlearrow-right fonticon-large\"></i></span>\r\n        </div>\r\n    </div>\r\n    <div class=\"hideBlock\" data-dojo-attach-point=\"_documentCreateIndicator\">\r\n        <div class=\"activity-indicator\">${!i18n.redirect_message}</div>\r\n    </div>\r\n    <div class=\"dialog-title\">\r\n        ${!i18n.dialog_title}\r\n        <div data-dojo-attach-event=\"click:_handleCloseButtonClick\" class=\"dialog-close-button\" title=\"close\"><i class=\"fonticon-cross\"></i></div>\r\n    </div>\r\n</div>","cb/widget/_HideableMixin":function(){define(["dojo/_base/declare","dojo/dom-class"],function(_987,_988){return _987(null,{hidden:false,_setHiddenAttr:function(_989){if(this._destroyed){return;}_989=!!_989;_988.toggle(this.domNode,"hideBlock",_989);this._set("hidden",_989);}});});},"url:cb/widget/InstallChromeAppDialog.html":"<div>\r\n\t<div class=\"dialog-title\">\r\n\t\t<div data-dojo-attach-event=\"click:_handleCloseButtonClick\" class=\"dialog-close-button\" title=\"${!i18n.button_close_title}\"><i class=\"fonticon-cross\"></i></div>\r\n\t</div>\r\n\t<div class=\"content\">\r\n\t\t<div class=\"chrome-logo\"></div>\r\n\t\t<h1 data-dojo-attach-point=\"titleNode\">${!i18n.dialog_title}</h1>\r\n\t\t<p data-dojo-attach-point=\"messageNode\">${!i18n.dialog_message}</p>\r\n\t</div>\r\n    <div class=\"buttons\">\r\n        <span data-dojo-attach-point=\"installButton\" data-dojo-attach-event=\"click:_handleInstallButtonClick\" class=\"button\" title=\"${!i18n.button_install_title}\">${!i18n.button_install}</span>\r\n        <span data-dojo-attach-point=\"cancelButton\" data-dojo-attach-event=\"click:_handleCloseButtonClick\" class=\"button secondary\" title=\"${!i18n.button_close_title}\">${!i18n.button_close}</span>\r\n    </div>\r\n</div>","cb/ext/timeago/Timeago":function(){define(["dojo/_base/lang","dijit/_Widget","cb/widget/_Templated","dojo/date/stamp","dojo/i18n!./nls/Timeago"],function(lang,w,t,_98a,i){function _98b(date){return (new Date().getTime()-date.getTime());};function _98c(_98d){if(!_98d){_98d="";}return _98a.fromISOString(_98d);};function _98e(_98f){var $l=i;var _990=$l.prefixAgo;var _991=$l.suffixAgo;if(_98f<0){_990=$l.prefixFromNow;_991=$l.suffixFromNow;}_98f=Math.abs(_98f);var _992=_98f/1000;var _993=_992/60;var _994=_993/60;var days=_994/24;var _995=days/365;function _996(_997,_998){var _999=dojo.isFunction(_997)?_997(_998,_98f):_997;var _99a=($l.numbers&&$l.numbers[_998])||_998;return _999.replace(/%d/i,_99a);};var _99b=_98f==0&&$l.now||_992==1&&_996($l.second,1)||_992<45&&_996($l.seconds,Math.round(_992))||_992<90&&_996($l.minute,1)||_993<45&&_996($l.minutes,Math.round(_993))||_993<90&&_996($l.hour,1)||_994<24&&_996($l.hours,Math.round(_994))||_994<48&&_996($l.day,1)||days<30&&_996($l.days,Math.floor(days))||days<60&&_996($l.month,1)||days<365&&_996($l.months,Math.floor(days/30))||_995<2&&_996($l.year,1)||_996($l.years,Math.floor(_995));if(_98f==0){_991="";}return dojo.trim([_990,_99b,_991].join(" "));};function _99c(d){return _98e(_98b(d));};var _99d=dojo.declare([dijit._Widget],{refreshMillis:60000,secRefreshMillis:5000,strings:null,interval:null,postCreate:function(){this.refresh();if(this.timeout>0){this.interval=setInterval(lang.hitch(this,function(){try{this.refresh();}catch(e){window.clearTimeout(this.interval);}}),this.timeout);}},inWords:function(_99e){return _98e(_99e);},parse:function(_99f){return _98c(_99f);},datetime:function(){var _9a0=this.domNode.tagName.toLowerCase()==="time";var _9a1=_9a0?dojo.attr(this.domNode,"datetime"):dojo.attr(this.domNode,"title");return this.parse(_9a1);},refresh:function(){var data=this.prepareData();if(!isNaN(data.datetime)){this.domNode.innerHTML=this.inWords(this.distance(data.datetime));}if(this.distance(data.datetime)<45000){this.timeout=this.secRefreshMillis;}else{if(this.timeout==this.secRefreshMillis){this.timeout=this.refreshMillis;clearInterval(this.interval);this.interval=setInterval(lang.hitch(this,function(){try{this.refresh();}catch(e){window.clearTimeout(this.interval);}}),this.timeout);}else{this.timeout=this.refreshMillis;}}return;},prepareData:function(){if(!this.timeago){this.timeago={datetime:this.datetime()};dojo.attr(this.domNode,"timeago",this.timeago);var text=dojo.trim(this.domNode.innerHTML);if(text.length>0){dojo.attr(this.domNode,"title",text);}}return this.timeago;},distance:function(date){return _98b(date);}});_99d.formatDate=_99c;return _99d;});},"dojo/store/Memory":function(){define(["../_base/declare","./util/QueryResults","./util/SimpleQueryEngine"],function(_9a2,_9a3,_9a4){var base=null;return _9a2("dojo.store.Memory",base,{constructor:function(_9a5){for(var i in _9a5){this[i]=_9a5[i];}this.setData(this.data||[]);},data:null,idProperty:"id",index:null,queryEngine:_9a4,get:function(id){return this.data[this.index[id]];},getIdentity:function(_9a6){return _9a6[this.idProperty];},put:function(_9a7,_9a8){var data=this.data,_9a9=this.index,_9aa=this.idProperty;var id=_9a7[_9aa]=(_9a8&&"id" in _9a8)?_9a8.id:_9aa in _9a7?_9a7[_9aa]:Math.random();if(id in _9a9){if(_9a8&&_9a8.overwrite===false){throw new Error("Object already exists");}data[_9a9[id]]=_9a7;}else{_9a9[id]=data.push(_9a7)-1;}return id;},add:function(_9ab,_9ac){(_9ac=_9ac||{}).overwrite=false;return this.put(_9ab,_9ac);},remove:function(id){var _9ad=this.index;var data=this.data;if(id in _9ad){data.splice(_9ad[id],1);this.setData(data);return true;}},query:function(_9ae,_9af){return _9a3(this.queryEngine(_9ae,_9af)(this.data));},setData:function(data){if(data.items){this.idProperty=data.identifier;data=this.data=data.items;}else{this.data=data;}this.index={};for(var i=0,l=data.length;i<l;i++){this.index[data[i][this.idProperty]]=i;}}});});},"cb/widget/AttachmentList":function(){define(["dojo","dojo/dom-construct","dojo/dom-class","dojo/store/Memory","dojo/store/Observable","dojo/date/stamp","dijit/_Widget","dijit/_Container","sp/dialog/YesNoDialog","sp/infos/InfoManager","cb/widget/SimpleTable","sp/I18n","sp/ajax/AjaxEngine","cb/Capabilities","cb/status","dojo/i18n!./nls/AttachmentList"],function(dojo,_9b0,_9b1,_9b2,_9b3,_9b4,_9b5,_9b6,_9b7,_9b8,_9b9,_9ba,_9bb,_9bc,_9bd,i18n){var _9be={"image-file":/image\/.*/,"pdf-file":/application\/.?pdf/,"doc-file":["application/msword",/application\/vnd.oasis.opendocument.text(-template|-master|-web)?/,/(application|text)\/rtf/],"ppt-file":[/application\/((ms-?|vnd.ms-)powerpoint)/,/application\/vnd.oasis.opendocument.presentation(-template)?/],"xls-file":[/application\/((ms-?|x-ms|vnd.ms-)excel)/,/application\/vnd.oasis.opendocument.spreadsheet(-template)?/]};var _9bf=function(_9c0){var _9c1=_9c0.contentType||"";var _9c2=function(_9c3){if(dojo.isString(_9c3)){return _9c3==_9c1;}else{return _9c1.match(_9c3);}};for(var _9c4 in _9be){if(_9be.hasOwnProperty(_9c4)){var _9c5=_9be[_9c4];if(!dojo.isArrayLike(_9c5)){_9c5=[_9c5];}var _9c6=dojo.some(_9c5,_9c2);if(_9c6){return _9c4;}}}return "";};var _9c7=dojo.declare([_9b5],{baseClass:"attachment-list-entry",buildRendering:function(){this.inherited(arguments);var _9c8=_9bf(this.item);var _9c9="/__/documentuploads/"+this.documentId+"/"+this.item.id;_9b1.add(this.domNode,_9c8);var _9ca=_9b0.create("div",{"class":"img-container"},this.domNode);if(_9c8==="image-file"){_9b0.create("img",{"src":_9c9},_9ca);}this._checkAccessControlState();var _9cb=_9b0.create("div",{"class":"meta-container",innerHTML:"<span>"+_9ba.esc(this.item.name)+"</span>"},this.domNode);var _9cc=_9b4.fromISOString(this.item.createdAt);var _9cd=_9b0.create("span",{"class":"subline",innerHTML:_9ba.wrap(i18n)("uploaded_at",[_9cc])},_9cb);_9b8.getById({type:"user",id:this.item.uploaderId}).then(function(_9ce){dojo.place(dojo.doc.createTextNode(" "+_9ba.wrap(i18n)("uploaded_by_suffix",[_9ce.user.displayname])),_9cd);});var link=_9b0.create("a",{href:_9c9,target:"_blank",innerHTML:"<span><i class=\"fonticon foncticon-large fonticon-download\"></i><br/>download</span>"},this.domNode);this.controlsNode=_9b0.create("div",{"class":this.baseClass+"-controls"},this.domNode);},_checkAccessControlState:function(){this.status.getAndWatch("editing",dojo.hitch(this,function(attr,old,_9cf){if(_9cf.readonly){this._disableAttachmentDeletion();}else{this._enableAttachmentDeletion();}}),this.documentId);},_enableAttachmentDeletion:function(){if(this.attachmentDeleteNodeRemover){return;}var _9d0=this._attachmentRemoveNode=dojo.create("span",{"title":_9ba.wrap(i18n)("attachment_remove_title"),"innerHTML":_9ba.wrap(i18n)("attachment_remove"),"class":"attachment-remove button small secondary"},this.controlsNode);var _9d1=this.connect(_9d0,"click",function(){this._removeSingleItemFromAttachmentList(this.item);});this.attachmentDeleteNodeRemover=dojo.hitch(this,function(){this.disconnect(_9d1);dojo.destroy(_9d0);this.attachmentDeleteNodeRemover=null;});},_disableAttachmentDeletion:function(){if(this.attachmentDeleteNodeRemover){this.attachmentDeleteNodeRemover();}},_removeSingleItemFromAttachmentList:function(item){var _9d2=new _9b7({title:_9ba.wrap(i18n)("attachment_remove_dialog_title",[item.name]),questionText:_9ba.wrap(i18n)("attachment_remove_dialog_question",[item.name]),okButtonText:_9ba.wrap(i18n)("attachment_remove_dialog_confirm"),hintText:_9ba.wrap(i18n)("attachment_remove_dialog_imageHint"),onYes:dojo.hitch(this,function(){_9bb.removeAttachment({attachmentId:item.id,documentId:this.documentId}).then(dojo.hitch(this,function(){_9b8.invalidateById({type:"documentuploads",id:this.documentId});_9d2.hide();}));})});_9d2.show(this._attachmentRemoveNode);}});var _9d3=dojo.declare([_9b5],{buildRendering:function(){this.inherited(arguments);_9b1.add(this.domNode,_9bf(this.item));this.containerNode=_9b0.create("div",{"class":"sidebar-element-content","title":this.item.name},this.domNode);var link=_9b0.create("a",{innerHTML:_9ba.esc(this.item.name),href:this.item.publicUrl,target:"_blank"},this.containerNode);var _9d4=_9b0.create("span",{"class":"subline",innerHTML:_9ba.wrap(i18n)("uploaded_at_current")},link);}});return dojo.declare([_9b9],{type:"list",baseClass:"attachment-list",status:null,queryOptions:{sort:[{attribute:"specialSortKey",descending:false},{attribute:"createdAtTimestamp",descending:true}]},buildRendering:function(){this.inherited(arguments);_9b1.add(this.domNode,"pretty-scrollbars");this.emptyMessageNode=_9b0.create("p",{"class":"empty-message hideBlock","innerHTML":_9ba.wrap(i18n)("empty_message")},this.domNode);_9b8.invalidateById({type:"documentuploads",id:this.documentId});},postCreate:function(){this.inherited(arguments);this.status=_9bd.Util.create({documentId:this.documentId},[_9bd.editingStatus]);this.subscribe("/sp/ajax/incoming/uploadfinished",function(msg){_9b8.invalidateById({type:"documentuploads",id:this.documentId});});this.subscribe("/sp/ajax/incoming/uploadremoved",function(msg){_9b8.invalidateById({type:"documentuploads",id:this.documentId});});this.connect(_9b8,"onInvalidate",function(_9d5){if(_9d5.type==="documentuploads"&&_9d5.id===this.documentId){this.reloadLater();}});this.reloadLater(1);},reloadLater:function(_9d6){if(this.reloadTimeout){window.clearTimeout(this.reloadTimeout);}this.reloadTimeout=window.setTimeout(dojo.hitch(this,function(){this.reload();}),_9d6||150);},reload:function(){this.changeQuery();_9b8.getById({type:"documentuploads",id:this.documentId}).then(dojo.hitch(this,function(_9d7){dojo.forEach(_9d7.uploads,function(_9d8){_9d8.createdAtTimestamp=_9b4.fromISOString(_9d8.createdAt).getTime();_9d8.specialSortKey=1;this.store.put(_9d8);},this);if(_9d7.uploads.length>0){_9b1.add(this.emptyMessageNode,"hideBlock");}else{_9b1.remove(this.emptyMessageNode,"hideBlock");}}));},createEntryWidget:function(id,item,node){var w;if(item.exportItem){w=new _9d3({item:item,documentId:this.documentId},node);}else{w=new _9c7({item:item,documentId:this.documentId,status:this.status},node);}return w;}});});},"url:cb/page/boards/DocumentSettings.html":"<div>\r\n    <div class=\"dialog-title\">\r\n        ${!i18n.title}\r\n        <div data-dojo-attach-event=\"click:_handleCloseButtonClick\" class=\"dialog-close-button\" title=\"close\"><i class=\"fonticon-cross\"></i></div>\r\n    </div>\r\n    <div class=\"margin\">\r\n        <span class=\"input-with-button full-width\">\r\n            <input data-dojo-attach-point=\"_nameInput\" class=\"full-width large\" type=\"text\" id=\"${id}_name\" value=\"${documentResult.document.title}\"/>\r\n            <button data-dojo-attach-event=\"click:_handleNameSubmitClick\" data-dojo-attach-point=\"_nameSubmit\" class=\"hideBlock\">${!i18n.save_button}</button>\r\n        </span>\r\n        <ul class=\"meta\" data-dojo-attach-point=\"_metaData\">\r\n            <li class=\"owner\"><span data-dojo-attach-point=\"_metaOwnerNode\"></span></li>\r\n            <li class=\"created\"><span data-dojo-attach-point=\"_metaCreatedAtNode\"></span></li>\r\n            <li class=\"modified\">\r\n                <span data-dojo-attach-point=\"_metaModifiedAtNode\"></span>\r\n                <span data-dojo-attach-point=\"_metaModifiedByNode\"></span>\r\n            </li>\r\n            <li><span data-dojo-type=\"cb/widget/SecuritySettingsDisplay\" data-dojo-props=\"documentId:'${documentResult.document.id}', oneliner: true\"></span></li>\r\n        </ul>\r\n        <ul class=\"settings\">\r\n            <li class=\"editing\">\r\n                <span\r\n                    type=\"checkbox\"\r\n                    id=\"${id}_collaboration\"\r\n                    data-dojo-type=\"cb.widget.BigSwitch\"\r\n                    data-dojo-attach-event=\"onChange:_handleCollaborationSwitchChange\"\r\n                    data-dojo-attach-point=\"_collaborationSwitch\"\r\n                    data-dojo-props=\"iconClass: 'fonticon-compose-multi'\">\r\n                    ${!i18n.collaboration_label}\r\n                </span>\r\n                <!--\r\n                <span\r\n                    type=\"checkbox\"\r\n                    id=\"${id}_reports\"\r\n                    data-dojo-type=\"cb.widget.BigSwitch\"\r\n                    data-dojo-attach-event=\"onChange:_handleNotifySwitchChange\"\r\n                    data-dojo-attach-point=\"_reportsSwitch\"\r\n                    data-dojo-props=\"iconClass: 'fonticon-message'\">\r\n                    ${!i18n.notify_label}\r\n                </span>\r\n                 -->\r\n            </li>\r\n            <li class=\"passphrase\">\r\n                <span \r\n                    type=\"checkbox\"\r\n                    id=\"${id}_passphrase\"\r\n                    data-dojo-type=\"cb.widget.BigSwitch\"\r\n                    data-dojo-attach-event=\"onChange:_handlePassphraseSwitchChange\"\r\n                    data-dojo-attach-point=\"_passphraseSwitch\"\r\n                    data-dojo-props=\"iconClass: 'fonticon-lock'\">\r\n                    ${!i18n.passphrase_label}\r\n                </span>\r\n                <span class=\"input-with-button\" data-dojo-attach-point=\"_inputWithButton\">\r\n                    <input type=\"text\" data-dojo-attach-point=\"_passphraseInput\" class=\"full-width\" value=\"${portfolioResult.project.accessControlState.accessControlToken}\"/>\r\n                    <button \r\n                        data-dojo-attach-point=\"_passphraseSubmit\"\r\n                        data-dojo-attach-event=\"click:_handlePassphraseSubmitClick\">\r\n                        ${!i18n.save_button}\r\n                    </button>\r\n                </span>\r\n            </li>\r\n            <li class=\"project\" data-dojo-attach-point=\"_projectLi\">\r\n                <label><i class=\"icon fonticon-portfolio\"></i> ${!i18n.move_to_project}</label>\r\n                <div data-dojo-attach-point=\"_projectSelectContainer\">\r\n                    <span data-dojo-attach-point=\"_projectSelectSave\" data-dojo-attach-event=\"click:_handleProjectSaveClick\"class=\"save-project button hideBlock\">save</span>\r\n                </div>\r\n            </li>\r\n        </ul>\r\n\r\n        <div class=\"document-actions\" data-dojo-attach-point=\"_documentActions\">\r\n            <button data-dojo-attach-point=\"_copyButton\" data-dojo-attach-event=\"click:_handleCopyClick\" class=\"hideBlock clean with-spinner\"><span class=\"label\"><i class=\"fonticon-copyboard\"></i> ${!i18n.copy_button}</span></button>\r\n            <button data-dojo-attach-point=\"_claimButton\" data-dojo-attach-event=\"click:_handleClaimClick\" class=\"hideBlock clean\">${!i18n.claim_button}</button>\r\n            <span data-dojo-attach-point=\"_deleteButton\" data-dojo-attach-event=\"click:_handleDeleteClick\" class=\"hideBlock delete\">${!i18n.delete_button}</span>\r\n            <span data-dojo-attach-point=\"_leaveButton\" data-dojo-attach-event=\"click:_handleLeaveClick\" class=\"hideBlock delete\">${!i18n.leave_button}</span>\r\n        </div>\r\n        <div data-dojo-attach-point=\"_msgLine\"></div>\r\n    </div>\r\n</div>","cb/user/ParticipantManager":function(){define(["dojo","sp/infos/InfoManager","dojo/date/stamp"],function(dojo,_9d9,_9da){return dojo.declare(null,{participants:null,documentId:null,constructor:function(args){dojo.mixin(this,args);this.participants=[];_9d9.watchById({type:"document",id:this.documentId},dojo.hitch(this,function(_9db){this.documentResult=_9db;dojo.forEach(_9db.documentParticipants,function(_9dc){_9dc=dojo.clone(_9dc);_9dc.lastAccessedAt=_9da.fromISOString(_9dc.lastAccessedAt);_9d9.getById({type:"user",id:_9dc.userId}).then(dojo.hitch(this,function(_9dd){_9dc.isInvitation=false;this._insertOrUpdateUser(dojo.mixin({},_9dd.user,_9dc));}));},this);dojo.forEach(_9db.currentlyActiveUsers,function(_9de){_9d9.getById({type:"user",id:_9de}).then(dojo.hitch(this,function(_9df){var _9e0={};dojo.mixin(_9e0,_9df.user);_9e0.state="online";_9e0.isInvitation=false;this._insertOrUpdateUser(_9e0);}));},this);}));_9d9.watchById({type:"documentinvitations",id:this.documentId},dojo.hitch(this,function(_9e1){dojo.forEach(_9e1.invitations,this._addInvitation,this);}));},addUser:function(user){this.participants.push(user);this.onNewUser(user);},onNewUser:function(user){},onChangedUser:function(_9e2,key,_9e3,_9e4){},_editSessionJoined:function(_9e5){var _9e6=_9e5.user;this._insertOrUpdateUser(dojo.mixin(_9e6,{state:"online",lastAccessedAt:new Date()}));},_insertOrUpdateUser:function(_9e7){var user=this._findUserById(_9e7.id);if(!user){var _9e8=this._findUserByEmail(_9e7.emailAdress);if(_9e8){user=_9e8;user.userId=_9e7.id;this.updateUser(user,_9e7);}if(!user){user=this.createUser(_9e7);this.addUser(user);}}this.updateUser(user,_9e7);},updateUser:function(_9e9,data){if(_9e9.userId&&data.id&&_9e9.userId!==data.id){return;}var _9ea=[];dojox.lang.functional.forIn(data,function(_9eb,key){var _9ec=_9e9[key];_9e9[key]=_9eb;if(_9eb!=_9ec){_9ea.push([_9e9,key,_9ec,_9eb]);}},this);if(!data.hasOwnProperty("displaynameDetail")){delete _9e9.displaynameDetail;}dojo.forEach(_9ea,function(args){this.onChangedUser.apply(this,args);},this);this.participants.sort(function(a,b){if(a.lastAccessedAt&&b.lastAccessedAt){return b.lastAccessedAt.getTime()-a.lastAccessedAt.getTime();}else{if(a.lastAccessedAt){return -1;}else{if(b.lastAccessedAt){return 1;}else{return 0;}}}});},_addInvitation:function(_9ed){var _9ee=this._findUserById(_9ed.invitedUserId);if(_9ee){if(_9ed.invitationPersonalMessageAvailable){this.updateUser(_9ee,{invitationPersonalMessageAvailable:!!_9ed.personalMessage});}}else{var _9ef=this._findUserByEmail(_9ed.invitedEmailAdress);if(_9ef){if(!_9ef.id){if(_9ed.invitedUserId){_9d9.getById({type:"user",id:_9ed.invitedUserId}).then(dojo.hitch(this,function(_9f0){this.updateUser(_9ef,_9f0.user);}));}}this.updateUser(_9ef,{invitationPersonalMessageAvailable:!!_9ed.personalMessage});}else{var _9f1=this.createInvited(_9ed);_9f1.state="offline";_9f1.isInvitation=true;this.addUser(_9f1);}}},_findUserById:function(_9f2){return _9f2?dojo.filter(this.participants,function(_9f3){if(_9f3){return _9f3.id===_9f2;}})[0]:null;},_findUsersByEmail:function(_9f4){return _9f4?dojo.filter(this.participants,function(_9f5){if(!_9f5){return false;}if(_9f5.emailAddresses){if(_9f5.emailAddresses.mostUsableEmailAddress===_9f4){return true;}}return _9f5.emailAdress===_9f4||_9f5.email===_9f4;}):null;},_findUserByEmail:function(_9f6){return _9f6?this._findUsersByEmail(_9f6)[0]:null;},createUser:function(user){return {id:user.id,email:user.emailAdress,state:undefined,displayname:user.displayname,visitor:user.visitor,namedGuest:user.namedGuest,companyname:user.companyname};},createInvited:function(_9f7){var ret={id:_9f7.invitedUserId||"visitor_"+_9f7.invitedEmailAdress,email:_9f7.invitedEmailAdress,displayname:_9f7.invitedName||_9f7.invitedEmailAdress,invitationPersonalMessageAvailable:!!_9f7.personalMessage};if(_9f7.invitedUserId){_9d9.getById({type:"user",id:_9f7.invitedUserId}).then(dojo.hitch(this,function(_9f8){this.updateUser(ret,_9f8.user);}));}return ret;},getAllParticipants:function(){return this.participants;},getPadOwnerId:function(){if(!this.documentResult){return null;}return this.documentResult.document.ownerId;}});});},"sp/ActivityIndicator":function(){define(["dijit","dojo","dojox"],function(_9f9,dojo,_9fa){dojo.provide("sp.ActivityIndicator");dojo.declare("sp.ActivityIndicator",[],{containerNode:null,isActive:false,activityIndicatorNode:null,constructor:function(_9fb){dojo.mixin(this,_9fb);},show:function(){if(this.isActive){return;}if(!this.activityIndicatorNode){var _9fc=dojo.query(".activity-indicator",this.containerNode);if(_9fc.length>0){this.activityIndicatorNode=_9fc.at(0)[0];}}if(!this.activityIndicatorNode){this.activityIndicatorNode=dojo.create("span",{"class":"activity-indicator hideBlock"},this.containerNode,"first");}this.isActive=true;this._updateActivityIndicatorNode(this.isActive);},hide:function(){if(!this.isActive){return;}if(!this.activityIndicatorNode){return;}this.isActive=false;this._updateActivityIndicatorNode(this.isActive);},_updateActivityIndicatorNode:function(_9fd){if(!this.activityIndicatorNode){return;}dojo.toggleClass(this.activityIndicatorNode,"hideBlock",!_9fd);}});});},"dijit/form/ComboBox":function(){define(["dojo/_base/declare","./ValidationTextBox","./ComboBoxMixin"],function(_9fe,_9ff,_a00){return _9fe("dijit.form.ComboBox",[_9ff,_a00],{});});},"url:cb/widget/OnboardingProgressBar.html":"<div class=\"progressbar\">\r\n    <div class=\"progressbar-container\" data-dojo-attach-point=\"_onboardingProgressNode,_containerNode\">\r\n        <div class=\"label progressbar-label\" data-dojo-attach-point=\"_onboardingProgressLabel,_labelNode\"></div>\r\n        <div class=\"bar progressbar-bar\" style=\"width: 0%\" data-dojo-attach-point=\"_onboardingProgressBar,_barNode\"></div>\r\n    </div>\r\n</div>","dojo/data/util/simpleFetch":function(){define(["../../_base/lang","../../_base/kernel","./sorter"],function(lang,_a01,_a02){var _a03={};lang.setObject("dojo.data.util.simpleFetch",_a03);_a03.errorHandler=function(_a04,_a05){if(_a05.onError){var _a06=_a05.scope||_a01.global;_a05.onError.call(_a06,_a04,_a05);}};_a03.fetchHandler=function(_a07,_a08){var _a09=_a08.abort||null,_a0a=false,_a0b=_a08.start?_a08.start:0,_a0c=(_a08.count&&(_a08.count!==Infinity))?(_a0b+_a08.count):_a07.length;_a08.abort=function(){_a0a=true;if(_a09){_a09.call(_a08);}};var _a0d=_a08.scope||_a01.global;if(!_a08.store){_a08.store=this;}if(_a08.onBegin){_a08.onBegin.call(_a0d,_a07.length,_a08);}if(_a08.sort){_a07.sort(_a02.createSortFunction(_a08.sort,this));}if(_a08.onItem){for(var i=_a0b;(i<_a07.length)&&(i<_a0c);++i){var item=_a07[i];if(!_a0a){_a08.onItem.call(_a0d,item,_a08);}}}if(_a08.onComplete&&!_a0a){var _a0e=null;if(!_a08.onItem){_a0e=_a07.slice(_a0b,_a0c);}_a08.onComplete.call(_a0d,_a0e,_a08);}};_a03.fetch=function(_a0f){_a0f=_a0f||{};if(!_a0f.store){_a0f.store=this;}this._fetchItems(_a0f,lang.hitch(this,"fetchHandler"),lang.hitch(this,"errorHandler"));return _a0f;};return _a03;});},"cb/infobanner/BoardSignupBanner":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/dom-construct","dojo/dom-attr","dojo/on","dojo/dom-class","dojo/query","dojo/html","dojo/Deferred","dojo/promise/all","cb/infobanner/Banner","sp/infos/InfoManager","cb/Capabilities","sp/ajax/AjaxEngine","sp/I18n","dojo/i18n!./nls/BannerMessages"],function(_a10,lang,_a11,_a12,on,_a13,_a14,_a15,_a16,_a17,_a18,_a19,_a1a,_a1b,_a1c,i18n){var _a1d="boardSignupBanner";var _a1e=_a10([_a18],{bannerId:_a1d,isCloseable:true,boardAccountType:null,featureRegistrationSelfsignup:false,buildRendering:function(){this.analyticsBannerId="signup and login";this.analyticsLabel=this.boardAccountType+" board";this.defaultIconClass="fonticon-participant";if(!this.featureRegistrationSelfsignup){this.defaultMessage=_a1c.wrap(i18n)("guest_login_only");}else{this.defaultMessage=_a1c.wrap(i18n)("guest_login_or_signup");}this.inherited(arguments);},postCreate:function(){this.inherited(arguments);var _a1f="/login?afterwardsUrl="+encodeURIComponent(window.location);var _a20="/registration?afterwardsUrl="+encodeURIComponent(window.location);_a14("a.js-login",this.domNode).attr("href",_a1f).on("click",lang.hitch(this,function(){sp.global.analytics.trackEvent(this.analyticsCategory,"click login",this.analyticsLabel);return true;}));_a14("a.js-signup",this.domNode).attr("href",_a20).on("click",lang.hitch(this,function(){sp.global.analytics.trackEvent(this.analyticsCategory,"click signup",this.analyticsLabel);return true;}));}});_a1e.addToContainerIfNecessary=function addToContainerIfNecessary(_a21){return _a21.addIfNotPresent(_a1d,function(){var _a22;if(sp.info.document){_a22=_a19.getById({type:"user",id:sp.info.document.document.ownerId}).then(function(_a23){return _a23.user;});}else{_a22=new _a16();_a22.resolve(null);}var _a24=_a19.getById({type:"user",id:sp.info.user.id}).then(function(_a25){return _a25.user.accountType.asString;});return _a17({boardOwner:_a22,userAccountType:_a24,featureRegistrationSelfsignup:_a1a.checkFeature("registration.selfsignup").then(function(_a26){return _a26==="enabled";})}).then(function(_a27){var _a28=_a27.boardOwner?_a27.boardOwner:null;var _a29=_a28?_a28.accountType.asString:null;var _a2a=_a27.userAccountType;if((_a29==="anonymous"||_a29==="basic")&&_a2a==="anonymous"){return new _a1e({boardAccountType:_a29,featureRegistrationSelfsignup:_a27.featureRegistrationSelfsignup});}});});};return _a1e;});},"dijit/form/_CheckBoxMixin":function(){define(["dojo/_base/declare","dojo/dom-attr","dojo/_base/event"],function(_a2b,_a2c,_a2d){return _a2b("dijit.form._CheckBoxMixin",null,{type:"checkbox",value:"on",readOnly:false,_aria_attr:"aria-checked",_setReadOnlyAttr:function(_a2e){this._set("readOnly",_a2e);_a2c.set(this.focusNode,"readOnly",_a2e);},_setLabelAttr:undefined,_getSubmitValue:function(_a2f){return !_a2f&&_a2f!==0?"on":_a2f;},_setValueAttr:function(_a30){_a30=this._getSubmitValue(_a30);this._set("value",_a30);_a2c.set(this.focusNode,"value",_a30);},reset:function(){this.inherited(arguments);this._set("value",this.params.value||"on");_a2c.set(this.focusNode,"value",this.value);},_onClick:function(e){if(this.readOnly){_a2d.stop(e);return false;}return this.inherited(arguments);}});});},"cb/infobanner/Banner":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/dom-construct","dojo/dom-attr","dojo/on","dojo/dom-class","dijit/_Widget","dijit/_Contained","sp/I18n","dojo/i18n!./nls/BannerMessages"],function(_a31,lang,_a32,_a33,on,_a34,_a35,_a36,_a37,i18n){return _a31([_a35,_a36],{analyticsCategory:"in app banner",analyticsBannerId:"not set",analyticsLabel:"",defaultIconClass:null,defaultMessage:null,messageNode:null,isCloseable:false,closeLinkNode:null,preventCloseDestroy:false,buildRendering:function(){this.inherited(arguments);if(this.defaultIconClass&&this.defaultMessage){this._createDefaultMessageWithIcon(this.defaultIconClass,this.defaultMessage);}if(this.isCloseable){this._createDefaultClosingNode();}_a34.add(this.domNode,"info-banner");this._trackBannerOpening();},_createDefaultMessageWithIcon:function(_a38,_a39){this.messageNode=_a32.create("span",{"class":"left",innerHTML:"<i class=\""+_a38+"\"></i> "+_a39},this.domNode);},_createDefaultClosingNode:function(){this.closeLinkNode=_a32.create("i",{"class":"fonticon-cross","title":_a37.wrap(i18n)("dismiss_title")},this.domNode);on(this.closeLinkNode,"click",lang.hitch(this,function(_a3a){this._trackBannerClosing();if(!this.preventCloseDestroy){this.getParent().removeChild(this);}}));},_trackBannerOpening:function(){sp.global.analytics.trackEvent(this.analyticsCategory,"show "+this.analyticsBannerId,this.analyticsLabel,null,true);},_trackBannerClosing:function(){sp.global.analytics.trackEvent(this.analyticsCategory,"close "+this.analyticsBannerId,this.analyticsLabel);}});});},"cb/api":function(){define(["./api/Api"],function(Api){return Api;});},"url:dijit/form/templates/ValidationTextBox.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\"\n\tid=\"widget_${id}\" role=\"presentation\"\n\t><div class='dijitReset dijitValidationContainer'\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t/></div\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\n\t\t><input class=\"dijitReset dijitInputInner\" data-dojo-attach-point='textbox,focusNode' autocomplete=\"off\"\n\t\t\t${!nameAttrSetting} type='${type}'\n\t/></div\n></div>\n","cb/widget/_SimpleTableMixin":function(){define(["dojo","dojo/dom-construct","dojo/dom-class","dojo/_base/Deferred","dojox/lang/functional","dojo/store/Observable","dojo/store/Memory"],function(dojo,_a3b,_a3c,_a3d,_a3e,_a3f,_a40){return dojo.declare(null,{containerNode:null,store:null,query:null,queryOptions:null,_entryNodeType:null,constructor:function(){this._widgets={};},postMixInProperties:function(){this.inherited(arguments);if(!this.store){this.store=_a3f(new _a40());}},postCreate:function(){this.inherited(arguments);this.connect(this,"onNewItem","_checkEmptiness");this.connect(this,"onRemovedItem","_checkEmptiness");this.changeQuery(this.query,this.queryOptions);this._checkEmptiness();},addChild:function(){this.inherited(arguments);this._scheduleParentResize();},removeChild:function(){this.inherited(arguments);this._scheduleParentResize();},_scheduleParentResize:function(){if(!this.getParent){return;}var _a41=this.getParent();if(_a41&&_a41.resize){_a41.resize();}},changeQuery:function(_a42,_a43){var _a44=this.store.query({},{});_a3d.when(_a44,dojo.hitch(this,function(_a45){dojo.forEach(_a45,function(_a46){this.store.remove(this.store.getIdentity(_a46));},this);}));if(this.currentObserver){this.currentObserver.cancel();}this.query=(_a42||this.query)||{};this.queryOptions=(_a43||this.newQueryOptions)||{};var _a47=this.store.query(this.query,this.queryOptions);this.currentObserver=_a47.observe(dojo.hitch(this,function(_a48,_a49,_a4a){var id=this.store.getIdentity(_a48);if(_a49===-1){this.handleNewItem(id,_a48,_a4a);}else{if(_a4a===-1){this.handleRemovedItem(id,_a48);}else{this.handleItemReordered(id,_a48,_a49,_a4a);}}}),true);_a3d.when(_a47,dojo.hitch(this,function(_a4b){dojo.forEach(_a4b,function(_a4c,_a4d){var id=this.store.getIdentity(_a4c);this.handleNewItem(id,_a4c,_a4d);},this);}));this._checkEmptiness();},onStoreLoadFinished:function(){},createEntryWidget:function(id,item,node){console.warn("createEntryWidget has to be overriden",arguments);return null;},getEntryWidget:function(id){return this._widgets[id]||null;},getEntryWidgets:function(){return _a3e.values(this._widgets);},isEmpty:function(){return this.getEntryWidgets().length===0;},onNewItem:function(id,item,_a4e){},handleNewItem:function(id,item,_a4f){if(this._widgets[id]){this.handleItemReordered(id,item,-1,_a4f);}else{try{var _a50=this.createEntryWidget(id,item,this._entryNodeType?_a3b.create(this._entryNodeType,{"class":this.baseClass?this.baseClass+"-entry":""}):null);if(_a50){this._widgets[id]=_a50;this.addChild(_a50,_a4f);this.onNewItem(id,item,_a4f);}}catch(e){console.error("error constructing entry widget",this,e,e.stack);throw e;}}},onRemovedItem:function(id,item){},handleRemovedItem:function(id,item){if(this._widgets[id]){this.removeChild(this._widgets[id]);this._widgets[id].destroy();delete this._widgets[id];}this.onRemovedItem(id,item);},onItemReordered:function(id,item,_a51,_a52){},handleItemReordered:function(id,item,_a53,_a54){var _a55=this._widgets[id];if(_a55){this.removeChild(_a55);this.addChild(_a55,_a54);if(_a55.update){_a55.update(item);}}this.onItemReordered(id,item,_a53,_a54);},_checkEmptiness:function(){_a3c.toggle(this.domNode,this.baseClass+"-empty",this.getEntryWidgets().length===0);}});});},"url:sp/dialog/UpgradeDialog.html":"<div>\r\n    <div data-dojo-type=\"dojox.widget.Rotator\" data-dojo-attach-point=\"featuresRotator\" data-dojo-id=\"${id}_FeaturesRotator\" id=\"${id}_FeaturesRotator\" class=\"features-rotator\" data-dojo-props=\"transition:'dojox.widget.rotator.pan', transitionParams:'duration: ${transitionDuration}, easing: dojo.fx.easing.easeIn'\">\r\n        @@PANES_MARKUP@@\r\n    </div>\r\n    \r\n    <div class=\"actions\">\r\n        <span class=\"button secondary cancel\" data-dojo-attach-event=\"click:_handleCloseButtonClick\">${!i18n.button_cancel}</span>\r\n        <a href=\"/upgrade\" class=\"button call-to-action view-update\" data-dojo-attach-point=\"_callToActionLink\">${!i18n.button_upgrade_options}</a>&nbsp;&nbsp;\r\n    </div>\r\n    \r\n    <div class=\"features-controller numbers\" data-dojo-type=\"dojox.widget.rotator.Controller\" data-dojo-props=\"rotator:${id}_FeaturesRotator, commands:'#'\"></div>\r\n</div>    ","url:dijit/form/templates/TextBox.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\" id=\"widget_${id}\" role=\"presentation\"\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\n\t\t><input class=\"dijitReset dijitInputInner\" data-dojo-attach-point='textbox,focusNode' autocomplete=\"off\"\n\t\t\t${!nameAttrSetting} type='${type}'\n\t/></div\n></div>\n","url:cb/widget/UserIconListEntry.html":"<li class=\"participant\">\n    <img class=\"image\" data-dojo-attach-point=\"_imgNode\" />\n    <div class=\"initials\" data-dojo-attach-point=\"_initialsNode\" ></div>\n    <span class=\"user-name\" data-dojo-attach-point=\"_displaynameNode\"></span>\n    <div data-dojo-attach-point=\"_tagsNode\"></div>\n    <div class=\"online-animation\"></div>\n</li>","dijit/form/DataList":function(){define(["dojo/_base/declare","dojo/dom","dojo/_base/lang","dojo/query","dojo/store/Memory","../registry"],function(_a56,dom,lang,_a57,_a58,_a59){function _a5a(_a5b){return {id:_a5b.value,value:_a5b.value,name:lang.trim(_a5b.innerText||_a5b.textContent||"")};};return _a56("dijit.form.DataList",_a58,{constructor:function(_a5c,_a5d){this.domNode=dom.byId(_a5d);lang.mixin(this,_a5c);if(this.id){_a59.add(this);}this.domNode.style.display="none";this.inherited(arguments,[{data:_a57("option",this.domNode).map(_a5a)}]);},destroy:function(){_a59.remove(this.id);},fetchSelectedItem:function(){var _a5e=_a57("> option[selected]",this.domNode)[0]||_a57("> option",this.domNode)[0];return _a5e&&_a5a(_a5e);}});});},"dojox/timing/_base":function(){define("dojox/timing/_base",["dojo/_base/kernel","dojo/_base/lang"],function(dojo){dojo.experimental("dojox.timing");dojo.getObject("timing",true,dojox);dojox.timing.Timer=function(_a5f){this.timer=null;this.isRunning=false;this.interval=_a5f;this.onStart=null;this.onStop=null;};dojo.extend(dojox.timing.Timer,{onTick:function(){},setInterval:function(_a60){if(this.isRunning){window.clearInterval(this.timer);}this.interval=_a60;if(this.isRunning){this.timer=window.setInterval(dojo.hitch(this,"onTick"),this.interval);}},start:function(){if(typeof this.onStart=="function"){this.onStart();}this.isRunning=true;this.timer=window.setInterval(dojo.hitch(this,"onTick"),this.interval);},stop:function(){if(typeof this.onStop=="function"){this.onStop();}this.isRunning=false;window.clearInterval(this.timer);}});return dojox.timing;});},"url:dijit/templates/Dialog.html":"<div class=\"dijitDialog\" role=\"dialog\" aria-labelledby=\"${id}_title\">\n\t<div data-dojo-attach-point=\"titleBar\" class=\"dijitDialogTitleBar\">\n\t\t<span data-dojo-attach-point=\"titleNode\" class=\"dijitDialogTitle\" id=\"${id}_title\"\n\t\t\t\trole=\"heading\" level=\"1\"></span>\n\t\t<span data-dojo-attach-point=\"closeButtonNode\" class=\"dijitDialogCloseIcon\" data-dojo-attach-event=\"ondijitclick: onCancel\" title=\"${buttonCancel}\" role=\"button\" tabIndex=\"-1\">\n\t\t\t<span data-dojo-attach-point=\"closeText\" class=\"closeText\" title=\"${buttonCancel}\">x</span>\n\t\t</span>\n\t</div>\n\t<div data-dojo-attach-point=\"containerNode\" class=\"dijitDialogPaneContent\"></div>\n</div>\n","dijit/form/CheckBox":function(){define(["require","dojo/_base/declare","dojo/dom-attr","dojo/has","dojo/query","dojo/ready","./ToggleButton","./_CheckBoxMixin","dojo/text!./templates/CheckBox.html","dojo/NodeList-dom"],function(_a61,_a62,_a63,has,_a64,_a65,_a66,_a67,_a68){if(has("dijit-legacy-requires")){_a65(0,function(){var _a69=["dijit/form/RadioButton"];_a61(_a69);});}return _a62("dijit.form.CheckBox",[_a66,_a67],{templateString:_a68,baseClass:"dijitCheckBox",_setValueAttr:function(_a6a,_a6b){if(typeof _a6a=="string"){this.inherited(arguments);_a6a=true;}if(this._created){this.set("checked",_a6a,_a6b);}},_getValueAttr:function(){return (this.checked?this.value:false);},_setIconClassAttr:null,postMixInProperties:function(){this.inherited(arguments);this.checkedAttrSetting=this.checked?"checked":"";},_fillContent:function(){},_onFocus:function(){if(this.id){_a64("label[for='"+this.id+"']").addClass("dijitFocusedLabel");}this.inherited(arguments);},_onBlur:function(){if(this.id){_a64("label[for='"+this.id+"']").removeClass("dijitFocusedLabel");}this.inherited(arguments);}});});},"cb/contacts/RoleSelectRadio":function(){define(["./RoleSelect"],function(_a6c){return _a6c.RadioGroup;});},"url:cb/page/dashboard/MainContent.html":"<div>\n    <div class=\"row new-board-and-stats\">\n        <span class=\"\" data-dojo-type=\"cb/widget/CreateBoard\" data-dojo-props=\"baseClass: 'new-board large'\"></span>\n        <div data-dojo-type=\"cb/user/UserStats\"></div>\n        <span class=\"button secondary large invite-participants hideBlock\" data-dojo-attach-point=\"_inviteParticipantsButton\" data-dojo-attach-event=\"click:openContactsInviteDialog\">${!i18n.invite_people}</span>\n        \n    </div>\n    <div class=\"row\">\n        <div data-dojo-attach-point=\"_onboardingTasksNode\"></div>\n    </div>\n    <div class=\"row\">\n        <div class=\"column-left\">\n            <div class=\"main-content-user-notices\">\n                <h3>${!i18n.user_notices}</h3>\n                <div data-dojo-attach-point=\"_onlineUsersModuleNode\"></div>\n                <div data-dojo-attach-point=\"_userNoticesModuleNode\"></div>\n                <div class=\"show-more-container hideBlock\"data-dojo-attach-point=\"_userNoticesLoadMoreContainer\" >\n                    <div class=\"show-more button small secondary\" data-dojo-attach-point=\"_userNoticesLoadMoreButton\">${!i18n.show_more}</div>\n                </div>\n            </div>\n        </div>\n        <div class=\"column-right\">\n            <div class=\"dashboard-module\">\n                <div data-dojo-attach-point=\"_userProfileDisplayNode\"></div>\n            </div>\n            <div class=\"dashboard-module\">\n                <h3>${!i18n.tasks_title}</h3>\n                <div data-dojo-attach-point=\"_tasksModuleNode\"></div>\n            </div>\n        </div>\n    </div>\n</div>","url:cb/contacts/ContactsTableRowActions.html":"<div>\r\n    <div class=\"button clean\" data-dojo-attach-point=\"_generalButtonNode\" data-dojo-attach-event=\"click:_handleGeneralClick\" title=\"${!i18n.contact_actions}\"><i class=\"fonticon-participant-remove\" ></i></div>\r\n    <a class=\"button delete small\" href=\"\" data-dojo-attach-point=\"_deleteTeammemberButtonNode\" title=\"${!i18n.delete_teammember}\">${!i18n.delete_teammember}</a>\r\n    <div class=\"button small\" data-dojo-attach-point=\"_cancelInviteButtonNode\" data-dojo-attach-event=\"click:_handleDeleteContactClick\" title=\"${!i18n.cancel_invite}\">${!i18n.cancel_invite}</div>\r\n    <div class=\"button small\" data-dojo-attach-point=\"_removeContactButtonNode\" data-dojo-attach-event=\"click:_handleDeleteContactClick\" title=\"${!i18n.remove_contact}\">${!i18n.remove_contact}</div>\r\n</div>","dojo/data/ItemFileReadStore":function(){define(["../_base/kernel","../_base/lang","../_base/declare","../_base/array","../_base/xhr","../Evented","./util/filter","./util/simpleFetch","../date/stamp"],function(_a6d,lang,_a6e,_a6f,xhr,_a70,_a71,_a72,_a73){var _a74=_a6e("dojo.data.ItemFileReadStore",[_a70],{constructor:function(_a75){this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._jsonFileUrl=_a75.url;this._ccUrl=_a75.url;this.url=_a75.url;this._jsonData=_a75.data;this.data=null;this._datatypeMap=_a75.typeMap||{};if(!this._datatypeMap["Date"]){this._datatypeMap["Date"]={type:Date,deserialize:function(_a76){return _a73.fromISOString(_a76);}};}this._features={"dojo.data.api.Read":true,"dojo.data.api.Identity":true};this._itemsByIdentity=null;this._storeRefPropName="_S";this._itemNumPropName="_0";this._rootItemPropName="_RI";this._reverseRefMap="_RRM";this._loadInProgress=false;this._queuedFetches=[];if(_a75.urlPreventCache!==undefined){this.urlPreventCache=_a75.urlPreventCache?true:false;}if(_a75.hierarchical!==undefined){this.hierarchical=_a75.hierarchical?true:false;}if(_a75.clearOnClose){this.clearOnClose=true;}if("failOk" in _a75){this.failOk=_a75.failOk?true:false;}},url:"",_ccUrl:"",data:null,typeMap:null,clearOnClose:false,urlPreventCache:false,failOk:false,hierarchical:true,_assertIsItem:function(item){if(!this.isItem(item)){throw new Error(this.declaredClass+": Invalid item argument.");}},_assertIsAttribute:function(_a77){if(typeof _a77!=="string"){throw new Error(this.declaredClass+": Invalid attribute argument.");}},getValue:function(item,_a78,_a79){var _a7a=this.getValues(item,_a78);return (_a7a.length>0)?_a7a[0]:_a79;},getValues:function(item,_a7b){this._assertIsItem(item);this._assertIsAttribute(_a7b);return (item[_a7b]||[]).slice(0);},getAttributes:function(item){this._assertIsItem(item);var _a7c=[];for(var key in item){if((key!==this._storeRefPropName)&&(key!==this._itemNumPropName)&&(key!==this._rootItemPropName)&&(key!==this._reverseRefMap)){_a7c.push(key);}}return _a7c;},hasAttribute:function(item,_a7d){this._assertIsItem(item);this._assertIsAttribute(_a7d);return (_a7d in item);},containsValue:function(item,_a7e,_a7f){var _a80=undefined;if(typeof _a7f==="string"){_a80=_a71.patternToRegExp(_a7f,false);}return this._containsValue(item,_a7e,_a7f,_a80);},_containsValue:function(item,_a81,_a82,_a83){return _a6f.some(this.getValues(item,_a81),function(_a84){if(_a84!==null&&!lang.isObject(_a84)&&_a83){if(_a84.toString().match(_a83)){return true;}}else{if(_a82===_a84){return true;}}});},isItem:function(_a85){if(_a85&&_a85[this._storeRefPropName]===this){if(this._arrayOfAllItems[_a85[this._itemNumPropName]]===_a85){return true;}}return false;},isItemLoaded:function(_a86){return this.isItem(_a86);},loadItem:function(_a87){this._assertIsItem(_a87.item);},getFeatures:function(){return this._features;},getLabel:function(item){if(this._labelAttr&&this.isItem(item)){return this.getValue(item,this._labelAttr);}return undefined;},getLabelAttributes:function(item){if(this._labelAttr){return [this._labelAttr];}return null;},filter:function(_a88,_a89,_a8a){var _a8b=[],i,key;if(_a88.query){var _a8c,_a8d=_a88.queryOptions?_a88.queryOptions.ignoreCase:false;var _a8e={};for(key in _a88.query){_a8c=_a88.query[key];if(typeof _a8c==="string"){_a8e[key]=_a71.patternToRegExp(_a8c,_a8d);}else{if(_a8c instanceof RegExp){_a8e[key]=_a8c;}}}for(i=0;i<_a89.length;++i){var _a8f=true;var _a90=_a89[i];if(_a90===null){_a8f=false;}else{for(key in _a88.query){_a8c=_a88.query[key];if(!this._containsValue(_a90,key,_a8c,_a8e[key])){_a8f=false;}}}if(_a8f){_a8b.push(_a90);}}_a8a(_a8b,_a88);}else{for(i=0;i<_a89.length;++i){var item=_a89[i];if(item!==null){_a8b.push(item);}}_a8a(_a8b,_a88);}},_fetchItems:function(_a91,_a92,_a93){var self=this;if(this._loadFinished){this.filter(_a91,this._getItemsArray(_a91.queryOptions),_a92);}else{if(this._jsonFileUrl!==this._ccUrl){_a6d.deprecated(this.declaredClass+": ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_a91,filter:lang.hitch(self,"filter"),findCallback:lang.hitch(self,_a92)});}else{this._loadInProgress=true;var _a94={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk};var _a95=xhr.get(_a94);_a95.addCallback(function(data){try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;self.filter(_a91,self._getItemsArray(_a91.queryOptions),_a92);self._handleQueuedFetches();}catch(e){self._loadFinished=true;self._loadInProgress=false;_a93(e,_a91);}});_a95.addErrback(function(_a96){self._loadInProgress=false;_a93(_a96,_a91);});var _a97=null;if(_a91.abort){_a97=_a91.abort;}_a91.abort=function(){var df=_a95;if(df&&df.fired===-1){df.cancel();df=null;}if(_a97){_a97.call(_a91);}};}}else{if(this._jsonData){try{this._loadFinished=true;this._getItemsFromLoadedData(this._jsonData);this._jsonData=null;self.filter(_a91,this._getItemsArray(_a91.queryOptions),_a92);}catch(e){_a93(e,_a91);}}else{_a93(new Error(this.declaredClass+": No JSON source data was provided as either URL or a nested Javascript object."),_a91);}}}},_handleQueuedFetches:function(){if(this._queuedFetches.length>0){for(var i=0;i<this._queuedFetches.length;i++){var _a98=this._queuedFetches[i],_a99=_a98.args,_a9a=_a98.filter,_a9b=_a98.findCallback;if(_a9a){_a9a(_a99,this._getItemsArray(_a99.queryOptions),_a9b);}else{this.fetchItemByIdentity(_a99);}}this._queuedFetches=[];}},_getItemsArray:function(_a9c){if(_a9c&&_a9c.deep){return this._arrayOfAllItems;}return this._arrayOfTopLevelItems;},close:function(_a9d){if(this.clearOnClose&&this._loadFinished&&!this._loadInProgress){if(((this._jsonFileUrl==""||this._jsonFileUrl==null)&&(this.url==""||this.url==null))&&this.data==null){}this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._itemsByIdentity=null;this._loadInProgress=false;this._queuedFetches=[];}},_getItemsFromLoadedData:function(_a9e){var _a9f=false,self=this;function _aa0(_aa1){return (_aa1!==null)&&(typeof _aa1==="object")&&(!lang.isArray(_aa1)||_a9f)&&(!lang.isFunction(_aa1))&&(_aa1.constructor==Object||lang.isArray(_aa1))&&(typeof _aa1._reference==="undefined")&&(typeof _aa1._type==="undefined")&&(typeof _aa1._value==="undefined")&&self.hierarchical;};function _aa2(_aa3){self._arrayOfAllItems.push(_aa3);for(var _aa4 in _aa3){var _aa5=_aa3[_aa4];if(_aa5){if(lang.isArray(_aa5)){var _aa6=_aa5;for(var k=0;k<_aa6.length;++k){var _aa7=_aa6[k];if(_aa0(_aa7)){_aa2(_aa7);}}}else{if(_aa0(_aa5)){_aa2(_aa5);}}}}};this._labelAttr=_a9e.label;var i,item;this._arrayOfAllItems=[];this._arrayOfTopLevelItems=_a9e.items;for(i=0;i<this._arrayOfTopLevelItems.length;++i){item=this._arrayOfTopLevelItems[i];if(lang.isArray(item)){_a9f=true;}_aa2(item);item[this._rootItemPropName]=true;}var _aa8={},key;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){if(key!==this._rootItemPropName){var _aa9=item[key];if(_aa9!==null){if(!lang.isArray(_aa9)){item[key]=[_aa9];}}else{item[key]=[null];}}_aa8[key]=key;}}while(_aa8[this._storeRefPropName]){this._storeRefPropName+="_";}while(_aa8[this._itemNumPropName]){this._itemNumPropName+="_";}while(_aa8[this._reverseRefMap]){this._reverseRefMap+="_";}var _aaa;var _aab=_a9e.identifier;if(_aab){this._itemsByIdentity={};this._features["dojo.data.api.Identity"]=_aab;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];_aaa=item[_aab];var _aac=_aaa[0];if(!Object.hasOwnProperty.call(this._itemsByIdentity,_aac)){this._itemsByIdentity[_aac]=item;}else{if(this._jsonFileUrl){throw new Error(this.declaredClass+":  The json data as specified by: ["+this._jsonFileUrl+"] is malformed.  Items within the list have identifier: ["+_aab+"].  Value collided: ["+_aac+"]");}else{if(this._jsonData){throw new Error(this.declaredClass+":  The json data provided by the creation arguments is malformed.  Items within the list have identifier: ["+_aab+"].  Value collided: ["+_aac+"]");}}}}}else{this._features["dojo.data.api.Identity"]=Number;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];item[this._storeRefPropName]=this;item[this._itemNumPropName]=i;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){_aaa=item[key];for(var j=0;j<_aaa.length;++j){_aa9=_aaa[j];if(_aa9!==null&&typeof _aa9=="object"){if(("_type" in _aa9)&&("_value" in _aa9)){var type=_aa9._type;var _aad=this._datatypeMap[type];if(!_aad){throw new Error("dojo.data.ItemFileReadStore: in the typeMap constructor arg, no object class was specified for the datatype '"+type+"'");}else{if(lang.isFunction(_aad)){_aaa[j]=new _aad(_aa9._value);}else{if(lang.isFunction(_aad.deserialize)){_aaa[j]=_aad.deserialize(_aa9._value);}else{throw new Error("dojo.data.ItemFileReadStore: Value provided in typeMap was neither a constructor, nor a an object with a deserialize function");}}}}if(_aa9._reference){var _aae=_aa9._reference;if(!lang.isObject(_aae)){_aaa[j]=this._getItemByIdentity(_aae);}else{for(var k=0;k<this._arrayOfAllItems.length;++k){var _aaf=this._arrayOfAllItems[k],_ab0=true;for(var _ab1 in _aae){if(_aaf[_ab1]!=_aae[_ab1]){_ab0=false;}}if(_ab0){_aaa[j]=_aaf;}}}if(this.referenceIntegrity){var _ab2=_aaa[j];if(this.isItem(_ab2)){this._addReferenceToMap(_ab2,item,key);}}}else{if(this.isItem(_aa9)){if(this.referenceIntegrity){this._addReferenceToMap(_aa9,item,key);}}}}}}}},_addReferenceToMap:function(_ab3,_ab4,_ab5){},getIdentity:function(item){var _ab6=this._features["dojo.data.api.Identity"];if(_ab6===Number){return item[this._itemNumPropName];}else{var _ab7=item[_ab6];if(_ab7){return _ab7[0];}}return null;},fetchItemByIdentity:function(_ab8){var item,_ab9;if(!this._loadFinished){var self=this;if(this._jsonFileUrl!==this._ccUrl){_a6d.deprecated(this.declaredClass+": ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null&&this._jsonData==null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_ab8});}else{this._loadInProgress=true;var _aba={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk};var _abb=xhr.get(_aba);_abb.addCallback(function(data){var _abc=_ab8.scope?_ab8.scope:_a6d.global;try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;item=self._getItemByIdentity(_ab8.identity);if(_ab8.onItem){_ab8.onItem.call(_abc,item);}self._handleQueuedFetches();}catch(error){self._loadInProgress=false;if(_ab8.onError){_ab8.onError.call(_abc,error);}}});_abb.addErrback(function(_abd){self._loadInProgress=false;if(_ab8.onError){var _abe=_ab8.scope?_ab8.scope:_a6d.global;_ab8.onError.call(_abe,_abd);}});}}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;item=self._getItemByIdentity(_ab8.identity);if(_ab8.onItem){_ab9=_ab8.scope?_ab8.scope:_a6d.global;_ab8.onItem.call(_ab9,item);}}}}else{item=this._getItemByIdentity(_ab8.identity);if(_ab8.onItem){_ab9=_ab8.scope?_ab8.scope:_a6d.global;_ab8.onItem.call(_ab9,item);}}},_getItemByIdentity:function(_abf){var item=null;if(this._itemsByIdentity){if(Object.hasOwnProperty.call(this._itemsByIdentity,_abf)){item=this._itemsByIdentity[_abf];}}else{if(Object.hasOwnProperty.call(this._arrayOfAllItems,_abf)){item=this._arrayOfAllItems[_abf];}}if(item===undefined){item=null;}return item;},getIdentityAttributes:function(item){var _ac0=this._features["dojo.data.api.Identity"];if(_ac0===Number){return null;}else{return [_ac0];}},_forceLoad:function(){var self=this;if(this._jsonFileUrl!==this._ccUrl){_a6d.deprecated(this.declaredClass+": ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){var _ac1={url:this._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk,sync:true};var _ac2=xhr.get(_ac1);_ac2.addCallback(function(data){try{if(self._loadInProgress!==true&&!self._loadFinished){self._getItemsFromLoadedData(data);self._loadFinished=true;}else{if(self._loadInProgress){throw new Error(this.declaredClass+":  Unable to perform a synchronous load, an async load is in progress.");}}}catch(e){throw e;}});_ac2.addErrback(function(_ac3){throw _ac3;});}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;}}}});lang.extend(_a74,_a72);return _a74;});},"cb/page/dashboard/OnboardingTasks":function(){define(["dojo","dojo/query","dojo/dom-construct","dojo/dom-class","dojo/dom-style","dojox/lang/functional","sp/dialog/TooltipDialog","sp/dialog/DialogContent","dijit/_Widget","cb/widget/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","sp/I18n","sp/infos/InfoManager","sp/ajax/AjaxEngine","dojo/text!./OnboardingTasks.html","dojo/i18n!./nls/OnboardingTasks"],function(dojo,_ac4,_ac5,_ac6,_ac7,_ac8,_ac9,_aca,_acb,_acc,_acd,_ace,_acf,_ad0,_ad1,i18n){dojo.require("cb.widget.OnboardingProgressBar");return dojo.declare([_acb,_acc,_acd],{templateString:_ad1,baseClass:"onboarding-tasks",i18n:i18n,widgetsInTemplate:true,userOnboardingTasks:null,postMixInProperties:function(){this.inherited(arguments);this._taskLines={};},buildRendering:function(){this.inherited(arguments);this._tasksListNode=_ac5.create("ul",{"class":"task-list"},this._tasksListNode,"replace");},postCreate:function(){this.inherited(arguments);this.connect(_acf,"onInvalidate",function(_ad2){if(_ad2.type==="onboardingtasks"&&_ad2.id===sp.info.user.id){this._reload();}});this._reload();},_reload:function(){_acf.getById({type:"onboardingtasks",id:sp.info.user.id}).then(dojo.hitch(this,function(_ad3){_ac8.forIn(_ad3.onboardingtasks,function(_ad4,_ad5){this._setTaskStatus({key:_ad5,status:_ad4});},this);}));},_hideOnboardingTasks:function(){this.getParent().hideOnboardingTasksContainer();_ac8.values(this._taskLines,function(_ad6){if(_ad6.dialog){_ad6.dialog.hide();}});},_setTaskStatus:function(_ad7){if(!this._taskLines[_ad7.key]){this._taskLines[_ad7.key]=this._createTaskLine(_ad7);}this._taskLines[_ad7.key].setStatus(_ad7.status);},_createTaskLine:function(_ad8){var _ad9=_ad8.key;var self=this;var ret={};ret.node=_ac5.create("li",null,this._tasksListNode);ret.setStatus=function(done){if(!ret.checkNode){ret.checkNode=_ac5.create("i",null,ret.node,"first");}_ac6.toggle(ret.checkNode,"fonticon-task-undone",!done);_ac6.toggle(ret.checkNode,"fonticon-task-checked",!!done);_ac6.toggle(ret.node,"done",!!done);};var _ada=_ac5.create("span",{"innerHTML":_ace.wrap(i18n)(_ad9)},ret.node,"last");var _adb=function(){if(_ad9==="watch_tutorial_videos"){return self._createTooltipDialogForWatchTutorialVideos();}else{return new _ac9({showDelay:0,hideDelay:150,invisibleMilk:true,baseClass:"task-dialog",complexOrient:["before-centered","after-centered"],postCreate:function(){this.inherited("postCreate",arguments);var _adc="<div class=\"onboarding-task-dialog ${dialogTaskStatusClass}\"><div class=\"margin\">${!dialog_image}<h4 class=\"title\">${!dialog_title}</h4><p class=\"task-description\">${!dialog_description}</p>${!dialog_button}<span class=\"task-status\"><i class=\"fonticon-check\"></i></span></div></div>";this.content=new _aca({i18n:i18n,templateString:_adc,widgetsInTemplate:true,dialog:this,dialog_title:_ace.wrap(i18n)("dialog_"+_ad9+"_title"),dialog_description:_ace.wrap(i18n)("dialog_"+_ad9+"_description"),dialog_image:"<img src=\"/_/images/"+_ace.wrap(i18n)("dialog_"+_ad9+"_image")+"\" class=\"task-image\"/>",dialog_button:_ace.wrap(i18n)("dialog_"+_ad9+"_button"),dialogTaskStatusClass:(_ad8.status)?"done":""});}});}};self.connect(ret.node,"click",function(){ret.dialog=_adb();ret.dialog.show(_ad9==="watch_tutorial_videos"?null:_ada);});return ret;},_createTooltipDialogForWatchTutorialVideos:function(){return new _ac9({content:"<iframe id=\"vimeo-video-player\" src=\"//player.vimeo.com/video/88451394?title=0&amp;byline=0&amp;portrait=0&amp;color=107fc9&amp;autoplay=1\" width=\"764\" height=\"430\" frameborder=\"0\" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>",style:"width: 764px; height: 430px",baseClass:"plain-video-dialog",postCreate:function(){this.inherited("postCreate",arguments);_ad0.setOnboardingtaskStatus({key:"watch_tutorial_videos",status:true,userId:sp.info.user.info.id});_acf.invalidateById({type:"onboardingtasks",id:sp.info.user.info.id});}});}});});},"cb/page/boards/personalcontainer/Filter":function(){define(["dojo","dojo/_base/declare","dojo/dom-attr","dijit/_Widget","cb/widget/_TemplatedMixin","sp/I18nWidget","dojo/text!./Filter.html","dojo/i18n!./nls/Filter"],function(dojo,_add,_ade,_adf,_ae0,_ae1,_ae2,i18n){return _add([_adf,_ae0,_ae1],{templateString:_ae2,i18n:i18n,postCreate:function(){this.inherited(arguments);this.connect(this.containerNode,"click",function(evt){var n=evt.target||evt.currentTarget;var _ae3=null;while(!_ae3&&n&&n!=this.containerNode){_ae3=_ade.get(n,"spFilterKey");n=n.parentNode;}if(!_ae3){return;}dojo.stopEvent(evt);dojo.publish("/cb/page/boards/displaySettings/set/filter",_ae3.toUpperCase());});this.subscribe("/cb/page/boards/displaySettings/changed/filter",function(_ae4){dojo.query(this.containerNode).children().removeClass("active").filter("[spFilterKey="+(_ae4||"").toLowerCase()+"]").addClass("active");});}});});},"dijit/form/ValidationTextBox":function(){define(["dojo/_base/declare","dojo/_base/kernel","dojo/i18n","./TextBox","../Tooltip","dojo/text!./templates/ValidationTextBox.html","dojo/i18n!./nls/validate"],function(_ae5,_ae6,i18n,_ae7,_ae8,_ae9){var _aea;return _aea=_ae5("dijit.form.ValidationTextBox",_ae7,{templateString:_ae9,required:false,promptMessage:"",invalidMessage:"$_unset_$",missingMessage:"$_unset_$",message:"",constraints:{},pattern:".*",regExp:"",regExpGen:function(){},state:"",tooltipPosition:[],_deprecateRegExp:function(attr,_aeb){if(_aeb!=_aea.prototype[attr]){_ae6.deprecated("ValidationTextBox id="+this.id+", set('"+attr+"', ...) is deprecated.  Use set('pattern', ...) instead.","","2.0");this.set("pattern",_aeb);}},_setRegExpGenAttr:function(_aec){this._deprecateRegExp("regExpGen",_aec);this.regExpGen=this._getPatternAttr;},_setRegExpAttr:function(_aed){this._deprecateRegExp("regExp",_aed);},_setValueAttr:function(){this.inherited(arguments);this.validate(this.focused);},validator:function(_aee,_aef){return (new RegExp("^(?:"+this._getPatternAttr(_aef)+")"+(this.required?"":"?")+"$")).test(_aee)&&(!this.required||!this._isEmpty(_aee))&&(this._isEmpty(_aee)||this.parse(_aee,_aef)!==undefined);},_isValidSubset:function(){return this.textbox.value.search(this._partialre)==0;},isValid:function(){return this.validator(this.textbox.value,this.constraints);},_isEmpty:function(_af0){return (this.trim?/^\s*$/:/^$/).test(_af0);},getErrorMessage:function(){var _af1=this.invalidMessage=="$_unset_$"?this.messages.invalidMessage:!this.invalidMessage?this.promptMessage:this.invalidMessage;var _af2=this.missingMessage=="$_unset_$"?this.messages.missingMessage:!this.missingMessage?_af1:this.missingMessage;return (this.required&&this._isEmpty(this.textbox.value))?_af2:_af1;},getPromptMessage:function(){return this.promptMessage;},_maskValidSubsetError:true,validate:function(_af3){var _af4="";var _af5=this.disabled||this.isValid(_af3);if(_af5){this._maskValidSubsetError=true;}var _af6=this._isEmpty(this.textbox.value);var _af7=!_af5&&_af3&&this._isValidSubset();this._set("state",_af5?"":(((((!this._hasBeenBlurred||_af3)&&_af6)||_af7)&&(this._maskValidSubsetError||(_af7&&!this._hasBeenBlurred&&_af3)))?"Incomplete":"Error"));this.focusNode.setAttribute("aria-invalid",_af5?"false":"true");if(this.state=="Error"){this._maskValidSubsetError=_af3&&_af7;_af4=this.getErrorMessage(_af3);}else{if(this.state=="Incomplete"){_af4=this.getPromptMessage(_af3);this._maskValidSubsetError=!this._hasBeenBlurred||_af3;}else{if(_af6){_af4=this.getPromptMessage(_af3);}}}this.set("message",_af4);return _af5;},displayMessage:function(_af8){if(_af8&&this.focused){_ae8.show(_af8,this.domNode,this.tooltipPosition,!this.isLeftToRight());}else{_ae8.hide(this.domNode);}},_refreshState:function(){if(this._created){this.validate(this.focused);}this.inherited(arguments);},constructor:function(_af9){this.constraints={};this.baseClass+=" dijitValidationTextBox";},startup:function(){this.inherited(arguments);this._refreshState();},_setConstraintsAttr:function(_afa){if(!_afa.locale&&this.lang){_afa.locale=this.lang;}this._set("constraints",_afa);this._refreshState();},_setPatternAttr:function(_afb){this._set("pattern",_afb);},_getPatternAttr:function(_afc){var p=this.pattern;var type=(typeof p).toLowerCase();if(type=="function"){p=this.pattern(_afc||this.constraints);}if(p!=this._lastRegExp){var _afd="";this._lastRegExp=p;if(p!=".*"){p.replace(/\\.|\[\]|\[.*?[^\\]{1}\]|\{.*?\}|\(\?[=:!]|./g,function(re){switch(re.charAt(0)){case "{":case "+":case "?":case "*":case "^":case "$":case "|":case "(":_afd+=re;break;case ")":_afd+="|$)";break;default:_afd+="(?:"+re+"|$)";break;}});}try{"".search(_afd);}catch(e){_afd=this.pattern;console.warn("RegExp error in "+this.declaredClass+": "+this.pattern);}this._partialre="^(?:"+_afd+")$";}return p;},postMixInProperties:function(){this.inherited(arguments);this.messages=i18n.getLocalization("dijit.form","validate",this.lang);this._setConstraintsAttr(this.constraints);},_setDisabledAttr:function(_afe){this.inherited(arguments);this._refreshState();},_setRequiredAttr:function(_aff){this._set("required",_aff);this.focusNode.setAttribute("aria-required",_aff);this._refreshState();},_setMessageAttr:function(_b00){this._set("message",_b00);this.displayMessage(_b00);},reset:function(){this._maskValidSubsetError=true;this.inherited(arguments);},_onBlur:function(){this.displayMessage("");this.inherited(arguments);}});});},"dijit/layout/BorderContainer":function(){define(["dojo/_base/array","dojo/cookie","dojo/_base/declare","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/on","dojo/touch","../_WidgetBase","../_Widget","../_TemplatedMixin","./_LayoutWidget","./utils"],function(_b01,_b02,_b03,_b04,_b05,_b06,_b07,_b08,keys,lang,on,_b09,_b0a,_b0b,_b0c,_b0d,_b0e){var _b0f=_b03("dijit.layout._Splitter",[_b0b,_b0c],{live:true,templateString:"<div class=\"dijitSplitter\" data-dojo-attach-event=\"onkeypress:_onKeyPress,press:_startDrag,onmouseenter:_onMouse,onmouseleave:_onMouse\" tabIndex=\"0\" role=\"separator\"><div class=\"dijitSplitterThumb\"></div></div>",constructor:function(){this._handlers=[];},postMixInProperties:function(){this.inherited(arguments);this.horizontal=/top|bottom/.test(this.region);this._factor=/top|left/.test(this.region)?1:-1;this._cookieName=this.container.id+"_"+this.region;},buildRendering:function(){this.inherited(arguments);_b04.add(this.domNode,"dijitSplitter"+(this.horizontal?"H":"V"));if(this.container.persist){var _b10=_b02(this._cookieName);if(_b10){this.child.domNode.style[this.horizontal?"height":"width"]=_b10;}}},_computeMaxSize:function(){var dim=this.horizontal?"h":"w",_b11=_b06.getMarginBox(this.child.domNode)[dim],_b12=_b01.filter(this.container.getChildren(),function(_b13){return _b13.region=="center";})[0],_b14=_b06.getMarginBox(_b12.domNode)[dim];return Math.min(this.child.maxSize,_b11+_b14);},_startDrag:function(e){if(!this.cover){this.cover=_b05.place("<div class=dijitSplitterCover></div>",this.child.domNode,"after");}_b04.add(this.cover,"dijitSplitterCoverActive");if(this.fake){_b05.destroy(this.fake);}if(!(this._resize=this.live)){(this.fake=this.domNode.cloneNode(true)).removeAttribute("id");_b04.add(this.domNode,"dijitSplitterShadow");_b05.place(this.fake,this.domNode,"after");}_b04.add(this.domNode,"dijitSplitterActive dijitSplitter"+(this.horizontal?"H":"V")+"Active");if(this.fake){_b04.remove(this.fake,"dijitSplitterHover dijitSplitter"+(this.horizontal?"H":"V")+"Hover");}var _b15=this._factor,_b16=this.horizontal,axis=_b16?"pageY":"pageX",_b17=e[axis],_b18=this.domNode.style,dim=_b16?"h":"w",_b19=_b06.getMarginBox(this.child.domNode)[dim],max=this._computeMaxSize(),min=this.child.minSize||20,_b1a=this.region,_b1b=_b1a=="top"||_b1a=="bottom"?"top":"left",_b1c=parseInt(_b18[_b1b],10),_b1d=this._resize,_b1e=lang.hitch(this.container,"_layoutChildren",this.child.id),de=this.ownerDocument;this._handlers=this._handlers.concat([on(de,_b09.move,this._drag=function(e,_b1f){var _b20=e[axis]-_b17,_b21=_b15*_b20+_b19,_b22=Math.max(Math.min(_b21,max),min);if(_b1d||_b1f){_b1e(_b22);}_b18[_b1b]=_b20+_b1c+_b15*(_b22-_b21)+"px";}),on(de,"dragstart",_b08.stop),on(this.ownerDocumentBody,"selectstart",_b08.stop),on(de,_b09.release,lang.hitch(this,"_stopDrag"))]);_b08.stop(e);},_onMouse:function(e){var o=(e.type=="mouseover"||e.type=="mouseenter");_b04.toggle(this.domNode,"dijitSplitterHover",o);_b04.toggle(this.domNode,"dijitSplitter"+(this.horizontal?"H":"V")+"Hover",o);},_stopDrag:function(e){try{if(this.cover){_b04.remove(this.cover,"dijitSplitterCoverActive");}if(this.fake){_b05.destroy(this.fake);}_b04.remove(this.domNode,"dijitSplitterActive dijitSplitter"+(this.horizontal?"H":"V")+"Active dijitSplitterShadow");this._drag(e);this._drag(e,true);}finally{this._cleanupHandlers();delete this._drag;}if(this.container.persist){_b02(this._cookieName,this.child.domNode.style[this.horizontal?"height":"width"],{expires:365});}},_cleanupHandlers:function(){var h;while(h=this._handlers.pop()){h.remove();}},_onKeyPress:function(e){this._resize=true;var _b23=this.horizontal;var tick=1;switch(e.charOrCode){case _b23?keys.UP_ARROW:keys.LEFT_ARROW:tick*=-1;case _b23?keys.DOWN_ARROW:keys.RIGHT_ARROW:break;default:return;}var _b24=_b06.getMarginSize(this.child.domNode)[_b23?"h":"w"]+this._factor*tick;this.container._layoutChildren(this.child.id,Math.max(Math.min(_b24,this._computeMaxSize()),this.child.minSize));_b08.stop(e);},destroy:function(){this._cleanupHandlers();delete this.child;delete this.container;delete this.cover;delete this.fake;this.inherited(arguments);}});var _b25=_b03("dijit.layout._Gutter",[_b0b,_b0c],{templateString:"<div class=\"dijitGutter\" role=\"presentation\"></div>",postMixInProperties:function(){this.inherited(arguments);this.horizontal=/top|bottom/.test(this.region);},buildRendering:function(){this.inherited(arguments);_b04.add(this.domNode,"dijitGutter"+(this.horizontal?"H":"V"));}});var _b26=_b03("dijit.layout.BorderContainer",_b0d,{design:"headline",gutters:true,liveSplitters:true,persist:false,baseClass:"dijitBorderContainer",_splitterClass:_b0f,postMixInProperties:function(){if(!this.gutters){this.baseClass+="NoGutter";}this.inherited(arguments);},startup:function(){if(this._started){return;}_b01.forEach(this.getChildren(),this._setupChild,this);this.inherited(arguments);},_setupChild:function(_b27){var _b28=_b27.region;if(_b28){this.inherited(arguments);_b04.add(_b27.domNode,this.baseClass+"Pane");var ltr=this.isLeftToRight();if(_b28=="leading"){_b28=ltr?"left":"right";}if(_b28=="trailing"){_b28=ltr?"right":"left";}if(_b28!="center"&&(_b27.splitter||this.gutters)&&!_b27._splitterWidget){var _b29=_b27.splitter?this._splitterClass:_b25;if(lang.isString(_b29)){_b29=lang.getObject(_b29);}var _b2a=new _b29({id:_b27.id+"_splitter",container:this,child:_b27,region:_b28,live:this.liveSplitters});_b2a.isSplitter=true;_b27._splitterWidget=_b2a;_b05.place(_b2a.domNode,_b27.domNode,"after");_b2a.startup();}_b27.region=_b28;}},layout:function(){this._layoutChildren();},addChild:function(_b2b,_b2c){this.inherited(arguments);if(this._started){this.layout();}},removeChild:function(_b2d){var _b2e=_b2d.region;var _b2f=_b2d._splitterWidget;if(_b2f){_b2f.destroy();delete _b2d._splitterWidget;}this.inherited(arguments);if(this._started){this._layoutChildren();}_b04.remove(_b2d.domNode,this.baseClass+"Pane");_b07.set(_b2d.domNode,{top:"auto",bottom:"auto",left:"auto",right:"auto",position:"static"});_b07.set(_b2d.domNode,_b2e=="top"||_b2e=="bottom"?"width":"height","auto");},getChildren:function(){return _b01.filter(this.inherited(arguments),function(_b30){return !_b30.isSplitter;});},getSplitter:function(_b31){return _b01.filter(this.getChildren(),function(_b32){return _b32.region==_b31;})[0]._splitterWidget;},resize:function(_b33,_b34){if(!this.cs||!this.pe){var node=this.domNode;this.cs=_b07.getComputedStyle(node);this.pe=_b06.getPadExtents(node,this.cs);this.pe.r=_b07.toPixelValue(node,this.cs.paddingRight);this.pe.b=_b07.toPixelValue(node,this.cs.paddingBottom);_b07.set(node,"padding","0px");}this.inherited(arguments);},_layoutChildren:function(_b35,_b36){if(!this._borderBox||!this._borderBox.h){return;}var _b37=_b01.map(this.getChildren(),function(_b38,idx){return {pane:_b38,weight:[_b38.region=="center"?Infinity:0,_b38.layoutPriority,(this.design=="sidebar"?1:-1)*(/top|bottom/.test(_b38.region)?1:-1),idx]};},this);_b37.sort(function(a,b){var aw=a.weight,bw=b.weight;for(var i=0;i<aw.length;i++){if(aw[i]!=bw[i]){return aw[i]-bw[i];}}return 0;});var _b39=[];_b01.forEach(_b37,function(_b3a){var pane=_b3a.pane;_b39.push(pane);if(pane._splitterWidget){_b39.push(pane._splitterWidget);}});var dim={l:this.pe.l,t:this.pe.t,w:this._borderBox.w-this.pe.w,h:this._borderBox.h-this.pe.h};_b0e.layoutChildren(this.domNode,dim,_b39,_b35,_b36);},destroyRecursive:function(){_b01.forEach(this.getChildren(),function(_b3b){var _b3c=_b3b._splitterWidget;if(_b3c){_b3c.destroy();}delete _b3b._splitterWidget;});this.inherited(arguments);}});_b26.ChildWidgetProperties={region:"",layoutPriority:0,splitter:false,minSize:0,maxSize:Infinity};lang.extend(_b0a,_b26.ChildWidgetProperties);_b26._Splitter=_b0f;_b26._Gutter=_b25;return _b26;});},"url:cb/page/dashboard/personalcontainer/Navigation.html":"<div class=\"subnav-container\">\n    <ul>\n        <li><a href=\"/home\"><i class=\"icon fonticon-home\"></i> <span class=\"label\">${!i18n.nav_home}</span></a></li>\n        <li><a href=\"/boards\"><i class=\"icon fonticon-boards\"></i> <span class=\"label\">${!i18n.nav_boards}</span></a></li>\n        <li><a href=\"/contacts\"><i class=\"icon fonticon-participants\"></i> <span class=\"label\" data-dojo-attach-point=\"_contactsLabelNode\">${!i18n.nav_contacts}</span></a></li>\n        <li data-dojo-attach-point=\"_freeUpgradeNode\" class=\"hideBlock\"><a href=\"/upgrade\"><i class=\"icon fonticon-star\"></i> <span class=\"label\">${!i18n.nav_upgrade}</span></a></li>\n        <li><a href=\"/profile\" title=\"edit your account settings\"><i class=\"icon fonticon-participant\"></i> <span class=\"label\">${!i18n.nav_settings}</span></a></li>\n        <li data-dojo-attach-point=\"_companyAdminNode\" class=\"hideBlock\"><a href=\"/__/company/admin\" title=\"\"><i class=\"icon fonticon-cog\"></i> <span class=\"label\">${!i18n.nav_admin}</span></a></li>\n    </ul>\n</div>","sp/StackLayout":function(){define(["dojo","dojo/dom-style","dojo/dom-geometry"],function(dojo,_b3d,_b3e){var _b3f=function(size,_b40){var arr=[];while(size--){arr.push(_b40);}return arr;};var _b41=function(_b42){return dojo.contentBox(_b42);};var _b43=function(_b44,_b45){return Math.max(Math.floor((_b44-_b45.m)/(_b45.w+_b45.m)),1);};var _b46=function(_b47){var _b48=null,_b49=0;dojo.forEach(_b47,function(_b4a,_b4b){if(_b48===null||(_b4a<_b48)){_b49=_b4b;_b48=_b4a;}});return _b49;};var _b4c=function(_b4d){var _b4e=0;dojo.forEach(_b4d,function(_b4f){_b4e=Math.max(_b4e,_b4f);});return _b4e;};var _b50=function(_b51,_b52,_b53){var left=_b51*(_b53.w+_b53.m)+_b53.m;var top=_b52+_b53.m;return {left:left,top:top};};var _b54=function(node,_b55){dojo.removeClass(node,"stacklayoutapplied");var _b56=_b3d.getComputedStyle(node);var _b57=_b3e.getContentBox(node,_b56);var _b58=_b3e.getPadBorderExtents(node,_b56);var _b59=_b3e.getMarginExtents(node,_b56);return {w:_b55,m:_b59.r,imgWidth:_b55};};return dojo.declare(null,{imgWidth:200,minimumRatio:4/1,maximumRatio:1/2,constructor:function(_b5a,_b5b){this.container=_b5a;if(_b5b){this.imgWidth=_b5b;}},getColumnMeasurements:function(){return _b54(dojo.query(this.container).children().first()[0],this.imgWidth);},calculateRatioForNode:function(node){var _b5c=node?parseInt(dojo.attr(node,"spWidth"),10):0;var _b5d=node?parseInt(dojo.attr(node,"spHeight"),10):0;if(isNaN(_b5c)){_b5c=dojo.marginBox(node).w;}if(isNaN(_b5d)){_b5d=dojo.marginBox(node).h;}if(isNaN(_b5c)||_b5c===0||isNaN(_b5d)||_b5d===0){return 1;}return (_b5c&&_b5d)?_b5c/_b5d:this.minimumRatio;},cleanup:function(){if(this.container){dojo.query(".stacklayoutapplied",this.container).concat(dojo.query(this.container)).style({height:null,width:null,left:null,top:null}).removeClass("stacklayoutapplied");}},layout:function(_b5e){if(this.container!==_b5e){this.cleanup();}this.container=_b5e;var _b5f=dojo.query(_b5e).children();if(_b5f.length===0){this.cleanup();return;}dojo.addClass(_b5e,"stacklayoutapplied");var _b60=this.getColumnMeasurements();var _b61=_b41(_b5e).w;var _b62=_b43(_b61,_b60);var _b63=0;var _b64=_b3f(_b62,0);dojo.query(_b5e).children().forEach(dojo.hitch(this,function(node){dojo.addClass(node,"stacklayoutapplied");var _b65=_b46(_b64);var _b66=_b64[_b65]||0;var _b67=_b50(_b65,_b66,_b60);dojo.style(node,{left:(_b67.left+_b63)+"px",top:_b67.top+"px",width:this.imgWidth+"px"});if(_b60.imgWidth>0){var _b68=dojo.query(".stacklayoutsizer, img",node).first();_b68.addClass("stacklayoutapplied");var _b69=this.calculateRatioForNode(_b68[0]);var _b6a=Math.max(_b69,this.maximumRatio);var _b6b=Math.round(_b60.imgWidth/_b69);var _b6c=Math.round(_b60.imgWidth/_b6a);if(_b68.length!==0){_b68.style({width:_b60.imgWidth+"px",height:_b6b+"px"});_b68.parent().style({height:_b6c+"px"}).addClass("stacklayoutapplied");}}_b64[_b65]=_b67.top+dojo.marginBox(node).h;}));dojo.style(_b5e,"height",(_b4c(_b64)+_b60.m)+"px");},relayout:function(){if(!this.container){return;}this.layout(this.container);}});});},"dojox/timing":function(){define("dojox/timing",["./timing/_base"],function(_b6d){return _b6d;});},"dojo/data/util/filter":function(){define(["../../_base/lang"],function(lang){var _b6e={};lang.setObject("dojo.data.util.filter",_b6e);_b6e.patternToRegExp=function(_b6f,_b70){var rxp="^";var c=null;for(var i=0;i<_b6f.length;i++){c=_b6f.charAt(i);switch(c){case "\\":rxp+=c;i++;rxp+=_b6f.charAt(i);break;case "*":rxp+=".*";break;case "?":rxp+=".";break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":rxp+="\\";default:rxp+=c;}}rxp+="$";if(_b70){return new RegExp(rxp,"mi");}else{return new RegExp(rxp,"m");}};return _b6e;});},"cb/personalcontainer/container/_StayAtBottomMixin":function(){define(["dojo/_base/declare","dojo/dom-geometry","dojo/dom-class","dojo/dom-style"],function(_b71,_b72,_b73,_b74){return _b71(null,{resize:function(_b75){this.inherited(arguments);if(!_b75||_b75.hasOwnProperty("h")){this._ensureBottomPosition();}},_ensureBottomPosition:function(){var _b76=!this._isAtBottom();_b73.toggle(this.domNode,this.baseClass+"-forceatbottom",_b76);var next=this._getNextVisibleSibling();if(next){_b73.add(this.domNode,this.baseClass+"-forceatbottom");_b74.set(this.domNode,"bottom",dojo.contentBox(this.getParent().domNode).h-dojo.marginBox(next.domNode).t+"px");}else{_b74.set(this.domNode,"bottom",null);}},_isAtBottom:function(){var _b77=_b73.contains(this.domNode,this.baseClass+"-forceatbottom");_b73.remove(this.domNode,this.baseClass+"-forceatbottom");var _b78=_b72.getMarginBox(this.domNode);var _b79;var next=this._getNextVisibleSibling();if(next){_b79=_b72.getMarginBox(next.domNode).t;}else{_b79=_b72.getMarginBox(this.getParent().domNode).h;}_b73.toggle(this.domNode,this.baseClass+"-forceatbottom",_b77);return _b78.t+_b78.h>=_b79;},_getNextVisibleSibling:function(){var next=this.getParent()._getSiblingOfChild(this,1);while(next&&_b73.contains(next.domNode,"hideBlock")){next=this.getParent()._getSiblingOfChild(next,1);}return next;}});});},"cb/assert":function(){define(["dojo/_base/lang","dojox/lang/functional"],function(lang,_b7a){function _b7b(v){return v!==null&&v!==undefined;};function _b7c(opts){return _b7a.mapIn(opts,function(_b7d,key){_b7d.optional=_b7d.opt=function opt(v,_b7e){if(!_b7b(v)){return;}return _b7d.apply(this,arguments);};return _b7d;});};return _b7c({dom:function assertDom(v,_b7f){if(_b7b(v)&&(!lang.isString(v))&&(v.nodeType&&v.nodeType===1)){return v;}throw new Error(_b7f||"value must be a dom node");},string:function assertString(v,_b80){if(_b7b(v)&&lang.isString(v)){return v;}throw new Error(_b80||"value must be a string");},func:function assertFunc(v,_b81){if(_b7b(v)&&lang.isFunction(v)){return v;}throw new Error(_b81||"value must be a function");},array:function assertArray(v,_b82){if(_b7b(v)&&lang.isArray(v)){return v;}throw new Error(_b82||"value must be an array");},object:function assertObject(v,_b83){if(_b7b(v)&&lang.isObject(v)){return v;}throw new Error(_b83||"value must be an object");}});});},"cb/user/UserTags":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/dom-class","dojo/dom-attr","dojo/dom-construct","dojo/on","dojo/Deferred","dojo/when","dojox/lang/functional","dijit/_WidgetBase","cb/util","sp/I18n","sp/infos/InfoManager","dojo/i18n!./nls/User"],function(_b84,_b85,lang,_b86,_b87,_b88,on,_b89,when,_b8a,_b8b,_b8c,_b8d,_b8e,i18n){var I18N=_b8d.wrap(i18n);var _b8f=["online","pro","student","basic","no_account","email_inactive"];function _b90(){return _b8a.foldl(_b8f,function(tags,_b91){tags[_b91]=false;return tags;},{});};return _b84([_b8b],{userId:null,emailAdresses:null,contact:null,constructor:function(){this.tags=_b90();},buildRendering:function(){this.domNode=_b88.create("ul",{"class":"user-tags"});this.inherited(arguments);this._tagNodes=_b8a.foldl(_b8f,lang.hitch(this,function(_b92,_b93){_b92[_b93]=_b88.create("li",{innerHTML:I18N("tag_display_"+_b93),"class":" hideBlock user-tags__tag user-tags__tag--"+_b93},this.domNode);return _b92;}),{});},_setUserIdAttr:function(_b94){this._set("userId",_b94);if(_b94){_b8e.getById({type:"user",id:_b94}).then(lang.hitch(this,function(_b95){this.set("userResult",_b95);}));}},_setUserResultAttr:function(_b96){this.set("tags",{pro:_b96.user.accountType.asString!=="anonymous"&&_b96.user.accountType.asString!=="basic",basic:_b96.user.accountType.asString!=="anonymous"&&_b96.user.accountType.asString==="basic",no_account:_b96.user.accountType.asString==="anonymous",email:!!_b96.user.emailAddresses.firstConfirmedEmailAddress,email_inactive:!!_b96.user.emailAddresses.lastUnconfirmedEmailAddress});this._set("userResult",_b96);},_setIdentityProvidersAttr:function(_b97){this._set("identityProviders",_b97);this.set("sublineinfo",{identityProviderId:this.identityProviders[0]});},_setContactAttr:function(_b98){if(this._destroyed){return;}if(!_b98){return;}this.set("tags",{student:_b85.some(_b98.companyUserRoles||[],function(role){return role==="student";}),no_account:true,email:!!_b98.emailAdresses.firstConfirmedEmailAddress,email_inactive:!!_b98.emailAdresses.lastUnconfirmedEmailAddress});this.set("userId",_b98.userId||this.get("userId"));this._set("contact",_b98);},_setEmailAdressesAttr:function(_b99){this.set("tags",{email:_b99&&(!!_b99.confirmedEmailAdress),email_inactive:_b99&&(!!_b99.unconfirmedEmailAdress||(!_b99.confirmedEmailAdress&&!_b99.unconfirmedEmailAdress))});this._set("emailAdresses",_b99);},_setTagsAttr:function(tags){if(!tags){this.set("tags",_b90());}else{if(lang.isString(tags)){var _b9a=this.get("tags");_b9a[tags]=true;this.set("tags",_b9a);}else{if(lang.isObject(tags)){var _b9a=lang.mixin({},this.get("tags")||_b90(),tags);_b8a.forIn(_b9a,function(v,_b9b){if(this._tagNodes[_b9b]){_b86.toggle(this._tagNodes[_b9b],"hideBlock",!v);}},this);this._set("tags",_b9a);}else{}}}}});});},"cb/widget/OnboardingProgressBar":function(){define(["dojo","dojo/dom-style","dojox/lang/functional","dijit/_Widget","cb/widget/_TemplatedMixin","sp/I18n","sp/infos/InfoManager","dojo/text!./OnboardingProgressBar.html","dojo/i18n!./nls/OnboardingProgressBar"],function(dojo,_b9c,_b9d,_b9e,_b9f,_ba0,_ba1,_ba2,i18n){var _ba3=dojo.declare([_b9e,_b9f],{templateString:_ba2,i18n:i18n,_setProgressAttr:function(_ba4){this._set("progress",_ba4);_b9c.set(this._barNode,"width",_ba4+"%");if(_ba4==100){this._labelNode.innerHTML=_ba0.wrap(i18n)("bar_label_done",[_ba4]);}else{this._labelNode.innerHTML=_ba0.wrap(i18n)("bar_label",[_ba4]);}}});return dojo.declare([_ba3],{baseClass:"onboarding-progress",postCreate:function(){this.inherited(arguments);this.connect(_ba1,"onInvalidate",function(_ba5){if(_ba5.type==="onboardingtasks"&&_ba5.id===sp.info.user.id){this._reload();}});this._reload();},_reload:function(){_ba1.getById({type:"onboardingtasks",id:sp.info.user.id}).then(dojo.hitch(this,function(_ba6){var _ba7,_ba8;_ba7=_ba8=_b9d.foldl(_ba6.onboardingtasks,function(acc,_ba9,key){acc.count++;if(_ba9){acc.done++;}return acc;},{count:0,done:0});this.set("progress",_ba7.count===0?100:Math.floor(_ba7.done/_ba7.count*100));}));}});});},"cb/widget/UpgradeButton":function(){define(["dojo/_base/declare","dojo/dom-construct","dojo/dom-attr","dojo/dom-class","dijit/_WidgetBase","sp/dialog/UpgradeDialog","sp/dialog/TooltipDialog","sp/dialog/Dialog","sp/I18n","dojo/i18n!./nls/UpgradeButton"],function(_baa,_bab,_bac,_bad,_bae,_baf,_bb0,_bb1,_bb2,i18n){return _baa([_bae],{upgradeDialogContent:null,buttonClass:"button small",postMixInProperties:function(){this.inherited(arguments);this.sourceHtml=this.srcNodeRef.innerHTML;},buildRendering:function(){this.inherited(arguments);this.domNode=_bab.create("span",{"class":"upgrade-button"},this.domNode);if(this.sourceHtml!=""){this.domNode.innerHTML=this.sourceHtml;}else{this.domNode.innerHTML=_bb2.wrap(i18n)("upgrade_label");}},postCreate:function(){this.inherited(arguments);this.connect(this.domNode,"click","_handleClick");_bad.add(this.domNode,this.buttonClass);},onCreateSuccess:function(_bb3){},onCreateError:function(_bb4){},_handleClick:function(_bb5){var _bb6=new _baf({dialogContent:this.upgradeDialogContent});var p=this.getParent();while(p){if(p.isInstanceOf(_bb0)||p.isInstanceOf(_bb1)){p.hide();break;}p=p.getParent();}_bb6.show();}});});},"cb/contacts/ContactSelectStoreFactory":function(){define(["dojo","dojo/DeferredList","dojo/on","dojo/when","dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/dom-class","dojo/dom-attr","dojox/lang/functional","dojo/store/Memory","dojo/store/Observable","dojo/promise/all","sp/infos/InfoManager","cb/api/Api","cb/util","sp/I18n","dojo/i18n!./nls/Contacts"],function(dojo,_bb7,on,when,lang,_bb8,_bb9,_bba,_bbb,_bbc,_bbd,_bbe,_bbf,all,_bc0,Api,util,_bc1,i18n){var I18N=_bc1.wrap(i18n);var _bc2={notStudent:function notStudent(_bc3){return dojo.indexOf(_bc3.contact.companyUserRoles,"student")===-1;},onlyProAccounts:function onlyProAccounts(_bc4){return _bc4.userResult&&!(_bc4.userResult.user.accountType.asString==="anonymous"||_bc4.userResult.user.accountType.asString==="basic");},sameCompany:function sameCompany(_bc5){return sp.info.company&&sp.info.company.id&&sp.info.company.id===_bc5.contact.companyId;},defaultPredicate:["onlyProAccounts"]};function _bc6(_bc7,_bc8){var _bc9=_bc7.userResult;var _bca=_bc9?_bc9.user.displayname:_bc7.contact.displayname;_bc8.add({id:_bc7.contact.contactType+"/"+_bc7.contact.contactId,contactType:_bc7.contact.contactType,userId:_bc7.contact.userId,displayname:_bca,contact:_bc7.contact,userResult:_bc7.userResult,companyId:_bc7.contact.companyId,sortKey:_bca.toLocaleLowerCase()});return _bc7;};function _bcb(_bcc,_bcd){if(!sp||!sp.info||!sp.info.company||!sp.info.company.id){return when(true);}_bcc.add({id:"conceptboard/loading",type:"loading",providerId:"conceptboard"});return Api.Caching.contacts.get().then(function(_bce){return all(_bb8.map(_bce.data,function(_bcf){var _bd0=_bcf.userId?_bc0.getById({type:"user",id:_bcf.userId}):null;return when(_bd0).then(function(_bd1){return {contact:_bcf,userResult:_bd1};});})).then(function(_bd2){return _bb8.filter(_bd2,_bcd);});}).then(function(_bd3){_bb8.forEach(_bd3,function(_bd4){_bc6(_bd4,_bcc);});_bcc.remove("conceptboard/loading");return true;}).otherwise(function(){return false;});};function _bd5(_bd6,_bd7){if(!_bd7){return _bd6;}return [_bd6,function(_bd8){return _bd7(_bd8.contact.userId);}];};function _bd9(p){if(lang.isString(p)){return _bc2[p]||_bd9(null);}else{if(lang.isArray(p)){var ps=_bb8.map(p,_bd9);return function(_bda){return _bbd.foldl(ps,function(_bdb,p){return _bdb&&p(_bda);},true);};}else{if(lang.isFunction(p)){return p;}else{return function(){return true;};}}}};return {create:function(_bdc){_bdc=_bdc||{};var _bdd=new _bbe();var _bde=_bdc.predicate||_bc2["defaultPredicate"];_bde=_bd5(_bde,_bdc.isUserIdAllowedFunction);var _bdf=_bd9(_bde);var _be0=_bcb(_bdd,_bdf);_be0.then(function(){Api.Listen.contacts.get().onInvalidate(util.debounce(function(){_bcb(_bdd,_bdf);},1000));});var ret=_bbf(_bdd);ret.fillPromise=_be0;return ret;},defaultPredicate:_bd9(_bc2["defaultPredicate"])};});},"dijit/form/FilteringSelect":function(){define(["dojo/data/util/filter","dojo/_base/declare","dojo/_base/lang","dojo/when","./MappedTextBox","./ComboBoxMixin"],function(_be1,_be2,lang,when,_be3,_be4){return _be2("dijit.form.FilteringSelect",[_be3,_be4],{required:true,_lastDisplayedValue:"",_isValidSubset:function(){return this._opened;},isValid:function(){return !!this.item||(!this.required&&this.get("displayedValue")=="");},_refreshState:function(){if(!this.searchTimer){this.inherited(arguments);}},_callbackSetLabel:function(_be5,_be6,_be7,_be8){if((_be6&&_be6[this.searchAttr]!==this._lastQuery)||(!_be6&&_be5.length&&this.store.getIdentity(_be5[0])!=this._lastQuery)){return;}if(!_be5.length){this.set("value","",_be8||(_be8===undefined&&!this.focused),this.textbox.value,null);}else{this.set("item",_be5[0],_be8);}},_openResultList:function(_be9,_bea,_beb){if(_bea[this.searchAttr]!==this._lastQuery){return;}this.inherited(arguments);if(this.item===undefined){this.validate(true);}},_getValueAttr:function(){return this.valueNode.value;},_getValueField:function(){return "value";},_setValueAttr:function(_bec,_bed,_bee,item){if(!this._onChangeActive){_bed=null;}if(item===undefined){if(_bec===null||_bec===""){_bec="";if(!lang.isString(_bee)){this._setDisplayedValueAttr(_bee||"",_bed);return;}}var self=this;this._lastQuery=_bec;when(this.store.get(_bec),function(item){self._callbackSetLabel(item?[item]:[],undefined,undefined,_bed);});}else{this.valueNode.value=_bec;this.inherited(arguments);}},_setItemAttr:function(item,_bef,_bf0){this.inherited(arguments);this._lastDisplayedValue=this.textbox.value;},_getDisplayQueryString:function(text){return text.replace(/([\\\*\?])/g,"\\$1");},_setDisplayedValueAttr:function(_bf1,_bf2){if(_bf1==null){_bf1="";}if(!this._created){if(!("displayedValue" in this.params)){return;}_bf2=false;}if(this.store){this.closeDropDown();var _bf3=lang.clone(this.query);var qs=this._getDisplayQueryString(_bf1),q;if(this.store._oldAPI){q=qs;}else{q=_be1.patternToRegExp(qs,this.ignoreCase);q.toString=function(){return qs;};}this._lastQuery=_bf3[this.searchAttr]=q;this.textbox.value=_bf1;this._lastDisplayedValue=_bf1;this._set("displayedValue",_bf1);var _bf4=this;var _bf5={ignoreCase:this.ignoreCase,deep:true};lang.mixin(_bf5,this.fetchProperties);this._fetchHandle=this.store.query(_bf3,_bf5);when(this._fetchHandle,function(_bf6){_bf4._fetchHandle=null;_bf4._callbackSetLabel(_bf6||[],_bf3,_bf5,_bf2);},function(err){_bf4._fetchHandle=null;if(!_bf4._cancelingQuery){console.error("dijit.form.FilteringSelect: "+err.toString());}});}},undo:function(){this.set("displayedValue",this._lastDisplayedValue);}});});},"dojo/data/util/sorter":function(){define(["../../_base/lang"],function(lang){var _bf7={};lang.setObject("dojo.data.util.sorter",_bf7);_bf7.basicComparator=function(a,b){var r=-1;if(a===null){a=undefined;}if(b===null){b=undefined;}if(a==b){r=0;}else{if(a>b||a==null){r=1;}}return r;};_bf7.createSortFunction=function(_bf8,_bf9){var _bfa=[];function _bfb(attr,dir,comp,s){return function(_bfc,_bfd){var a=s.getValue(_bfc,attr);var b=s.getValue(_bfd,attr);return dir*comp(a,b);};};var _bfe;var map=_bf9.comparatorMap;var bc=_bf7.basicComparator;for(var i=0;i<_bf8.length;i++){_bfe=_bf8[i];var attr=_bfe.attribute;if(attr){var dir=(_bfe.descending)?-1:1;var comp=bc;if(map){if(typeof attr!=="string"&&("toString" in attr)){attr=attr.toString();}comp=map[attr]||bc;}_bfa.push(_bfb(attr,dir,comp,_bf9));}}return function(rowA,rowB){var i=0;while(i<_bfa.length){var ret=_bfa[i++](rowA,rowB);if(ret!==0){return ret;}}return 0;};};return _bf7;});},"cb/infobanner/BoardClaimBanner":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/dom-construct","dojo/dom-attr","dojo/on","dojo/dom-class","dojo/query","dojo/html","dojo/Deferred","dojo/promise/all","cb/infobanner/Banner","sp/infos/InfoManager","cb/Capabilities","sp/ajax/AjaxEngine","sp/I18n","dojo/i18n!./nls/BannerMessages"],function(_bff,lang,_c00,_c01,on,_c02,_c03,_c04,_c05,_c06,_c07,_c08,_c09,_c0a,_c0b,i18n){var _c0c="boardClaimBanner";var _c0d=_bff([_c07],{bannerId:_c0c,isCloseable:true,buildRendering:function(){this.analyticsBannerId="claim board";this.defaultIconClass="fonticon-briefcase";this.defaultMessage=_c0b.wrap(i18n)("claim_board");this.inherited(arguments);},postCreate:function(){this.inherited(arguments);_c03(".js-claim",this.domNode).on("click",lang.hitch(this,function(){sp.global.analytics.trackEvent(this.analyticsCategory,"click claim board");_c0a.claimDocument({documentId:sp.info.document.document.id}).then(lang.hitch(this,function(){window.location.reload();}));}));}});_c0d.addToContainerIfNecessary=function addToContainerIfNecessary(_c0e){return _c0e.addIfNotPresent(_c0c,function(){var _c0f;if(sp.info.document){_c0f=_c08.getById({type:"user",id:sp.info.document.document.ownerId}).then(function(_c10){return _c10.user;});}else{_c0f=new _c05();_c0f.resolve(null);}var _c11=_c08.getById({type:"user",id:sp.info.user.id}).then(function(_c12){return _c12.user.accountType.asString;});return _c06({boardOwner:_c0f,userAccountType:_c11}).then(function(_c13){var _c14=_c13.boardOwner?_c13.boardOwner:null;var _c15=_c14?_c14.accountType.asString:null;var _c16=_c13.userAccountType;if(_c15==="anonymous"&&_c16!=="anonymous"){return new _c0d();}});});};return _c0d;});},"cb/api/ApiEngine":function(){define(["dojo/_base/array","dojo/_base/lang","dojo/when","dojo/Deferred","dojo/json","dojo/request","dojo/request/util","dojo/request/handlers","dojo/dom-construct","./Types","cb/util"],function(_c17,lang,when,_c18,json,_c19,_c1a,_c1b,_c1c,_c1d,_c1e){var _c1f={timeout:10*60*1000,handleAs:"json",headers:{"Content-Type":"application/json","X-is-ajax-call":"true","X-CB-CSRF":sp.info.user.nonce},addValidationHelper:true};var _c20=_c1d.CbApiError;var _c21=_c1d.ClientCbApiError;var _c22=_c1d.ApiResponse;function _c23(_c24){if(_c24 instanceof _c20){return _c24;}else{if(_c24 instanceof _c21){return _c24;}else{return new _c21(_c24);}}};function _c25(_c26){throw _c23(_c26);};function _c27(_c28){return function(url,_c29){_c29=lang.delegate(_c29||{});_c29.method=_c28;if(_c29.data!==undefined&&!lang.isString(_c29.data)){_c29.data=json.stringify(_c1a.deepCopy({},_c29.data));}_c29=_c1a.deepCreate(_c1f,_c29);var ret=_c19.call(null,url,_c29).response.then(function(_c2a){if(_c2a.data&&_c2a.data.problemType){throw new _c20(_c2a);}return new _c22(_c2a);},function(_c2b){if(_c2b.response&&_c2b.response.data&&_c2b.response.data.problemType){throw new _c20(_c2b.response,_c2b);}throw _c2b;}).otherwise(_c25);ret.then(null,function(_c2c){if(console["warn"]){console["warn"]("error on api call",arguments,_c2c.stack);}throw _c2c;});return ret;};};function _c2d(Api,_c2e){var _c2f={};var ret={};var i;for(i in Api){if(i in _c2f){continue;}else{if(i[0]!==i[0].toLowerCase()){ret[i]=Api[i];}else{if(i[0]==="_"){ret[i]=Api[i];}else{if(lang.isFunction(Api[i])){ret[i]=_c2e(Api[i],i);}else{if(lang.isObject(Api[i])){ret[i]=_c2d(Api[i],_c2e);}else{ret[i]=Api[i];}}}}}}return ret;};function _c30(fn){return function(){try{return when(fn.apply(this,arguments)).otherwise(_c25);}catch(e){return new _c18().reject(_c23(e));}};};function _c31(_c32,_c33){_c32=lang.delegate(_c32);var _c34=_c32.get;function _c35(){if(arguments.length===1){var _c36=arguments[0];var _c37=_c33.get(_c36);var _c38;if(_c37){_c38=lang.delegate(_c37.response);var _c39=new _c18();_c39.CachingApi=lang.delegate(_c38.CachingApi);_c39.CachingApi.hit=true;_c1e.defer(function(){_c38.then(function(_c3a){_c39.resolve(_c3a);},function(_c3b){_c39.reject(_c3b);});});return _c39;}else{_c38=lang.delegate(_c34.apply(this,arguments));_c38.CachingApi={hit:false};var _c3c={response:_c38,cachedAt:new Date()};_c1e.defer(function(){_c33.set(_c36,_c3c);});_c38.otherwise(function(_c3d){if(_c3c===_c33.get(_c36)){_c33.set(_c36,null);}throw _c3d;});return _c38;}}else{return _c34.apply(this,arguments);}};_c32.get=_c35;return _c32;};function _c3e(_c3f,_c40){_c3f=lang.delegate(_c3f);function _c41(){if(arguments.length===1){_c40.set(arguments[0],null);}return null;};_c3f.get=_c41;_c3f.post=_c3f.put=_c3f.del=function(){return null;};return _c3f;};function _c42(_c43,_c44){_c43=lang.delegate(_c43);function _c45(){if(arguments.length===1){return (function(_c46){return {onInvalidate:function(fn){return _c44.watch(_c46,function(key,old,_c47){if(old&&!_c47){fn();}});}};})(arguments[0]);}return function(){return null;};};_c43.get=_c45;_c43.post=_c43.put=_c43.del=function(){return {onInvalidate:function(){return null;}};};return _c43;};var ret={defaultOptions:_c1a.deepCreate({},_c1f),wrapResponsePromise:_c30,mapApiFunctions:_c2d,makeCachingApiEngine:_c31,makeInvalidatingApiEngine:_c3e,makeListeningApiEngine:_c42};_c17.forEach(["GET","POST","PUT","DELETE","PATCH"],function(_c48){ret[(_c48==="DELETE"?"DEL":_c48).toLowerCase()]=_c27(_c48);});return ret;});},"cb/user/UserDisplay":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/dom-class","dojo/dom-attr","dojo/dom-construct","dojo/on","dojo/Deferred","dojo/when","dojox/lang/functional","dijit/_WidgetBase","cb/widget/_TemplatedMixin","cb/util","sp/I18n","sp/infos/InfoManager","cb/widget/UserDialog","cb/api/Api","./UserTags","dojo/text!./UserDisplay.html","dojo/i18n!./nls/User"],function(_c49,_c4a,lang,_c4b,_c4c,_c4d,on,_c4e,when,_c4f,_c50,_c51,_c52,_c53,_c54,_c55,Api,_c56,_c57,i18n){var I18N=_c53.wrap(i18n);var _c58=_c49([_c50,_c51],{identityProviders:null,userId:null,emailAdresses:null,forceEmailSubline:false,displayname:null,contact:null,size:"medium",reduced:false,templateString:_c57,userDialogClass:_c55,dialogAvailable:false,bemBaseClass:"user-display",constructor:function(){this._updateDisplay=_c52.debounce(lang.hitch(this,this._updateDisplay),150);},postMixInProperties:function(){this.inherited(arguments);if(!this.identityProviders){this.identityProviders=[];}},buildRendering:function(){this.inherited(arguments);this._userTags=new _c56({userId:this.userId,contact:this.contact},this._tagsNode);},postCreate:function(){this.inherited(arguments);this.own(this.watch("userId",lang.hitch(this,function(){this.set("dialogAvailable",(this.userId&&this.userDialogClass));})));this.own(on(this.domNode,".profile-image:click",lang.hitch(this,function(e){this._toggleDialog();})));},_toggleDialog:function(show){if(this._destroyed){return;}if(!this.get("dialogAvailable")){return;}this._initDialog();if(this.dialog){when(this.dialog).then(lang.hitch(this,function(_c59){if(show||!_c59.isOpen()){_c59.show(this._profileImageNode);}else{_c59.hide();}}));}},_initDialog:function(){if(this.dialog||!this.userDialogClass){return;}if(this.userId){var _c5a=(this.dialog=new _c4e());var _c5b=this.userDialogClass;_c54.getById({type:"user",id:this.userId}).then(function(_c5c){_c54.getById({type:"companyuser",id:_c5c.user.id}).then(function(_c5d){if(_c5d.companyuser.companyId){return _c54.getById({type:"company",id:_c5d.companyuser.companyId});}else{return null;}}).always(function(_c5e){_c5a.resolve(new _c5b({user:_c5c.user,company:_c5e&&_c5e.company?_c5e.company:null}));});});}},_setDialogAvailableAttr:function(_c5f){if(this._destroyed){return;}_c4b.toggle(this._profileImageNode,"profile_image--with-dialog",_c5f);this._set("dialogAvailable",_c5f);},_setUserIdAttr:function(_c60){this._set("userId",_c60);this._userTags.set("userId",_c60);if(_c60){_c54.getById({type:"user",id:_c60}).then(lang.hitch(this,function(_c61){this.set("userResult",_c61);}));}this.set("emailAdresses",this.get("emailAdresses"));this.set("sublineinfo",this.get("sublineinfo"));},_setUserResultAttr:function(_c62){if(this._destroyed){return;}if(_c62){this.set("displayname",_c62.user.displayname);this.set("profileImageUserId",_c62.user.id);this.set("emailAdresses",{confirmedEmailAdress:_c62.user.emailAddresses.firstConfirmedEmailAddress,unconfirmedEmailAdress:_c62.user.emailAddresses.lastUnconfirmedEmailAddress});this._set("userId",_c62.user.id);}this._set("userResult",_c62);},_setEmailAdressesAttr:function(_c63){if(this._destroyed){return;}this._userTags.set("emailAdresses",_c63);if(_c63&&(_c63.confirmedEmailAdress||_c63.unconfirmedEmailAdress)){if(!this.get("userId")){this.set("sublineinfo",{email:(_c63.confirmedEmailAdress||_c63.unconfirmedEmailAdress)});}else{if(this.forceEmailSubline){this.set("sublineinfo",{email:(_c63.confirmedEmailAdress||_c63.unconfirmedEmailAdress)});}else{this.set("sublineinfo",{email:null});}}}this.set("displayname",this.get("displayname"));_c4b.toggle(this._noemailbadgeNode,"hideBlock",_c63&&_c63.confirmedEmailAdress);_c4c.set(this._noemailbadgeNode,"title",I18N("badge_title_noemail"));this._set("emailAdresses",_c63);},_setIdentityProvidersAttr:function(_c64){if(this._destroyed){return;}this._set("identityProviders",_c64);this.set("sublineinfo",{identityProviderId:this.identityProviders[0]});},_setContactAttr:function(_c65){if(this._destroyed){return;}if(_c65.identityProviders){this.set("identityProviders",_c65.identityProviders);}if(_c65.emailAdresses){this.set("emailAdresses",{unconfirmedEmailAdress:_c65.emailAdresses.lastUnconfirmedEmailAddress,confirmedEmailAdress:_c65.emailAdresses.firstConfirmedEmailAddress});}this._userTags.set("contact",_c65);this.set("displayname",_c65.displayname||this.get("displayname"));this.set("userId",_c65.userId||this.get("userId"));this._set("contact",_c65);},_setContactIdentifierAttr:function(_c66){Api.Caching.contacts.getContact(_c66.type,_c66.id).then(lang.hitch(this,function(_c67){this.set("contact",_c67.data);this._set("contactIdentifier",_c66);}));},_setProfileImageSizeAttr:function(size){if(this._destroyed){return;}_c4b.add(this._profileImageNode.parentNode,"profile-image--"+(size||"medium"));this._set("profileImageSize",size);},_setProfileImageUserIdAttr:function(_c68){if(this._destroyed){return;}var _c69=_c68||"guest_";_c54.getById({type:"user",id:_c69}).then(lang.hitch(this,function(_c6a){if(_c6a.user.hasUserPhoto){this.set("profileImageSrc","/__/photo/"+_c6a.user.id+".medium.png");this.set("profileImageInitials",null);}else{if(_c6a.user.accountType.asString==="anonymous"){this.set("profileImageSrc",null);this.set("profileImageInitials",null);}else{this.set("profileImageSrc",null);this.set("profileImageInitials",_c6a.user.initials);}}}));},_setProfileImageSrcAttr:function(src){if(this._destroyed){return;}_c4c.set(this._profileImageImgNode,"src",src?src:"/_/images/blank_1x1.png");this._set("profileImageSrc");},_setProfileImageInitialsAttr:function(_c6b){if(this._destroyed){return;}this._profileImageInitialsNode.innerHTML=_c53.esc(_c6b?_c6b:"");this._set("profileImageInitials",_c6b);},_setDisplaynameAttr:function(_c6c){if(this._destroyed){return;}var _c6d=_c6c;if(!_c6d){var _c6e=this.get("emailAdresses");if(_c6e){_c6d=_c6e.confirmedEmailAdress||_c6e.unconfirmedEmailAdress;}}if(!_c6d){_c6d=I18N("unknown_user_displayname");}this._displaynameNode.innerHTML=_c53.esc(_c6d);this._set("displayname",_c6c);},_setSublineinfoAttr:function(_c6f){if(this._destroyed){return;}var _c70=this.get("sublineinfo");if(_c6f===null){this._sublineNode.innerHTML="";this._set("sublineinfo",_c6f);}else{if(lang.isString(_c6f)){this.set("sublineinfo",{text:_c6f});}else{if(lang.isObject(_c6f)){var _c71=lang.mixin({},this.get("sublineinfo")||{},_c6f);if(_c6f.text){this._sublineNode.innerHTML=_c53.esc(_c6f.text);this._set("sublineinfo",_c71);}else{if(_c6f.email){this._sublineNode.innerHTML=_c53.esc(_c6f.email);this._set("sublineinfo",_c71);}else{if(_c6f.identityProviderId){if(_c4a.indexOf(["conceptboard","email"],_c6f.identityProviderId)===-1&&!this.get("userId")){this._sublineNode.innerHTML=I18N("via_"+_c6f.identityProviderId);}else{this._sublineNode.innerHTML="";}this._set("sublineinfo",_c71);}else{this.set("sublineinfo",null);}}}}}}},_setSizeAttr:function(_c72){var size=_c72||"medium";_c4b.toggle(this.domNode,this.bemBaseClass+"--"+size);this.set("profileImageSize",size);this._set("size",size);},_setReducedAttr:function(_c73){_c4b.toggle(this.domNode,this.bemBaseClass+"--reduced",_c73);this._set("reduced",_c73);}});var _c74=_c49([_c58],{buildRendering:function(){this.inherited(arguments);_c4b.add(this.domNode,this.bemBaseClass+"--extended");this._shortDescriptionNode=_c4d.create("div",{"class":""},this._extendedNode);this._companyNameNode=_c4d.create("div",{"class":""},this._extendedNode);this._contactDetailsNode=_c4d.create("div",{"class":""},this._extendedNode);},_setContactAttr:function(_c75){this.inherited(arguments);if(!_c75.userId&&_c75.emailAdresses&&_c75.emailAdresses.mostUsableEmailAddress){this.set("emailAdresses",{confirmedEmailAdress:_c75.emailAdresses.firstConfirmedEmailAddress,unconfirmedEmailAdress:_c75.emailAdresses.lastUnconfirmedEmailAddress});}if(_c75.companyId){this.set("companyId",_c75.companyId);}},_setUserResultAttr:function(_c76){this.inherited(arguments);if(_c76){this._shortDescriptionNode.innerHTML=_c53.esc(_c76.user.company);this._contactDetailsNode.innerHTML=_c53.esc(_c76.user.phone);}this._set("userResult",_c76);},_setCompanyIdAttr:function(_c77){if(_c77){_c54.getById({type:"company",id:_c77}).then(lang.hitch(this,function(_c78){this.set("companyResult",_c78);}));}this._set("companyId",_c77);},_setCompanyResultAttr:function(_c79){if(_c79){this._companyNameNode.innerHTML=_c79.company.name;}else{this._companyNameNode.innerHTML="";}this._set("companyResult",_c79);}});_c58.Extended=_c74;return _c58;});},"url:cb/contacts/InviteToolReferAFriend.html":"<div class=\"\">\r\n    <p>\r\n        ${!i18n.invite_tool_referafriend_message}\r\n        <input class=\"joinlink js-select-all-input\" data-dojo-attach-point=\"_joinLinkInputNode\">\r\n    </p>\r\n    <div class=\"social-invite\">\r\n        ${!i18n.invite_tool_referafriend_social}\r\n        <div class=\"social-buttons non-fancy\">\r\n            <a data-dojo-attach-point=\"_twitterLinkNode\" href=\"http://twitter.com/share?url=${joinLink}&amp;related=conceptboardapp\" class=\"twitter button\" target=\"_blank\"><i class=\"fonticon-twitter\"></i> Twitter</a>\r\n            <a data-dojo-attach-point=\"_facebookLinkNode\" href=\"http://www.facebook.com/sharer.php?u=${joinLink}\" class=\"facebook button\"><i class=\"fonticon-facebook\"></i> Facebook</a>\r\n            <a data-dojo-attach-point=\"_googlePlusLinkNode\" href=\"https://plusone.google.com/_/+1/confirm?hl=en&amp;url=${joinLink}\" class=\"googleplus button\"><i class=\"fonticon-google\"></i> Google +</a>\r\n        </div>\r\n    </div>\r\n    <div class=\"ad-image-right\">\r\n        <h2>${!i18n.invite_tool_ad_headline}</h2>\r\n        <p>${!i18n.invite_tool_ad_sqm}</p>\r\n        <div class=\"video-special\">\r\n            <p>${!i18n.invite_tool_ad_videospecial}</p>\r\n            <img src=\"/_/images/invite-tool-ad_blue-bubble-man.png\" class=\"ad-image\" />\r\n        </div>\r\n    </div>\r\n</div>","cb/util-hashtags":function(){define(["dojo/_base/array","dojo/when"],function(arr,when){var ret={};var _c7a="#\\[((/hashtags/([^\\]/]+?)/[^\\]]+?)(?:#([^\\]]+?)))\\]";function _c7b(text){var re=new RegExp(_c7a,"i");var _c7c=re.exec(text);return {link:_c7c[1],id:_c7c[2],providerId:_c7c[3],displayname:(_c7c[4]?decodeURIComponent(_c7c[4]):null)};};ret.getHashtagIdsFromText=function getHashtagIdsFromText(text){return arr.map(ret.getHashtagsFromText(text),function(tag){return tag.id;});};ret.getHashtagsFromText=function getHashtagsFromText(text){var ret=[];var re=new RegExp(_c7a,"gi");var _c7d;while((_c7d=re.exec(text))!==null){ret.push(_c7b(_c7d[0]));}return ret;};ret.convertTextToFullyEnrichedMarkup=function convertTextToFullyEnrichedMarkup(text,_c7e,_c7f){var re=new RegExp(_c7a,"gi");return when(text.replace(re,function(_c80){var tag=_c7b(_c80);if(!tag){return _c80;}_c7e=_c7e||"";var _c81="";var _c82="";if(tag.providerId==="trello"){_c81="<img src=\"/_/images/Trello-Icon_24.png\" "+_c7e+"/>";_c82="title=\"Card created in "+tag.displayname+"\"";}return "<span class=\"hashtag\" "+_c7e+_c82+" >"+_c81+"#"+tag.displayname+"</span>";}));};return ret;});},"cb/contacts/ContactsTableRow":function(){define(["dojo/ready","dojo/on","dojo/aspect","dojo/query","dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/dom-class","dojo/dom-attr","dojo/json","dojox/lang/functional","dojo/store/Memory","dojo/store/Observable","dojo/Stateful","dojo/date/stamp","dojo/behavior","dijit/registry","dijit/_WidgetBase","cb/widget/_TemplatedMixin","dijit/_Container","dijit/form/Select","sp/dialog/TooltipDialog","sp/dialog/DialogContentWithoutTemplate","cb/api/Api","cb/Capabilities","cb/widget/_HideableMixin","cb/util","sp/ajax/AjaxEngine","sp/infos/InfoManager","sp/I18n","cb/user/UserDisplay","sp/ActivityIndicatorMixin","./RoleSelect","dojo/text!./ContactsTableRow.html","dojo/text!./ContactsTableRowInvitationInfo.html","dojo/text!./ContactsTableRowActions.html","dojo/i18n!./nls/Contacts"],function(_c83,on,_c84,_c85,lang,_c86,_c87,_c88,_c89,_c8a,json,_c8b,_c8c,_c8d,_c8e,_c8f,_c90,_c91,_c92,_c93,_c94,_c95,_c96,_c97,Api,_c98,_c99,_c9a,_c9b,_c9c,_c9d,_c9e,_c9f,_ca0,_ca1,_ca2,_ca3,i18n){var I18N=_c9d.wrap(i18n);var _ca4=_c9a.relayMethodInvocation;var _ca5=_c9a.watchAndGetImmediately;var _ca6=_c87([_c92,_c93,_c9f],{templateString:_ca3,mode:"none",contact:null,i18n:i18n,_setModeAttr:function(mode){if(this._destroyed){return;}_c89.toggle(this._generalButtonNode,"hideBlock",mode!=="general");_c89.toggle(this._deleteTeammemberButtonNode,"hideBlock",mode!=="deleteTeammember");_c89.toggle(this._cancelInviteButtonNode,"hideBlock",mode!=="cancelInvite");_c89.toggle(this._removeContactButtonNode,"hideBlock",mode!=="removeContact");this._set("mode",mode);},_setContactAttr:function(_ca7){if(this._destroyed){return;}if(_ca7.userId===sp.info.user.info.id){this.set("mode","none");}else{if(_ca7.contactType==="company"){_c98.checkIsManager().then(lang.hitch(this,function(_ca8){if(_ca8){this.set("mode","general");if(this._deleteTeammemberButtonNode){_c8a.set(this._deleteTeammemberButtonNode,"href","/__/company/users/"+_ca7.contactId+"/delete");}}else{this.set("mode","none");}}));}else{if(_ca7.contactType==="contact"){this.set("mode","general");}else{this.set("mode","none");}}}this._set("contact",_ca7);},_handleGeneralClick:function(){if(!this.contact){return;}if(this.contact.contactType==="company"){_c98.checkIsManager().then(lang.hitch(this,function(_ca9){if(_ca9){if(this.contact.userId){this.set("mode","deleteTeammember");}else{this.set("mode","cancelInvite");}}else{this.set("mode","none");}}));}else{if(this.contact.contactType==="contact"){if(!this.contact.userId||(this.contact.invitationStatus&&(this.contact.invitationStatus.status==="pending"||this.contact.invitationStatus.status==="declined"))){this.set("mode","cancelInvite");}else{this.set("mode","removeContact");}}}},onContactManipulated:function(_caa){},_handleDeleteContactClick:function(){this.set("active",true);Api.contacts.delContact(this.contact.contactType,this.contact.contactId).then(lang.hitch(this,function(){this.onContactManipulated(this.contact);})).always(lang.hitch(this,function(){this.set("active",false);}));}});var _cab=_c87([_c92,_c99],{buildRendering:function(){this.inherited(arguments);this.domNode.innerHTML="<span class=\"contacts-table__row__relation__invite small button\">"+I18N("relation_info_invite_hint")+"</span>";_c89.add(this.domNode,"invite-hint");},postCreate:function(){this.inherited(arguments);this.own(on(this.domNode,".contacts-table__row__relation__invite:click",lang.hitch(this,this._handleInviteLinkClick)));},_setContactAttr:function(_cac){if(this._destroyed){return;}_c98.checkIsManager().then(lang.hitch(this,function(_cad){if(!_cad){this.set("hidden",true);}else{if(_cac.userId===sp.info.user.info.id){this.set("hidden",true);}else{if(_cac.contactType==="company"){this.set("hidden",true);}else{if(!sp.info.user.info.accountType.hasUserRoles){this.set("hidden",true);}else{if(_cac.emailAdresses&&_cac.emailAdresses.oneEmailAddress){this.set("hidden",false);}else{if(_cac.userId){this.set("hidden",false);}else{this.set("hidden",true);}}}}}}this._set("contact",_cac);}));},onContactManipulated:function(){},_handleInviteLinkClick:function(_cae){_c98.checkIsManager().then(lang.hitch(this,function(_caf){var _cb0=lang.delegate(this.contact);var self=this;if(_caf){var _cb1=new _c96({content:"<div class=\"dialog-content tooltip-hint-content\"><fieldset><ul><li>"+I18N("invite_tool_contact_inline_message")+"</li><li><div data-dojo-type=\"cb/contacts/RoleSelectRadio\"></div></li><li><div class=\"button full-width\">"+I18N("invite_submit")+"</div></li></ul></fieldset></div>",position:["below-centered","below","above-centered","above"],i18n:i18n,postCreate:function(){this.inherited("postCreate",arguments);this.own(on(this.domNode,".button:click",lang.hitch(this,this._handleSubmitClick)));},_handleSubmitClick:function(_cb2){var _cb3=this;var _cb4=[];if(_cb0.emailAdresses&&_cb0.emailAdresses.oneEmailAddress){_cb4.push({providerId:"email",providerUserId:_cb0.emailAdresses.oneEmailAddress});}if(_cb0.userId){_cb4.push({providerId:"conceptboard",providerUserId:_cb0.userId});}Api.contacts.post({companyUserRoles:this.get("roles"),contactType:"company",contactId:null,displayname:this.get("displayname"),identifiers:_cb4}).then(function(){return Api.contacts.delContact(_cb0.contactType,_cb0.contactId);}).then(function(){_cb3.hide();self.onContactManipulated(_cb0);}).otherwise(function(_cb5){Api.Validate.withSpec(_cb5,{errorCode:"generic",dom:Api.Validate.errorDom(this,_cb2.target,"after")});});},_getRolesAttr:function(){return _c86.filter(_c91.findWidgets(this.containerNode),function(w){return w.isInstanceOf(_ca0.RadioGroup);})[0].get("roles");},_getDisplaynameAttr:function(){return _cb0.displayname||(_cb0.emailAdresses?_cb0.emailAdresses.oneEmailAddress:null);}}).show(_cae.target);}else{new _c96({content:"<div class=\"dialog-content tooltip-hint-content\">"+I18N("invite_tool_contact_manager_message")+"</div>",i18n:i18n,postCreate:function(){this.inherited("postCreate",arguments);}}).show(_cae.target);}}));}});var _cb6=_c87([_c92,_c9f,_ca0.RolesTranslationMixin],{mode:"text",buildRendering:function(){this.inherited(arguments);this._textNode=_c88.create("div",{"class":"contacts-table__row__relation__text"},this.domNode,"first");this.inviteHint=new _cab(null,_c88.create("div",null,this.domNode,"last"));_ca4(this.inviteHint,this,"onContactManipulated");},onContactManipulated:function(){},_initSelectWidget:function(_cb7){if(this._destroyed){return;}this._selectWidget=new _ca0(lang.mixin({buildRendering:function(){this.inherited("buildRendering",arguments);_c89.add(this.domNode,"clean");}},_cb7),_c88.create("div",null,this.domNode,"first"));if(this.value){this._selectWidget.set("value",this.value);}this.own(this._selectWidget.watch("value",lang.hitch(this,function(attr,_cb8,role){this.set("value",role);})));this.own(this.watch("roles",lang.hitch(this,function(attr,_cb9,_cba){if(!_c9a.equalSets(_cb9,_cba)){if(this.contact&&this.contact.contactType==="company"){if(!_c9a.equalSets(_cba,this.contact.companyUserRoles)){this._handleRolesChange(_cba);}}}})));},_setContactAttr:function(_cbb){if(this._destroyed){return;}this._set("contact",_cbb);this.inviteHint.set("contact",_cbb);if(_cbb.contactType==="company"){_c98.checkIsManager().then(lang.hitch(this,function(_cbc){if(_cbc&&sp.info.company.id===_cbb.companyId&&_cbb.userId!==sp.info.user.info.id){this.set("mode","select");}else{this.set("mode","text");}}));this.set("roles",_cbb.companyUserRoles);}else{if(_cbb.contactType==="contact"){this.set("mode","text");this.set("value",null);this.set("referredStatus",_cbb.referredMe?"referredMe":(_cbb.referredByMe?"referredByMe":null));this.set("invitationStatus",_cbb.invitationStatus);}}},_setModeAttr:function(mode){if(this._destroyed){return;}switch(mode){case "text":_c89.toggle(this._textNode,"hideBlock",false);if(this._selectWidget){this._selectWidget.set("hidden",true);}break;case "select":_c89.toggle(this._textNode,"hideBlock",true);if(!this._selectWidget){this._initSelectWidget({hidden:false});}this._selectWidget.set("hidden",false);break;}this._set("mode",mode);},_setValueAttr:function(_cbd){if(this._destroyed){return;}this._textNode.innerHTML=this._determineDisplayText(_cbd,this.get("referredStatus"),this.get("invitationStatus"),this.get("contact"));if(this._selectWidget){this._selectWidget.set("value",_cbd);}this._set("value",_cbd);},_setReferredStatusAttr:function(_cbe){if(this._destroyed){return;}this._textNode.innerHTML=this._determineDisplayText(this.get("value"),_cbe,this.get("invitationStatus"),this.get("contact"));this._set("referredStatus",_cbe);},_setInvitationStatusAttr:function(_cbf){if(this._destroyed){return;}this._textNode.innerHTML=this._determineDisplayText(this.get("value"),this.get("referredStatus"),_cbf,this.get("contact"));this._set("invitationStatus",_cbf);},_determineDisplayText:function(_cc0,_cc1,_cc2,_cc3){if(_cc3){switch(_cc3.contactType){case "company":return I18N("role_"+_cc0)+((_cc3.userId===sp.info.user.info.id)?", "+I18N("role_text_myself"):"");case "contact":default:if(_cc3.userId===sp.info.user.info.id){return I18N("role_text_myself");}else{if(_cc3.invitation_accepted_or_null){return I18N("role_text_contact");}else{return I18N("role_text_invited");}}}}else{return I18N("role_text_invited");}},_handleRolesChange:function(_cc4){if(this.contact&&this.contact.companyId&&this.contact.contactType==="company"){this.set("active",true);_c9b.updateCompanyUserRoles({companyId:this.contact.companyId,companyUserId:this.contact.contactId,roles:_cc4}).then(lang.hitch(this,function(){if(this.contact.userId){_c9c.invalidateById({type:"companyuser",id:this.contact.userId});}}),lang.hitch(this,function(e){this.set("roles",this.contact.companyUserRoles);})).always(lang.hitch(this,function(){this.set("active",false);this.onContactManipulated(this.contact);}));}}});var _cc5=_c87([_c92,_c93,_c99],{templateString:_ca2,i18n:i18n,contact:null,_setContactAttr:function(_cc6){if(this._destroyed){return;}this._set("contact",_cc6);if(_cc6.invitationStatus){this.set("invitationInfo",{createdAt:_cc6.invitationStatus.createdAt?_c8f.fromISOString(_cc6.invitationStatus.createdAt):null,joinLink:_cc6.invitationStatus.invitationLink,status:_cc6.invitationStatus.status});}else{this.set("invitationInfo",null);}},_setInvitationInfoAttr:function(_cc7){if(this._destroyed){return;}if(_cc7===null){this.set("disabled",true);this.set("hidden",true);}else{if(_cc7.status==="pending"){this._messageNode.innerHTML=I18N("pending_invited_at",[_cc7.createdAt]);this.set("disabled",false);this.set("hidden",false);}else{if(_cc7.status==="aborted"){this._messageNode.innerHTML=I18N("aborted_invited_at",[_cc7.createdAt]);this.set("disabled",true);this.set("hidden",false);}else{if(_cc7.status==="declined"){this._messageNode.innerHTML=I18N("decline_invited_at",[_cc7.createdAt]);this.set("disabled",false);this.set("hidden",false);}else{this.set("disabled",true);this.set("hidden",true);}}}}if(_cc7&&!_cc7.joinLink){this.set("disabled",true);}this._set("invitationInfo",_cc7);},_setDisabledAttr:function(_cc8){if(this._destroyed){return;}_cc8=!!_cc8;_c89.toggle(this._reinviteControlsNode,"hideBlock",_cc8);this._set("disabled",_cc8);},_handleReinviteLinkClick:function(e){if(this.get("disabled")){return;}if(this._destroyed){return;}if(this._validationErrors){this._validationErrors.remove();}this.set("active",true);Api.contacts.post(this.get("contact")).otherwise(function(_cc9){Api.Validate.withSpec({messageCode:"generic",dom:Api.Validate.errorDom(this,"_errorMessagesNode","last")});}).then(function(){sp.global.err.showMessage("invitation","",I18N("invitation_sent_message_title"));}).always(lang.hitch(this,function(){this.set("active",false);}));},_handleShowInviteLinkClick:function(e){if(this.get("disabled")){return;}if(this._destroyed){return;}var _cca=this.get("invitationInfo");if(!_cca||!_cca.joinLink){return;}new _c96({content:"<div class=\"dialog-content contacts-table-show-invite-link-dialog\"><p>"+I18N("show_invite_link_message")+"</p><input class=\"full-width js-select-all-input\" type=\"text\" value=\""+_cca.joinLink+"\"></input></div>",postCreate:function(){this.inherited("postCreate",arguments);_c90.apply(this.domNode);}}).show(this._showInviteLinkNode);}});var _ccb=_c87([_c92,_c93],{templateString:_ca1,buildRendering:function(){this.inherited(arguments);this._userWidget=new _c9e.Extended({size:"large"},_c88.create("div",null,this._userNode));this._relationWidget=new _cb6(null,_c88.create("div",{"class":"clearfix"},this._relationNode));this._invitationWidget=new _cc5(null,_c88.create("div",null,this._relationNode));this._actionsWidget=new _ca6(null,_c88.create("div",null,this._actionsNode));},_setContactAttr:function(_ccc){if(this._destroyed){return;}this._set("contact",_ccc);this._userWidget.set("contact",_ccc);this._invitationWidget.set("contact",_ccc);this._relationWidget.set("contact",_ccc);this._actionsWidget.set("contact",_ccc);_ca4(this._relationWidget,this,"onContactManipulated");_ca4(this._actionsWidget,this,"onContactManipulated");if(_ccc.userId===sp.info.user.info.id){this.set("multiSelectable",false);}else{if(_ccc.userId){_c9c.getById({type:"user",id:_ccc.userId}).then(lang.hitch(this,function(_ccd){this.set("multiSelectable",_ccd.user.emailAddresses.confirmedEmailAddressPresent);}));}else{this.set("multiSelectable",(_ccc.emailAdresses?_ccc.emailAdresses.confirmedEmailAddressPresent:null));}}},_setMultiSelectableAttr:function(_cce){if(this._destroyed){return;}_cce=!!_cce;_c8a.set(this._checkBoxNode,"disabled",!_cce);this._set("multiSelectable",_cce);},_getSelectedAttr:function(){return this.get("multiSelectable")&&_c8a.get(this._checkBoxNode,"checked");},onContactManipulated:function(_ccf){}});return _ccb;});},"dijit/form/_FormSelectWidget":function(){define(["dojo/_base/array","dojo/_base/Deferred","dojo/aspect","dojo/data/util/sorter","dojo/_base/declare","dojo/dom","dojo/dom-class","dojo/_base/kernel","dojo/_base/lang","dojo/query","dojo/when","dojo/store/util/QueryResults","./_FormValueWidget"],function(_cd0,_cd1,_cd2,_cd3,_cd4,dom,_cd5,_cd6,lang,_cd7,when,_cd8,_cd9){var _cda=_cd4("dijit.form._FormSelectWidget",_cd9,{multiple:false,options:null,store:null,query:null,queryOptions:null,labelAttr:"",onFetch:null,sortByLabel:true,loadChildrenOnOpen:false,onLoadDeferred:null,getOptions:function(_cdb){var _cdc=_cdb,opts=this.options||[],l=opts.length;if(_cdc===undefined){return opts;}if(lang.isArray(_cdc)){return _cd0.map(_cdc,"return this.getOptions(item);",this);}if(lang.isObject(_cdb)){if(!_cd0.some(this.options,function(o,idx){if(o===_cdc||(o.value&&o.value===_cdc.value)){_cdc=idx;return true;}return false;})){_cdc=-1;}}if(typeof _cdc=="string"){for(var i=0;i<l;i++){if(opts[i].value===_cdc){_cdc=i;break;}}}if(typeof _cdc=="number"&&_cdc>=0&&_cdc<l){return this.options[_cdc];}return null;},addOption:function(_cdd){if(!lang.isArray(_cdd)){_cdd=[_cdd];}_cd0.forEach(_cdd,function(i){if(i&&lang.isObject(i)){this.options.push(i);}},this);this._loadChildren();},removeOption:function(_cde){if(!lang.isArray(_cde)){_cde=[_cde];}var _cdf=this.getOptions(_cde);_cd0.forEach(_cdf,function(i){if(i){this.options=_cd0.filter(this.options,function(node){return (node.value!==i.value||node.label!==i.label);});this._removeOptionItem(i);}},this);this._loadChildren();},updateOption:function(_ce0){if(!lang.isArray(_ce0)){_ce0=[_ce0];}_cd0.forEach(_ce0,function(i){var _ce1=this.getOptions(i),k;if(_ce1){for(k in i){_ce1[k]=i[k];}}},this);this._loadChildren();},setStore:function(_ce2,_ce3,_ce4){var _ce5=this.store;_ce4=_ce4||{};if(_ce5!==_ce2){var h;while((h=this._notifyConnections.pop())){h.remove();}if(!_ce2.get){lang.mixin(_ce2,{_oldAPI:true,get:function(id){var _ce6=new _cd1();this.fetchItemByIdentity({identity:id,onItem:function(_ce7){_ce6.resolve(_ce7);},onError:function(_ce8){_ce6.reject(_ce8);}});return _ce6.promise;},query:function(_ce9,_cea){var _ceb=new _cd1(function(){if(_cec.abort){_cec.abort();}});_ceb.total=new _cd1();var _cec=this.fetch(lang.mixin({query:_ce9,onBegin:function(_ced){_ceb.total.resolve(_ced);},onComplete:function(_cee){_ceb.resolve(_cee);},onError:function(_cef){_ceb.reject(_cef);}},_cea));return new _cd8(_ceb);}});if(_ce2.getFeatures()["dojo.data.api.Notification"]){this._notifyConnections=[_cd2.after(_ce2,"onNew",lang.hitch(this,"_onNewItem"),true),_cd2.after(_ce2,"onDelete",lang.hitch(this,"_onDeleteItem"),true),_cd2.after(_ce2,"onSet",lang.hitch(this,"_onSetItem"),true)];}}this._set("store",_ce2);}if(this.options&&this.options.length){this.removeOption(this.options);}if(this._queryRes&&this._queryRes.close){this._queryRes.close();}if(_ce4.query){this._set("query",_ce4.query);this._set("queryOptions",_ce4.queryOptions);}if(_ce2){this._loadingStore=true;this.onLoadDeferred=new _cd1();this._queryRes=_ce2.query(this.query,this.queryOptions);when(this._queryRes,lang.hitch(this,function(_cf0){if(this.sortByLabel&&!_ce4.sort&&_cf0.length){if(_cf0[0].getValue){_cf0.sort(_cd3.createSortFunction([{attribute:_ce2.getLabelAttributes(_cf0[0])[0]}],_ce2));}else{var _cf1=this.labelAttr;_cf0.sort(function(a,b){return a[_cf1]>b[_cf1]?1:b[_cf1]>a[_cf1]?-1:0;});}}if(_ce4.onFetch){_cf0=_ce4.onFetch.call(this,_cf0,_ce4);}_cd0.forEach(_cf0,function(i){this._addOptionForItem(i);},this);if(this._queryRes.observe){this._queryRes.observe(lang.hitch(this,function(_cf2,_cf3,_cf4){if(_cf3==_cf4){this._onSetItem(_cf2);}else{if(_cf3!=-1){this._onDeleteItem(_cf2);}if(_cf4!=-1){this._onNewItem(_cf2);}}}),true);}this._loadingStore=false;this.set("value","_pendingValue" in this?this._pendingValue:_ce3);delete this._pendingValue;if(!this.loadChildrenOnOpen){this._loadChildren();}else{this._pseudoLoadChildren(_cf0);}this.onLoadDeferred.resolve(true);this.onSetStore();}),function(err){console.error("dijit.form.Select: "+err.toString());this.onLoadDeferred.reject(err);});}return _ce5;},_setValueAttr:function(_cf5,_cf6){if(!this._onChangeActive){_cf6=null;}if(this._loadingStore){this._pendingValue=_cf5;return;}var opts=this.getOptions()||[];if(!lang.isArray(_cf5)){_cf5=[_cf5];}_cd0.forEach(_cf5,function(i,idx){if(!lang.isObject(i)){i=i+"";}if(typeof i==="string"){_cf5[idx]=_cd0.filter(opts,function(node){return node.value===i;})[0]||{value:"",label:""};}},this);_cf5=_cd0.filter(_cf5,function(i){return i&&i.value;});if(!this.multiple&&(!_cf5[0]||!_cf5[0].value)&&opts.length){_cf5[0]=opts[0];}_cd0.forEach(opts,function(i){i.selected=_cd0.some(_cf5,function(v){return v.value===i.value;});});var val=_cd0.map(_cf5,function(i){return i.value;}),disp=_cd0.map(_cf5,function(i){return i.label;});if(typeof val=="undefined"||typeof val[0]=="undefined"){return;}this._setDisplay(this.multiple?disp:disp[0]);this.inherited(arguments,[this.multiple?val:val[0],_cf6]);this._updateSelection();},_getDisplayedValueAttr:function(){var val=this.get("value");if(!lang.isArray(val)){val=[val];}var ret=_cd0.map(this.getOptions(val),function(v){if(v&&"label" in v){return v.label;}else{if(v){return v.value;}}return null;},this);return this.multiple?ret:ret[0];},_loadChildren:function(){if(this._loadingStore){return;}_cd0.forEach(this._getChildren(),function(_cf7){_cf7.destroyRecursive();});_cd0.forEach(this.options,this._addOptionItem,this);this._updateSelection();},_updateSelection:function(){this._set("value",this._getValueFromOpts());var val=this.value;if(!lang.isArray(val)){val=[val];}if(val&&val[0]){_cd0.forEach(this._getChildren(),function(_cf8){var _cf9=_cd0.some(val,function(v){return _cf8.option&&(v===_cf8.option.value);});_cd5.toggle(_cf8.domNode,this.baseClass.replace(/\s+|$/g,"SelectedOption "),_cf9);_cf8.domNode.setAttribute("aria-selected",_cf9?"true":"false");},this);}},_getValueFromOpts:function(){var opts=this.getOptions()||[];if(!this.multiple&&opts.length){var opt=_cd0.filter(opts,function(i){return i.selected;})[0];if(opt&&opt.value){return opt.value;}else{opts[0].selected=true;return opts[0].value;}}else{if(this.multiple){return _cd0.map(_cd0.filter(opts,function(i){return i.selected;}),function(i){return i.value;})||[];}}return "";},_onNewItem:function(item,_cfa){if(!_cfa||!_cfa.parent){this._addOptionForItem(item);}},_onDeleteItem:function(item){var _cfb=this.store;this.removeOption(_cfb.getIdentity(item));},_onSetItem:function(item){this.updateOption(this._getOptionObjForItem(item));},_getOptionObjForItem:function(item){var _cfc=this.store,_cfd=(this.labelAttr&&this.labelAttr in item)?item[this.labelAttr]:_cfc.getLabel(item),_cfe=(_cfd?_cfc.getIdentity(item):null);return {value:_cfe,label:_cfd,item:item};},_addOptionForItem:function(item){var _cff=this.store;if(_cff.isItemLoaded&&!_cff.isItemLoaded(item)){_cff.loadItem({item:item,onItem:function(i){this._addOptionForItem(i);},scope:this});return;}var _d00=this._getOptionObjForItem(item);this.addOption(_d00);},constructor:function(_d01){this._oValue=(_d01||{}).value||null;this._notifyConnections=[];},buildRendering:function(){this.inherited(arguments);dom.setSelectable(this.focusNode,false);},_fillContent:function(){if(!this.options){this.options=this.srcNodeRef?_cd7("> *",this.srcNodeRef).map(function(node){if(node.getAttribute("type")==="separator"){return {value:"",label:"",selected:false,disabled:false};}return {value:(node.getAttribute("data-"+_cd6._scopeName+"-value")||node.getAttribute("value")),label:String(node.innerHTML),selected:node.getAttribute("selected")||false,disabled:node.getAttribute("disabled")||false};},this):[];}if(!this.value){this._set("value",this._getValueFromOpts());}else{if(this.multiple&&typeof this.value=="string"){this._set("value",this.value.split(","));}}},postCreate:function(){this.inherited(arguments);this.connect(this,"onChange","_updateSelection");var _d02=this.store;if(_d02&&(_d02.getIdentity||_d02.getFeatures()["dojo.data.api.Identity"])){this.store=null;this.setStore(_d02,this._oValue);}},startup:function(){this._loadChildren();this.inherited(arguments);},destroy:function(){var h;while((h=this._notifyConnections.pop())){h.remove();}if(this._queryRes&&this._queryRes.close){this._queryRes.close();}this.inherited(arguments);},_addOptionItem:function(){},_removeOptionItem:function(){},_setDisplay:function(){},_getChildren:function(){return [];},_getSelectedOptionsAttr:function(){return this.getOptions(this.get("value"));},_pseudoLoadChildren:function(){},onSetStore:function(){}});return _cda;});},"dijit/form/Select":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/dom-attr","dojo/dom-class","dojo/dom-geometry","dojo/_base/event","dojo/i18n","dojo/_base/lang","dojo/sniff","./_FormSelectWidget","../_HasDropDown","../Menu","../MenuItem","../MenuSeparator","../Tooltip","dojo/text!./templates/Select.html","dojo/i18n!./nls/validate"],function(_d03,_d04,_d05,_d06,_d07,_d08,i18n,lang,has,_d09,_d0a,Menu,_d0b,_d0c,_d0d,_d0e){var _d0f=_d04("dijit.form._SelectMenu",Menu,{autoFocus:true,buildRendering:function(){this.inherited(arguments);var o=(this.menuTableNode=this.domNode);var n=(this.domNode=this.ownerDocument.createElement("div"));n.style.cssText="overflow-x: hidden; overflow-y: scroll";if(o.parentNode){o.parentNode.replaceChild(n,o);}_d06.remove(o,"dijitMenuTable");n.className=o.className+" dijitSelectMenu";o.className="dijitReset dijitMenuTable";o.setAttribute("role","listbox");n.setAttribute("role","presentation");n.appendChild(o);},postCreate:function(){this.inherited(arguments);this.connect(this.domNode,"onselectstart",_d08.stop);},focus:function(){var _d10=false,val=this.parentWidget.value;if(lang.isArray(val)){val=val[val.length-1];}if(val){_d03.forEach(this.parentWidget._getChildren(),function(_d11){if(_d11.option&&(val===_d11.option.value)){_d10=true;this.focusChild(_d11,false);}},this);}if(!_d10){this.inherited(arguments);}},resize:function(mb){if(mb){_d07.setMarginBox(this.domNode,mb);if("w" in mb){this.menuTableNode.style.width="100%";}}}});var _d12=_d04("dijit.form.Select",[_d09,_d0a],{baseClass:"dijitSelect dijitValidationTextBox",templateString:_d0e,_buttonInputDisabled:has("ie")?"disabled":"",required:false,state:"",message:"",tooltipPosition:[],emptyLabel:"&#160;",_isLoaded:false,_childrenLoaded:false,_fillContent:function(){this.inherited(arguments);if(this.options.length&&!this.value&&this.srcNodeRef){var si=this.srcNodeRef.selectedIndex||0;this.value=this.options[si>=0?si:0].value;}this.dropDown=new _d0f({id:this.id+"_menu",parentWidget:this});_d06.add(this.dropDown.domNode,this.baseClass.replace(/\s+|$/g,"Menu "));},_getMenuItemForOption:function(_d13){if(!_d13.value&&!_d13.label){return new _d0c({ownerDocument:this.ownerDocument});}else{var _d14=lang.hitch(this,"_setValueAttr",_d13);var item=new _d0b({option:_d13,label:_d13.label||this.emptyLabel,onClick:_d14,ownerDocument:this.ownerDocument,dir:this.dir,disabled:_d13.disabled||false});item.focusNode.setAttribute("role","option");return item;}},_addOptionItem:function(_d15){if(this.dropDown){this.dropDown.addChild(this._getMenuItemForOption(_d15));}},_getChildren:function(){if(!this.dropDown){return [];}return this.dropDown.getChildren();},_loadChildren:function(_d16){if(_d16===true){if(this.dropDown){delete this.dropDown.focusedChild;}if(this.options.length){this.inherited(arguments);}else{_d03.forEach(this._getChildren(),function(_d17){_d17.destroyRecursive();});var item=new _d0b({ownerDocument:this.ownerDocument,label:this.emptyLabel});this.dropDown.addChild(item);}}else{this._updateSelection();}this._isLoaded=false;this._childrenLoaded=true;if(!this._loadingStore){this._setValueAttr(this.value,false);}},_refreshState:function(){if(this._started){this.validate(this.focused);}},startup:function(){this.inherited(arguments);this._refreshState();},_setValueAttr:function(_d18){this.inherited(arguments);_d05.set(this.valueNode,"value",this.get("value"));this._refreshState();},_setDisabledAttr:function(_d19){this.inherited(arguments);this._refreshState();},_setRequiredAttr:function(_d1a){this._set("required",_d1a);this.focusNode.setAttribute("aria-required",_d1a);this._refreshState();},_setOptionsAttr:function(_d1b){this._isLoaded=false;this._set("options",_d1b);},_setDisplay:function(_d1c){var lbl=_d1c||this.emptyLabel;this.containerNode.innerHTML="<span role=\"option\" class=\"dijitReset dijitInline "+this.baseClass.replace(/\s+|$/g,"Label ")+"\">"+lbl+"</span>";},validate:function(_d1d){var _d1e=this.disabled||this.isValid(_d1d);this._set("state",_d1e?"":(this._hasBeenBlurred?"Error":"Incomplete"));this.focusNode.setAttribute("aria-invalid",_d1e?"false":"true");var _d1f=_d1e?"":this._missingMsg;if(_d1f&&this.focused&&this._hasBeenBlurred){_d0d.show(_d1f,this.domNode,this.tooltipPosition,!this.isLeftToRight());}else{_d0d.hide(this.domNode);}this._set("message",_d1f);return _d1e;},isValid:function(){return (!this.required||this.value===0||!(/^\s*$/.test(this.value||"")));},reset:function(){this.inherited(arguments);_d0d.hide(this.domNode);this._refreshState();},postMixInProperties:function(){this.inherited(arguments);this._missingMsg=i18n.getLocalization("dijit.form","validate",this.lang).missingMessage;},postCreate:function(){this.inherited(arguments);this.connect(this.domNode,"onselectstart",_d08.stop);this.domNode.setAttribute("aria-expanded","false");if(has("ie")<9){this.defer(function(){try{var s=domStyle.getComputedStyle(this.domNode);if(s){var ff=s.fontFamily;if(ff){var _d20=this.domNode.getElementsByTagName("INPUT");if(_d20){for(var i=0;i<_d20.length;i++){_d20[i].style.fontFamily=ff;}}}}}catch(e){}});}},_setStyleAttr:function(_d21){this.inherited(arguments);_d06.toggle(this.domNode,this.baseClass.replace(/\s+|$/g,"FixedWidth "),!!this.domNode.style.width);},isLoaded:function(){return this._isLoaded;},loadDropDown:function(_d22){this._loadChildren(true);this._isLoaded=true;_d22();},closeDropDown:function(){this.inherited(arguments);if(this.dropDown&&this.dropDown.menuTableNode){this.dropDown.menuTableNode.style.width="";}},destroy:function(_d23){if(this.dropDown&&!this.dropDown._destroyed){this.dropDown.destroyRecursive(_d23);delete this.dropDown;}this.inherited(arguments);},_onFocus:function(){this.validate(true);this.inherited(arguments);},_onBlur:function(){_d0d.hide(this.domNode);this.inherited(arguments);this.validate(false);}});_d12._Menu=_d0f;return _d12;});},"sp/dialog/Dialog":function(){define(["dijit","dojo","dojox","dojo/i18n!sp/dialog/nls/Dialog","dojo/require!dijit/Dialog,sp/I18nWidget"],function(_d24,dojo,_d25){dojo.provide("sp.dialog.Dialog");dojo.require("dijit.Dialog");dojo.require("sp.I18nWidget");dojo.requireLocalization("sp.dialog","Dialog");_d24.Dialog._DialogLevelManager._beginZIndex=64007;dojo.declare("sp.dialog.Dialog",[_d24.Dialog,sp.I18nWidget],{disableEsc:false,showAt:function(){this.show();},_setContentAttr:function(data){this.inherited(arguments);this.content=data;},startup:function(){this.inherited(arguments);if(this.content&&this.content.startup&&!this.content._started){this.content.startup();}},show:function(){if(this.open){return;}if(!this._alreadyInitialized){this._setup();this._alreadyInitialized=true;}if(this._fadeOutDeferred){this._fadeOutDeferred.cancel();}if(!this.disableUpdatePosition){this._modalconnects.push(dojo.connect(window,"onscroll",this,"resize"));this._modalconnects.push(dojo.connect(window,"onresize",this,function(){var _d26=dojo.window.getBox();if(!this._oldViewport||_d26.h!=this._oldViewport.h||_d26.w!=this._oldViewport.w){this.resize();this._oldViewport=_d26;}}));}this._modalconnects.push(dojo.connect(this.domNode,"onkeypress",this,"_onKey"));dojo.style(this.domNode,{opacity:0,display:""});this._set("open",true);this._onShow();this._size();this._position();var _d27;this._fadeInDeferred=new dojo.Deferred(dojo.hitch(this,function(){_d27.stop();delete this._fadeInDeferred;}));_d27=dojo.fadeIn({node:this.domNode,duration:this.duration,beforeBegin:dojo.hitch(this,function(){_d24.Dialog._DialogLevelManager.show(this,this.underlayAttrs);if(!this._started){this.startup();}}),onEnd:dojo.hitch(this,function(){if(this.autofocus&&_d24.Dialog._DialogLevelManager.isTop(this)){this._getFocusItems(this.domNode);_d24.focus(this._firstFocusItem);}this._fadeInDeferred.callback(true);delete this._fadeInDeferred;})}).play();return this._fadeInDeferred;},_onKey:function(evt){if(evt.charOrCode){var dk=dojo.keys;var node=evt.target;if(evt.charOrCode===dk.TAB){this._getFocusItems(this.domNode);}var _d28=(this._firstFocusItem==this._lastFocusItem);if(node==this._firstFocusItem&&evt.shiftKey&&evt.charOrCode===dk.TAB){if(!_d28){_d24.focus(this._lastFocusItem);}dojo.stopEvent(evt);}else{if(node==this._lastFocusItem&&evt.charOrCode===dk.TAB&&!evt.shiftKey){if(!_d28){_d24.focus(this._firstFocusItem);}dojo.stopEvent(evt);}else{while(node){if(node==this.domNode||dojo.hasClass(node,"dijitPopup")){if(evt.charOrCode==dk.ESCAPE&&!this.disableEsc){this.onCancel();}else{return;}}node=node.parentNode;}if(evt.charOrCode!==dk.TAB){dojo.stopEvent(evt);}else{if(!dojo.isOpera){try{this._firstFocusItem.focus();}catch(e){}}}}}}}});});},"cb/page/dashboard/MainContent":function(){define(["dojo","dojo/_base/lang","dojo/on","dojo/aspect","dojo/DeferredList","dojo/promise/all","dojox/lang/functional/object","dojo/dom-style","dojo/dom-class","dojo/dom-construct","dojo/fx","dojo/_base/fx","dojo/date/stamp","dijit","dijit/_Widget","cb/widget/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","cb/Capabilities","cb/api/Api","cb/contacts/ContactsInviteDialog","sp/I18n","sp/infos/InfoManager","cb/widget/UserIconListEntry","sp/TasksList","cb/widget/SearchSubmit","./UserProfileDisplay","./UserNoticesList","sp/ActivityIndicatorMixin","./OnboardingTasks","sp/ajax/AjaxEngine","cb/util","cb/user/UserStats","dojo/text!./MainContent.html","dojo/i18n!./nls/MainContent","cb/widget/CreateBoard"],function(dojo,lang,on,_d29,_d2a,_d2b,_d2c,_d2d,_d2e,_d2f,_d30,fx,_d31,_d32,_d33,_d34,_d35,_d36,Api,_d37,_d38,_d39,_d3a,_d3b,_d3c,_d3d,_d3e,_d3f,_d40,_d41,_d42,_d43,_d44,i18n){dojo.require("cb.widget.CreateBoard");return dojo.declare([_d33,_d34,_d35],{baseClass:"main-content",templateString:_d44,i18n:i18n,postCreate:function(){this.inherited(arguments);var _d45=_d39.getById({type:"user",id:sp.info.user.info.id}).then(dojo.hitch(this,function(_d46){return _d46;}));var _d47=_d39.getById({type:"companyuser",id:sp.info.user.info.id}).then(function(_d48){if(_d48&&_d48.companyuser&&_d48.companyuser.companyId){return _d48.companyuser.companyId;}else{return null;}});_d2a.gatherResults([_d45,_d47]).then(function(_d49){return {user:_d49[0].user,isInCompany:_d49[1]!==null,userResult:_d49[0]};}).then(dojo.hitch(this,function(_d4a){this.userProfileDisplayWidget=new _d3d({user:_d4a.user},this._userProfileDisplayNode);if(sp.info.user.info.showOnboardingtasks){this.showOnboardingTasksContainer(false,true);}else{this.hideOnboardingTasksContainer(true);this.userProfileDisplayWidget.showProfileOnboardingMiniPostit();}}));var self=this;window.setTimeout(function(){var _d4b=new _d3e({query:function(item){return item.type!==35;}},self._userNoticesModuleNode);var _d4c=_d42.debounce(function(){_d2e.toggle(self._userNoticesLoadMoreContainer,"hideBlock",!_d4b.get("hasMore"));},100);dojo.forEach(["onNewItem","onRemovedItem","loadMore"],function(_d4d){_d29.after(_d4b,_d4d,_d4c);});_d39.getById({type:"onlineusers",id:sp.info.user.id}).then(function(_d4e){_d2c.forIn(_d4e.onlineusers,function(_d4f,_d50){_d4b.add({type:"clientnotice_onlineusers_live",createdAt:new Date(),isLive:true,"arguments":{documentId:_d50,activeUsers:_d4f}});});});self.own(on(self._userNoticesLoadMoreButton,"click",function(){_d4b.loadMore();}));_d4c();},0);window.setTimeout(function(){new _d3b({},self._tasksModuleNode);},200);window.setTimeout(lang.hitch(this,function(){_d2b({isManager:_d36.checkIsManager(),selfsignupAvailable:_d36.checkFeature("registration.selfsignup").then(function(_d51){return _d51==="enabled";})}).then(lang.hitch(this,function(_d52){_d2e.toggle(this._inviteParticipantsButton,"hideBlock",(!_d52.selfsignupAvailable&&!_d52.isManager));}));}),200);},startup:function(){dojo.forEach(_d32.findWidgets(this.domNode),function(w){if(w&&w.startup){w.startup();}});},resize:function(){dojo.forEach(_d32.findWidgets(this.domNode),function(w){if(w&&w.resize){w.resize();}});},showOnboardingTasksContainer:function(_d53,_d54){if(!_d54){_d41.changeUserSettingShowOnboardingtasks({userId:sp.info.user.id,state:true});}if(!this.onboardingTasksWidget){this.onboardingTasksWidget=new _d40({},this._onboardingTasksNode);}if(_d53){var _d55=_d30.wipeIn({node:this.onboardingTasksWidget.domNode,duration:350});var _d56=fx.fadeIn({node:this.onboardingTasksWidget.domNode,duration:350,delay:150});_d30.chain([_d55,_d56]).play();}_d2e.remove(this.userProfileDisplayWidget.profileData,"with-progress-bar");},hideOnboardingTasksContainer:function(_d57){if(!_d57){_d41.changeUserSettingShowOnboardingtasks({userId:sp.info.user.id,state:false});}if(this.onboardingTasksWidget){var _d58=fx.fadeOut({node:this.onboardingTasksWidget.domNode,duration:350});var _d59=_d30.wipeOut({node:this.onboardingTasksWidget.domNode,duration:350,delay:50});_d30.chain([_d58,_d59]).play();}this.userProfileDisplayWidget.showProfileOnboardingMiniPostit();},_onSearchChange:function(_d5a){if(!_d5a){return;}var hash=dojo.objectToQuery({q:_d5a});window.location="/boards#"+hash;},openContactsInviteDialog:function(){Api.Util.data(Api.Caching.referrals.get()).then(function(_d5b){new _d37({"referralStatus":_d5b}).show();return _d5b;});}});});},"cb/contacts/RoleSelectRadioPanes":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/on","dojo/when","dojo/topic","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dijit/form/RadioButton","cb/Capabilities","./RoleSelectRadio","sp/I18n","dojo/i18n!./nls/Contacts"],function(_d5c,lang,_d5d,on,when,_d5e,_d5f,_d60,_d61,_d62,_d63,_d64,_d65,i18n){var I18N=_d65.wrap(i18n);var _d66=true;_d63.checkFeature("registration.selfsignup").then(function(_d67){return _d67==="enabled";}).then(function(_d68){_d66=_d68;});return _d5c([_d64],{featuresPerRole:{"basic":["feat_sqm_5"],"external_user":["feat_sqm","feat_ssl","feat_projects","feat_mentions"],"user":["feat_sqm","feat_ssl","feat_projects","feat_mentions","feat_see"],"manager":["feat_sqm","feat_ssl","feat_projects","feat_mentions","feat_see","feat_admin"]},postMixInProperties:function(){this.inherited(arguments);this.basicAvailable=_d66;if(this.basicAvailable){this.availableValues.unshift("basic");}},buildRendering:function(){this.inherited(arguments);_d60.add(this.domNode,"role-select--panes");},_valueToRoles:function(_d69){if("basic"===_d69&&this.basicAvailable){return [];}else{return this.inherited(arguments);}},_rolesToValue:function(_d6a){if(_d6a&&_d6a.length===0&&this.basicAvailable){return "basic";}else{return this.inherited(arguments);}},_createRadioNode:function(_d6b){var li=_d61.create("li",{"class":"radiogroup-entry"},this.containerNode);var _d6c=this.get("id")+"_radio";var _d6d=_d6c+"_"+_d6b;var _d6e=_d61.create("input",{"type":"radio","name":_d6c,"id":_d6d,"value":_d6b,"title":I18N("role_title_"+_d6b),"class":"dijitReset dijitCheckBoxInput"},_d61.create("div",{"class":"role-select__option forms__custom__checkbox dijitRadio"},li));var _d6f=_d61.create("label",{"for":_d6d,"class":"role-select__label"},li);var _d70=_d61.create("div",{"class":"invitation-type-title","innerHTML":I18N("role_"+_d6b)},_d6f);_d61.create("p",{"innerHTML":I18N("role_title_"+_d6b)},_d6f);var _d71=_d61.create("ul",{"class":"role-select__label"},_d6f);if(this.featuresPerRole[_d6b]&&this.featuresPerRole[_d6b].length>0){for(var i=0;i<this.featuresPerRole[_d6b].length;i++){_d61.create("li",{"innerHTML":"<i class=\"fonticon-check\"></i> "+I18N(this.featuresPerRole[_d6b][i])},_d71);}}return _d6e;}});});},"cb/api/Validate":function(){define(["dojo/_base/lang","dojo/dom-construct","./validateWithSpec"],function(lang,_d72,_d73){return {withSpec:_d73,errorDom:function errorDom(_d74,_d75,_d76){_d76=_d76||"after";return function(_d77){var _d78=lang.isString(_d75)?_d74[_d75]:_d75;if(!_d78){return null;}return _d72.create("span",{"class":"errors "},_d78,_d76);};}};});},"dojo/store/util/QueryResults":function(){define(["../../_base/array","../../_base/lang","../../_base/Deferred"],function(_d79,lang,_d7a){var _d7b=function(_d7c){if(!_d7c){return _d7c;}if(_d7c.then){_d7c=lang.delegate(_d7c);}function _d7d(_d7e){if(!_d7c[_d7e]){_d7c[_d7e]=function(){var args=arguments;return _d7a.when(_d7c,function(_d7f){Array.prototype.unshift.call(args,_d7f);return _d7b(_d79[_d7e].apply(_d79,args));});};}};_d7d("forEach");_d7d("filter");_d7d("map");if(!_d7c.total){_d7c.total=_d7a.when(_d7c,function(_d80){return _d80.length;});}return _d7c;};lang.setObject("dojo.store.util.QueryResults",_d7b);return _d7b;});},"dijit/form/_ListBase":function(){define(["dojo/_base/declare","dojo/on","dojo/window"],function(_d81,on,_d82){return _d81("dijit.form._ListBase",null,{selected:null,_listConnect:function(_d83,_d84){var self=this;return self.own(on(self.containerNode,on.selector(function(_d85,_d86,_d87){return _d85.parentNode==_d87;},_d83),function(evt){evt.preventDefault();self[_d84](evt,this);}));},selectFirstNode:function(){var _d88=this.containerNode.firstChild;while(_d88&&_d88.style.display=="none"){_d88=_d88.nextSibling;}this._setSelectedAttr(_d88);},selectLastNode:function(){var last=this.containerNode.lastChild;while(last&&last.style.display=="none"){last=last.previousSibling;}this._setSelectedAttr(last);},selectNextNode:function(){var _d89=this.selected;if(!_d89){this.selectFirstNode();}else{var next=_d89.nextSibling;while(next&&next.style.display=="none"){next=next.nextSibling;}if(!next){this.selectFirstNode();}else{this._setSelectedAttr(next);}}},selectPreviousNode:function(){var _d8a=this.selected;if(!_d8a){this.selectLastNode();}else{var prev=_d8a.previousSibling;while(prev&&prev.style.display=="none"){prev=prev.previousSibling;}if(!prev){this.selectLastNode();}else{this._setSelectedAttr(prev);}}},_setSelectedAttr:function(node){if(this.selected!=node){var _d8b=this.selected;if(_d8b){this.onDeselect(_d8b);this.selected=null;}if(node){this.selected=node;_d82.scrollIntoView(node);this.onSelect(node);}}else{if(node){this.onSelect(node);}}}});});},"cb/infobanner/Container":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/dom-class","dojo/dom-construct","dojo/topic","dojo/when","dijit/registry","dijit/_Widget","dijit/_Container"],function(_d8c,_d8d,lang,_d8e,_d8f,_d90,when,_d91,_d92,_d93){function _d94(){return _d91.byId("global-infobanner-container");};var _d95=_d8c([_d92,_d93],{buildRendering:function(){this.inherited(arguments);this.containerNode=_d8f.create("div",{"class":"info-banner-container"},this.domNode);},isEmpty:function(){return !this.hasChildren();},hasBanner:function(_d96){return !!this.getBanner(_d96);},getBanner:function(_d97){if(!_d97){return null;}return _d8d.filter(this.getChildren(),function(c){return c.get("bannerId")===_d97;})[0];},postCreate:function(){this.inherited(arguments);this._checkEmptiness();},addChild:function(){this.inherited(arguments);this._checkEmptiness();if(borderContainer&&borderContainer.resize){borderContainer.resize();}dojo.publish("/window/resize");},addIfNotPresent:function(_d98,_d99){var ids=lang.isArray(_d98)?_d98:[_d98];if(_d8d.some(ids,function(id){return this.hasBanner(id);},this)){return;}return when(_d99()).then(lang.hitch(this,function(_d9a){if(!_d9a){return;}this.addChild(_d9a);if(!_d9a.get("bannerId")&&ids[0]){_d9a.set("bannerId",ids[0]);}}));},removeChild:function(_d9b){this.inherited(arguments);this._checkEmptiness();borderContainer.resize();},_checkEmptiness:function(){_d8e.toggle(this.domNode,"hideBlock",!this.hasChildren());}});_d95.getGlobal=_d94;return _d95;});},"cb/infobanner/LifecycleUserBanner":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/dom-construct","dojo/dom-attr","dojo/on","dojo/_base/array","dojo/dom-class","dojo/query","dojo/html","dojo/date/stamp","dojo/promise/all","cb/infobanner/Banner","sp/infos/InfoManager","sp/ajax/AjaxEngine","cb/api/Api","cb/Capabilities","./Container","sp/I18n","dojo/i18n!./nls/BannerMessages"],function(_d9c,lang,_d9d,_d9e,on,arr,_d9f,_da0,_da1,_da2,_da3,_da4,_da5,_da6,Api,_da7,_da8,_da9,i18n){var _daa="lifecycleUserBanner";var _dab=_d9c([_da4],{bannerId:_daa,isCloseable:true,preventCloseDestroy:true,daysUntilTrialEndTodisplay:null,bannerIdToShow:null,bannerIdKey:null,buildRendering:function(){this.analyticsBannerId="downgrade no cc";this.analyticsLabel=this.bannerIdKey;this.defaultIconClass="fonticon-star";this.defaultMessage=_da9.wrap(i18n)(this.bannerIdToShow,[this.daysUntilTrialEndTodisplay]);this.inherited(arguments);},postCreate:function(){this.inherited(arguments);on(this.closeLinkNode,"click",lang.hitch(this,function(_dac){Api.userbannerstatus.deleteByIdAndBannerId(sp.info.user.id,this.bannerIdToShow).always(lang.hitch(this,function(){this.getParent().removeChild(this);}));}));_da0("a.js-billing",this.domNode).on("click",lang.hitch(this,function(){sp.global.analytics.trackEvent(this.analyticsCategory,"click billing",this.analyticsLabel);return true;}));}});_dab.addToContainerIfNecessary=function addToContainerIfNecessary(_dad){return _dad.addIfNotPresent(_daa,function(){var _dae=sp.info.company&&sp.info.company.autodowngrade&&sp.info.company.activeLicense?sp.info.company.activeLicense:null;if(!_dae){return null;}else{return _da3({featureRegistrationSelfsignup:_da7.checkFeature("registration.selfsignup").then(function(_daf){return _daf==="enabled";}),isManager:_da7.checkIsManager()}).then(function(_db0){return _db0.featureRegistrationSelfsignup&&_db0.isManager;}).then(function(_db1){if(!_db1){return null;}return Api.Caching.licenses.getById(_dae);}).then(lang.hitch(this,function(_db2){if(!_db2||!_db2.data){return null;}var _db3=_db2.data;if(_db3.billable){return null;}var _db4=(_da2.fromISOString(_db3.trialUntil)-new Date())/86400000;if(_db4<-3){return null;}if(_db4>21){return null;}var _db5=_db4>0?Math.ceil(_db4):0;var _db6="";if(_db5>14){_db6="14plus";}else{if(_db5>7){_db6="7plus";}else{if(_db5>3){_db6="3plus";}else{if(_db5>1){_db6="1plus";}else{_db6="zero";}}}}var _db7="trialdowngradenocc_"+_db6;return Api.Caching.userbannerstatus.getById(sp.info.user.id).then(lang.hitch(this,function(_db8){if(_db8&&_db8.data&&_db8.data.deletedBannerIds){var _db9=_db8.data.deletedBannerIds;if(arr.indexOf(_db9,_db7)===-1){return new _dab({daysUntilTrialEndTodisplay:_db5,bannerIdToShow:_db7,bannerIdKey:_db6});}}return null;}));})).otherwise(function(e){});}});};return _dab;});},"cb/infobanner/BannerManager":function(){define(["dojo/Deferred","dojo/promise/all","./Container","dojo/when","sp/infos/InfoManager","cb/Capabilities","./BoardClaimBanner","./BoardSignupBanner","./ConfirmEmailBanner","./LifecycleUserBanner","./RequestTeamJoinBanner","./UpgradeNoFreeSqmBanner","./ChromeWebstoreRatingBanner"],function(_dba,_dbb,_dbc,when,_dbd,_dbe,_dbf,_dc0,_dc1,_dc2,_dc3,_dc4,_dc5){function _dc6(){window.setTimeout(function(){if(!sp.info.padConfig||!sp.info.padConfig.showWelcomeDialog){when(true).always(function(){if(_dbc.getGlobal().isEmpty()){return _dc0.addToContainerIfNecessary(_dbc.getGlobal());}}).otherwise(function(e){console.warn("error on BoardSignupBanner",e,e.stack);}).always(function(){if(_dbc.getGlobal().isEmpty()){return _dc3.addToContainerIfNecessary(_dbc.getGlobal());}}).otherwise(function(e){console.warn("error on RequestTeamJoinBanner",e,e.stack);}).always(function(){if(_dbc.getGlobal().isEmpty()){return _dbf.addToContainerIfNecessary(_dbc.getGlobal());}}).otherwise(function(e){console.warn("error on BoardClaimBanner",e,e.stack);}).always(function(){if(_dbc.getGlobal().isEmpty()){return _dc1.addToContainerIfNecessary(_dbc.getGlobal());}}).otherwise(function(e){console.warn("error on ConfirmEmailBanner",e,e.stack);}).always(function(){if(_dbc.getGlobal().isEmpty()){return _dc2.addToContainerIfNecessary(_dbc.getGlobal());}}).otherwise(function(e){console.warn("error on LifecycleUserBanner",e,e.stack);}).always(function(){if(_dbc.getGlobal().isEmpty()){return _dc5.addToContainerIfNecessary(_dbc.getGlobal());}}).otherwise(function(e){console.warn("error on ChromeWebstoreRatingBanner",e,e.stack);}).always(function(){return _dc4.addToContainerIfNecessary(_dbc.getGlobal());}).otherwise(function(e){console.warn("error on UpgradeNoFreeSqmBanner",e,e.stack);}).otherwise(function(_dc7){});}},0);};return {init:function init(){_dc6();},getBanner:function(id){var g=_dbc.getGlobal();if(!g||!g.hasBanner(id)){return null;}return g.getBanner(id);}};});},"dojo/dnd/common":function(){define(["../_base/connect","../_base/kernel","../_base/lang","../dom"],function(_dc8,_dc9,lang,dom){var _dca=lang.getObject("dojo.dnd",true);_dca.getCopyKeyState=_dc8.isCopyKey;_dca._uniqueId=0;_dca.getUniqueId=function(){var id;do{id=_dc9._scopeName+"Unique"+(++_dca._uniqueId);}while(dom.byId(id));return id;};_dca._empty={};_dca.isFormElement=function(e){var t=e.target;if(t.nodeType==3){t=t.parentNode;}return " button textarea input select option ".indexOf(" "+t.tagName.toLowerCase()+" ")>=0;};return _dca;});},"url:cb/widget/SecuritySettingsDisplay.html":"<span>\n    <span data-dojo-attach-point=\"_descriptionNode\" class=\"security-settings-display-description\"></span>\n</span>","url:cb/page/dashboard/UserProfileDisplay.html":"<div>\n    <h3>${!i18n.headline}</h3>\n    \n    <div class=\"profile-image-container profile-image--large\">\n        <img class=\"profile-image\" src=\"/__/photo/${user.id}.large.png\" />\n    </div>\n    \n    <div class=\"profile-data\" data-dojo-attach-point=\"profileData\">\n        <p>\n            <strong>${user.displayname}</strong>\n            <i class=\"fonticon-badge hideBlock\" data-dojo-attach-point=\"_userNameBadge\" data-dojo-attach-event=\"click:showLargeOnboardingPostit\" title=\"${!i18n.badgeTitle}\"></i><br/>\n            <span title=\"${user.emailAddresses.mostUsableEmailAddress}\">${user.emailAddresses.mostUsableEmailAddress}</span><br/>\n            <a href=\"/support\">${!i18n.support}</a>&nbsp;&nbsp;|&nbsp;&nbsp;<a href=\"/logout\">${!i18n.logout}</a>\n        </p>\n    </div>\n    \n    <div class=\"profile-onboarding-container hideBlock\" data-dojo-attach-point=\"_profileOnboardingContainer\" data-dojo-attach-event=\"click:showLargeOnboardingPostit\">\n        <p>\n            <strong>${!i18n.onboardingTitle}</strong><br/>\n            ${!i18n.onboardingText}\n        </p>\n        <i class=\"profile-onboarding-overlay fonticon-doublearrow-right\"></i>\n    </div>\n    \n    <div class=\"profile-sqm content-container\" data-dojo-attach-point=\"_profileSqm\">\n    \t<div class=\"profile-sqm-bar-container\">\n            <div class=\"profile-sqm-bar\" data-dojo-attach-point=\"_sqmBar\"></div>\n            <h1 class=\"center\"><span data-dojo-attach-point=\"_sqmHeader\">50</span>&thinsp;m²</h1>\n            <p class=\"center\" data-dojo-attach-point=\"_sqmUsageSubline\"></p>\n        </div>\n    \t<p class=\"action\">\n            <a href=\"#\" data-dojo-attach-event=\"click: openUpgradeDialog\" data-dojo-attach-point=\"_actionUpgradeNode\">\n                Get free space!\n                <span class=\"upgrade-button button small\">upgrade</span>\n            </a>\n        </p>\n    </div>\n</div>\n\t\n\t","cb/widget/InstallChromeAppDialog":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/ready","dojo/date","dojo/date/stamp","dojo/dom-construct","sp/dialog/Dialog","sp/dialog/DialogContent","sp/I18n","cb/api/Api","cb/Capabilities","dojo/i18n!./nls/InstallChromeAppDialog","dojo/text!./InstallChromeAppDialog.html"],function(_dcb,lang,_dcc,date,_dcd,_dce,_dcf,_dd0,_dd1,Api,_dd2,i18n,_dd3){var _dd4=_dcb([_dd0],{i18n:i18n,templateString:_dd3,postCreate:function(){this.inherited(arguments);},_handleInstallButtonClick:function(){sp.global.analytics.trackEvent("user engagement","click webstore install","");chrome.webstore.install("",lang.hitch(this,this.chromeInstallSuccess),lang.hitch(this,this.chromeInstallError));},_handleCloseButtonClick:function(){this.dialog.hide();sp.global.analytics.trackEvent("user engagement","close webstore install dialog","");},chromeInstallSuccess:function(){this.dialog.hide();sp.global.analytics.trackEvent("user engagement","webstore install success","",null,true);},chromeInstallError:function(err){this.dialog.hide();sp.global.analytics.trackEvent("user engagement","webstore install error",err,null,true);}});var _dd5=_dcb([_dcf],{baseClass:"install-chrome-app-dialog",destroyOnHide:true,autofocus:false,postCreate:function(){this.inherited(arguments);this.content=new _dd4({dialog:this});},onHide:function(){this.inherited(arguments);Api.users_me_flags.del("showChromeAppInstallDialog");}});function init(){if(typeof chrome==="undefined"){return null;}if(chrome.app.isInstalled){return null;}if(sp.info.document){return null;}if(!sp.info.user.isIdentified){return null;}if(date.difference(_dcd.fromISOString(sp.info.user.info.createdAt),new Date(),"minute")<30){return null;}Api.Caching.users_me_flags.get().then(lang.hitch(this,function(_dd6){if(typeof _dd6.data.showChromeAppInstallDialog==="undefined"||_dd6.data.showChromeAppInstallDialog.value!==false){_dd2.checkFeature("chromewebstoreapp.usable").then(function(_dd7){sp.global.analytics.trackEvent("user engagement","show webstore install dialog","",null,true);(new _dd5()).show();});}}));};_dd5.init=init;return _dd5;});},"dijit/form/_ComboBoxMenu":function(){define(["dojo/_base/declare","dojo/dom-class","dojo/dom-style","dojo/keys","../_WidgetBase","../_TemplatedMixin","./_ComboBoxMenuMixin","./_ListMouseMixin"],function(_dd8,_dd9,_dda,keys,_ddb,_ddc,_ddd,_dde){return _dd8("dijit.form._ComboBoxMenu",[_ddb,_ddc,_dde,_ddd],{templateString:"<div class='dijitReset dijitMenu' data-dojo-attach-point='containerNode' style='overflow: auto; overflow-x: hidden;' role='listbox'>"+"<div class='dijitMenuItem dijitMenuPreviousButton' data-dojo-attach-point='previousButton' role='option'></div>"+"<div class='dijitMenuItem dijitMenuNextButton' data-dojo-attach-point='nextButton' role='option'></div>"+"</div>",baseClass:"dijitComboBoxMenu",postCreate:function(){this.inherited(arguments);if(!this.isLeftToRight()){_dd9.add(this.previousButton,"dijitMenuItemRtl");_dd9.add(this.nextButton,"dijitMenuItemRtl");}},_createMenuItem:function(){var item=this.ownerDocument.createElement("div");item.className="dijitReset dijitMenuItem"+(this.isLeftToRight()?"":" dijitMenuItemRtl");item.setAttribute("role","option");return item;},onHover:function(node){_dd9.add(node,"dijitMenuItemHover");},onUnhover:function(node){_dd9.remove(node,"dijitMenuItemHover");},onSelect:function(node){_dd9.add(node,"dijitMenuItemSelected");},onDeselect:function(node){_dd9.remove(node,"dijitMenuItemSelected");},_page:function(up){var _ddf=0;var _de0=this.domNode.scrollTop;var _de1=_dda.get(this.domNode,"height");if(!this.getHighlightedOption()){this.selectNextNode();}while(_ddf<_de1){var _de2=this.getHighlightedOption();if(up){if(!_de2.previousSibling||_de2.previousSibling.style.display=="none"){break;}this.selectPreviousNode();}else{if(!_de2.nextSibling||_de2.nextSibling.style.display=="none"){break;}this.selectNextNode();}var _de3=this.domNode.scrollTop;_ddf+=(_de3-_de0)*(up?-1:1);_de0=_de3;}},handleKey:function(evt){switch(evt.keyCode){case keys.DOWN_ARROW:this.selectNextNode();return false;case keys.PAGE_DOWN:this._page(false);return false;case keys.UP_ARROW:this.selectPreviousNode();return false;case keys.PAGE_UP:this._page(true);return false;default:return true;}}});});},"url:cb/widget/EmailTooltip.html":"<div>\r\n    <div class=\"dialog-content email-template\">\r\n        <table>\r\n            <tr class=\"email-template__to\">\r\n                <th>${!i18n.email_tooltip_label_to}</th>\r\n                <td data-dojo-attach-point=\"_toNode\"></td>\r\n            </tr>\r\n            <tr  class=\"email-template__from\">\r\n                <th>${!i18n.email_tooltip_label_from}</th>\r\n                <td data-dojo-attach-point=\"_fromNode\"></td>\r\n            </tr>\r\n            <tr  class=\"email-template__subject\">\r\n                <th>${!i18n.email_tooltip_label_subject}</th>\r\n                <td data-dojo-attach-point=\"_subjectNode\"></td>\r\n            </tr>\r\n            <tr  class=\"email-template__body\">\r\n                <td colspan=\"2\" data-dojo-attach-point=\"_bodyNode\"></td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>","cb/Capabilities":function(){define(["dojo","dojo/_base/array","dojo/_base/lang","dojo/promise/all","dojo/when","sp/infos/InfoManager","cb/api","cb/util"],function(dojo,_de4,lang,all,when,_de5,api,util){var _de6="hasModeratorMode";var _de7="hasVideoChat";var _de8="hasForcedotcomChatter";var _de9="hasGoogleDrive";var _dea="hasSqmLimit";var _deb=function(){return all(_de4.map(arguments,function(p){return p.otherwise(function(e){return null;});}));};var _dec=function(_ded){return _de5.getById({type:"user",id:_ded}).then(function(_dee){return _dee.user;});};var _def=function(_df0){var _df1=Array.prototype.slice.call(arguments,1);return _deb.apply(null,(_df1)).then(function(_df2){return dojo.some(_df2,function(user){return !!user.accountType[_df0];});});};var _df3=function _df3(args){this.checkFn=args.checkFn;this.liveCheckCreator=args.liveCheckCreator||function(){};};_df3.prototype.watch=function watch(_df4,_df5,_df6){var _df7=this.checkFn;var _df8=this.liveCheckCreator;var _df9=Array.prototype.slice.call(arguments,1);var _dfa=function(arg){return dojo.when(arg,function(arg){return _df4(arg);});};_dfa(_df7.apply(null,_df9));_df8.apply(null,[].concat(_dfa,_df7).concat(_df9));};var _dfb=util.once;var _dfc={};var _dfd=function(_dfe){var _dff=_dfc[_dfe];return function(_e00,_e01){var _e02=Array.prototype.slice.call(arguments,0);return {then:function(fn){var _e03=[];_e03.push(_dfb(fn));Array.prototype.push.apply(_e03,_e02);_dff.watch.apply(_dff,_e03);},watch:function(fn){var _e04=[];_e04.push(fn);Array.prototype.push.apply(_e04,_e02);_dff.watch.apply(_dff,_e04);}};};};dojo.mixin(_dfc,{portfolios:new _df3({checkFn:function(){return sp.info.company?"enabled":"premium";}}),collaborateOnBoard:new _df3({checkFn:function(_e05){return _de5.getById({type:"document",id:_e05}).then(function(_e06){var _e07=_e06.document.accessControlState;if(_e07.collaboration){return "enabled";}else{if(_e07.collaborators&&dojo.some(_e07.collaborators,function(c){return c===sp.info.user.info.id;})){return "enabled";}else{return "disabled";}}});},liveCheckCreator:function(_e08,_e09,_e0a){dojo.subscribe("/sp/ajax/incoming/documentaccesscontrol",function(){_de5.invalidateById({type:"document",id:_e0a});window.setTimeout(function(){_e08(_e09(_e0a));},1);});}}),passphrase:new _df3({checkFn:function(){return _def("hasPassphrase",_dec(sp.info.user.info.id)).then(function(any){return any?"enabled":"premium";});}})});dojo.mixin(_dfc,{checkPortfolios:_dfd("portfolios"),checkPassphrase:_dfd("passphrase"),checkVideoChat:function(){return _dfc.checkFeature(["videochat"]).then(function(_e0b){if(_e0b==="enabled"){var _e0c=_dec(sp.info.document.document.ownerId);return _def(_de7,_e0c).then(function(any){return any?"enabled":"premium";});}else{return "disabled";}});},checkModerator:function(){var user=_dec(sp.info.user.info.id);var _e0d=_dec(sp.info.document.document.ownerId);return _deb(user,_e0d).then(function(_e0e){if(_e0e[0].student){return "student";}return _def(_de6,_e0d).then(function(any){return any?"enabled":"premium";});});},checkHasSqmLimt:function(){return _def(_dea,_dec(sp.info.user.info.id)).then(function(_e0f){return _e0f?"enabled":"disabled";});},checkCreateBoard:function(){return _dfc.checkHasSqmLimt().then(function(_e10){if(_e10==="disabled"){return "enabled";}else{return _de5.getById({type:"squaremeters",id:sp.info.user.info.id}).then(function(_e11){if(_e11.nofreesqm){return "nofreesqm";}else{return "enabled";}});}});},checkForcedotcomChatter:function(){return _dfc.checkFeature("forcedotcom.chatter").then(function(_e12){if(_e12==="enabled"){return _def(_de8,_dec(sp.info.user.info.id)).then(function(_e13){return _e13?"enabled":"premium";});}else{return "disabled";}});},checkGoogleDrive:function(){return _dfc.checkFeature("google.drive");},canCollaborateOnBoard:_dfd("collaborateOnBoard"),checkIsManager:function(){return _de5.getById({type:"companyuser",id:sp.info.user.info.id}).then(function(_e14){return _e14&&_e14.companyuser&&_de4.some(_e14.companyuser.roles,function(role){return role==="manager";});});},checkHasAnyRoleOf:function(_e15){return _de5.getById({type:"companyuser",id:sp.info.user.info.id}).then(function(_e16){return _e16&&_e16.companyuser&&_de4.some(_e16.companyuser.roles,function(role){return _de4.indexOf(_e15,role)!==-1;});});},checkFeature:function checkFeature(_e17){_e17=lang.isArray(_e17)?_e17:[_e17];return api.Caching.users_me_features.get(_e17).then(api.Util.data).then(function(_e18){return _de4.every(_e17,function(_e19){return _e18[_e19];});}).then(function(_e1a){return _e1a?"enabled":"disabled";});}});return _dfc;});},"dijit/Dialog":function(){define(["require","dojo/_base/array","dojo/_base/connect","dojo/_base/declare","dojo/_base/Deferred","dojo/dom","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/event","dojo/_base/fx","dojo/i18n","dojo/keys","dojo/_base/lang","dojo/on","dojo/ready","dojo/sniff","dojo/window","dojo/dnd/Moveable","dojo/dnd/TimedMoveable","./focus","./_base/manager","./_Widget","./_TemplatedMixin","./_CssStateMixin","./form/_FormMixin","./_DialogMixin","./DialogUnderlay","./layout/ContentPane","dojo/text!./templates/Dialog.html","./main","dojo/i18n!./nls/common"],function(_e1b,_e1c,_e1d,_e1e,_e1f,dom,_e20,_e21,_e22,_e23,fx,i18n,keys,lang,on,_e24,has,_e25,_e26,_e27,_e28,_e29,_e2a,_e2b,_e2c,_e2d,_e2e,_e2f,_e30,_e31,_e32){var _e33=_e1e("dijit._DialogBase",[_e2b,_e2d,_e2e,_e2c],{templateString:_e31,baseClass:"dijitDialog",cssStateNodes:{closeButtonNode:"dijitDialogCloseIcon"},_setTitleAttr:[{node:"titleNode",type:"innerHTML"},{node:"titleBar",type:"attribute"}],open:false,duration:_e29.defaultDuration,refocus:true,autofocus:true,_firstFocusItem:null,_lastFocusItem:null,doLayout:false,draggable:true,_setDraggableAttr:function(val){this._set("draggable",val);},"aria-describedby":"",maxRatio:0.9,postMixInProperties:function(){var _e34=i18n.getLocalization("dijit","common");lang.mixin(this,_e34);this.inherited(arguments);},postCreate:function(){_e22.set(this.domNode,{display:"none",position:"absolute"});this.ownerDocumentBody.appendChild(this.domNode);this.inherited(arguments);this.connect(this,"onExecute","hide");this.connect(this,"onCancel","hide");this._modalconnects=[];},onLoad:function(){this._position();if(this.autofocus&&_e35.isTop(this)){this._getFocusItems(this.domNode);_e28.focus(this._firstFocusItem);}this.inherited(arguments);},_onBlur:function(by){this.inherited(arguments);var _e36=lang.hitch(this,function(){if(this.open&&!this._destroyed&&_e35.isTop(this)){this._getFocusItems(this.domNode);_e28.focus(this._firstFocusItem);}});if(by=="mouse"){on.once(this.ownerDocument,"mouseup",_e36);}else{_e36();}},_endDrag:function(){var _e37=_e21.position(this.domNode),_e38=_e25.getBox(this.ownerDocument);_e37.y=Math.min(Math.max(_e37.y,0),(_e38.h-_e37.h));_e37.x=Math.min(Math.max(_e37.x,0),(_e38.w-_e37.w));this._relativePosition=_e37;this._position();},_setup:function(){var node=this.domNode;if(this.titleBar&&this.draggable){this._moveable=new ((has("ie")==6)?_e27:_e26)(node,{handle:this.titleBar});this.connect(this._moveable,"onMoveStop","_endDrag");}else{_e20.add(node,"dijitDialogFixed");}this.underlayAttrs={dialogId:this.id,"class":_e1c.map(this["class"].split(/\s/),function(s){return s+"_underlay";}).join(" "),ownerDocument:this.ownerDocument};},_size:function(){this._checkIfSingleChild();if(this._singleChild){if(typeof this._singleChildOriginalStyle!="undefined"){this._singleChild.domNode.style.cssText=this._singleChildOriginalStyle;delete this._singleChildOriginalStyle;}}else{_e22.set(this.containerNode,{width:"auto",height:"auto"});}var bb=_e21.position(this.domNode);var _e39=_e25.getBox(this.ownerDocument);_e39.w*=this.maxRatio;_e39.h*=this.maxRatio;if(bb.w>=_e39.w||bb.h>=_e39.h){var _e3a=_e21.position(this.containerNode),w=Math.min(bb.w,_e39.w)-(bb.w-_e3a.w),h=Math.min(bb.h,_e39.h)-(bb.h-_e3a.h);if(this._singleChild&&this._singleChild.resize){if(typeof this._singleChildOriginalStyle=="undefined"){this._singleChildOriginalStyle=this._singleChild.domNode.style.cssText;}this._singleChild.resize({w:w,h:h});}else{_e22.set(this.containerNode,{width:w+"px",height:h+"px",overflow:"auto",position:"relative"});}}else{if(this._singleChild&&this._singleChild.resize){this._singleChild.resize();}}},_position:function(){if(!_e20.contains(this.ownerDocumentBody,"dojoMove")){var node=this.domNode,_e3b=_e25.getBox(this.ownerDocument),p=this._relativePosition,bb=p?null:_e21.position(node),l=Math.floor(_e3b.l+(p?p.x:(_e3b.w-bb.w)/2)),t=Math.floor(_e3b.t+(p?p.y:(_e3b.h-bb.h)/2));_e22.set(node,{left:l+"px",top:t+"px"});}},_onKey:function(evt){if(evt.charOrCode){var node=evt.target;if(evt.charOrCode===keys.TAB){this._getFocusItems(this.domNode);}var _e3c=(this._firstFocusItem==this._lastFocusItem);if(node==this._firstFocusItem&&evt.shiftKey&&evt.charOrCode===keys.TAB){if(!_e3c){_e28.focus(this._lastFocusItem);}_e23.stop(evt);}else{if(node==this._lastFocusItem&&evt.charOrCode===keys.TAB&&!evt.shiftKey){if(!_e3c){_e28.focus(this._firstFocusItem);}_e23.stop(evt);}else{while(node){if(node==this.domNode||_e20.contains(node,"dijitPopup")){if(evt.charOrCode==keys.ESCAPE){this.onCancel();}else{return;}}node=node.parentNode;}if(evt.charOrCode!==keys.TAB){_e23.stop(evt);}else{if(!has("opera")){try{this._firstFocusItem.focus();}catch(e){}}}}}}},show:function(){if(this.open){return;}if(!this._started){this.startup();}if(!this._alreadyInitialized){this._setup();this._alreadyInitialized=true;}if(this._fadeOutDeferred){this._fadeOutDeferred.cancel();}var win=_e25.get(this.ownerDocument);this._modalconnects.push(on(win,"scroll",lang.hitch(this,"resize")));this._modalconnects.push(on(this.domNode,_e1d._keypress,lang.hitch(this,"_onKey")));_e22.set(this.domNode,{opacity:0,display:""});this._set("open",true);this._onShow();this._size();this._position();var _e3d;this._fadeInDeferred=new _e1f(lang.hitch(this,function(){_e3d.stop();delete this._fadeInDeferred;}));_e3d=fx.fadeIn({node:this.domNode,duration:this.duration,beforeBegin:lang.hitch(this,function(){_e35.show(this,this.underlayAttrs);}),onEnd:lang.hitch(this,function(){if(this.autofocus&&_e35.isTop(this)){this._getFocusItems(this.domNode);_e28.focus(this._firstFocusItem);}this._fadeInDeferred.resolve(true);delete this._fadeInDeferred;})}).play();return this._fadeInDeferred;},hide:function(){if(!this._alreadyInitialized||!this.open){return;}if(this._fadeInDeferred){this._fadeInDeferred.cancel();}var _e3e;this._fadeOutDeferred=new _e1f(lang.hitch(this,function(){_e3e.stop();delete this._fadeOutDeferred;}));this._fadeOutDeferred.then(lang.hitch(this,"onHide"));_e3e=fx.fadeOut({node:this.domNode,duration:this.duration,onEnd:lang.hitch(this,function(){this.domNode.style.display="none";_e35.hide(this);this._fadeOutDeferred.resolve(true);delete this._fadeOutDeferred;})}).play();if(this._scrollConnected){this._scrollConnected=false;}var h;while(h=this._modalconnects.pop()){h.remove();}if(this._relativePosition){delete this._relativePosition;}this._set("open",false);return this._fadeOutDeferred;},resize:function(){if(this.domNode.style.display!="none"){if(_e2f._singleton){_e2f._singleton.layout();}this._position();this._size();}},destroy:function(){if(this._fadeInDeferred){this._fadeInDeferred.cancel();}if(this._fadeOutDeferred){this._fadeOutDeferred.cancel();}if(this._moveable){this._moveable.destroy();}var h;while(h=this._modalconnects.pop()){h.remove();}_e35.hide(this);this.inherited(arguments);}});var _e3f=_e1e("dijit.Dialog",[_e30,_e33],{});_e3f._DialogBase=_e33;var _e35=_e3f._DialogLevelManager={_beginZIndex:950,show:function(_e40,_e41){ds[ds.length-1].focus=_e28.curNode;var _e42=_e2f._singleton;if(!_e42||_e42._destroyed){_e42=_e32._underlay=_e2f._singleton=new _e2f(_e41);}else{_e42.set(_e40.underlayAttrs);}var _e43=ds[ds.length-1].dialog?ds[ds.length-1].zIndex+2:_e3f._DialogLevelManager._beginZIndex;if(ds.length==1){_e42.show();}_e22.set(_e2f._singleton.domNode,"zIndex",_e43-1);_e22.set(_e40.domNode,"zIndex",_e43);ds.push({dialog:_e40,underlayAttrs:_e41,zIndex:_e43});},hide:function(_e44){if(ds[ds.length-1].dialog==_e44){ds.pop();var pd=ds[ds.length-1];if(!_e2f._singleton._destroyed){if(ds.length==1){_e2f._singleton.hide();}else{_e22.set(_e2f._singleton.domNode,"zIndex",pd.zIndex-1);_e2f._singleton.set(pd.underlayAttrs);}}if(_e44.refocus){var _e45=pd.focus;if(pd.dialog&&(!_e45||!dom.isDescendant(_e45,pd.dialog.domNode))){pd.dialog._getFocusItems(pd.dialog.domNode);_e45=pd.dialog._firstFocusItem;}if(_e45){try{_e45.focus();}catch(e){}}}}else{var idx=_e1c.indexOf(_e1c.map(ds,function(elem){return elem.dialog;}),_e44);if(idx!=-1){ds.splice(idx,1);}}},isTop:function(_e46){return ds[ds.length-1].dialog==_e46;}};var ds=_e3f._dialogStack=[{dialog:null,focus:null,underlayAttrs:null}];if(has("dijit-legacy-requires")){_e24(0,function(){var _e47=["dijit/TooltipDialog"];_e1b(_e47);});}return _e3f;});},"url:cb/contacts/ContactsTableRowInvitationInfo.html":"<div class=\"contacts-table__invitation-info\">\r\n    <div class=\"contacts-table__invitation-info__message\" data-dojo-attach-point=\"_messageNode\"></div>\r\n    <div data-dojo-attach-point=\"_reinviteControlsNode\">\r\n        <span class=\"contacts-table__invitation-info__reinvite-link link\" data-dojo-attach-point=\"_reinviteLinkNode\" data-dojo-attach-event=\"click:_handleReinviteLinkClick\">${!i18n.reinvite_link}</span>\r\n        |\r\n        <span class=\"contacts-table__invitation-info__show-invite-link link\" data-dojo-attach-point=\"_showInviteLinkNode\" data-dojo-attach-event=\"click:_handleShowInviteLinkClick\">${!i18n.show_invite_link}</span>\r\n    </div>\r\n    <div data-dojo-attach-point=\"_errorMessagesNode\"></div>\r\n</div>","url:cb/widget/UserList.html":"<div >\n    <ul class=\"participants-list clearfix\" data-dojo-attach-point=\"containerNode\"></ul>\n</div>","url:cb/page/boards/PortfolioInformation.html":"<div>\n    <div class=\"settings\">\n        <span class=\"back-button\" data-dojo-attach-event=\"click:_handleBackToAllBoardsClick\"><i class=\"fonticon-arrow-back\"></i> ${!i18n.back_to_boards}</span>\n    </div>\n    <h3><span data-dojo-attach-point=\"_titleNode\" class=\"title\" data-dojo-attach-event=\"click:_handleSettingsClick\">${portfolio.title}</span></h3>\n    <ul class=\"meta\">\n        <li class=\"modified\" data-dojo-attach-point=\"modifiedRow\">${!i18n.modified_at}</li>\n        <li class=\"portfolio-settings\" data-dojo-attach-event=\"click:_handleSettingsClick\" title=\"${!i18n.settings_button}\"><i class=\"fonticon-cog\"></i> ${!i18n.settings_button}</li>\n    </ul>\n    <div data-dojo-attach-point=\"containerNode\" class=\"portfolio-participants\">\n        <h3><i class=\"fonticon-participants\"></i>&nbsp;&nbsp;${!i18n.participants_title}</h3>\n    </div>\n</div>","cb/user/CurrentlyActiveUsers":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/query","dojo/dom","dojo/dom-construct","dojo/dom-class","dojo/dom-geometry","dijit/_WidgetBase","sp/I18n","cb/common/UserListUtils","cb/widget/UserIconListEntry","cb/user/UserDisplay","dojo/i18n!./nls/User"],function(_e48,lang,_e49,_e4a,dom,_e4b,_e4c,_e4d,_e4e,_e4f,_e50,_e51,_e52,i18n){var I18N=_e4f.wrap(i18n);return _e48([_e4e],{baseClass:"currently-active-users",customClass:null,users:[],listEntryNodes:[],maxUsers:5,buildRendering:function(){this.inherited(arguments);this.domNode=_e4b.create("ul",null,this.domNode);_e4c.add(this.domNode,this.baseClass+" "+this.customClass);},postCreate:function(){this.inherited(arguments);this.listEntryNodes=[];var _e53=_e50.createUsersListSortedWithMyselfLast(this.users,sp.info.user.id);_e49.forEach(_e53,this.addUser,this);},addUser:function(_e54,_e55,_e56){var _e57=new _e51({userid:_e54});this.listEntryNodes.push(_e57.domNode);if(_e55===_e56.length-1){this.removeUsersIfNotEnoughSpace(_e55,_e56);}},removeUsersIfNotEnoughSpace:function(_e58,_e59){if(_e59.length>this.maxUsers){var _e5a=_e4a.NodeList(this.listEntryNodes).slice(0,this.maxUsers-1);var _e5b=_e4a.NodeList(this.listEntryNodes).splice(this.maxUsers-1,(_e59.length-(this.maxUsers-1)));var _e5c=_e4b.create("li",{"class":"user-icon-list-entry additional-users-button",innerHTML:"+ "+_e5b.length});_e5a.push(_e5c);_e5a.place(this.domNode);}else{_e4a.NodeList(this.listEntryNodes).place(this.domNode);}},foundWidgetinDom:function(_e5d,func){var _e5e=dom.byId(_e5d);if(_e5e){func(_e5e);}else{setTimeout(lang.hitch(this,function(){this.foundWidgetinDom(_e5d,func);}),250);}}});});},"cb/widget/UserList":function(){define(["dojo","dojo/_base/declare","dojo/DeferredList","dojo/store/Memory","dojo/store/Observable","dijit/_Widget","cb/widget/_TemplatedMixin","dijit/_Container","cb/widget/_SimpleTableMixin","./UserIconListEntry","sp/infos/InfoManager","dojo/text!./UserList.html"],function(dojo,_e5f,_e60,_e61,_e62,_e63,_e64,_e65,_e66,_e67,_e68,_e69){return _e5f([_e63,_e64,_e65,_e66],{templateString:_e69,baseClass:"participants-display",type:"list",_widgets:null,_entryNodeType:"li",entryWidgetConstructor:_e67,query:{},queryOptions:{sort:[{attribute:"sortkey"}]},postMixInProperties:function(){this.inherited(arguments);this.ownUserId=sp.info.user.info.id;this._latestSortKey=1;},removeUser:function(_e6a){this.store.remove(_e6a);},addUsers:function(_e6b){return _e68.bulkloadByIds({type:"user",ids:_e6b}).then(dojo.hitch(this,function(){return new _e60(dojo.map(_e6b,dojo.hitch(this,function(_e6c){return _e68.getById({type:"user",id:_e6c}).then(dojo.hitch(this,function(_e6d){this.addUser(_e6d.user.id,_e6d.user);}));}))).then(function(){return _e6b;});}));},addUser:function(_e6e,_e6f,_e70){var _e71=this._latestSortKey++;var data={id:_e6e,user:_e6f,sortkey:_e6e===this.ownUserId?-1*_e71:_e71};if(_e70){data=dojo.mixin(data,_e70);}data=dojo.mixin(data,this.getDataEnrichmentMixin(_e6e,_e6f,_e70));this.store.put(data);},getDataEnrichmentMixin:function(_e72,data,_e73){return {};},createEntryWidget:function(id,_e74,node){var _e75=new this.entryWidgetConstructor({entry:_e74},node);return _e75;},resize:function(){}});});},"cb/page/dashboard/UserProfileDisplay":function(){define(["dojo","dojo/dom-class","dojo/dom-construct","dojo/html","dojo/on","dojox/lang/functional","dijit/_Widget","cb/widget/_TemplatedMixin","cb/api/Api","sp/Tooltip","cb/Capabilities","sp/I18n","sp/infos/InfoManager","sp/dialog/UpgradeDialog","cb/widget/OnboardingProgressBar","cb/contacts/ContactsInviteDialog","dojo/text!./UserProfileDisplay.html","dojo/i18n!./nls/UserProfileDisplay"],function(dojo,_e76,_e77,_e78,on,_e79,_e7a,_e7b,Api,_e7c,_e7d,_e7e,_e7f,_e80,_e81,_e82,_e83,i18n){return dojo.declare([_e7a,_e7b],{templateString:_e83,baseClass:"userprofiledisplay",i18n:i18n,user:null,companyName:null,profileOnboardingListHidden:true,postMixInProperties:function(){this.inherited(arguments);this.isInCompany=!!sp.info.company;this.companyName=sp.info.company?sp.info.company.name:"";},buildRendering:function(){this.inherited(arguments);_e7d.checkHasSqmLimt().then(dojo.hitch(this,function(_e84){if(_e84==="enabled"){return _e7f.getById({type:"squaremeters",id:sp.info.user.info.id}).then(dojo.hitch(this,function(_e85){_e78.set(this._sqmHeader,""+Math.round(_e85.sqm));_e78.set(this._sqmUsageSubline,_e7e.wrap(i18n)("sqm_usage",[Math.round(_e85.usedsqm*10)/10]));dojo.style(this._sqmBar,{height:Math.min(Math.round(_e85.usedsqm/_e85.sqm*100),100)+"%"});}));}else{_e76.add(this._profileSqm,"hideBlock");}})).then(dojo.hitch(this,function(){return _e7d.checkCreateBoard().then(dojo.hitch(this,function(_e86){if(_e86==="nofreesqm"){_e76.add(this._profileSqm,"profile-sqm-nofreesqm");}}));}));_e7d.checkFeature("registration.selfsignup").then(dojo.hitch(this,function(_e87){_e76.toggle(this._actionUpgradeNode,"hideBlock",_e87!=="enabled");}));},postCreate:function(){this.inherited(arguments);this.connect(_e7f,"onInvalidate",function(_e88){if(_e88.type==="onboardingtasks"&&_e88.id===sp.info.user.id){this._reloadOnboardingList();}});this._reloadOnboardingList();},_reloadOnboardingList:function(){_e7f.getById({type:"onboardingtasks",id:sp.info.user.id}).then(dojo.hitch(this,function(_e89){var _e8a=[];_e79.forIn(_e89.onboardingtasks,function(_e8b,_e8c){if(!_e8b){_e8a.push(_e8c);}},this);dojo.query(this._profileOnboardingList).children().orphan();if(_e8a.length>0){if(!this.profileOnboardingListHidden){_e76.remove(this._profileOnboardingContainer,"hideBlock");}_e76.add(this._userNameBadge,"hideBlock");}else{_e76.add(this._profileOnboardingContainer,"hideBlock");_e76.remove(this._userNameBadge,"hideBlock");}}));},openUpgradeDialog:function(_e8d){var _e8e=new _e80({dialogContent:"sqm"});_e8e.show();},showProfileOnboardingMiniPostit:function(){this.profileOnboardingListHidden=false;this._reloadOnboardingList();},showLargeOnboardingPostit:function(){this.getParent().showOnboardingTasksContainer(true);_e76.add(this._profileOnboardingContainer,"hideBlock");this.profileOnboardingListHidden=true;}});});},"url:dijit/form/templates/Select.html":"<table class=\"dijit dijitReset dijitInline dijitLeft\"\n\tdata-dojo-attach-point=\"_buttonNode,tableNode,focusNode\" cellspacing='0' cellpadding='0'\n\trole=\"listbox\" aria-haspopup=\"true\"\n\t><tbody role=\"presentation\"><tr role=\"presentation\"\n\t\t><td class=\"dijitReset dijitStretch dijitButtonContents\" role=\"presentation\"\n\t\t\t><div class=\"dijitReset dijitInputField dijitButtonText\"  data-dojo-attach-point=\"containerNode,_popupStateNode\" role=\"presentation\"></div\n\t\t\t><div class=\"dijitReset dijitValidationContainer\"\n\t\t\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t\t\t/></div\n\t\t\t><input type=\"hidden\" ${!nameAttrSetting} data-dojo-attach-point=\"valueNode\" value=\"${value}\" aria-hidden=\"true\"\n\t\t/></td\n\t\t><td class=\"dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer\"\n\t\t\tdata-dojo-attach-point=\"titleNode\" role=\"presentation\"\n\t\t\t><input class=\"dijitReset dijitInputField dijitArrowButtonInner\" value=\"&#9660; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t\t\t\t${_buttonInputDisabled}\n\t\t/></td\n\t></tr></tbody\n></table>\n","url:cb/page/boards/PortfolioSettings.html":"<div>\r\n    <div class=\"dialog-title\">\r\n        ${!i18n.title}\r\n        <div data-dojo-attach-event=\"click:_handleCloseButtonClick\" class=\"dialog-close-button\" title=\"close\"><i class=\"fonticon-cross\"></i></div>\r\n    </div>\r\n    <div class=\"margin\">\r\n        <span class=\"input-with-button full-width\">\r\n            <input data-dojo-attach-point=\"_nameInput\" class=\"full-width large\" type=\"text\" id=\"${id}_name\" value=\"${portfolioResult.project.title}\"/>\r\n            <button data-dojo-attach-event=\"click:_handleNameSubmitClick\" data-dojo-attach-point=\"_nameSubmit\">${!i18n.save_button}</button>\r\n        </span>\r\n        <ul class=\"meta\" data-dojo-attach-point=\"_metaData\">\r\n        </ul>\r\n        <ul class=\"settings\">\r\n            <li class=\"passphrase\" style=\"border-bottom: 0;\">\r\n                <span \r\n                    type=\"checkbox\"\r\n                    id=\"${id}_passphrase\"\r\n                    data-dojo-type=\"cb.widget.BigSwitch\"\r\n                    data-dojo-attach-event=\"onChange:_handlePassphraseSwitchChange\"\r\n                    data-dojo-attach-point=\"_passphraseSwitch\"\r\n                    data-dojo-props=\"iconClass: 'fonticon-lock'\"\r\n                    >\r\n                    ${!i18n.passphrase_label}\r\n                </span>\r\n                <span class=\"input-with-button\" data-dojo-attach-point=\"_inputWithButton\">\r\n                    <input type=\"text\" data-dojo-attach-point=\"_passphraseInput\" class=\"full-width\" value=\"${portfolioResult.project.accessControlState.accessControlToken}\"/>\r\n                    <button \r\n                        data-dojo-attach-point=\"_passphraseSubmit\"\r\n                        data-dojo-attach-event=\"click:_handlePassphraseSubmitClick\">\r\n                        ${!i18n.save_button}\r\n                    </button>\r\n                </span>\r\n            </li>\r\n        </ul>\r\n        \r\n        <div class=\"portfolio-actions\" data-dojo-attach-point=\"_portfolioActions\">\r\n            <span data-dojo-attach-point=\"_leaveButton\" data-dojo-attach-event=\"click:_handleLeaveClick\" class=\"hideBlock delete\">${!i18n.leave_button}</span>\r\n            <span data-dojo-attach-point=\"_deleteButton\" data-dojo-attach-event=\"click:_handleDeleteClick\" class=\"hideBlock small delete\">${!i18n.delete_button}</span>\r\n            <span class=\"light small\" data-dojo-attach-point=\"_deleteSoftHint\">${!i18n.delete_soft_hint}</span>\r\n        </div>\r\n        <div data-dojo-attach-point=\"_msgLine\"></div>\r\n    </div>\r\n</div>","url:cb/contacts/ContactsTable.html":"<table class=\"contacts-table content-module\">\r\n    <thead class=\"contacts-table__head\">\r\n        <tr class=\"contacts-table__row\">\r\n            <td class=\"contacts-table__head__arrow\"><i class=\"fonticon-corner-down-arrow\"></i></td>\r\n            <td colspan=\"3\">\r\n                <div\r\n                    class=\"clean button contacts-table__head__new-board-button\">${!i18n.new_board_button}</div>\r\n            </td>\r\n        </tr>\r\n    </thead>\r\n    <tbody class=\"contacts-table__body\" data-dojo-attach-point=\"containerNode\">\r\n    </tbody>\r\n</table>","dojo/request":function(){define(["./request/default!"],function(_e8f){return _e8f;});},"cb/personalcontainer/container/Sidebar":function(){define(["dojo","dijit/layout/ContentPane","dijit/layout/_ContentPaneResizeMixin","dijit/_Container","dojo/dom-geometry","./Footer"],function(dojo,_e90,_e91,_e92,_e93,_e94){return dojo.declare([_e90,_e91,_e92],{isPcContainer:true,region:"left",_isOpen:true,buildRendering:function(){this.inherited("buildRendering",arguments);dojo.addClass(this.domNode,"personal-container-sidebar");},postCreate:function(){this.inherited(arguments);this.addChild(new _e94({baseClass:"personal-container-footer"}),"last");},isOpen:function(){return this._isOpen;},signal:function(){if(this.isOpen()){return;}if(this._closeAnimation||this._openAnimation||this._signalAnimation){return;}var _e95=dojo.coords(this.domNode);if(_e95.l!==0){return;}var _e96=dojo.animateProperty({node:this.domNode,properties:{left:20},duration:250,delay:200,easing:dojo.fx.easing.quadIn});var _e97=dojo.animateProperty({node:this.domNode,properties:{left:0},onEnd:dojo.hitch(this,"_stopSignal"),duration:100,easing:dojo.fx.easing.quadOut});dojo.fx.chain([_e96,_e97]).play();},_stopSignal:function(){if(!this._signalAnimation){return;}this._signalAnimation.stop();this._signalAnimation.destroy();this._signalAnimation=null;},resize:function(_e98){var _e99=_e98;var _e9a=dojo.getMarginBox(this.domNode);if(_e98&&_e98.w===0&&_e98.w!==_e9a.w){if(this._closeAnimation){return;}this._stopSignal();var _e9b=_e9a.w;_e99=dojo.clone(_e98);_e99.w=_e9b;_e99.l=-1*_e9b;this._closeAnimation=dojo.animateProperty({node:this.domNode,properties:{left:-1*_e9b},duration:300,easing:dojo.fx.easing.quadIn,beforeBegin:function(node){var _e9c=dojo.clone(_e98);delete _e9c.w;delete _e9c.l;_e93.setMarginBox(node,_e9c);},onEnd:dojo.hitch(this,function(node){var _e9d=dojo.clone(_e98);_e93.setMarginBox(node,_e98);this.getParent().resize();this._closeAnimation=null;this._isOpen=false;this.inherited("resize",arguments,[]);dojo.publish("/personalcontainer/closed");})});this._closeAnimation.play();}else{if(_e98&&_e98.w!==undefined&&_e98.w!==(_e9a.w-1)){var _e9e=_e98.w;_e99=dojo.clone(_e98);_e99.w=0;_e99.l=0;if(this._openAnimation){return;}this._stopSignal();this._openAnimation=dojo.animateProperty({node:this.domNode,properties:{left:0},delay:100,duration:300,easing:dojo.fx.easing.backOut,beforeBegin:function(node){dojo.style(node,{"left":(-1*_e9e+1)+"px"});_e93.setMarginBox(node,_e98);},onEnd:dojo.hitch(this,function(){_e93.setMarginBox(this.domNode,_e98);this.getParent().resize();this._openAnimation=null;this._isOpen=true;this.inherited("resize",arguments,[]);dojo.publish("/personalcontainer/open");})});this._openAnimation.play();}else{if(_e98){_e93.setMarginBox(this.domNode,_e98);_e99=_e93.getMarginBox(this.domNode);this.inherited(arguments,[]);}else{this.inherited(arguments);}}}return _e99;}});});},"cb/page/boards/DocumentSettingsDialog":function(){define(["dojo","dojo/_base/Deferred","dojo/_base/lang","dojo/dom-construct","dojo/dom-class","dojo/dom-attr","dojo/date/stamp","dojo/html","dojo/on","dojo/topic","dojo/when","dojo/promise/all","cb/Capabilities","cb/util","sp/dialog/TooltipDialog","sp/dialog/DialogContent","sp/ajax/AjaxEngine","sp/infos/InfoManager","sp/dialog/YesNoDialog","cb/widget/UserDialog","sp/I18n","cb/widget/UpgradeButton","cb/widget/PortfolioSelect","dojo/text!./DocumentSettings.html","dojo/i18n!./nls/DocumentSettings","cb/widget/BigSwitch","cb/widget/SecuritySettingsDisplay"],function(dojo,_e9f,lang,_ea0,_ea1,_ea2,_ea3,_ea4,on,_ea5,when,_ea6,_ea7,_ea8,_ea9,_eaa,_eab,_eac,_ead,_eae,_eaf,_eb0,_eb1,_eb2,i18n){var _eb3=dojo.declare([_eaa],{i18n:i18n,templateString:_eb2,documentResult:null,portfolioResult:null,widgetsInTemplate:true,invisibleMilk:true,nameSaveButtonActive:false,postMixInProperties:function(){this.inherited(arguments);},buildRendering:function(){this.inherited(arguments);},postCreate:function(){this.inherited(arguments);this.set("nameSaveButtonActive",this.get("nameSaveButtonActive"));this._update();var _eb4=_ea8.debounce(lang.hitch(this,"_update"),100);this.own(this.watch("documentResult",_eb4));this.own(this.watch("portfolioResult",_eb4));this.connect(_eac,"onInvalidate",function(_eb5){if(_eb5.type==="document"&&_eb5.id===this.documentResult.document.id){_eac.getById(_eb5).then(dojo.hitch(this,function(_eb6){this.set("documentResult",_eb6);}));}if(_eb5.type==="portfolio"&&_eb5.id===this.portfolioResult.project.id){_eac.getById(_eb5).then(dojo.hitch(this,function(_eb7){this.set("portfolioResult",_eb7);}));}});this.own(on(this._nameInput,"change, keydown",lang.hitch(this,function(e){this.set("nameSaveButtonActive",true);})));},_update:function(){this._changeAccessControlState();this._changePassphraseEditable();this._changeTitleEditableStatus();this._changeCollaborationEditableStatus();this._changePortfolioEditable();this.set("collaboration",this.documentResult.document.accessControlState.collaboration);this.set("documentCopyable",!(sp.info.user.isNamedGuest||sp.info.user.isAnonymous));this.set("documentDeletable",this.documentResult.document.ownerId===sp.info.user.info.id&&!(sp.info.user.isNamedGuest||sp.info.user.isAnonymous));this.set("documentClaimable",!this.documentResult.document.owned&&sp.info.user.isIdentified&&!(sp.info.user.isNamedGuest||sp.info.user.isAnonymous));this.set("documentLeavable",this.documentResult.document.ownerId!==sp.info.user.info.id&&!(sp.info.user.isNamedGuest||sp.info.user.isAnonymous)&&(this.portfolioResult.project.adhoc||(!this.portfolioResult.project.adhoc&&this.portfolioResult.readOnly)));this.set("ownerId",this.documentResult.document.ownerId);this.set("createdAt",_ea3.fromISOString(this.documentResult.document.createdAt));this.set("modifiedAt",_ea3.fromISOString(this.documentResult.document.lastModifiedAt));this.set("modifiedBy",this.documentResult.document.lastModifiedBy);},_setNameSaveButtonActiveAttr:function(_eb8){_ea1.toggle(this._nameSubmit,"hideBlock",!_eb8);_ea2.set(this._nameSubmit,"disabled",!_eb8);this._set("nameSaveButtonActive",_eb8);},_setDocumentCopyableAttr:function(_eb9){if(this._destroyed){return;}_ea1.toggle(this._copyButton,"hideBlock",!_eb9);this._set("documentCopyable",_eb9);},_setDocumentDeletableAttr:function(_eba){if(this._destroyed){return;}_ea1.toggle(this._deleteButton,"hideBlock",!_eba);this._set("documentDeletable",_eba);},_setDocumentClaimableAttr:function(_ebb){if(this._destroyed){return;}_ea1.toggle(this._claimButton,"hideBlock",!_ebb);this._set("documentClaimable",_ebb);},_setDocumentLeavableAttr:function(_ebc){if(this._destroyed){return;}_ea1.toggle(this._leaveButton,"hideBlock",!_ebc);this._set("documentLeavable",_ebc);},_setCreatedAtAttr:function(_ebd){if(this._destroyed){return;}this._metaCreatedAtNode.innerHTML=_eaf.wrap(i18n)("created_at",[_ebd]);this._set("createdAt",_ebd);},_setModifiedAtAttr:function(_ebe){if(this._destroyed){return;}this._metaModifiedAtNode.innerHTML=_eaf.wrap(i18n)("modified_at",[_ebe]);this._set("modifiedAt",_ebe);},_setModifiedByAttr:function(_ebf){if(this._destroyed){return;}_eac.getById({type:"user",id:_ebf}).then(dojo.hitch(this,function(_ec0){this._metaModifiedByNode.innerHTML=_eaf.wrap(i18n)("modified_by")+" ";var _ec1=_ea0.create("span",{"class":"link",innerHTML:_eaf.esc(_ec0.user.displayname)},this._metaModifiedByNode,"last");on(_ec1,"click",dojo.hitch(this,function(evt){this._handleUserLinkClick(evt,_ec0.user);}));}));this._set("modifiedBy",_ebf);},_setOwnerIdAttr:function(_ec2){if(this._destroyed){return;}_eac.getById({type:"user",id:_ec2}).then(dojo.hitch(this,function(_ec3){this._metaOwnerNode.innerHTML=_eaf.wrap(i18n)("owner")+" ";var _ec4=_ea0.create("span",{"class":"link",innerHTML:_eaf.esc(_ec3.user.displayname)},this._metaOwnerNode,"last");on(_ec4,"click",dojo.hitch(this,function(evt){this._handleUserLinkClick(evt,_ec3.user);}));}));this._set("ownerId",_ec2);},_setCollaborationAttr:function(_ec5){if(this._destroyed){return;}this._collaborationSwitch.set("checked",_ec5);this._set("collaboration",_ec5);},_setNotificationsAttr:function(_ec6){if(this._destroyed){return;}this._reportsSwitch.set("checked",_ec6);this._set("notifications",_ec6);},_handleUserLinkClick:function(evt,user){var _ec7=new _eae({user:user});_ec7.show(evt.target);},_handleSelectWidgetChange:function(_ec8){var _ec9=false;if(_ec8.type==="option"){if(this.portfolioResult.project.id&&!this.portfolioResult.project.adhoc){if(_ec8.value!==this.portfolioResult.project.id){_ec9=true;}}else{if(_ec8.value!=="default_selection"){_ec9=true;}}}else{_ec9=true;}if(_ec9){_ea1.remove(this._projectSelectSave,"hideBlock");}if(_ec8.type==="option"&&_ec8.value==="default_selection"){_ea1.add(this._projectSelectSave,"hideBlock");}},_handleProjectSaveClick:function(){var _eca=this.projectSelectWidget.get("value");if(_eca.type==="remove"){_eab.removeDocument({documentId:this.documentResult.document.id,portfolioId:this.portfolioResult.project.id}).then(dojo.hitch(this,function(_ecb){window.setTimeout(function(){var _ecc=sp.infos.getInstance();_ecc.invalidateById({type:sp.infos.TYPE.portfolios,id:sp.info.user.id});_ecc.invalidateById({type:sp.infos.TYPE.portfolio,id:_ecb.oldPortfolioId});_ecc.invalidateById({type:sp.infos.TYPE.portfolio,id:_ecb.newPortfolioId});_ecc.invalidateById({type:sp.infos.TYPE.document,id:_ecb.documentId});},1);this.dialog.hide();}));}if(_eca.type==="option"&&_eca.value!=="default_selection"){this._addToPortfolio(this.documentResult.document.id,_eca.value);this.dialog.hide();}if(_eca.type==="new"&&_eca.value!==""){_eab.createPortfolio({portfolioTitle:_eca.value}).then(function(_ecd){sp.infos.getInstance().invalidateById({type:sp.infos.TYPE.portfolios,id:sp.info.user.id});return _ecd;}).then(dojo.hitch(this,function(_ece){return this._addToPortfolio(this.documentResult.document.id,_ece.portfolioId);})).then(dojo.hitch(this,function(){this.dialog.hide();}));}},_changePortfolioEditable:function(){_ea7.checkPortfolios().then(dojo.hitch(this,function(_ecf){if(_ecf==="premium"){_eac.getById({type:"companyuser",id:this.documentResult.document.ownerId}).then(lang.hitch(this,function(_ed0){if(_ed0.companyuser){this.set("portfolioEditableStatus","disabled");}else{this.set("portfolioEditableStatus","pro_only");}}));}else{if(this.documentResult.document.ownerId===sp.info.user.info.id){this.set("portfolioEditableStatus","enabled");}else{if(dojo.some(this.portfolioResult.projectParticipants,function(p){return p.userId===sp.info.user.info.id;})){this.set("portfolioEditableStatus","enabled");}else{this.set("portfolioEditableStatus","disabled");}}}}));},_setPortfolioEditableStatusAttr:function(_ed1){if(this._destroyed){return;}_ea7.checkFeature("registration.selfsignup").then(function(_ed2){return _ed2==="enabled";}).then(lang.hitch(this,function(_ed3){if(_ed1==="pro_only"){if(this.projectSelectWidget){this.projectSelectWidget.destroyRecursive();this.projectSelectWidget=null;}if(this._portfolioEditableDisabledLabel){_ea0.orphan(this._portfolioEditableDisabledLabel);}if(_ed3){this._portfolioEditableUpgradeButton=new _eb0({upgradeDialogContent:"projects"},_ea0.create("span",null,this._projectSelectContainer,"after"));}_ea1.add(this._projectLi,"light");_ea1.add(this._projectSelectContainer,"hideBlock");}else{if(_ed1==="disabled"){if(this.projectSelectWidget){this.projectSelectWidget.destroyRecursive();this.projectSelectWidget=null;}if(this._portfolioEditableUpgradeButton){this._portfolioEditableUpgradeButton.destroyRecursive();}if(!this._portfolioEditableDisabledLabel){this._portfolioEditableDisabledLabel=_ea0.create("span",{"class":"project__project-label"},this._projectSelectContainer,"after");}_ea1.toggle(this._projectLi,"hideBlock",this.portfolioResult.project.adhoc);this._portfolioEditableDisabledLabel.innerHTML=_eaf.esc(this.portfolioResult.project.title);}else{if(this._portfolioEditableUpgradeButton){this._portfolioEditableUpgradeButton.destroyRecursive();}if(this._portfolioEditableDisabledLabel){_ea0.orphan(this._portfolioEditableDisabledLabel);}var _ed4=(!this.portfolioResult.project.adhoc)?this.portfolioResult.project.id:null;if(!this.projectSelectWidget){this.projectSelectWidget=new _eb1({portfolioId:_ed4,defaultSelectProjects:true,defaultSelectOption:!_ed4,baseClass:"project__project-select",createNewItemOption:true,removeFromProjectOption:!!_ed4},this._projectSelectContainer,"first");}this.projectSelectWidget.set("portfolioId",_ed4);_ea1.remove(this._projectLi,"light");_ea1.remove(this._projectSelectContainer,"hideBlock");this.own(on(this.projectSelectWidget,"change",dojo.hitch(this,this._handleSelectWidgetChange)));this._handleSelectWidgetChange(this.projectSelectWidget.get("value"));}}this._set("portfolioEditableStatus",_ed1);}));},_handlePassphraseSwitchChange:function(_ed5){if(!_ed5&&_ed5!==this.portfolioResult.project.accessControlState.controlled){this._postPortfolioAccessControlChange("");}this.set("accessControlled",_ed5);},_handleCollaborationSwitchChange:function(_ed6){if(_ed6!==this.documentResult.document.accessControlState.collaboration){_eab.changeDocumentAccessControl({documentId:this.documentResult.document.id,collaboration:_ed6}).then(dojo.hitch(this,function(){_eac.invalidateById({type:"document",id:this.documentResult.document.id});this.documentResult.document.accessControlState.collaboration=_ed6;}));}},_changeTitleEditableStatus:function(_ed7){if(this.documentResult.document.owned){this.set("titleEditableStatus",(sp.info.user.isNamedGuest||sp.info.user.isAnonymous)?"disabled":"enabled");}else{this.set("titleEditableStatus","enabled");}},_setTitleEditableStatusAttr:function(_ed8){if(this._destroyed){return;}var _ed9,_eda;switch(_ed8){case "enabled":_eda=null;_ed9=true;break;case "disabled":_eda=null;_ed9=false;break;case "wrong_team":_eda=_eac.byId({type:"companyuser",id:this.portfolioResult.project.userId}).then(function(_edb){return _eac.byId({type:"company",id:_edb.companyuser.companyId}).then(function(_edc){return _edc.company.name;});}).then(function(_edd){return _eaf.wrap(i18n)("title_edit_wrong_team",[_edd]);});_ed9=false;break;case "pro_only":default:_eda=null;_ed9=true;}_ea6({title:when(_eda),enabled:when(_ed9)}).then(dojo.hitch(this,function(data){_ea2.set(this._nameInput,"title",data.title||"");_ea2.set(this._nameInput,"disabled",!data.enabled);_ea2.set(this._nameSubmit,"disabled",!data.enabled);}));this._set("titleEditableStatus",_ed8);},_changePassphraseEditable:function(){if(!sp.info.user.info.accountType.hasPassphrase){_eac.getById({type:"companyuser",id:this.documentResult.document.ownerId}).then(lang.hitch(this,function(_ede){if(_ede.companyuser){this.set("passphraseEditableStatus","disabled");}else{this.set("passphraseEditableStatus","pro_only");}}));}else{if(!this.portfolioResult.project.adhoc){this.set("passphraseEditableStatus","adhoc_documents_only");}else{if(this.portfolioResult.project.ownerId===sp.info.user.info.id){this.set("passphraseEditableStatus","enabled");}else{this.set("passphraseEditableStatus","disabled");}}}},_setPassphraseEditableStatusAttr:function(_edf){if(this._destroyed){return;}var _ee0,_ee1,_ee2=false;switch(_edf){case "enabled":_ee1=null;_ee0=true;break;case "wrong_team":_ee1=_eac.byId({type:"companyuser",id:this.portfolioResult.project.userId}).then(function(_ee3){return _eac.byId({type:"company",id:_ee3.companyuser.companyId}).then(function(_ee4){return _ee4.company.name;});}).then(function(_ee5){return _eaf.wrap(i18n)("passphrase_edit_wrong_team",[_ee5]);});_ee0=false;break;case "pro_only":_ee1=_eaf.wrap(i18n)("passphrase_edit_pro_only");_ee0=false;_ee2=_ea7.checkFeature("registration.selfsignup").then(function(_ee6){return _ee6==="enabled";});break;case "adhoc_documents_only":case "disabled":_ee1=null;_ee0=false;break;default:_ee1=null;_ee0=true;}_ea6({title:when(_ee1),enabled:when(_ee0),showUpgradeButton:when(_ee2)}).then(lang.hitch(this,function(data){if(data.showUpgradeButton){this._passphraseUpgradeButton=new _eb0({upgradeDialogContent:"security"},_ea0.create("span",null,this._passphraseSwitch.titleNode,"after"));_ea1.add(this._passphraseSwitch.titleNode,"hideBlock");}else{if(this._passphraseUpgradeButton){this._passphraseUpgradeButton.destroyRecursive();}_ea1.remove(this._passphraseSwitch.titleNode,"hideBlock");}this.set("passphraseInputVisible",data.enabled&&this.portfolioResult.project.accessControlState.controlled);this._passphraseSwitch.set("disabled",!data.enabled);_ea1.toggle(this._passphraseSubmit,"disabled",!data.enabled);_ea2.set(this._passphraseSubmit,"disabled",!data.enabled);_ea2.set(this._passphraseInput,"disabled",!data.enabled);_ea2.set(this._passphraseInput,"title",data.title||"");}));this._set("passphraseEditableStatus",_edf);},_setPassphraseInputVisibleAttr:function(_ee7){if(this._destroyed){return;}_ea1.toggle(this._inputWithButton,"hideBlock",!_ee7);this._set("passphraseInputVisible",_ee7);},_changeCollaborationEditableStatus:function(){when("unknown").then(lang.hitch(this,function(_ee8){if(_ee8!=="unknown"){return _ee8;}if(sp.info.user.isIdentified&&this.documentResult.document.ownerId===sp.info.user.info.id){return "enabled";}else{return "disabled";}})).otherwise(function(){return "unknown";}).then(lang.hitch(this,function(_ee9){this.set("collaborationEditableStatus",_ee9||"unknown");}));},_setCollaborationEditableStatusAttr:function(_eea){if(this._destroyed){return;}var _eeb,_eec,_eed=false;switch(_eea){case "enabled":_eeb=true;_eec=null;break;case "disabled":_eeb=false;_eec=null;break;case "no_student":_eeb=false;_eec=_eaf.wrap(i18n)("collaboration_edit_no_student");break;case "wrong_team":_eeb=false;_eec=_eac.byId({type:"companyuser",id:this.documentResult.document.userId}).then(function(_eee){return _eac.byId({type:"company",id:_eee.companyuser.companyId}).then(function(_eef){return _eef.company.name;});}).then(function(_ef0){return _eaf.wrap(i18n)("collaboration_edit_wrong_team",[_ef0]);});break;default:_eeb=true;_eec=null;}_ea6({title:when(_eec),enabled:when(_eeb),showUpgradeButton:when(_eed)}).then(lang.hitch(this,function(data){if(data.showUpgradeButton){this._editCollaborationUpgradeButton=new _eb0({upgradeDialogContent:"security"},_ea0.create("span",null,this._collaborationSwitch.titleNode,"after"));_ea1.add(this._collaborationSwitch.titleNode,"hideBlock");}else{if(this._editCollaborationUpgradeButton){this._editCollaborationUpgradeButton.destroyRecursive();}_ea1.remove(this._collaborationSwitch.titleNode,"hideBlock");}this._collaborationSwitch.set("disabled",!data.enabled);}));this._set("collaborationEditableStatus",_eea);},_changeAccessControlState:function(){this.set("accessControlled",this.portfolioResult.project.accessControlState.controlled);this.set("accessControlPassphrase",this.portfolioResult.project.accessControlState.accessControlToken);},_setAccessControlledAttr:function(_ef1){if(this._destroyed){return;}this._passphraseSwitch.set("checked",_ef1);this.set("passphraseInputVisible",_ef1);this._set("accessControlled",_ef1);},_setAccessControllPassphraseAttr:function(_ef2){if(this._destroyed){return;}this._passphraseInput.innerHTML=_eaf.esc(_ef2||"");this._set("accessControlPassphrase",_ef2);},_handlePassphraseSubmitClick:function(_ef3){dojo.stopEvent(_ef3);var _ef4=_ea2.get(this._passphraseInput,"value");this._postPortfolioAccessControlChange(_ef4);},_handleNameSubmitClick:function(_ef5){dojo.stopEvent(_ef5);_eab.changeDocumentTitle({documentId:this.documentResult.document.id,title:_ea2.get(this._nameInput,"value")}).then(dojo.hitch(this,function(){this.dialog.hide();_eac.invalidateById({type:"document",id:this.documentResult.document.id});_eac.invalidateById({type:"portfolio",id:this.portfolioResult.project.id});}));},_postPortfolioAccessControlChange:function(_ef6){_eab.changePortfolioAccessControl({portfolioId:this.portfolioResult.project.id,token:_ef6}).then(dojo.hitch(this,function(){_eac.invalidateById({type:"portfolio",id:this.portfolioResult.project.id});}));},_addToPortfolio:function(_ef7,_ef8){return _eab.addToPortfolio({documentId:_ef7,portfolioId:_ef8}).then(dojo.hitch(this,function(_ef9){window.setTimeout(function(){var _efa=sp.infos.getInstance();_efa.invalidateById({type:sp.infos.TYPE.portfolios,id:sp.info.user.id});_efa.invalidateById({type:sp.infos.TYPE.portfolio,id:_ef9.oldPortfolioId});_efa.invalidateById({type:sp.infos.TYPE.portfolio,id:_ef9.portfolioId});_efa.invalidateById({type:sp.infos.TYPE.document,id:_ef9.documentId});},1);}));},_handleCopyClick:function(_efb){_ea1.add(this._copyButton,"loading");sp.ajax.getInstance().copyDocument({documentId:this.documentResult.document.id,timeout:5*60*1000}).then(dojo.hitch(this,function(_efc){if(_efc.newDocumentId){sp.infos.getInstance().invalidateById({type:"document",id:_efc.newDocumentId});if(!this.portfolioResult.project.adhoc){return this._addToPortfolio(_efc.newDocumentId,this.portfolioResult.id).always(function(){return _efc;});}else{return {documentId:_efc.newDocumentId};}}else{if(_efc.redirectUrl){window.location=_efc.redirectUrl;}}})).then(dojo.hitch(this,function(_efd){this.dialog.hide();this.onDocumentCopied(_efd.documentId,this.documentResult.document.id);})).then(function(){_ea1.remove(this._copyButton,"loading");}).otherwise(dojo.hitch(this,function(){console.error(arguments,arguments[0].stack);_ea1.remove(this._copyButton,"loading");this._msgLine.innerHTML=sp.I18n.get("sp.dialog","AddToPortfolioDialog")("copy_document_error");}));},onDocumentCopied:function(_efe,_eff){},_handleDeleteClick:function(_f00){var _f01=new _ead({title:_eaf.wrap(i18n)("delete_board_confirm_title"),questionText:_eaf.wrap(i18n)("delete_board_confirm_question"),okButtonText:_eaf.wrap(i18n)("delete_board_confirm_button"),deleteAction:true,onYes:dojo.hitch(this,function(){return _eab.deleteDocument({documentId:this.documentResult.document.id}).then(dojo.hitch(this,function(){if(sp.info.document&&sp.info.document.document.id===this.documentResult.document.id){if(sp.info.user.isIdentified){window.location.assign("/boards");}else{window.location.assign("/thanks-for-working-with-us");}}else{_f01.hide();this.dialog.hide();}_eac.invalidateById({type:"document",id:this.documentResult.document.id});_eac.invalidateById({type:"portfolio",id:this.documentResult.document.projectId});_eac.invalidateById({type:"portfolios",id:sp.info.user.info.id});}));}),onNo:dojo.hitch(this,function(){_f01.hide();})});_f01.show(_f00.currentTarget);},_handleClaimClick:function(_f02){_eab.claimDocument({documentId:this.documentResult.document.id}).then(dojo.hitch(this,function(){if(sp.info.document&&sp.info.document.document.id===this.documentResult.document.id){window.location.reload();}else{this.dialog.hide();}_eac.invalidateById({type:"document",id:this.documentResult.document.id});}));},_handleLeaveClick:function(_f03){var _f04=new _ead({title:_eaf.wrap(i18n)("leave_board_confirm_title"),questionText:_eaf.wrap(i18n)("leave_board_confirm_question"),okButtonText:_eaf.wrap(i18n)("leave_board_confirm_button"),deleteAction:true,onYes:dojo.hitch(this,function(){return _eab.removeDocumentParticipant({documentId:this.documentResult.document.id,userId:sp.info.user.info.id}).then(dojo.hitch(this,function(){if(sp.info.document&&sp.info.document.document.id===this.documentResult.document.id){if(sp.info.user.isIdentified){window.location.assign("/boards");}else{window.location.assign("/thanks-for-working-with-us");}}else{_f04.hide();this.dialog.hide();}_eac.invalidateById({type:"document",id:this.documentResult.document.id});_eac.invalidateById({type:"portfolio",id:this.documentResult.document.projectId});_eac.invalidateById({type:"portfolios",id:sp.info.user.info.id});}));}),onNo:dojo.hitch(this,function(){_f04.hide();})});_f04.show(_f03.currentTarget);},_handleCloseButtonClick:function(){this.dialog.hide();}});return dojo.declare([_ea9],{portfolioResult:null,documentResult:null,baseClass:"with-title document-settings-dialog",autofocus:false,postCreate:function(){this.inherited(arguments);this.content=new _eb3({dialog:this,portfolioResult:this.portfolioResult,documentResult:this.documentResult});}});});},"sp/dialog/DialogContentWithoutTemplate":function(){define(["dojo","dijit","dojo/dom-class","dojo/query","dijit/_Widget","sp/I18n"],function(dojo,_f05,_f06,_f07,_f08,_f09){return dojo.declare([_f08],{dialog:null,milkElement:null,closeLinkText:null,skipDialogInit:false,constructor:function(){this.closeLinkText=_f09.get("sp","I18nWidget")("close_link");},postMixInProperties:function(){this.inherited(arguments);if(!this.i18n&&this.dialog&&this.dialog.i18n){this.i18n=this.dialog.i18n;}},postCreate:function(){this.inherited("postCreate",arguments);if(!this.skipDialogInit&&this.dialog){var _f0a=dojo.query(".dijitTooltipFocusNode",this.dialog.domNode)[0];this.dialog.attr("content",this);if(this.closeLinkText&&this.closeLinkText.length>0){this._createCloseLink(this.closeLinkText);}if(_f0a){dojo.attr(_f0a,"title","");if(_f0a.firstChild){dojo.attr(_f0a.firstChild,"title","");}var _f0b=dojo.doc.createElement("span");dojo.addClass(_f0b,"spinner-small");this.milkElement=dojo.doc.createElement("div");dojo.addClass(this.milkElement,"milk");dojo.addClass(this.milkElement,"hideBlock");dojo.place(_f0b,this.milkElement,"first");dojo.place(this.milkElement,_f0a,"first");}}dojo.behavior.apply(this.domNode);},_createCloseLink:function(_f0c){var _f0d=dojo.doc.createElement("div");dojo.addClass(_f0d,"closeLinkDiv");var _f0e=dojo.doc.createElement("span");_f0e.innerHTML=_f0c;dojo.addClass(_f0e,"closeLink");dojo.connect(_f0e,"onclick",dojo.hitch(this,function(e){this._cancelClick(e);}));dojo.place(_f0e,_f0d,"first");dojo.place(_f0d,this.domNode,"last");},_executeClick:function(_f0f){if(this.dialog&&this.dialog._onSubmit){var _f10=(!sp.info.document)?"boardsAction":"toolAction";sp.global.analytics.trackEvent(_f10,"participantInvited");this.dialog._onSubmit(_f0f);}this.showMilk();},showMilk:function(){if(this.milkElement){dojo.removeClass(this.milkElement,"hideBlock");}},hideMilk:function(){if(this.milkElement){dojo.addClass(this.milkElement,"hideBlock");}},_cancelClick:function(_f11){if(this.dialog&&this.dialog.onCancel){this.dialog.onCancel(_f11);}},_executeOnEnter:function(_f12){if(_f12.charOrCode){if(_f12.charOrCode==dojo.keys.ENTER){this._executeClick(_f12);}}}});});},"sp/dialog/NewPortfolioDialog":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/on","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/keys","dijit/focus","sp/dialog/TooltipDialog","sp/dialog/DialogContent","sp/ajax/AjaxEngine","sp/infos/InfoManager","sp/I18n","cb/Capabilities","dojo/i18n!./nls/NewPortfolioDialog","dojo/text!./NewPortfolioDialog.html","cb/widget/BigSwitch"],function(_f13,lang,on,_f14,_f15,_f16,keys,_f17,_f18,_f19,_f1a,_f1b,_f1c,_f1d,i18n,_f1e){var _f1f=_f13([_f19],{i18n:i18n,portfolioId:null,templateString:_f1e,widgetsInTemplate:true,newProjectTitle:null,passphraseActive:false,postMixInProperties:function(){this.inherited(arguments);if(sp.info.user.info.accountType.asString==="basic"){this.projectsLabel=_f1c.wrap(i18n)("create_project_label_basic");this.passphraseLabel=_f1c.wrap(i18n)("passphrase_label_basic");}else{this.projectsLabel=_f1c.wrap(i18n)("create_project_label");this.passphraseLabel=_f1c.wrap(i18n)("passphrase_label");}},postCreate:function(){this.inherited(arguments);this.kepressListener=on(window.document,"keypress",dojo.hitch(this,function(e){if(e.which===keys.ENTER){this._handleCreateButtonClick();}}));},_togglePassphrase:function(_f20){if(_f20){_f15.remove(this._passphraseContainer,"disabled");this._passphraseSwitch.set("disabled",false);}else{_f15.add(this._passphraseContainer,"disabled");this.passphraseActive=false;_f15.add(this._passphraseInput,"hideBlock");this._passphraseSwitch.set("disabled",true);this._passphraseSwitch.set("checked",false);}},_handleCloseButtonClick:function(){this.dialog.hide();},_handleCreateButtonClick:function(){window.setTimeout(dojo.hitch(this,function(){this._showActivityIndicator();}),1);this._createPortfolio({portfolioTitle:_f14.get(this._nameInput,"value")}).then(dojo.hitch(this,function(_f21){var _f22=_f14.get(this._passphraseInput,"value");if(_f22!==""&&this.passphraseActive){return _f1a.changePortfolioAccessControl({portfolioId:_f21.portfolioId,token:_f22}).then(function(_f23){return _f21;});}else{return _f21;}})).then(dojo.hitch(this,this._cleanup),dojo.hitch(this,this._cleanup)).then(dojo.hitch(this,this.onCreateSuccess),dojo.hitch(this,this.onCreateError));},_handlePassphraseSwitchChange:function(){if(!this._passphraseSwitch.disabled){this.passphraseActive=(!this.passphraseActive);_f15.toggle(this._passphraseInput,"hideBlock",!this.passphraseActive);_f17.focus(this._passphraseInput);}},_showActivityIndicator:function(){_f15.toggle(this._documentCreateForm,"hideBlock",true);_f15.toggle(this._documentCreateIndicator,"hideBlock",false);},onCreateSuccess:function(_f24){window.location="#p="+_f24.portfolioId;this.dialog.hide();},onCreateError:function(_f25){},_createPortfolio:function(args){return _f1a.createPortfolio({portfolioTitle:args.portfolioTitle}).then(lang.hitch(this,function(_f26){this._cleanup(_f26);return _f26;}));},_cleanup:function(_f27){window.setTimeout(lang.hitch(this,function(){if(_f27.documentId){_f1b.invalidateById({type:"document",id:_f27.documentId});}if(_f27.portfolioId){_f1b.invalidateById({type:"portfolio",id:_f27.portfolioId});}_f1b.invalidateById({type:"portfolios",id:sp.info.user.info.id});}),1);return _f27;}});return _f13([_f18],{complexOrient:["after-centered","before-centered","below-centered","above-centered","before","after"],baseClass:"create-new-board-dialog with-title",portfolioId:null,autofocus:true,postCreate:function(){this.inherited(arguments);this.content=new _f1f({dialog:this,portfolioId:this.portfolioId,postCreate:function(){this.inherited("postCreate",arguments);}});},onHide:function(){this.content.kepressListener.remove();}});});},"*now":function(r){r(["dojo/i18n!*preload*layer/nls/sp-lvl-1*[\"en\",\"de\",\"fr\",\"ROOT\"]"]);}}});define("layer/sp-lvl-1",["dijit","dojo","dojox","dojo/require!sp/JavaDeployer,sp/TasksList,dijit/form/Select,dijit/layout/BorderContainer,cb/infobanner/BannerManager,cb/infobanner/Container,dijit/layout/ContentPane,cb/widget/SearchSubmit,cb/page/dashboard/MainContent,cb/contacts/ContactsPage,cb/page/dashboard/personalcontainer/Navigation,cb/page/boards/personalcontainer/Filter,cb/page/boards/toolbar/Toolbar,cb/page/boards/DocumentSelector,cb/page/upgrade/Page,cb/ext/skrollr,cb/personalcontainer/header/Header,cb/personalcontainer/container/Sidebar,cb/personalcontainer/container/LogoContainer,cb/personalcontainer/container/UploadBox,cb/page/profile_account/SocialConnectionList,cb/freezing/FreezeOverlay,cb/widget/InstallChromeAppDialog,cb/notifications/Announcements"],function(_f28,dojo,_f29){dojo.provide("layer.sp-lvl-1");dojo.require("sp.JavaDeployer");dojo.require("sp.TasksList");dojo.require("dijit.form.Select");dojo.require("dijit.layout.BorderContainer");dojo.require("cb.infobanner.BannerManager");dojo.require("cb.infobanner.Container");dojo.require("dijit.layout.ContentPane");dojo.require("cb.widget.SearchSubmit");dojo.require("cb.page.dashboard.MainContent");dojo.require("cb.contacts.ContactsPage");dojo.require("cb.page.dashboard.personalcontainer.Navigation");dojo.require("cb.page.boards.personalcontainer.Filter");dojo.require("cb.page.boards.toolbar.Toolbar");dojo.require("cb.page.boards.DocumentSelector");dojo.require("cb.page.upgrade.Page");dojo.require("cb.ext.skrollr");dojo.require("cb.personalcontainer.header.Header");dojo.require("cb.personalcontainer.container.Sidebar");dojo.require("cb.personalcontainer.container.LogoContainer");dojo.require("cb.personalcontainer.container.UploadBox");dojo.require("cb.page.profile_account.SocialConnectionList");dojo.require("cb.freezing.FreezeOverlay");dojo.require("cb.widget.InstallChromeAppDialog");dojo.require("cb.notifications.Announcements");});
////@ sourceURL=/_/js-master-REL-153/layer/sp-lvl-1.js